(()=>{var Go=Object.create;var Se=Object.defineProperty;var Uo=Object.getOwnPropertyDescriptor;var No=Object.getOwnPropertyNames;var qo=Object.getPrototypeOf,Qo=Object.prototype.hasOwnProperty;var Xo=(i,e,t)=>e in i?Se(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var U=(i,e)=>()=>(i&&(e=i(i=0)),e);var S=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),le=(i,e)=>{for(var t in e)Se(i,t,{get:e[t],enumerable:!0})},Wt=(i,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of No(e))!Qo.call(i,a)&&a!==t&&Se(i,a,{get:()=>e[a],enumerable:!(n=Uo(e,a))||n.enumerable});return i};var Ve=(i,e,t)=>(t=i!=null?Go(qo(i)):{},Wt(e||!i||!i.__esModule?Se(t,"default",{value:i,enumerable:!0}):t,i)),me=i=>Wt(Se({},"__esModule",{value:!0}),i);var Pe=(i,e,t)=>(Xo(i,typeof e!="symbol"?e+"":e,t),t);var jt=S(()=>{PP={}});var Q={};le(Q,{ARRAY_TYPE:()=>F,EPSILON:()=>O,RANDOM:()=>J,equals:()=>Yo,setMatrixArrayType:()=>Ko,toRadian:()=>Zo});function Ko(i){F=i}function Zo(i){return i*Jo}function Yo(i,e){return Math.abs(i-e)<=O*Math.max(1,Math.abs(i),Math.abs(e))}var O,F,J,Jo,ae=U(()=>{O=1e-6,F=typeof Float32Array<"u"?Float32Array:Array,J=Math.random;Jo=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)})});var q={};le(q,{add:()=>Tr,adjoint:()=>rr,clone:()=>er,copy:()=>tr,create:()=>et,determinant:()=>lr,equals:()=>Mr,exactEquals:()=>br,frob:()=>vr,fromMat2d:()=>dr,fromMat4:()=>$o,fromQuat:()=>_r,fromRotation:()=>hr,fromScaling:()=>pr,fromTranslation:()=>ur,fromValues:()=>ir,identity:()=>ar,invert:()=>or,mul:()=>Ar,multiply:()=>zt,multiplyScalar:()=>Cr,multiplyScalarAndAdd:()=>Sr,normalFromMat4:()=>Pr,projection:()=>gr,rotate:()=>yr,scale:()=>cr,set:()=>nr,str:()=>fr,sub:()=>Ir,subtract:()=>Gt,translate:()=>mr,transpose:()=>sr});function et(){var i=new F(9);return F!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function $o(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i}function er(i){var e=new F(9);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e}function tr(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i}function ir(i,e,t,n,a,s,o,l,m){var c=new F(9);return c[0]=i,c[1]=e,c[2]=t,c[3]=n,c[4]=a,c[5]=s,c[6]=o,c[7]=l,c[8]=m,c}function nr(i,e,t,n,a,s,o,l,m,c){return i[0]=e,i[1]=t,i[2]=n,i[3]=a,i[4]=s,i[5]=o,i[6]=l,i[7]=m,i[8]=c,i}function ar(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}function sr(i,e){if(i===e){var t=e[1],n=e[2],a=e[5];i[1]=e[3],i[2]=e[6],i[3]=t,i[5]=e[7],i[6]=n,i[7]=a}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i}function or(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],m=e[6],c=e[7],r=e[8],y=r*o-l*c,u=-r*s+l*m,p=c*s-o*m,d=t*y+n*u+a*p;return d?(d=1/d,i[0]=y*d,i[1]=(-r*n+a*c)*d,i[2]=(l*n-a*o)*d,i[3]=u*d,i[4]=(r*t-a*m)*d,i[5]=(-l*t+a*s)*d,i[6]=p*d,i[7]=(-c*t+n*m)*d,i[8]=(o*t-n*s)*d,i):null}function rr(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],m=e[6],c=e[7],r=e[8];return i[0]=o*r-l*c,i[1]=a*c-n*r,i[2]=n*l-a*o,i[3]=l*m-s*r,i[4]=t*r-a*m,i[5]=a*s-t*l,i[6]=s*c-o*m,i[7]=n*m-t*c,i[8]=t*o-n*s,i}function lr(i){var e=i[0],t=i[1],n=i[2],a=i[3],s=i[4],o=i[5],l=i[6],m=i[7],c=i[8];return e*(c*s-o*m)+t*(-c*a+o*l)+n*(m*a-s*l)}function zt(i,e,t){var n=e[0],a=e[1],s=e[2],o=e[3],l=e[4],m=e[5],c=e[6],r=e[7],y=e[8],u=t[0],p=t[1],d=t[2],_=t[3],h=t[4],P=t[5],T=t[6],v=t[7],f=t[8];return i[0]=u*n+p*o+d*c,i[1]=u*a+p*l+d*r,i[2]=u*s+p*m+d*y,i[3]=_*n+h*o+P*c,i[4]=_*a+h*l+P*r,i[5]=_*s+h*m+P*y,i[6]=T*n+v*o+f*c,i[7]=T*a+v*l+f*r,i[8]=T*s+v*m+f*y,i}function mr(i,e,t){var n=e[0],a=e[1],s=e[2],o=e[3],l=e[4],m=e[5],c=e[6],r=e[7],y=e[8],u=t[0],p=t[1];return i[0]=n,i[1]=a,i[2]=s,i[3]=o,i[4]=l,i[5]=m,i[6]=u*n+p*o+c,i[7]=u*a+p*l+r,i[8]=u*s+p*m+y,i}function yr(i,e,t){var n=e[0],a=e[1],s=e[2],o=e[3],l=e[4],m=e[5],c=e[6],r=e[7],y=e[8],u=Math.sin(t),p=Math.cos(t);return i[0]=p*n+u*o,i[1]=p*a+u*l,i[2]=p*s+u*m,i[3]=p*o-u*n,i[4]=p*l-u*a,i[5]=p*m-u*s,i[6]=c,i[7]=r,i[8]=y,i}function cr(i,e,t){var n=t[0],a=t[1];return i[0]=n*e[0],i[1]=n*e[1],i[2]=n*e[2],i[3]=a*e[3],i[4]=a*e[4],i[5]=a*e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i}function ur(i,e){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=e[0],i[7]=e[1],i[8]=1,i}function hr(i,e){var t=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=t,i[2]=0,i[3]=-t,i[4]=n,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}function pr(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=e[1],i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}function dr(i,e){return i[0]=e[0],i[1]=e[1],i[2]=0,i[3]=e[2],i[4]=e[3],i[5]=0,i[6]=e[4],i[7]=e[5],i[8]=1,i}function _r(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=t+t,l=n+n,m=a+a,c=t*o,r=n*o,y=n*l,u=a*o,p=a*l,d=a*m,_=s*o,h=s*l,P=s*m;return i[0]=1-y-d,i[3]=r-P,i[6]=u+h,i[1]=r+P,i[4]=1-c-d,i[7]=p-_,i[2]=u-h,i[5]=p+_,i[8]=1-c-y,i}function Pr(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],m=e[6],c=e[7],r=e[8],y=e[9],u=e[10],p=e[11],d=e[12],_=e[13],h=e[14],P=e[15],T=t*l-n*o,v=t*m-a*o,f=t*c-s*o,g=n*m-a*l,C=n*c-s*l,M=a*c-s*m,b=r*_-y*d,A=r*h-u*d,I=r*P-p*d,V=y*h-u*_,D=y*P-p*_,B=u*P-p*h,L=T*B-v*D+f*V+g*I-C*A+M*b;return L?(L=1/L,i[0]=(l*B-m*D+c*V)*L,i[1]=(m*I-o*B-c*A)*L,i[2]=(o*D-l*I+c*b)*L,i[3]=(a*D-n*B-s*V)*L,i[4]=(t*B-a*I+s*A)*L,i[5]=(n*I-t*D-s*b)*L,i[6]=(_*M-h*C+P*g)*L,i[7]=(h*f-d*M-P*v)*L,i[8]=(d*C-_*f+P*T)*L,i):null}function gr(i,e,t){return i[0]=2/e,i[1]=0,i[2]=0,i[3]=0,i[4]=-2/t,i[5]=0,i[6]=-1,i[7]=1,i[8]=1,i}function fr(i){return"mat3("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+")"}function vr(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])}function Tr(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i}function Gt(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i}function Cr(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i}function Sr(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i[2]=e[2]+t[2]*n,i[3]=e[3]+t[3]*n,i[4]=e[4]+t[4]*n,i[5]=e[5]+t[5]*n,i[6]=e[6]+t[6]*n,i[7]=e[7]+t[7]*n,i[8]=e[8]+t[8]*n,i}function br(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]&&i[4]===e[4]&&i[5]===e[5]&&i[6]===e[6]&&i[7]===e[7]&&i[8]===e[8]}function Mr(i,e){var t=i[0],n=i[1],a=i[2],s=i[3],o=i[4],l=i[5],m=i[6],c=i[7],r=i[8],y=e[0],u=e[1],p=e[2],d=e[3],_=e[4],h=e[5],P=e[6],T=e[7],v=e[8];return Math.abs(t-y)<=O*Math.max(1,Math.abs(t),Math.abs(y))&&Math.abs(n-u)<=O*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(a-p)<=O*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-d)<=O*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(o-_)<=O*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(l-h)<=O*Math.max(1,Math.abs(l),Math.abs(h))&&Math.abs(m-P)<=O*Math.max(1,Math.abs(m),Math.abs(P))&&Math.abs(c-T)<=O*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(r-v)<=O*Math.max(1,Math.abs(r),Math.abs(v))}var Ar,Ir,tt=U(()=>{ae();Ar=zt,Ir=Gt});var k={};le(k,{add:()=>ml,adjoint:()=>Hr,clone:()=>Rr,copy:()=>Vr,create:()=>xr,determinant:()=>Er,equals:()=>hl,exactEquals:()=>ul,frob:()=>ll,fromQuat:()=>Yr,fromQuat2:()=>Kr,fromRotation:()=>Nr,fromRotationTranslation:()=>qt,fromRotationTranslationScale:()=>Jr,fromRotationTranslationScaleOrigin:()=>Zr,fromScaling:()=>Ur,fromTranslation:()=>Gr,fromValues:()=>Dr,fromXRotation:()=>qr,fromYRotation:()=>Qr,fromZRotation:()=>Xr,frustum:()=>$r,getRotation:()=>nt,getScaling:()=>Qt,getTranslation:()=>it,identity:()=>Ut,invert:()=>Or,lookAt:()=>sl,mul:()=>pl,multiply:()=>Nt,multiplyScalar:()=>yl,multiplyScalarAndAdd:()=>cl,ortho:()=>nl,orthoNO:()=>Kt,orthoZO:()=>al,perspective:()=>el,perspectiveFromFieldOfView:()=>il,perspectiveNO:()=>Xt,perspectiveZO:()=>tl,rotate:()=>wr,rotateX:()=>Wr,rotateY:()=>jr,rotateZ:()=>zr,scale:()=>Fr,set:()=>Lr,str:()=>rl,sub:()=>dl,subtract:()=>Jt,targetTo:()=>ol,translate:()=>kr,transpose:()=>Br});function xr(){var i=new F(16);return F!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i}function Rr(i){var e=new F(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e}function Vr(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function Dr(i,e,t,n,a,s,o,l,m,c,r,y,u,p,d,_){var h=new F(16);return h[0]=i,h[1]=e,h[2]=t,h[3]=n,h[4]=a,h[5]=s,h[6]=o,h[7]=l,h[8]=m,h[9]=c,h[10]=r,h[11]=y,h[12]=u,h[13]=p,h[14]=d,h[15]=_,h}function Lr(i,e,t,n,a,s,o,l,m,c,r,y,u,p,d,_,h){return i[0]=e,i[1]=t,i[2]=n,i[3]=a,i[4]=s,i[5]=o,i[6]=l,i[7]=m,i[8]=c,i[9]=r,i[10]=y,i[11]=u,i[12]=p,i[13]=d,i[14]=_,i[15]=h,i}function Ut(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Br(i,e){if(i===e){var t=e[1],n=e[2],a=e[3],s=e[6],o=e[7],l=e[11];i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=t,i[6]=e[9],i[7]=e[13],i[8]=n,i[9]=s,i[11]=e[14],i[12]=a,i[13]=o,i[14]=l}else i[0]=e[0],i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=e[1],i[5]=e[5],i[6]=e[9],i[7]=e[13],i[8]=e[2],i[9]=e[6],i[10]=e[10],i[11]=e[14],i[12]=e[3],i[13]=e[7],i[14]=e[11],i[15]=e[15];return i}function Or(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],m=e[6],c=e[7],r=e[8],y=e[9],u=e[10],p=e[11],d=e[12],_=e[13],h=e[14],P=e[15],T=t*l-n*o,v=t*m-a*o,f=t*c-s*o,g=n*m-a*l,C=n*c-s*l,M=a*c-s*m,b=r*_-y*d,A=r*h-u*d,I=r*P-p*d,V=y*h-u*_,D=y*P-p*_,B=u*P-p*h,L=T*B-v*D+f*V+g*I-C*A+M*b;return L?(L=1/L,i[0]=(l*B-m*D+c*V)*L,i[1]=(a*D-n*B-s*V)*L,i[2]=(_*M-h*C+P*g)*L,i[3]=(u*C-y*M-p*g)*L,i[4]=(m*I-o*B-c*A)*L,i[5]=(t*B-a*I+s*A)*L,i[6]=(h*f-d*M-P*v)*L,i[7]=(r*M-u*f+p*v)*L,i[8]=(o*D-l*I+c*b)*L,i[9]=(n*I-t*D-s*b)*L,i[10]=(d*C-_*f+P*T)*L,i[11]=(y*f-r*C-p*T)*L,i[12]=(l*A-o*V-m*b)*L,i[13]=(t*V-n*A+a*b)*L,i[14]=(_*v-d*g-h*T)*L,i[15]=(r*g-y*v+u*T)*L,i):null}function Hr(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],m=e[6],c=e[7],r=e[8],y=e[9],u=e[10],p=e[11],d=e[12],_=e[13],h=e[14],P=e[15];return i[0]=l*(u*P-p*h)-y*(m*P-c*h)+_*(m*p-c*u),i[1]=-(n*(u*P-p*h)-y*(a*P-s*h)+_*(a*p-s*u)),i[2]=n*(m*P-c*h)-l*(a*P-s*h)+_*(a*c-s*m),i[3]=-(n*(m*p-c*u)-l*(a*p-s*u)+y*(a*c-s*m)),i[4]=-(o*(u*P-p*h)-r*(m*P-c*h)+d*(m*p-c*u)),i[5]=t*(u*P-p*h)-r*(a*P-s*h)+d*(a*p-s*u),i[6]=-(t*(m*P-c*h)-o*(a*P-s*h)+d*(a*c-s*m)),i[7]=t*(m*p-c*u)-o*(a*p-s*u)+r*(a*c-s*m),i[8]=o*(y*P-p*_)-r*(l*P-c*_)+d*(l*p-c*y),i[9]=-(t*(y*P-p*_)-r*(n*P-s*_)+d*(n*p-s*y)),i[10]=t*(l*P-c*_)-o*(n*P-s*_)+d*(n*c-s*l),i[11]=-(t*(l*p-c*y)-o*(n*p-s*y)+r*(n*c-s*l)),i[12]=-(o*(y*h-u*_)-r*(l*h-m*_)+d*(l*u-m*y)),i[13]=t*(y*h-u*_)-r*(n*h-a*_)+d*(n*u-a*y),i[14]=-(t*(l*h-m*_)-o*(n*h-a*_)+d*(n*m-a*l)),i[15]=t*(l*u-m*y)-o*(n*u-a*y)+r*(n*m-a*l),i}function Er(i){var e=i[0],t=i[1],n=i[2],a=i[3],s=i[4],o=i[5],l=i[6],m=i[7],c=i[8],r=i[9],y=i[10],u=i[11],p=i[12],d=i[13],_=i[14],h=i[15],P=e*o-t*s,T=e*l-n*s,v=e*m-a*s,f=t*l-n*o,g=t*m-a*o,C=n*m-a*l,M=c*d-r*p,b=c*_-y*p,A=c*h-u*p,I=r*_-y*d,V=r*h-u*d,D=y*h-u*_;return P*D-T*V+v*I+f*A-g*b+C*M}function Nt(i,e,t){var n=e[0],a=e[1],s=e[2],o=e[3],l=e[4],m=e[5],c=e[6],r=e[7],y=e[8],u=e[9],p=e[10],d=e[11],_=e[12],h=e[13],P=e[14],T=e[15],v=t[0],f=t[1],g=t[2],C=t[3];return i[0]=v*n+f*l+g*y+C*_,i[1]=v*a+f*m+g*u+C*h,i[2]=v*s+f*c+g*p+C*P,i[3]=v*o+f*r+g*d+C*T,v=t[4],f=t[5],g=t[6],C=t[7],i[4]=v*n+f*l+g*y+C*_,i[5]=v*a+f*m+g*u+C*h,i[6]=v*s+f*c+g*p+C*P,i[7]=v*o+f*r+g*d+C*T,v=t[8],f=t[9],g=t[10],C=t[11],i[8]=v*n+f*l+g*y+C*_,i[9]=v*a+f*m+g*u+C*h,i[10]=v*s+f*c+g*p+C*P,i[11]=v*o+f*r+g*d+C*T,v=t[12],f=t[13],g=t[14],C=t[15],i[12]=v*n+f*l+g*y+C*_,i[13]=v*a+f*m+g*u+C*h,i[14]=v*s+f*c+g*p+C*P,i[15]=v*o+f*r+g*d+C*T,i}function kr(i,e,t){var n=t[0],a=t[1],s=t[2],o,l,m,c,r,y,u,p,d,_,h,P;return e===i?(i[12]=e[0]*n+e[4]*a+e[8]*s+e[12],i[13]=e[1]*n+e[5]*a+e[9]*s+e[13],i[14]=e[2]*n+e[6]*a+e[10]*s+e[14],i[15]=e[3]*n+e[7]*a+e[11]*s+e[15]):(o=e[0],l=e[1],m=e[2],c=e[3],r=e[4],y=e[5],u=e[6],p=e[7],d=e[8],_=e[9],h=e[10],P=e[11],i[0]=o,i[1]=l,i[2]=m,i[3]=c,i[4]=r,i[5]=y,i[6]=u,i[7]=p,i[8]=d,i[9]=_,i[10]=h,i[11]=P,i[12]=o*n+r*a+d*s+e[12],i[13]=l*n+y*a+_*s+e[13],i[14]=m*n+u*a+h*s+e[14],i[15]=c*n+p*a+P*s+e[15]),i}function Fr(i,e,t){var n=t[0],a=t[1],s=t[2];return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=e[3]*n,i[4]=e[4]*a,i[5]=e[5]*a,i[6]=e[6]*a,i[7]=e[7]*a,i[8]=e[8]*s,i[9]=e[9]*s,i[10]=e[10]*s,i[11]=e[11]*s,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}function wr(i,e,t,n){var a=n[0],s=n[1],o=n[2],l=Math.hypot(a,s,o),m,c,r,y,u,p,d,_,h,P,T,v,f,g,C,M,b,A,I,V,D,B,L,w;return l<O?null:(l=1/l,a*=l,s*=l,o*=l,m=Math.sin(t),c=Math.cos(t),r=1-c,y=e[0],u=e[1],p=e[2],d=e[3],_=e[4],h=e[5],P=e[6],T=e[7],v=e[8],f=e[9],g=e[10],C=e[11],M=a*a*r+c,b=s*a*r+o*m,A=o*a*r-s*m,I=a*s*r-o*m,V=s*s*r+c,D=o*s*r+a*m,B=a*o*r+s*m,L=s*o*r-a*m,w=o*o*r+c,i[0]=y*M+_*b+v*A,i[1]=u*M+h*b+f*A,i[2]=p*M+P*b+g*A,i[3]=d*M+T*b+C*A,i[4]=y*I+_*V+v*D,i[5]=u*I+h*V+f*D,i[6]=p*I+P*V+g*D,i[7]=d*I+T*V+C*D,i[8]=y*B+_*L+v*w,i[9]=u*B+h*L+f*w,i[10]=p*B+P*L+g*w,i[11]=d*B+T*L+C*w,e!==i&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i)}function Wr(i,e,t){var n=Math.sin(t),a=Math.cos(t),s=e[4],o=e[5],l=e[6],m=e[7],c=e[8],r=e[9],y=e[10],u=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=s*a+c*n,i[5]=o*a+r*n,i[6]=l*a+y*n,i[7]=m*a+u*n,i[8]=c*a-s*n,i[9]=r*a-o*n,i[10]=y*a-l*n,i[11]=u*a-m*n,i}function jr(i,e,t){var n=Math.sin(t),a=Math.cos(t),s=e[0],o=e[1],l=e[2],m=e[3],c=e[8],r=e[9],y=e[10],u=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=s*a-c*n,i[1]=o*a-r*n,i[2]=l*a-y*n,i[3]=m*a-u*n,i[8]=s*n+c*a,i[9]=o*n+r*a,i[10]=l*n+y*a,i[11]=m*n+u*a,i}function zr(i,e,t){var n=Math.sin(t),a=Math.cos(t),s=e[0],o=e[1],l=e[2],m=e[3],c=e[4],r=e[5],y=e[6],u=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=s*a+c*n,i[1]=o*a+r*n,i[2]=l*a+y*n,i[3]=m*a+u*n,i[4]=c*a-s*n,i[5]=r*a-o*n,i[6]=y*a-l*n,i[7]=u*a-m*n,i}function Gr(i,e){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i}function Ur(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Nr(i,e,t){var n=t[0],a=t[1],s=t[2],o=Math.hypot(n,a,s),l,m,c;return o<O?null:(o=1/o,n*=o,a*=o,s*=o,l=Math.sin(e),m=Math.cos(e),c=1-m,i[0]=n*n*c+m,i[1]=a*n*c+s*l,i[2]=s*n*c-a*l,i[3]=0,i[4]=n*a*c-s*l,i[5]=a*a*c+m,i[6]=s*a*c+n*l,i[7]=0,i[8]=n*s*c+a*l,i[9]=a*s*c-n*l,i[10]=s*s*c+m,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}function qr(i,e){var t=Math.sin(e),n=Math.cos(e);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n,i[6]=t,i[7]=0,i[8]=0,i[9]=-t,i[10]=n,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Qr(i,e){var t=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=0,i[2]=-t,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=t,i[9]=0,i[10]=n,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Xr(i,e){var t=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=t,i[2]=0,i[3]=0,i[4]=-t,i[5]=n,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function qt(i,e,t){var n=e[0],a=e[1],s=e[2],o=e[3],l=n+n,m=a+a,c=s+s,r=n*l,y=n*m,u=n*c,p=a*m,d=a*c,_=s*c,h=o*l,P=o*m,T=o*c;return i[0]=1-(p+_),i[1]=y+T,i[2]=u-P,i[3]=0,i[4]=y-T,i[5]=1-(r+_),i[6]=d+h,i[7]=0,i[8]=u+P,i[9]=d-h,i[10]=1-(r+p),i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}function Kr(i,e){var t=new F(3),n=-e[0],a=-e[1],s=-e[2],o=e[3],l=e[4],m=e[5],c=e[6],r=e[7],y=n*n+a*a+s*s+o*o;return y>0?(t[0]=(l*o+r*n+m*s-c*a)*2/y,t[1]=(m*o+r*a+c*n-l*s)*2/y,t[2]=(c*o+r*s+l*a-m*n)*2/y):(t[0]=(l*o+r*n+m*s-c*a)*2,t[1]=(m*o+r*a+c*n-l*s)*2,t[2]=(c*o+r*s+l*a-m*n)*2),qt(i,e,t),i}function it(i,e){return i[0]=e[12],i[1]=e[13],i[2]=e[14],i}function Qt(i,e){var t=e[0],n=e[1],a=e[2],s=e[4],o=e[5],l=e[6],m=e[8],c=e[9],r=e[10];return i[0]=Math.hypot(t,n,a),i[1]=Math.hypot(s,o,l),i[2]=Math.hypot(m,c,r),i}function nt(i,e){var t=new F(3);Qt(t,e);var n=1/t[0],a=1/t[1],s=1/t[2],o=e[0]*n,l=e[1]*a,m=e[2]*s,c=e[4]*n,r=e[5]*a,y=e[6]*s,u=e[8]*n,p=e[9]*a,d=e[10]*s,_=o+r+d,h=0;return _>0?(h=Math.sqrt(_+1)*2,i[3]=.25*h,i[0]=(y-p)/h,i[1]=(u-m)/h,i[2]=(l-c)/h):o>r&&o>d?(h=Math.sqrt(1+o-r-d)*2,i[3]=(y-p)/h,i[0]=.25*h,i[1]=(l+c)/h,i[2]=(u+m)/h):r>d?(h=Math.sqrt(1+r-o-d)*2,i[3]=(u-m)/h,i[0]=(l+c)/h,i[1]=.25*h,i[2]=(y+p)/h):(h=Math.sqrt(1+d-o-r)*2,i[3]=(l-c)/h,i[0]=(u+m)/h,i[1]=(y+p)/h,i[2]=.25*h),i}function Jr(i,e,t,n){var a=e[0],s=e[1],o=e[2],l=e[3],m=a+a,c=s+s,r=o+o,y=a*m,u=a*c,p=a*r,d=s*c,_=s*r,h=o*r,P=l*m,T=l*c,v=l*r,f=n[0],g=n[1],C=n[2];return i[0]=(1-(d+h))*f,i[1]=(u+v)*f,i[2]=(p-T)*f,i[3]=0,i[4]=(u-v)*g,i[5]=(1-(y+h))*g,i[6]=(_+P)*g,i[7]=0,i[8]=(p+T)*C,i[9]=(_-P)*C,i[10]=(1-(y+d))*C,i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}function Zr(i,e,t,n,a){var s=e[0],o=e[1],l=e[2],m=e[3],c=s+s,r=o+o,y=l+l,u=s*c,p=s*r,d=s*y,_=o*r,h=o*y,P=l*y,T=m*c,v=m*r,f=m*y,g=n[0],C=n[1],M=n[2],b=a[0],A=a[1],I=a[2],V=(1-(_+P))*g,D=(p+f)*g,B=(d-v)*g,L=(p-f)*C,w=(1-(u+P))*C,E=(h+T)*C,j=(d+v)*M,G=(h-T)*M,X=(1-(u+_))*M;return i[0]=V,i[1]=D,i[2]=B,i[3]=0,i[4]=L,i[5]=w,i[6]=E,i[7]=0,i[8]=j,i[9]=G,i[10]=X,i[11]=0,i[12]=t[0]+b-(V*b+L*A+j*I),i[13]=t[1]+A-(D*b+w*A+G*I),i[14]=t[2]+I-(B*b+E*A+X*I),i[15]=1,i}function Yr(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=t+t,l=n+n,m=a+a,c=t*o,r=n*o,y=n*l,u=a*o,p=a*l,d=a*m,_=s*o,h=s*l,P=s*m;return i[0]=1-y-d,i[1]=r+P,i[2]=u-h,i[3]=0,i[4]=r-P,i[5]=1-c-d,i[6]=p+_,i[7]=0,i[8]=u+h,i[9]=p-_,i[10]=1-c-y,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function $r(i,e,t,n,a,s,o){var l=1/(t-e),m=1/(a-n),c=1/(s-o);return i[0]=s*2*l,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s*2*m,i[6]=0,i[7]=0,i[8]=(t+e)*l,i[9]=(a+n)*m,i[10]=(o+s)*c,i[11]=-1,i[12]=0,i[13]=0,i[14]=o*s*2*c,i[15]=0,i}function Xt(i,e,t,n,a){var s=1/Math.tan(e/2),o;return i[0]=s/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,a!=null&&a!==1/0?(o=1/(n-a),i[10]=(a+n)*o,i[14]=2*a*n*o):(i[10]=-1,i[14]=-2*n),i}function tl(i,e,t,n,a){var s=1/Math.tan(e/2),o;return i[0]=s/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=s,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,a!=null&&a!==1/0?(o=1/(n-a),i[10]=a*o,i[14]=a*n*o):(i[10]=-1,i[14]=-n),i}function il(i,e,t,n){var a=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),l=Math.tan(e.rightDegrees*Math.PI/180),m=2/(o+l),c=2/(a+s);return i[0]=m,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=c,i[6]=0,i[7]=0,i[8]=-((o-l)*m*.5),i[9]=(a-s)*c*.5,i[10]=n/(t-n),i[11]=-1,i[12]=0,i[13]=0,i[14]=n*t/(t-n),i[15]=0,i}function Kt(i,e,t,n,a,s,o){var l=1/(e-t),m=1/(n-a),c=1/(s-o);return i[0]=-2*l,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*m,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*c,i[11]=0,i[12]=(e+t)*l,i[13]=(a+n)*m,i[14]=(o+s)*c,i[15]=1,i}function al(i,e,t,n,a,s,o){var l=1/(e-t),m=1/(n-a),c=1/(s-o);return i[0]=-2*l,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*m,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=c,i[11]=0,i[12]=(e+t)*l,i[13]=(a+n)*m,i[14]=s*c,i[15]=1,i}function sl(i,e,t,n){var a,s,o,l,m,c,r,y,u,p,d=e[0],_=e[1],h=e[2],P=n[0],T=n[1],v=n[2],f=t[0],g=t[1],C=t[2];return Math.abs(d-f)<O&&Math.abs(_-g)<O&&Math.abs(h-C)<O?Ut(i):(r=d-f,y=_-g,u=h-C,p=1/Math.hypot(r,y,u),r*=p,y*=p,u*=p,a=T*u-v*y,s=v*r-P*u,o=P*y-T*r,p=Math.hypot(a,s,o),p?(p=1/p,a*=p,s*=p,o*=p):(a=0,s=0,o=0),l=y*o-u*s,m=u*a-r*o,c=r*s-y*a,p=Math.hypot(l,m,c),p?(p=1/p,l*=p,m*=p,c*=p):(l=0,m=0,c=0),i[0]=a,i[1]=l,i[2]=r,i[3]=0,i[4]=s,i[5]=m,i[6]=y,i[7]=0,i[8]=o,i[9]=c,i[10]=u,i[11]=0,i[12]=-(a*d+s*_+o*h),i[13]=-(l*d+m*_+c*h),i[14]=-(r*d+y*_+u*h),i[15]=1,i)}function ol(i,e,t,n){var a=e[0],s=e[1],o=e[2],l=n[0],m=n[1],c=n[2],r=a-t[0],y=s-t[1],u=o-t[2],p=r*r+y*y+u*u;p>0&&(p=1/Math.sqrt(p),r*=p,y*=p,u*=p);var d=m*u-c*y,_=c*r-l*u,h=l*y-m*r;return p=d*d+_*_+h*h,p>0&&(p=1/Math.sqrt(p),d*=p,_*=p,h*=p),i[0]=d,i[1]=_,i[2]=h,i[3]=0,i[4]=y*h-u*_,i[5]=u*d-r*h,i[6]=r*_-y*d,i[7]=0,i[8]=r,i[9]=y,i[10]=u,i[11]=0,i[12]=a,i[13]=s,i[14]=o,i[15]=1,i}function rl(i){return"mat4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+", "+i[9]+", "+i[10]+", "+i[11]+", "+i[12]+", "+i[13]+", "+i[14]+", "+i[15]+")"}function ll(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])}function ml(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i[9]=e[9]+t[9],i[10]=e[10]+t[10],i[11]=e[11]+t[11],i[12]=e[12]+t[12],i[13]=e[13]+t[13],i[14]=e[14]+t[14],i[15]=e[15]+t[15],i}function Jt(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i[9]=e[9]-t[9],i[10]=e[10]-t[10],i[11]=e[11]-t[11],i[12]=e[12]-t[12],i[13]=e[13]-t[13],i[14]=e[14]-t[14],i[15]=e[15]-t[15],i}function yl(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i[9]=e[9]*t,i[10]=e[10]*t,i[11]=e[11]*t,i[12]=e[12]*t,i[13]=e[13]*t,i[14]=e[14]*t,i[15]=e[15]*t,i}function cl(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i[2]=e[2]+t[2]*n,i[3]=e[3]+t[3]*n,i[4]=e[4]+t[4]*n,i[5]=e[5]+t[5]*n,i[6]=e[6]+t[6]*n,i[7]=e[7]+t[7]*n,i[8]=e[8]+t[8]*n,i[9]=e[9]+t[9]*n,i[10]=e[10]+t[10]*n,i[11]=e[11]+t[11]*n,i[12]=e[12]+t[12]*n,i[13]=e[13]+t[13]*n,i[14]=e[14]+t[14]*n,i[15]=e[15]+t[15]*n,i}function ul(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]&&i[4]===e[4]&&i[5]===e[5]&&i[6]===e[6]&&i[7]===e[7]&&i[8]===e[8]&&i[9]===e[9]&&i[10]===e[10]&&i[11]===e[11]&&i[12]===e[12]&&i[13]===e[13]&&i[14]===e[14]&&i[15]===e[15]}function hl(i,e){var t=i[0],n=i[1],a=i[2],s=i[3],o=i[4],l=i[5],m=i[6],c=i[7],r=i[8],y=i[9],u=i[10],p=i[11],d=i[12],_=i[13],h=i[14],P=i[15],T=e[0],v=e[1],f=e[2],g=e[3],C=e[4],M=e[5],b=e[6],A=e[7],I=e[8],V=e[9],D=e[10],B=e[11],L=e[12],w=e[13],E=e[14],j=e[15];return Math.abs(t-T)<=O*Math.max(1,Math.abs(t),Math.abs(T))&&Math.abs(n-v)<=O*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(a-f)<=O*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-g)<=O*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(o-C)<=O*Math.max(1,Math.abs(o),Math.abs(C))&&Math.abs(l-M)<=O*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(m-b)<=O*Math.max(1,Math.abs(m),Math.abs(b))&&Math.abs(c-A)<=O*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(r-I)<=O*Math.max(1,Math.abs(r),Math.abs(I))&&Math.abs(y-V)<=O*Math.max(1,Math.abs(y),Math.abs(V))&&Math.abs(u-D)<=O*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(p-B)<=O*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(d-L)<=O*Math.max(1,Math.abs(d),Math.abs(L))&&Math.abs(_-w)<=O*Math.max(1,Math.abs(_),Math.abs(w))&&Math.abs(h-E)<=O*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(P-j)<=O*Math.max(1,Math.abs(P),Math.abs(j))}var el,nl,pl,dl,at=U(()=>{ae();el=Xt;nl=Kt;pl=Nt,dl=Jt});var x={};le(x,{add:()=>fl,angle:()=>wl,bezier:()=>Dl,ceil:()=>vl,clone:()=>_l,copy:()=>Pl,create:()=>De,cross:()=>be,dist:()=>Ql,distance:()=>ti,div:()=>ql,divide:()=>ei,dot:()=>Be,equals:()=>Gl,exactEquals:()=>zl,floor:()=>Tl,forEach:()=>Jl,fromValues:()=>Le,hermite:()=>Vl,inverse:()=>xl,len:()=>ot,length:()=>Zt,lerp:()=>Rl,max:()=>Sl,min:()=>Cl,mul:()=>Nl,multiply:()=>$t,negate:()=>Il,normalize:()=>st,random:()=>Ll,rotateX:()=>El,rotateY:()=>kl,rotateZ:()=>Fl,round:()=>bl,scale:()=>Ml,scaleAndAdd:()=>Al,set:()=>gl,sqrDist:()=>Xl,sqrLen:()=>Kl,squaredDistance:()=>ii,squaredLength:()=>ni,str:()=>jl,sub:()=>Ul,subtract:()=>Yt,transformMat3:()=>Ol,transformMat4:()=>Bl,transformQuat:()=>Hl,zero:()=>Wl});function De(){var i=new F(3);return F!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function _l(i){var e=new F(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}function Zt(i){var e=i[0],t=i[1],n=i[2];return Math.hypot(e,t,n)}function Le(i,e,t){var n=new F(3);return n[0]=i,n[1]=e,n[2]=t,n}function Pl(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i}function gl(i,e,t,n){return i[0]=e,i[1]=t,i[2]=n,i}function fl(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i}function Yt(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i}function $t(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i}function ei(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i}function vl(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i[2]=Math.ceil(e[2]),i}function Tl(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i[2]=Math.floor(e[2]),i}function Cl(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i}function Sl(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i}function bl(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i[2]=Math.round(e[2]),i}function Ml(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i}function Al(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i[2]=e[2]+t[2]*n,i}function ti(i,e){var t=e[0]-i[0],n=e[1]-i[1],a=e[2]-i[2];return Math.hypot(t,n,a)}function ii(i,e){var t=e[0]-i[0],n=e[1]-i[1],a=e[2]-i[2];return t*t+n*n+a*a}function ni(i){var e=i[0],t=i[1],n=i[2];return e*e+t*t+n*n}function Il(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i}function xl(i,e){return i[0]=1/e[0],i[1]=1/e[1],i[2]=1/e[2],i}function st(i,e){var t=e[0],n=e[1],a=e[2],s=t*t+n*n+a*a;return s>0&&(s=1/Math.sqrt(s)),i[0]=e[0]*s,i[1]=e[1]*s,i[2]=e[2]*s,i}function Be(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}function be(i,e,t){var n=e[0],a=e[1],s=e[2],o=t[0],l=t[1],m=t[2];return i[0]=a*m-s*l,i[1]=s*o-n*m,i[2]=n*l-a*o,i}function Rl(i,e,t,n){var a=e[0],s=e[1],o=e[2];return i[0]=a+n*(t[0]-a),i[1]=s+n*(t[1]-s),i[2]=o+n*(t[2]-o),i}function Vl(i,e,t,n,a,s){var o=s*s,l=o*(2*s-3)+1,m=o*(s-2)+s,c=o*(s-1),r=o*(3-2*s);return i[0]=e[0]*l+t[0]*m+n[0]*c+a[0]*r,i[1]=e[1]*l+t[1]*m+n[1]*c+a[1]*r,i[2]=e[2]*l+t[2]*m+n[2]*c+a[2]*r,i}function Dl(i,e,t,n,a,s){var o=1-s,l=o*o,m=s*s,c=l*o,r=3*s*l,y=3*m*o,u=m*s;return i[0]=e[0]*c+t[0]*r+n[0]*y+a[0]*u,i[1]=e[1]*c+t[1]*r+n[1]*y+a[1]*u,i[2]=e[2]*c+t[2]*r+n[2]*y+a[2]*u,i}function Ll(i,e){e=e||1;var t=J()*2*Math.PI,n=J()*2-1,a=Math.sqrt(1-n*n)*e;return i[0]=Math.cos(t)*a,i[1]=Math.sin(t)*a,i[2]=n*e,i}function Bl(i,e,t){var n=e[0],a=e[1],s=e[2],o=t[3]*n+t[7]*a+t[11]*s+t[15];return o=o||1,i[0]=(t[0]*n+t[4]*a+t[8]*s+t[12])/o,i[1]=(t[1]*n+t[5]*a+t[9]*s+t[13])/o,i[2]=(t[2]*n+t[6]*a+t[10]*s+t[14])/o,i}function Ol(i,e,t){var n=e[0],a=e[1],s=e[2];return i[0]=n*t[0]+a*t[3]+s*t[6],i[1]=n*t[1]+a*t[4]+s*t[7],i[2]=n*t[2]+a*t[5]+s*t[8],i}function Hl(i,e,t){var n=t[0],a=t[1],s=t[2],o=t[3],l=e[0],m=e[1],c=e[2],r=a*c-s*m,y=s*l-n*c,u=n*m-a*l,p=a*u-s*y,d=s*r-n*u,_=n*y-a*r,h=o*2;return r*=h,y*=h,u*=h,p*=2,d*=2,_*=2,i[0]=l+r+p,i[1]=m+y+d,i[2]=c+u+_,i}function El(i,e,t,n){var a=[],s=[];return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],s[0]=a[0],s[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),s[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),i[0]=s[0]+t[0],i[1]=s[1]+t[1],i[2]=s[2]+t[2],i}function kl(i,e,t,n){var a=[],s=[];return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],s[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),s[1]=a[1],s[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),i[0]=s[0]+t[0],i[1]=s[1]+t[1],i[2]=s[2]+t[2],i}function Fl(i,e,t,n){var a=[],s=[];return a[0]=e[0]-t[0],a[1]=e[1]-t[1],a[2]=e[2]-t[2],s[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),s[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),s[2]=a[2],i[0]=s[0]+t[0],i[1]=s[1]+t[1],i[2]=s[2]+t[2],i}function wl(i,e){var t=i[0],n=i[1],a=i[2],s=e[0],o=e[1],l=e[2],m=Math.sqrt(t*t+n*n+a*a),c=Math.sqrt(s*s+o*o+l*l),r=m*c,y=r&&Be(i,e)/r;return Math.acos(Math.min(Math.max(y,-1),1))}function Wl(i){return i[0]=0,i[1]=0,i[2]=0,i}function jl(i){return"vec3("+i[0]+", "+i[1]+", "+i[2]+")"}function zl(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}function Gl(i,e){var t=i[0],n=i[1],a=i[2],s=e[0],o=e[1],l=e[2];return Math.abs(t-s)<=O*Math.max(1,Math.abs(t),Math.abs(s))&&Math.abs(n-o)<=O*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(a-l)<=O*Math.max(1,Math.abs(a),Math.abs(l))}var Ul,Nl,ql,Ql,Xl,ot,Kl,Jl,rt=U(()=>{ae();Ul=Yt,Nl=$t,ql=ei,Ql=ti,Xl=ii,ot=Zt,Kl=ni,Jl=function(){var i=De();return function(e,t,n,a,s,o){var l,m;for(t||(t=3),n||(n=0),a?m=Math.min(a*t+n,e.length):m=e.length,l=n;l<m;l+=t)i[0]=e[l],i[1]=e[l+1],i[2]=e[l+2],s(i,i,o),e[l]=i[0],e[l+1]=i[1],e[l+2]=i[2];return e}}()});var se={};le(se,{add:()=>ut,ceil:()=>Zl,clone:()=>lt,copy:()=>yt,create:()=>ai,cross:()=>sm,dist:()=>pm,distance:()=>li,div:()=>hm,divide:()=>ri,dot:()=>dt,equals:()=>gt,exactEquals:()=>Pt,floor:()=>Yl,forEach:()=>gm,fromValues:()=>mt,inverse:()=>am,len:()=>_m,length:()=>Oe,lerp:()=>_t,max:()=>em,min:()=>$l,mul:()=>um,multiply:()=>oi,negate:()=>nm,normalize:()=>pt,random:()=>om,round:()=>tm,scale:()=>ht,scaleAndAdd:()=>im,set:()=>ct,sqrDist:()=>dm,sqrLen:()=>Pm,squaredDistance:()=>mi,squaredLength:()=>He,str:()=>ym,sub:()=>cm,subtract:()=>si,transformMat4:()=>rm,transformQuat:()=>lm,zero:()=>mm});function ai(){var i=new F(4);return F!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}function lt(i){var e=new F(4);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}function mt(i,e,t,n){var a=new F(4);return a[0]=i,a[1]=e,a[2]=t,a[3]=n,a}function yt(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}function ct(i,e,t,n,a){return i[0]=e,i[1]=t,i[2]=n,i[3]=a,i}function ut(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i}function si(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i}function oi(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i[3]=e[3]*t[3],i}function ri(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i[3]=e[3]/t[3],i}function Zl(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i[2]=Math.ceil(e[2]),i[3]=Math.ceil(e[3]),i}function Yl(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i[2]=Math.floor(e[2]),i[3]=Math.floor(e[3]),i}function $l(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i[3]=Math.min(e[3],t[3]),i}function em(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i[3]=Math.max(e[3],t[3]),i}function tm(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i[2]=Math.round(e[2]),i[3]=Math.round(e[3]),i}function ht(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i}function im(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i[2]=e[2]+t[2]*n,i[3]=e[3]+t[3]*n,i}function li(i,e){var t=e[0]-i[0],n=e[1]-i[1],a=e[2]-i[2],s=e[3]-i[3];return Math.hypot(t,n,a,s)}function mi(i,e){var t=e[0]-i[0],n=e[1]-i[1],a=e[2]-i[2],s=e[3]-i[3];return t*t+n*n+a*a+s*s}function Oe(i){var e=i[0],t=i[1],n=i[2],a=i[3];return Math.hypot(e,t,n,a)}function He(i){var e=i[0],t=i[1],n=i[2],a=i[3];return e*e+t*t+n*n+a*a}function nm(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=-e[3],i}function am(i,e){return i[0]=1/e[0],i[1]=1/e[1],i[2]=1/e[2],i[3]=1/e[3],i}function pt(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=t*t+n*n+a*a+s*s;return o>0&&(o=1/Math.sqrt(o)),i[0]=t*o,i[1]=n*o,i[2]=a*o,i[3]=s*o,i}function dt(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]*e[3]}function sm(i,e,t,n){var a=t[0]*n[1]-t[1]*n[0],s=t[0]*n[2]-t[2]*n[0],o=t[0]*n[3]-t[3]*n[0],l=t[1]*n[2]-t[2]*n[1],m=t[1]*n[3]-t[3]*n[1],c=t[2]*n[3]-t[3]*n[2],r=e[0],y=e[1],u=e[2],p=e[3];return i[0]=y*c-u*m+p*l,i[1]=-(r*c)+u*o-p*s,i[2]=r*m-y*o+p*a,i[3]=-(r*l)+y*s-u*a,i}function _t(i,e,t,n){var a=e[0],s=e[1],o=e[2],l=e[3];return i[0]=a+n*(t[0]-a),i[1]=s+n*(t[1]-s),i[2]=o+n*(t[2]-o),i[3]=l+n*(t[3]-l),i}function om(i,e){e=e||1;var t,n,a,s,o,l;do t=J()*2-1,n=J()*2-1,o=t*t+n*n;while(o>=1);do a=J()*2-1,s=J()*2-1,l=a*a+s*s;while(l>=1);var m=Math.sqrt((1-o)/l);return i[0]=e*t,i[1]=e*n,i[2]=e*a*m,i[3]=e*s*m,i}function rm(i,e,t){var n=e[0],a=e[1],s=e[2],o=e[3];return i[0]=t[0]*n+t[4]*a+t[8]*s+t[12]*o,i[1]=t[1]*n+t[5]*a+t[9]*s+t[13]*o,i[2]=t[2]*n+t[6]*a+t[10]*s+t[14]*o,i[3]=t[3]*n+t[7]*a+t[11]*s+t[15]*o,i}function lm(i,e,t){var n=e[0],a=e[1],s=e[2],o=t[0],l=t[1],m=t[2],c=t[3],r=c*n+l*s-m*a,y=c*a+m*n-o*s,u=c*s+o*a-l*n,p=-o*n-l*a-m*s;return i[0]=r*c+p*-o+y*-m-u*-l,i[1]=y*c+p*-l+u*-o-r*-m,i[2]=u*c+p*-m+r*-l-y*-o,i[3]=e[3],i}function mm(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=0,i}function ym(i){return"vec4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}function Pt(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]}function gt(i,e){var t=i[0],n=i[1],a=i[2],s=i[3],o=e[0],l=e[1],m=e[2],c=e[3];return Math.abs(t-o)<=O*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(n-l)<=O*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-m)<=O*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-c)<=O*Math.max(1,Math.abs(s),Math.abs(c))}var cm,um,hm,pm,dm,_m,Pm,gm,ft=U(()=>{ae();cm=si,um=oi,hm=ri,pm=li,dm=mi,_m=Oe,Pm=He,gm=function(){var i=ai();return function(e,t,n,a,s,o){var l,m;for(t||(t=4),n||(n=0),a?m=Math.min(a*t+n,e.length):m=e.length,l=n;l<m;l+=t)i[0]=e[l],i[1]=e[l+1],i[2]=e[l+2],i[3]=e[l+3],s(i,i,o),e[l]=i[0],e[l+1]=i[1],e[l+2]=i[2],e[l+3]=i[3];return e}}()});var W={};le(W,{add:()=>Lm,calculateW:()=>Cm,clone:()=>Rm,conjugate:()=>Am,copy:()=>ke,create:()=>Me,dot:()=>Fe,equals:()=>Fm,exactEquals:()=>km,exp:()=>ui,fromEuler:()=>Im,fromMat3:()=>pi,fromValues:()=>Vm,getAngle:()=>Tm,getAxisAngle:()=>vm,identity:()=>fm,invert:()=>Mm,len:()=>Hm,length:()=>we,lerp:()=>Om,ln:()=>hi,mul:()=>Bm,multiply:()=>ci,normalize:()=>St,pow:()=>Sm,random:()=>bm,rotateX:()=>vt,rotateY:()=>Tt,rotateZ:()=>Ct,rotationTo:()=>wm,scale:()=>di,set:()=>Dm,setAxes:()=>jm,setAxisAngle:()=>yi,slerp:()=>Ee,sqlerp:()=>Wm,sqrLen:()=>Em,squaredLength:()=>We,str:()=>xm});function Me(){var i=new F(4);return F!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function fm(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function yi(i,e,t){t=t*.5;var n=Math.sin(t);return i[0]=n*e[0],i[1]=n*e[1],i[2]=n*e[2],i[3]=Math.cos(t),i}function vm(i,e){var t=Math.acos(e[3])*2,n=Math.sin(t/2);return n>O?(i[0]=e[0]/n,i[1]=e[1]/n,i[2]=e[2]/n):(i[0]=1,i[1]=0,i[2]=0),t}function Tm(i,e){var t=Fe(i,e);return Math.acos(2*t*t-1)}function ci(i,e,t){var n=e[0],a=e[1],s=e[2],o=e[3],l=t[0],m=t[1],c=t[2],r=t[3];return i[0]=n*r+o*l+a*c-s*m,i[1]=a*r+o*m+s*l-n*c,i[2]=s*r+o*c+n*m-a*l,i[3]=o*r-n*l-a*m-s*c,i}function vt(i,e,t){t*=.5;var n=e[0],a=e[1],s=e[2],o=e[3],l=Math.sin(t),m=Math.cos(t);return i[0]=n*m+o*l,i[1]=a*m+s*l,i[2]=s*m-a*l,i[3]=o*m-n*l,i}function Tt(i,e,t){t*=.5;var n=e[0],a=e[1],s=e[2],o=e[3],l=Math.sin(t),m=Math.cos(t);return i[0]=n*m-s*l,i[1]=a*m+o*l,i[2]=s*m+n*l,i[3]=o*m-a*l,i}function Ct(i,e,t){t*=.5;var n=e[0],a=e[1],s=e[2],o=e[3],l=Math.sin(t),m=Math.cos(t);return i[0]=n*m+a*l,i[1]=a*m-n*l,i[2]=s*m+o*l,i[3]=o*m-s*l,i}function Cm(i,e){var t=e[0],n=e[1],a=e[2];return i[0]=t,i[1]=n,i[2]=a,i[3]=Math.sqrt(Math.abs(1-t*t-n*n-a*a)),i}function ui(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=Math.sqrt(t*t+n*n+a*a),l=Math.exp(s),m=o>0?l*Math.sin(o)/o:0;return i[0]=t*m,i[1]=n*m,i[2]=a*m,i[3]=l*Math.cos(o),i}function hi(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=Math.sqrt(t*t+n*n+a*a),l=o>0?Math.atan2(o,s)/o:0;return i[0]=t*l,i[1]=n*l,i[2]=a*l,i[3]=.5*Math.log(t*t+n*n+a*a+s*s),i}function Sm(i,e,t){return hi(i,e),di(i,i,t),ui(i,i),i}function Ee(i,e,t,n){var a=e[0],s=e[1],o=e[2],l=e[3],m=t[0],c=t[1],r=t[2],y=t[3],u,p,d,_,h;return p=a*m+s*c+o*r+l*y,p<0&&(p=-p,m=-m,c=-c,r=-r,y=-y),1-p>O?(u=Math.acos(p),d=Math.sin(u),_=Math.sin((1-n)*u)/d,h=Math.sin(n*u)/d):(_=1-n,h=n),i[0]=_*a+h*m,i[1]=_*s+h*c,i[2]=_*o+h*r,i[3]=_*l+h*y,i}function bm(i){var e=J(),t=J(),n=J(),a=Math.sqrt(1-e),s=Math.sqrt(e);return i[0]=a*Math.sin(2*Math.PI*t),i[1]=a*Math.cos(2*Math.PI*t),i[2]=s*Math.sin(2*Math.PI*n),i[3]=s*Math.cos(2*Math.PI*n),i}function Mm(i,e){var t=e[0],n=e[1],a=e[2],s=e[3],o=t*t+n*n+a*a+s*s,l=o?1/o:0;return i[0]=-t*l,i[1]=-n*l,i[2]=-a*l,i[3]=s*l,i}function Am(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i}function pi(i,e){var t=e[0]+e[4]+e[8],n;if(t>0)n=Math.sqrt(t+1),i[3]=.5*n,n=.5/n,i[0]=(e[5]-e[7])*n,i[1]=(e[6]-e[2])*n,i[2]=(e[1]-e[3])*n;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[a*3+a]&&(a=2);var s=(a+1)%3,o=(a+2)%3;n=Math.sqrt(e[a*3+a]-e[s*3+s]-e[o*3+o]+1),i[a]=.5*n,n=.5/n,i[3]=(e[s*3+o]-e[o*3+s])*n,i[s]=(e[s*3+a]+e[a*3+s])*n,i[o]=(e[o*3+a]+e[a*3+o])*n}return i}function Im(i,e,t,n){var a=.5*Math.PI/180;e*=a,t*=a,n*=a;var s=Math.sin(e),o=Math.cos(e),l=Math.sin(t),m=Math.cos(t),c=Math.sin(n),r=Math.cos(n);return i[0]=s*m*r-o*l*c,i[1]=o*l*r+s*m*c,i[2]=o*m*c-s*l*r,i[3]=o*m*r+s*l*c,i}function xm(i){return"quat("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}var Rm,Vm,ke,Dm,Lm,Bm,di,Fe,Om,we,Hm,We,Em,St,km,Fm,wm,Wm,jm,bt=U(()=>{ae();tt();rt();ft();Rm=lt,Vm=mt,ke=yt,Dm=ct,Lm=ut,Bm=ci,di=ht,Fe=dt,Om=_t,we=Oe,Hm=we,We=He,Em=We,St=pt,km=Pt,Fm=gt,wm=function(){var i=De(),e=Le(1,0,0),t=Le(0,1,0);return function(n,a,s){var o=Be(a,s);return o<-.999999?(be(i,e,a),ot(i)<1e-6&&be(i,t,a),st(i,i),yi(n,i,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(be(i,a,s),n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=1+o,St(n,n))}}(),Wm=function(){var i=Me(),e=Me();return function(t,n,a,s,o,l){return Ee(i,n,o,l),Ee(e,a,s,l),Ee(t,i,e,2*l*(1-l)),t}}(),jm=function(){var i=et();return function(e,t,n,a){return i[0]=n[0],i[3]=n[1],i[6]=n[2],i[1]=a[0],i[4]=a[1],i[7]=a[2],i[2]=-t[0],i[5]=-t[1],i[8]=-t[2],St(e,pi(e,i))}}()});var z={};le(z,{add:()=>my,clone:()=>Gm,conjugate:()=>py,copy:()=>Pi,create:()=>zm,dot:()=>fi,equals:()=>vy,exactEquals:()=>fy,fromMat4:()=>Xm,fromRotation:()=>Qm,fromRotationTranslation:()=>_i,fromRotationTranslationValues:()=>Nm,fromTranslation:()=>qm,fromValues:()=>Um,getDual:()=>Ym,getReal:()=>Zm,getTranslation:()=>ty,identity:()=>Km,invert:()=>hy,len:()=>dy,length:()=>vi,lerp:()=>uy,mul:()=>yy,multiply:()=>gi,normalize:()=>Py,rotateAroundAxis:()=>ly,rotateByQuatAppend:()=>oy,rotateByQuatPrepend:()=>ry,rotateX:()=>ny,rotateY:()=>ay,rotateZ:()=>sy,scale:()=>cy,set:()=>Jm,setDual:()=>ey,setReal:()=>$m,sqrLen:()=>_y,squaredLength:()=>je,str:()=>gy,translate:()=>iy});function zm(){var i=new F(8);return F!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[4]=0,i[5]=0,i[6]=0,i[7]=0),i[3]=1,i}function Gm(i){var e=new F(8);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e}function Um(i,e,t,n,a,s,o,l){var m=new F(8);return m[0]=i,m[1]=e,m[2]=t,m[3]=n,m[4]=a,m[5]=s,m[6]=o,m[7]=l,m}function Nm(i,e,t,n,a,s,o){var l=new F(8);l[0]=i,l[1]=e,l[2]=t,l[3]=n;var m=a*.5,c=s*.5,r=o*.5;return l[4]=m*n+c*t-r*e,l[5]=c*n+r*i-m*t,l[6]=r*n+m*e-c*i,l[7]=-m*i-c*e-r*t,l}function _i(i,e,t){var n=t[0]*.5,a=t[1]*.5,s=t[2]*.5,o=e[0],l=e[1],m=e[2],c=e[3];return i[0]=o,i[1]=l,i[2]=m,i[3]=c,i[4]=n*c+a*m-s*l,i[5]=a*c+s*o-n*m,i[6]=s*c+n*l-a*o,i[7]=-n*o-a*l-s*m,i}function qm(i,e){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=e[0]*.5,i[5]=e[1]*.5,i[6]=e[2]*.5,i[7]=0,i}function Qm(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=0,i[5]=0,i[6]=0,i[7]=0,i}function Xm(i,e){var t=Me();nt(t,e);var n=new F(3);return it(n,e),_i(i,t,n),i}function Pi(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i}function Km(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i[4]=0,i[5]=0,i[6]=0,i[7]=0,i}function Jm(i,e,t,n,a,s,o,l,m){return i[0]=e,i[1]=t,i[2]=n,i[3]=a,i[4]=s,i[5]=o,i[6]=l,i[7]=m,i}function Ym(i,e){return i[0]=e[4],i[1]=e[5],i[2]=e[6],i[3]=e[7],i}function ey(i,e){return i[4]=e[0],i[5]=e[1],i[6]=e[2],i[7]=e[3],i}function ty(i,e){var t=e[4],n=e[5],a=e[6],s=e[7],o=-e[0],l=-e[1],m=-e[2],c=e[3];return i[0]=(t*c+s*o+n*m-a*l)*2,i[1]=(n*c+s*l+a*o-t*m)*2,i[2]=(a*c+s*m+t*l-n*o)*2,i}function iy(i,e,t){var n=e[0],a=e[1],s=e[2],o=e[3],l=t[0]*.5,m=t[1]*.5,c=t[2]*.5,r=e[4],y=e[5],u=e[6],p=e[7];return i[0]=n,i[1]=a,i[2]=s,i[3]=o,i[4]=o*l+a*c-s*m+r,i[5]=o*m+s*l-n*c+y,i[6]=o*c+n*m-a*l+u,i[7]=-n*l-a*m-s*c+p,i}function ny(i,e,t){var n=-e[0],a=-e[1],s=-e[2],o=e[3],l=e[4],m=e[5],c=e[6],r=e[7],y=l*o+r*n+m*s-c*a,u=m*o+r*a+c*n-l*s,p=c*o+r*s+l*a-m*n,d=r*o-l*n-m*a-c*s;return vt(i,e,t),n=i[0],a=i[1],s=i[2],o=i[3],i[4]=y*o+d*n+u*s-p*a,i[5]=u*o+d*a+p*n-y*s,i[6]=p*o+d*s+y*a-u*n,i[7]=d*o-y*n-u*a-p*s,i}function ay(i,e,t){var n=-e[0],a=-e[1],s=-e[2],o=e[3],l=e[4],m=e[5],c=e[6],r=e[7],y=l*o+r*n+m*s-c*a,u=m*o+r*a+c*n-l*s,p=c*o+r*s+l*a-m*n,d=r*o-l*n-m*a-c*s;return Tt(i,e,t),n=i[0],a=i[1],s=i[2],o=i[3],i[4]=y*o+d*n+u*s-p*a,i[5]=u*o+d*a+p*n-y*s,i[6]=p*o+d*s+y*a-u*n,i[7]=d*o-y*n-u*a-p*s,i}function sy(i,e,t){var n=-e[0],a=-e[1],s=-e[2],o=e[3],l=e[4],m=e[5],c=e[6],r=e[7],y=l*o+r*n+m*s-c*a,u=m*o+r*a+c*n-l*s,p=c*o+r*s+l*a-m*n,d=r*o-l*n-m*a-c*s;return Ct(i,e,t),n=i[0],a=i[1],s=i[2],o=i[3],i[4]=y*o+d*n+u*s-p*a,i[5]=u*o+d*a+p*n-y*s,i[6]=p*o+d*s+y*a-u*n,i[7]=d*o-y*n-u*a-p*s,i}function oy(i,e,t){var n=t[0],a=t[1],s=t[2],o=t[3],l=e[0],m=e[1],c=e[2],r=e[3];return i[0]=l*o+r*n+m*s-c*a,i[1]=m*o+r*a+c*n-l*s,i[2]=c*o+r*s+l*a-m*n,i[3]=r*o-l*n-m*a-c*s,l=e[4],m=e[5],c=e[6],r=e[7],i[4]=l*o+r*n+m*s-c*a,i[5]=m*o+r*a+c*n-l*s,i[6]=c*o+r*s+l*a-m*n,i[7]=r*o-l*n-m*a-c*s,i}function ry(i,e,t){var n=e[0],a=e[1],s=e[2],o=e[3],l=t[0],m=t[1],c=t[2],r=t[3];return i[0]=n*r+o*l+a*c-s*m,i[1]=a*r+o*m+s*l-n*c,i[2]=s*r+o*c+n*m-a*l,i[3]=o*r-n*l-a*m-s*c,l=t[4],m=t[5],c=t[6],r=t[7],i[4]=n*r+o*l+a*c-s*m,i[5]=a*r+o*m+s*l-n*c,i[6]=s*r+o*c+n*m-a*l,i[7]=o*r-n*l-a*m-s*c,i}function ly(i,e,t,n){if(Math.abs(n)<O)return Pi(i,e);var a=Math.hypot(t[0],t[1],t[2]);n=n*.5;var s=Math.sin(n),o=s*t[0]/a,l=s*t[1]/a,m=s*t[2]/a,c=Math.cos(n),r=e[0],y=e[1],u=e[2],p=e[3];i[0]=r*c+p*o+y*m-u*l,i[1]=y*c+p*l+u*o-r*m,i[2]=u*c+p*m+r*l-y*o,i[3]=p*c-r*o-y*l-u*m;var d=e[4],_=e[5],h=e[6],P=e[7];return i[4]=d*c+P*o+_*m-h*l,i[5]=_*c+P*l+h*o-d*m,i[6]=h*c+P*m+d*l-_*o,i[7]=P*c-d*o-_*l-h*m,i}function my(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i}function gi(i,e,t){var n=e[0],a=e[1],s=e[2],o=e[3],l=t[4],m=t[5],c=t[6],r=t[7],y=e[4],u=e[5],p=e[6],d=e[7],_=t[0],h=t[1],P=t[2],T=t[3];return i[0]=n*T+o*_+a*P-s*h,i[1]=a*T+o*h+s*_-n*P,i[2]=s*T+o*P+n*h-a*_,i[3]=o*T-n*_-a*h-s*P,i[4]=n*r+o*l+a*c-s*m+y*T+d*_+u*P-p*h,i[5]=a*r+o*m+s*l-n*c+u*T+d*h+p*_-y*P,i[6]=s*r+o*c+n*m-a*l+p*T+d*P+y*h-u*_,i[7]=o*r-n*l-a*m-s*c+d*T-y*_-u*h-p*P,i}function cy(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i}function uy(i,e,t,n){var a=1-n;return fi(e,t)<0&&(n=-n),i[0]=e[0]*a+t[0]*n,i[1]=e[1]*a+t[1]*n,i[2]=e[2]*a+t[2]*n,i[3]=e[3]*a+t[3]*n,i[4]=e[4]*a+t[4]*n,i[5]=e[5]*a+t[5]*n,i[6]=e[6]*a+t[6]*n,i[7]=e[7]*a+t[7]*n,i}function hy(i,e){var t=je(e);return i[0]=-e[0]/t,i[1]=-e[1]/t,i[2]=-e[2]/t,i[3]=e[3]/t,i[4]=-e[4]/t,i[5]=-e[5]/t,i[6]=-e[6]/t,i[7]=e[7]/t,i}function py(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=e[3],i[4]=-e[4],i[5]=-e[5],i[6]=-e[6],i[7]=e[7],i}function Py(i,e){var t=je(e);if(t>0){t=Math.sqrt(t);var n=e[0]/t,a=e[1]/t,s=e[2]/t,o=e[3]/t,l=e[4],m=e[5],c=e[6],r=e[7],y=n*l+a*m+s*c+o*r;i[0]=n,i[1]=a,i[2]=s,i[3]=o,i[4]=(l-n*y)/t,i[5]=(m-a*y)/t,i[6]=(c-s*y)/t,i[7]=(r-o*y)/t}return i}function gy(i){return"quat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+")"}function fy(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]&&i[4]===e[4]&&i[5]===e[5]&&i[6]===e[6]&&i[7]===e[7]}function vy(i,e){var t=i[0],n=i[1],a=i[2],s=i[3],o=i[4],l=i[5],m=i[6],c=i[7],r=e[0],y=e[1],u=e[2],p=e[3],d=e[4],_=e[5],h=e[6],P=e[7];return Math.abs(t-r)<=O*Math.max(1,Math.abs(t),Math.abs(r))&&Math.abs(n-y)<=O*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(a-u)<=O*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(s-p)<=O*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(o-d)<=O*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(l-_)<=O*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(m-h)<=O*Math.max(1,Math.abs(m),Math.abs(h))&&Math.abs(c-P)<=O*Math.max(1,Math.abs(c),Math.abs(P))}var Zm,$m,yy,fi,vi,dy,je,_y,Ti=U(()=>{ae();bt();at();Zm=ke;$m=ke;yy=gi;fi=Fe;vi=we,dy=vi,je=We,_y=je});var ee={};le(ee,{add:()=>My,angle:()=>Ny,ceil:()=>Ay,clone:()=>Ty,copy:()=>Sy,create:()=>Ci,cross:()=>ky,dist:()=>ec,distance:()=>Ai,div:()=>$y,divide:()=>Mi,dot:()=>Ey,equals:()=>Ky,exactEquals:()=>Xy,floor:()=>Iy,forEach:()=>nc,fromValues:()=>Cy,inverse:()=>Oy,len:()=>Jy,length:()=>xi,lerp:()=>Fy,max:()=>Ry,min:()=>xy,mul:()=>Yy,multiply:()=>bi,negate:()=>By,normalize:()=>Hy,random:()=>wy,rotate:()=>Uy,round:()=>Vy,scale:()=>Dy,scaleAndAdd:()=>Ly,set:()=>by,sqrDist:()=>tc,sqrLen:()=>ic,squaredDistance:()=>Ii,squaredLength:()=>Ri,str:()=>Qy,sub:()=>Zy,subtract:()=>Si,transformMat2:()=>Wy,transformMat2d:()=>jy,transformMat3:()=>zy,transformMat4:()=>Gy,zero:()=>qy});function Ci(){var i=new F(2);return F!=Float32Array&&(i[0]=0,i[1]=0),i}function Ty(i){var e=new F(2);return e[0]=i[0],e[1]=i[1],e}function Cy(i,e){var t=new F(2);return t[0]=i,t[1]=e,t}function Sy(i,e){return i[0]=e[0],i[1]=e[1],i}function by(i,e,t){return i[0]=e,i[1]=t,i}function My(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i}function Si(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i}function bi(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i}function Mi(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i}function Ay(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i}function Iy(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i}function xy(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i}function Ry(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i}function Vy(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i}function Dy(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i}function Ly(i,e,t,n){return i[0]=e[0]+t[0]*n,i[1]=e[1]+t[1]*n,i}function Ai(i,e){var t=e[0]-i[0],n=e[1]-i[1];return Math.hypot(t,n)}function Ii(i,e){var t=e[0]-i[0],n=e[1]-i[1];return t*t+n*n}function xi(i){var e=i[0],t=i[1];return Math.hypot(e,t)}function Ri(i){var e=i[0],t=i[1];return e*e+t*t}function By(i,e){return i[0]=-e[0],i[1]=-e[1],i}function Oy(i,e){return i[0]=1/e[0],i[1]=1/e[1],i}function Hy(i,e){var t=e[0],n=e[1],a=t*t+n*n;return a>0&&(a=1/Math.sqrt(a)),i[0]=e[0]*a,i[1]=e[1]*a,i}function Ey(i,e){return i[0]*e[0]+i[1]*e[1]}function ky(i,e,t){var n=e[0]*t[1]-e[1]*t[0];return i[0]=i[1]=0,i[2]=n,i}function Fy(i,e,t,n){var a=e[0],s=e[1];return i[0]=a+n*(t[0]-a),i[1]=s+n*(t[1]-s),i}function wy(i,e){e=e||1;var t=J()*2*Math.PI;return i[0]=Math.cos(t)*e,i[1]=Math.sin(t)*e,i}function Wy(i,e,t){var n=e[0],a=e[1];return i[0]=t[0]*n+t[2]*a,i[1]=t[1]*n+t[3]*a,i}function jy(i,e,t){var n=e[0],a=e[1];return i[0]=t[0]*n+t[2]*a+t[4],i[1]=t[1]*n+t[3]*a+t[5],i}function zy(i,e,t){var n=e[0],a=e[1];return i[0]=t[0]*n+t[3]*a+t[6],i[1]=t[1]*n+t[4]*a+t[7],i}function Gy(i,e,t){var n=e[0],a=e[1];return i[0]=t[0]*n+t[4]*a+t[12],i[1]=t[1]*n+t[5]*a+t[13],i}function Uy(i,e,t,n){var a=e[0]-t[0],s=e[1]-t[1],o=Math.sin(n),l=Math.cos(n);return i[0]=a*l-s*o+t[0],i[1]=a*o+s*l+t[1],i}function Ny(i,e){var t=i[0],n=i[1],a=e[0],s=e[1],o=Math.sqrt(t*t+n*n)*Math.sqrt(a*a+s*s),l=o&&(t*a+n*s)/o;return Math.acos(Math.min(Math.max(l,-1),1))}function qy(i){return i[0]=0,i[1]=0,i}function Qy(i){return"vec2("+i[0]+", "+i[1]+")"}function Xy(i,e){return i[0]===e[0]&&i[1]===e[1]}function Ky(i,e){var t=i[0],n=i[1],a=e[0],s=e[1];return Math.abs(t-a)<=O*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(n-s)<=O*Math.max(1,Math.abs(n),Math.abs(s))}var Jy,Zy,Yy,$y,ec,tc,ic,nc,Vi=U(()=>{ae();Jy=xi,Zy=Si,Yy=bi,$y=Mi,ec=Ai,tc=Ii,ic=Ri,nc=function(){var i=Ci();return function(e,t,n,a,s,o){var l,m;for(t||(t=2),n||(n=0),a?m=Math.min(a*t+n,e.length):m=e.length,l=n;l<m;l+=t)i[0]=e[l],i[1]=e[l+1],s(i,i,o),e[l]=i[0],e[l+1]=i[1];return e}}()});var Mt=U(()=>{ae();tt();at();bt();Ti();Vi();rt();ft()});var sc={};var Di=U(()=>{Mt();Array.prototype._pp_syncPrototypesProperties=function(){let e=[Array.prototype,Uint8ClampedArray.prototype,Uint8Array.prototype,Uint16Array.prototype,Uint32Array.prototype,Int8Array.prototype,Int16Array.prototype,Int32Array.prototype,Float32Array.prototype,Float64Array.prototype],t=["pp_","vec_","vec2_","vec3_","vec4_","quat_","quat2_","mat3_","mat4_","_pp_","_vec_","_quat_"];for(let n in Array.prototype){let a=!1;for(let s of t)if(n.startsWith(s)){a=!0;break}if(a)for(let s of e)s[n]=Array.prototype[n],Object.defineProperty(s,n,{enumerable:!1})}};Array.prototype.vec2_set=function(e,t){return t===void 0?ee.set(this,e,e):ee.set(this,e,t),this};Array.prototype.vec3_set=function(e,t,n){return t===void 0?x.set(this,e,e,e):x.set(this,e,t,n),this};Array.prototype.vec4_set=function(e,t,n,a){return t===void 0?se.set(this,e,e,e,e):se.set(this,e,t,n,a),this};Array.prototype.quat_set=function(e,t,n,a){return t===void 0?W.set(this,e,e,e,e):W.set(this,e,t,n,a),this};Array.prototype.quat2_set=function(e,t,n,a,s,o,l,m){return t===void 0?z.set(this,e,e,e,e,e,e,e,e):z.set(this,e,t,n,a,s,o,l,m),this};Array.prototype.mat3_set=function(e,t,n,a,s,o,l,m,c){return t===void 0?q.set(this,e,e,e,e,e,e,e,e,e):q.set(this,e,t,n,a,s,o,l,m,c),this};Array.prototype.mat4_set=function(e,t,n,a,s,o,l,m,c,r,y,u,p,d,_,h){return t===void 0?k.set(this,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e):k.set(this,e,t,n,a,s,o,l,m,c,r,y,u,p,d,_,h),this};Array.prototype._pp_syncPrototypesProperties();PP.vec2_create=function(e,t){let n=ee.create();return e!==void 0&&n.vec2_set(e,t),n};PP.vec3_create=function(e,t,n){let a=x.create();return e!==void 0&&a.vec3_set(e,t,n),a};PP.vec4_create=function(e,t,n,a){let s=se.create();return e!==void 0&&s.vec4_set(e,t,n,a),s};PP.quat_create=function(e,t,n,a){let s=W.create();return e!==void 0&&s.quat_set(e,t,n,a),s};PP.quat2_create=function(e,t,n,a,s,o,l,m){let c=z.create();return e!==void 0&&c.quat2_set(e,t,n,a,s,o,l,m),c};PP.mat3_create=function(e,t,n,a,s,o,l,m,c){let r=q.create();return e!==void 0&&r.mat3_set(e,t,n,a,s,o,l,m,c),r};PP.mat4_create=function(e,t,n,a,s,o,l,m,c,r,y,u,p,d,_,h){let P=k.create();return e!==void 0&&P.mat4_set(e,t,n,a,s,o,l,m,c,r,y,u,p,d,_,h),P};PP.quat2_fromPositionRotation=function(e,t){return quat2_fromPositionRotationDegrees(e,t)};PP.quat2_fromPositionRotationDegrees=function(e,t){let n=PP.quat2_create();return n.quat2_setPositionRotationDegrees(e,t),n};PP.quat2_fromPositionRotationRadians=function(e,t){let n=PP.quat2_create();return n.quat2_setPositionRotationRadians(e,t),n};PP.quat2_fromPositionRotationQuat=function(e,t){let n=PP.quat2_create();return n.quat2_setPositionRotationQuat(e,t),n};PP.mat4_fromPositionRotation=function(e,t){return mat4_fromPositionRotationDegrees(e,t)};PP.mat4_fromPositionRotationDegrees=function(e,t){let n=PP.mat4_create();return n.mat4_setPositionRotationDegrees(e,t),n};PP.mat4_fromPositionRotationRadians=function(e,t){let n=PP.mat4_create();return n.mat4_setPositionRotationRadians(e,t),n};PP.mat4_fromPositionRotationQuat=function(e,t){let n=PP.mat4_create();return n.mat4_setPositionRotationQuat(e,t),n};PP.mat4_fromPositionRotationScale=function(e,t,n){return mat4_fromPositionRotationDegreesScale(e,t,n)};PP.mat4_fromPositionRotationDegreesScale=function(e,t,n){let a=PP.mat4_create();return a.mat4_setPositionRotationDegreesScale(e,t,n),a};PP.mat4_fromPositionRotationRadiansScale=function(e,t,n){let a=PP.mat4_create();return a.mat4_setPositionRotationRadiansScale(e,t,n),a};PP.mat4_fromPositionRotationQuatScale=function(e,t,n){let a=PP.mat4_create();return a.mat4_setPositionRotationQuatScale(e,t,n),a};Array.prototype.pp_first=function(){return this.length>0?this[0]:void 0};Array.prototype.pp_last=function(){return this.length>0?this[this.length-1]:void 0};Array.prototype.pp_has=function(e){return this.pp_find(e)!=null};Array.prototype.pp_hasEqual=function(e,t=null){return this.pp_findEqual(e,t)!=null};Array.prototype.pp_find=function(e){let t,n=this.findIndex(e);return n>=0&&(t=this[n]),t};Array.prototype.pp_findIndex=function(e){return this.findIndex(e)};Array.prototype.pp_findAll=function(e){return this.filter(e)};Array.prototype.pp_findAllIndexes=function(e){let t=[];for(let n=0;n<this.length;n++){let a=this[n];e(a)&&t.push(n)}return t};Array.prototype.pp_findEqual=function(e,t=null){if(t==null){let a=this.pp_findIndexEqual(e);return a<0?void 0:this[a]}let n;for(let a=0;a<this.length;a++){let s=this[a];if(t(s,e)){n=s;break}}return n};Array.prototype.pp_findAllEqual=function(e,t=null){if(t==null)return this._pp_findAllEqualOptimized(e,!1);let n=[];for(let a=0;a<this.length;a++){let s=this[a];t(s,e)&&n.push(s)}return n};Array.prototype.pp_findIndexEqual=function(e,t=null){if(t==null)return this.indexOf(e);let n=-1;for(let a=0;a<this.length;a++){let s=this[a];if(t(s,e)){n=a;break}}return n};Array.prototype.pp_findAllIndexesEqual=function(e,t=null){if(t==null)return this._pp_findAllEqualOptimized(e,!0);let n=[];for(let a=0;a<this.length;a++){let s=this[a];t(s,e)&&n.push(a)}return n};Array.prototype.pp_removeIndex=function(e){let t;if(e>=0&&e<this.length){let n=this.splice(e,1);n.length==1&&(t=n[0])}return t};Array.prototype.pp_removeAllIndexes=function(e){let t=[];for(let n of e){let a=this.pp_removeIndex(n);a!==void 0&&t.push(a)}return t};Array.prototype.pp_remove=function(e){let t,n=this.findIndex(e);return n>=0&&(t=this.pp_removeIndex(n)),t};Array.prototype.pp_removeAll=function(e){let t=[],n;do n=this.pp_remove(e),n!==void 0&&t.push(n);while(n!==void 0);return t};Array.prototype.pp_removeEqual=function(e,t=null){return this.pp_removeIndex(this.pp_findIndexEqual(e,t))};Array.prototype.pp_removeAllEqual=function(e,t=null){return this.pp_removeAllIndexes(this.pp_findAllIndexesEqual(e,t))};Array.prototype.pp_pushUnique=function(e,t=null){let n=this.length;return this.pp_hasEqual(e,t)||(n=this.push(e)),n};Array.prototype.pp_unshiftUnique=function(e,t=null){let n=this.length;return this.pp_hasEqual(e,t)||(n=this.unshift(e)),n};Array.prototype.pp_copy=function(e,t=null){for(;this.length>e.length;)this.pop();for(let n=0;n<e.length;n++)t==null?this[n]=e[n]:this[n]=t(this[n],e[n]);return this};Array.prototype.pp_clone=function(e=null){if(e==null)return this.slice(0);let t=null;switch(this.constructor.name){case"Array":t=new Array(this.length);break;case"Uint32Array":t=new Uint32Array(this.length);break;case"Int32Array":t=new Int32Array(this.length);break;case"Float32Array":t=new Float32Array(this.length);break;case"Float64Array":t=new Float64Array(this.length);break;default:t=new Array(this.length),console.error("Cloned array type not supported!");break}for(let n=0;n<this.length;n++)t[n]=e(this[n]);return t};Array.prototype.pp_equals=function(e,t=null){let n=!0;if(e!=null&&this.length==e.length){for(let a=0;a<this.length;a++)if(t!=null&&!t(this[a],e[a])||t==null&&this[a]!=e[a]){n=!1;break}}else n=!1;return n};Array.prototype.pp_clear=function(){return this.length=0,this};Array.prototype.vec_toString=function(e=null){return this._vec_buildConsoleMessage(e)};Array.prototype.vec_log=function(e=4){let t=this._vec_buildConsoleMessage(e);console.log(t)};Array.prototype.vec_error=function(e=4){let t=this._vec_buildConsoleMessage(e);console.error(t)};Array.prototype.vec_warn=function(e=4){let t=this._vec_buildConsoleMessage(e);console.warn(t)};Array.prototype.vec_scale=function(e,t=null){t=this._vec_prepareOut(t);for(let n=0;n<t.length;n++)t[n]=t[n]*e;return t};Array.prototype.vec_round=function(e=null){e=this._vec_prepareOut(e);for(let t=0;t<e.length;t++)e[t]=Math.round(e[t]);return e};Array.prototype.vec_floor=function(e=null){e=this._vec_prepareOut(e);for(let t=0;t<e.length;t++)e[t]=Math.floor(e[t]);return e};Array.prototype.vec_ceil=function(e=null){e=this._vec_prepareOut(e);for(let t=0;t<e.length;t++)e[t]=Math.ceil(e[t]);return e};Array.prototype.vec_clamp=function(e,t,n=null){n=this._vec_prepareOut(n);let a=e??-Number.MAX_VALUE,s=t??Number.MAX_VALUE,o=Math.min(a,s),l=Math.max(a,s);for(let m=0;m<n.length;m++)n[m]=Math.min(Math.max(n[m],o),l);return n};Array.prototype.vec_equals=function(e,t=0){let n=this.length==e.length;for(let a=0;a<this.length&&n;a++)n=n&&Math.abs(this[a]-e[a])<=t;return n};Array.prototype.vec2_length=function(){return ee.length(this)};Array.prototype.vec2_normalize=function(e=PP.vec2_create()){return ee.normalize(e,this),e};Array.prototype.vec2_copy=function(e){return ee.copy(this,e),this};Array.prototype.vec2_clone=function(e=PP.vec2_create()){return ee.copy(e,this),e};Array.prototype.vec2_zero=function(){return ee.zero(this),this};Array.prototype.vec2_isZero=function(e=0){return this.vec2_length()<=e};Array.prototype.vec3_normalize=function(e=PP.vec3_create()){return x.normalize(e,this),e};Array.prototype.vec3_copy=function(e){return x.copy(this,e),this};Array.prototype.vec3_clone=function(e=PP.vec3_create()){return x.copy(e,this),e};Array.prototype.vec3_zero=function(){return x.zero(this),this};Array.prototype.vec3_angle=function(e){return this.vec3_angleDegrees(e)};Array.prototype.vec3_angleDegrees=function(e){return this.vec3_angleRadians(e)*(180/Math.PI)};Array.prototype.vec3_angleRadians=function(e){let t=this[0],n=this[1],a=this[2],s=e[0],o=e[1],l=e[2],m=t*t+n*n+a*a,c=s*s+o*o+l*l,r=m*c,y=0;if(r>this._pp_epsilonSquared){let u=Math.sqrt(r),p=this.vec3_dot(e)/u;y=Math.acos(Math.min(Math.max(p,-1),1))}return y};Array.prototype.vec3_equals=function(e,t=0){let n=this.length==e.length;return n&&(n&&=Math.abs(this[0]-e[0])<=t,n&&=Math.abs(this[1]-e[1])<=t,n&&=Math.abs(this[2]-e[2])<=t),n};Array.prototype.vec3_length=function(){return x.length(this)};Array.prototype.vec3_lengthSquared=function(){return x.squaredLength(this)};Array.prototype.vec3_distance=function(e){return x.dist(this,e)};Array.prototype.vec3_distanceSquared=function(e){return x.squaredDistance(this,e)};Array.prototype.vec3_add=function(e,t=PP.vec3_create()){return x.add(t,this,e),t};Array.prototype.vec3_sub=function(e,t=PP.vec3_create()){return x.sub(t,this,e),t};Array.prototype.vec3_mul=function(e,t=PP.vec3_create()){return x.mul(t,this,e),t};Array.prototype.vec3_div=function(e,t=PP.vec3_create()){return x.div(t,this,e),t};Array.prototype.vec3_scale=function(e,t=PP.vec3_create()){return x.scale(t,this,e),t};Array.prototype.vec3_dot=function(e){return x.dot(this,e)};Array.prototype.vec3_negate=function(e=PP.vec3_create()){return x.negate(e,this),e};Array.prototype.vec3_cross=function(e,t=PP.vec3_create()){return x.cross(t,this,e),t};Array.prototype.vec3_transformQuat=function(e,t=PP.vec3_create()){return x.transformQuat(t,this,e),t};Array.prototype.vec3_transformMat3=function(e,t=PP.vec3_create()){return x.transformMat3(t,this,e),t};Array.prototype.vec3_transformMat4=function(e,t=PP.vec3_create()){return x.transformMat4(t,this,e),t};Array.prototype.vec3_lengthSigned=function(e){let t=this.vec3_length();return this.vec3_isConcordant(e)||(t*=-1),t};Array.prototype.vec3_angleSigned=function(e,t){return this.vec3_angleSignedDegrees(e,t)};Array.prototype.vec3_angleSignedDegrees=function(e,t){return this.vec3_angleSignedRadians(e,t)*(180/Math.PI)};Array.prototype.vec3_angleSignedRadians=function(){let i=PP.vec3_create();return function(t,n){this.vec3_cross(t,i);let a=this.vec3_angleRadians(t);return i.vec3_isConcordant(n)||(a=-a),a}}();Array.prototype.vec3_toRadians=function(e=PP.vec3_create()){return x.set(e,Q.toRadian(this[0]),Q.toRadian(this[1]),Q.toRadian(this[2])),e};Array.prototype.vec3_toDegrees=function(e=PP.vec3_create()){return x.set(e,this[0]*(180/Math.PI),this[1]*(180/Math.PI),this[2]*(180/Math.PI)),e};Array.prototype.vec3_toQuat=function(e){return this.vec3_degreesToQuat(e)};Array.prototype.vec3_radiansToQuat=function(e=PP.quat_create()){return e.quat_fromRadians(this),e};Array.prototype.vec3_degreesToQuat=function(e=PP.quat_create()){return e.quat_fromDegrees(this),e};Array.prototype.vec3_isNormalized=function(e=this._pp_normalizedEpsilon){return Math.abs(this.vec3_lengthSquared()-1)<e};Array.prototype.vec3_isZero=function(e=0){return this.vec3_lengthSquared()<=e*e};Array.prototype.vec3_componentAlongAxis=function(e,t=PP.vec3_create()){let n=this.vec3_dot(e);return x.copy(t,e),x.scale(t,t,n),t};Array.prototype.vec3_valueAlongAxis=function(e){return this.vec3_dot(e)};Array.prototype.vec3_removeComponentAlongAxis=function(){let i=PP.vec3_create();return function(t,n=PP.vec3_create()){return this.vec3_componentAlongAxis(t,i),x.sub(n,this,i),n}}();Array.prototype.vec3_copyComponentAlongAxis=function(){let i=PP.vec3_create();return function(t,n,a=PP.vec3_create()){return this.vec3_removeComponentAlongAxis(n,a),t.vec3_componentAlongAxis(n,i),a.vec3_add(i,a),a}}();Array.prototype.vec3_isConcordant=function(e){return this.vec3_dot(e)>=0};Array.prototype.vec3_isFartherAlongAxis=function(e,t){return this.vec3_valueAlongAxis(t)>e.vec3_valueAlongAxis(t)};Array.prototype.vec3_isToTheRight=function(e,t){return this.vec3_signTo(e,t)>=0};Array.prototype.vec3_signTo=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a,s=1){this.vec3_removeComponentAlongAxis(a,i),n.vec3_removeComponentAlongAxis(a,e);let o=this.vec3_angleSigned(n,a);return o>0?1:o==0?s:-1}}();Array.prototype.vec3_projectOnAxis=function(e,t=PP.vec3_create()){return this.vec3_componentAlongAxis(e,t),t};Array.prototype.vec3_projectOnAxisAlongAxis=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create();return function(a,s,o=PP.vec3_create()){if(this.vec3_isOnAxis(a)||s.vec3_isOnAxis(a))o.vec3_copy(this);else if(s.vec3_cross(a,i),i.vec3_normalize(i),this.vec3_removeComponentAlongAxis(i,o),!o.vec3_isOnAxis(a)){o.vec3_projectOnAxis(a,e),e.vec3_sub(o,e),e.vec3_isConcordant(s)?t.vec3_copy(s):s.vec3_negate(t);let l=t.vec3_angleRadians(e),m=e.vec3_length()/Math.cos(l);t.vec3_normalize(t),t.vec3_scale(m,t),o.vec3_add(t,o),o.vec3_projectOnAxis(a,o)}return o}}();Array.prototype.vec3_projectOnPlane=function(e,t=PP.vec3_create()){return this.vec3_removeComponentAlongAxis(e,t),t};Array.prototype.vec3_projectOnPlaneAlongAxis=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a,s=PP.vec3_create()){if(this.vec3_isOnPlane(n)||a.vec3_isOnPlane(n))s.vec3_copy(this);else{s.vec3_copy(this),s.vec3_projectOnPlane(n,i),i.vec3_sub(s,i),i.vec3_isConcordant(a)?e.vec3_copy(a):a.vec3_negate(e);let o=e.vec3_angleRadians(i),l=i.vec3_length()/Math.cos(o);e.vec3_normalize(e),e.vec3_scale(l,e),s.vec3_add(e,s),s.vec3_projectOnPlane(n,s)}return s}}();Array.prototype.vec3_isOnAxis=function(e){let t=this.vec3_angle(e);return Math.abs(t)<this._pp_degreesEpsilon||Math.abs(t-180)<this._pp_degreesEpsilon};Array.prototype.vec3_isOnPlane=function(e){let t=this.vec3_angle(e);return Math.abs(t-90)<this._pp_degreesEpsilon};Array.prototype.vec3_rotate=function(e,t){return this.vec3_rotateDegrees(e,t)};Array.prototype.vec3_rotateDegrees=function(){let i=PP.vec3_create();return function(t,n){return this.vec3_rotateAroundDegrees(t,i,n)}}();Array.prototype.vec3_rotateRadians=function(){let i=PP.vec3_create();return function(t,n){return this.vec3_rotateAroundRadians(t,i,n)}}();Array.prototype.vec3_rotateQuat=function(){let i=PP.vec3_create();return function(t,n){return this.vec3_rotateAroundQuat(t,i,n)}}();Array.prototype.vec3_rotateAxis=function(e,t,n){return this.vec3_rotateAxisDegrees(e,t,n)};Array.prototype.vec3_rotateAxisDegrees=function(){let i=PP.vec3_create();return function(t,n,a){return this.vec3_rotateAroundAxisDegrees(t,n,i,a)}}();Array.prototype.vec3_rotateAxisRadians=function(){let i=PP.vec3_create();return function(t,n,a){return this.vec3_rotateAroundAxisRadians(t,n,i,a)}}();Array.prototype.vec3_rotateAround=function(e,t,n){return this.vec3_rotateAroundDegrees(e,t,n)};Array.prototype.vec3_rotateAroundDegrees=function(){let i=PP.quat_create();return function(t,n,a=PP.vec3_create()){return t.vec3_degreesToQuat(i),this.vec3_rotateAroundQuat(i,n,a)}}();Array.prototype.vec3_rotateAroundRadians=function(){let i=PP.quat_create();return function(t,n,a=PP.vec3_create()){return t.vec3_radiansToQuat(i),this.vec3_rotateAroundQuat(i,n,a)}}();Array.prototype.vec3_rotateAroundQuat=function(e,t,n=PP.vec3_create()){return x.sub(n,this,t),x.transformQuat(n,n,e),x.add(n,n,t),n};Array.prototype.vec3_rotateAroundAxis=function(e,t,n,a){return this.vec3_rotateAroundAxisDegrees(e,t,n,a)};Array.prototype.vec3_rotateAroundAxisDegrees=function(e,t,n,a){return this.vec3_rotateAroundAxisRadians(Q.toRadian(e),t,n,a)};Array.prototype.vec3_rotateAroundAxisRadians=function(){let i=PP.quat_create();return function(t,n,a,s=PP.vec3_create()){return W.setAxisAngle(i,n,t),this.vec3_rotateAroundQuat(i,a,s)}}();Array.prototype.vec3_convertPositionToWorld=function(e,t){return this.vec3_convertPositionToWorldMatrix(e,t)};Array.prototype.vec3_convertPositionToLocal=function(e,t){return this.vec3_convertPositionToLocalMatrix(e,t)};Array.prototype.vec3_convertPositionToWorldMatrix=function(e,t=PP.vec3_create()){return x.transformMat4(t,this,e),t};Array.prototype.vec3_convertPositionToLocalMatrix=function(){let i=PP.mat4_create();return function(t,n=PP.vec3_create()){return k.invert(i,t),x.transformMat4(n,this,i),n}}();Array.prototype.vec3_convertPositionToWorldQuat=function(){let i=PP.mat4_create(),e=PP.vec3_create(),t=PP.quat_create(),n=PP.vec3_create();return x.set(n,1,1,1),function(s,o=PP.vec3_create()){return s.quat2_getPosition(e),s.quat2_getRotationQuat(t),i.mat4_setPositionRotationQuatScale(e,t,n),this.vec3_convertPositionToWorldMatrix(i,o)}}();Array.prototype.vec3_convertPositionToLocalQuat=function(){let i=PP.mat4_create(),e=PP.vec3_create(),t=PP.quat_create(),n=PP.vec3_create();return x.set(n,1,1,1),function(s,o=PP.vec3_create()){return s.quat2_getPosition(e),s.quat2_getRotationQuat(t),i.mat4_setPositionRotationQuatScale(e,t,n),this.vec3_convertPositionToLocalMatrix(i,o)}}();Array.prototype.vec3_convertDirectionToWorld=function(e,t){return this.vec3_convertDirectionToWorldMatrix(e,t)};Array.prototype.vec3_convertDirectionToLocal=function(e,t){return this.vec3_convertDirectionToLocalMatrix(e,t)};Array.prototype.vec3_convertDirectionToWorldMatrix=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return t.mat4_getRotationQuat(i),x.transformQuat(n,this,i),n}}();Array.prototype.vec3_convertDirectionToLocalMatrix=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return t.mat4_getRotationQuat(i),W.conjugate(i,i),x.transformQuat(n,this,i),n}}();Array.prototype.vec3_convertDirectionToWorldQuat=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return t.quat2_getRotationQuat(i),x.transformQuat(n,this,i),n}}();Array.prototype.vec3_convertDirectionToLocalQuat=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return t.quat2_getRotationQuat(i),W.conjugate(i,i),x.transformQuat(n,this,i),n}}();Array.prototype.vec3_log=function(e=4){this.vec_log(e)};Array.prototype.vec3_error=function(e=4){this.vec_error(e)};Array.prototype.vec3_warn=function(e=4){this.vec_warn(e)};Array.prototype.vec3_addRotation=function(e,t){return this.vec3_degreesAddRotation(e,t)};Array.prototype.vec3_addRotationDegrees=function(e,t){return quat.vec3_degreesAddRotationDegrees(e,t)};Array.prototype.vec3_addRotationRadians=function(e,t){return quat.vec3_degreesAddRotationRadians(e,t)};Array.prototype.vec3_addRotationQuat=function(e,t){return quat.vec3_degreesAddRotationQuat(e,t)};Array.prototype.vec3_degreesAddRotation=function(e,t){return this.vec3_degreesAddRotationDegrees(e,t)};Array.prototype.vec3_degreesAddRotationDegrees=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return this.vec3_degreesToQuat(i),i.quat_addRotationDegrees(t,i).quat_toDegrees(n)}}();Array.prototype.vec3_degreesAddRotationRadians=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return this.vec3_degreesToQuat(i),i.quat_addRotationRadians(t,i).quat_toDegrees(n)}}();Array.prototype.vec3_degreesAddRotationQuat=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return this.vec3_degreesToQuat(i),i.quat_addRotationQuat(t,i).quat_toDegrees(n)}}();Array.prototype.vec3_radiansAddRotation=function(e,t){return this.vec3_radiansAddRotationDegrees(e,t)};Array.prototype.vec3_radiansAddRotationDegrees=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return this.vec3_radiansToQuat(i),i.quat_addRotationDegrees(t,i).quat_toRadians(n)}}();Array.prototype.vec3_radiansAddRotationRadians=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return this.vec3_radiansToQuat(i),i.quat_addRotationRadians(t,i).quat_toRadians(n)}}();Array.prototype.vec3_radiansAddRotationQuat=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return this.vec3_radiansToQuat(i),i.quat_addRotationQuat(t,i).quat_toRadians(n)}}();Array.prototype.vec3_toMatrix=function(e=PP.mat3_create()){return this.vec3_degreesToMatrix(e)};Array.prototype.vec3_degreesToMatrix=function(){let i=PP.quat_create();return function(t=PP.mat3_create()){return this.vec3_degreesToQuat(i),i.quat_toMatrix(t)}}();Array.prototype.vec3_radiansToMatrix=function(){let i=PP.quat_create();return function(t=PP.mat3_create()){return this.vec3_radiansToQuat(i),i.quat_toMatrix(t)}}();Array.prototype.vec3_rotationTo=function(e,t){return this.vec3_rotationToDegrees(e,t)};Array.prototype.vec3_rotationToDegrees=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return this.vec3_rotationToQuat(t,i),i.quat_toDegrees(n),n}}();Array.prototype.vec3_rotationToRadians=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return this.vec3_rotationToQuat(t,i),i.quat_toRadians(n),n}}();Array.prototype.vec3_rotationToQuat=function(){let i=PP.vec3_create();return function(t,n=PP.quat_create()){this.vec3_cross(t,i),i.vec3_normalize(i);let a=this.vec3_angleSigned(t,i);return n.quat_fromAxis(a,i),n}}();Array.prototype.vec3_rotationToPivoted=function(e,t,n){return this.vec3_rotationToPivotedDegrees(e,t,n)};Array.prototype.vec3_rotationToPivotedDegrees=function(){let i=PP.quat_create();return function(t,n,a=PP.vec3_create()){return this.vec3_rotationToPivotedQuat(t,n,i),i.quat_toDegrees(a),a}}();Array.prototype.vec3_rotationToPivotedRadians=function(){let i=PP.quat_create();return function(t,n,a=PP.vec3_create()){return this.vec3_rotationToPivotedQuat(t,n,i),i.quat_toRadians(a),a}}();Array.prototype.vec3_rotationToPivotedQuat=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create();return function(a,s,o=PP.quat_create()){this.vec3_removeComponentAlongAxis(s,i),a.vec3_removeComponentAlongAxis(s,e),i.vec3_cross(e,t),t.vec3_normalize(t);let l=i.vec3_angleSigned(e,t);return o.quat_fromAxis(l,t),o}}();Array.prototype.vec3_lerp=function(e,t,n=PP.vec3_create()){return t<=0?(n.vec3_copy(this),n):t>=1?(n.vec3_copy(e),n):(x.lerp(n,this,e,t),n)};Array.prototype.vec3_interpolate=function(e,t,n=PP.EasingFunction.linear,a=PP.vec3_create()){let s=n(t);return this.vec3_lerp(e,s,a)};Array.prototype.vec4_copy=function(e){return se.copy(this,e),this};Array.prototype.vec4_clone=function(e=PP.vec4_create()){return se.copy(e,this),e};Array.prototype.quat_normalize=function(e=PP.quat_create()){return W.normalize(e,this),e};Array.prototype.quat_copy=function(e){return W.copy(this,e),this};Array.prototype.quat_clone=function(e=PP.quat_create()){return W.copy(e,this),e};Array.prototype.quat_identity=function(){return W.identity(this),this};Array.prototype.quat_length=function(){return W.length(this)};Array.prototype.quat_lengthSquared=function(){return W.squaredLength(this)};Array.prototype.quat_invert=function(e=PP.quat_create()){return W.invert(e,this),e};Array.prototype.quat_conjugate=function(e=PP.quat_create()){return W.conjugate(e,this),e};Array.prototype.quat_mul=function(e,t=PP.quat_create()){return W.mul(t,this,e),t};Array.prototype.quat_getAxis=function(){let i=PP.vec3_create(0,0,0);return function(t=PP.vec3_create()){return W.getAxisAngle(t,this)<=this._pp_epsilon&&t.vec3_copy(i),t}}();Array.prototype.quat_getAngle=function(){return this.quat_getAngleDegrees()};Array.prototype.quat_getAngleDegrees=function(){return this.quat_getAngleRadians()*(180/Math.PI)};Array.prototype.quat_getAngleRadians=function(){let i=PP.vec3_create();return function(){return W.getAxisAngle(i,this)}}();Array.prototype.quat_getAxisScaled=function(e=PP.vec3_create()){return this.quat_getAxisScaledDegrees(e)};Array.prototype.quat_getAxisScaledDegrees=function(e=PP.vec3_create()){this.quat_getAxis(e);let t=this.quat_getAngleDegrees();return e.vec3_scale(t,e),e};Array.prototype.quat_getAxisScaledRadians=function(){let i=PP.vec3_create(0,0,0);return function(t=PP.vec3_create()){this.quat_getAxis(t);let n=this.quat_getAngleRadians();return n<=this._pp_epsilon?t.vec3_copy(i):t.vec3_scale(n,t),t}}();Array.prototype.quat_getAxes=function(e=[PP.vec3_create(),PP.vec3_create(),PP.vec3_create()]){return this.quat_getLeft(e[0]),this.quat_getUp(e[1]),this.quat_getForward(e[2]),e};Array.prototype.quat_getForward=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return q.fromQuat(i,this),x.set(t,i[6],i[7],i[8]),x.normalize(t,t),t}}();Array.prototype.quat_getBackward=function(e){return e=this.quat_getForward(e),e.vec3_negate(e),e};Array.prototype.quat_getLeft=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return q.fromQuat(i,this),x.set(t,i[0],i[1],i[2]),x.normalize(t,t),t}}();Array.prototype.quat_getRight=function(e){return e=this.quat_getLeft(e),e.vec3_negate(e),e};Array.prototype.quat_getUp=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return q.fromQuat(i,this),x.set(t,i[3],i[4],i[5]),x.normalize(t,t),t}}();Array.prototype.quat_getDown=function(e){return e=this.quat_getUp(e),e.vec3_negate(e),e};Array.prototype.quat_setAxes=function(e,t,n){return n!=null?this.quat_setForward(n,t,e):t!=null?this.quat_setUp(t,n,e):this.quat_setLeft(e,t,n)};Array.prototype.quat_setForward=function(e,t=null,n=null){return this._quat_setAxes([n,t,e],[2,1,0])};Array.prototype.quat_setBackward=function(){let i=PP.vec3_create();return function(t,n=null,a=null){return t.vec3_negate(i),this._quat_setAxes([a,n,i],[2,1,0])}}();Array.prototype.quat_setUp=function(e,t=null,n=null){return this._quat_setAxes([n,e,t],[1,2,0])};Array.prototype.quat_setDown=function(){let i=PP.vec3_create();return function(t,n=null,a=null){return t.vec3_negate(i),this._quat_setAxes([a,i,n],[1,2,0])}}();Array.prototype.quat_setLeft=function(e,t=null,n=null){return this._quat_setAxes([e,t,n],[0,1,2])};Array.prototype.quat_setRight=function(){let i=PP.vec3_create();return function(t,n=null,a=null){return t.vec3_negate(i),this._quat_setAxes([i,n,a],[0,1,2])}}();Array.prototype.quat_toWorld=function(e,t=PP.quat_create()){return W.mul(t,e,this),t};Array.prototype.quat_toLocal=function(){let i=PP.quat_create();return function(t,n=PP.quat_create()){return W.conjugate(i,t),W.mul(n,i,this),n}}();Array.prototype.quat_fromAxis=function(e,t){return this.quat_fromAxisDegrees(e,t)};Array.prototype.quat_fromAxisDegrees=function(e,t){return W.setAxisAngle(this,t,Q.toRadian(e)),this};Array.prototype.quat_fromAxisRadians=function(e,t){return W.setAxisAngle(this,t,e),this};Array.prototype.quat_fromAxes=function(){let i=PP.mat3_create();return function(t,n,a){return i.mat3_fromAxes(t,n,a),i.mat3_toQuat(this)}}();Array.prototype.quat_fromRadians=function(){let i=PP.vec3_create();return function(t){return t.vec3_toDegrees(i),this.quat_fromDegrees(i)}}();Array.prototype.quat_fromDegrees=function(e){return W.fromEuler(this,e[0],e[1],e[2]),this};Array.prototype.quat_toRadians=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return q.fromQuat(i,this),t[1]=Math.asin(-this._pp_clamp(i[2],-1,1)),Math.abs(i[2])<1-this._pp_epsilon?(t[0]=Math.atan2(i[5],i[8]),t[2]=Math.atan2(i[1],i[0])):(t[0]=0,t[2]=Math.atan2(-i[3],i[4])),t}}();Array.prototype.quat_toDegrees=function(e=PP.vec3_create()){return this.quat_toRadians(e),e.vec3_toDegrees(e),e};Array.prototype.quat_isNormalized=function(e=this._pp_normalizedEpsilon){return Math.abs(this.quat_lengthSquared()-1)<e};Array.prototype.quat_addRotation=function(e,t){return this.quat_addRotationDegrees(e,t)};Array.prototype.quat_addRotationDegrees=function(){let i=PP.quat_create();return function(t,n){return t.vec3_degreesToQuat(i),this.quat_addRotationQuat(i,n)}}();Array.prototype.quat_addRotationRadians=function(){let i=PP.quat_create();return function(t,n){return t.vec3_radiansToQuat(i),this.quat_addRotationQuat(i,n)}}();Array.prototype.quat_addRotationQuat=function(e,t=PP.quat_create()){return e.quat_mul(this,t),t};Array.prototype.quat_subRotation=function(e,t){return this.quat_subRotationDegrees(e,t)};Array.prototype.quat_subRotationDegrees=function(){let i=PP.quat_create();return function(t,n){return t.vec3_degreesToQuat(i),this.quat_subRotationQuat(i,n)}}();Array.prototype.quat_subRotationRadians=function(){let i=PP.quat_create();return function(t,n){return t.vec3_radiansToQuat(i),this.quat_subRotationQuat(i,n)}}();Array.prototype.quat_subRotationQuat=function(){let i=PP.quat_create();return function(t,n=PP.quat_create()){return t.quat_invert(i),this.quat_mul(i,n),this.quat_isNormalized()&&t.quat_isNormalized()&&n.quat_normalize(n),n}}();Array.prototype.quat_rotationTo=function(e,t){return this.quat_rotationToDegrees(e,t)};Array.prototype.quat_rotationToDegrees=function(){let i=PP.quat_create();return function(t,n){return t.vec3_degreesToQuat(i),this.quat_rotationToQuat(i,n)}}();Array.prototype.quat_rotationToRadians=function(){let i=PP.quat_create();return function(t,n){return t.vec3_radiansToQuat(i),this.quat_rotationToQuat(i,n)}}();Array.prototype.quat_rotationToQuat=function(e,t){return e.quat_subRotationQuat(this,t)};Array.prototype.quat_getTwist=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.quat_create();return function(a,s=PP.quat_create()){i[0]=this[0],i[1]=this[1],i[2]=this[2];let o=x.dot(a,i);return a.vec3_scale(o,e),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=this[3],t.quat_normalize(t),o<0&&(t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],t[3]=-t[3]),s.quat_copy(t)}}();Array.prototype.quat_getSwing=function(){let i=PP.quat_create();return function(t,n=PP.quat_create()){return this.quat_getTwist(t,i),this.quat_getSwingFromTwist(i,n),n}}();Array.prototype.quat_getSwingFromTwist=function(e,t=PP.quat_create()){return this.quat_subRotationQuat(e,t)};Array.prototype.quat_getTwistFromSwing=function(){let i=PP.quat_create();return function(t,n=PP.quat_create()){return t.quat_invert(i),this.quat_addRotationQuat(i,n),n}}();Array.prototype.quat_fromTwistSwing=function(e,t){return e.quat_addRotationQuat(t,this)};Array.prototype.quat_toMatrix=function(e=PP.mat3_create()){return q.fromQuat(e,this),e};Array.prototype.quat_rotate=function(e,t){return this.quat_rotateDegrees(e,t)};Array.prototype.quat_rotateDegrees=function(e,t){return this.quat_addRotationDegrees(e,t)};Array.prototype.quat_rotateRadians=function(e,t){return this.quat_addRotationRadians(e,t)};Array.prototype.quat_rotateQuat=function(e,t){return this.quat_addRotationQuat(e,t)};Array.prototype.quat_rotateAxis=function(e,t,n){return this.quat_rotateAxisDegrees(e,t,n)};Array.prototype.quat_rotateAxisDegrees=function(){let i=PP.quat_create();return function(t,n,a){return i.quat_fromAxisDegrees(t,n),this.quat_rotateQuat(i,a)}}();Array.prototype.quat_rotateAxisRadians=function(){let i=PP.quat_create();return function(t,n,a){return i.quat_fromAxisRadians(t,n),this.quat_rotateQuat(i,a)}}();Array.prototype.quat_lerp=function(e,t,n=PP.quat_create()){return t<=0?(n.quat_copy(this),n):t>=1?(n.quat_copy(e),n):(W.lerp(n,this,e,t),n)};Array.prototype.quat_interpolate=function(e,t,n=PP.EasingFunction.linear,a=PP.quat_create()){let s=n(t);return this.quat_lerp(e,s,a)};Array.prototype.quat_slerp=function(e,t,n=PP.quat_create()){return t<=0?(n.quat_copy(this),n):t>=1?(n.quat_copy(e),n):(W.slerp(n,this,e,t),n)};Array.prototype.quat_sinterpolate=function(e,t,n=PP.EasingFunction.linear,a=PP.quat_create()){let s=n(t);return this.quat_slerp(e,s,a)};Array.prototype.quat2_normalize=function(e=PP.quat2_create()){return z.normalize(e,this),e};Array.prototype.quat2_invert=function(e=PP.quat2_create()){return z.invert(e,this),e};Array.prototype.quat2_conjugate=function(e=PP.quat2_create()){return z.conjugate(e,this),e};Array.prototype.quat2_copy=function(e){return z.copy(this,e),this};Array.prototype.quat2_identity=function(){return z.identity(this),this};Array.prototype.quat2_getPosition=function(e=PP.vec3_create()){return z.getTranslation(e,this),e};Array.prototype.quat2_getRotation=function(e){return this.quat2_getRotationDegrees(e)};Array.prototype.quat2_getRotationDegrees=function(){let i=PP.quat_create();return function(t=PP.vec3_create()){return this.quat2_getRotationQuat(i).quat_toDegrees(t),t}}();Array.prototype.quat2_getRotationRadians=function(){let i=PP.quat_create();return function(t=PP.vec3_create()){return this.quat2_getRotationQuat(i).quat_toRadians(t),t}}();Array.prototype.quat2_getRotationQuat=function(e=PP.quat_create()){return W.copy(e,this),e};Array.prototype.quat2_setPosition=function(){let i=PP.quat_create();return function(t){return this.quat2_getRotationQuat(i),this.quat2_setPositionRotationQuat(t,i),this}}();Array.prototype.quat2_setRotation=function(e){return this.quat2_setRotationDegrees(e)};Array.prototype.quat2_setRotationDegrees=function(){let i=PP.vec3_create();return function(t){return this.quat2_getPosition(i),this.quat2_setPositionRotationDegrees(i,t),this}}();Array.prototype.quat2_setRotationRadians=function(){let i=PP.vec3_create();return function(t){return this.quat2_getPosition(i),this.quat2_setPositionRotationRadians(i,t),this}}();Array.prototype.quat2_setRotationQuat=function(){let i=PP.vec3_create();return function(t){return this.quat2_getPosition(i),this.quat2_setPositionRotationQuat(i,t),this}}();Array.prototype.quat2_setPositionRotation=function(e,t){return this.quat2_setPositionRotationDegrees(e,t)};Array.prototype.quat2_setPositionRotationDegrees=function(){let i=PP.quat_create();return function(t,n){return n.vec3_degreesToQuat(i),z.fromRotationTranslation(this,i,t),this}}();Array.prototype.quat2_setPositionRotationRadians=function(){let i=PP.quat_create();return function(t,n){return n.vec3_radiansToQuat(i),z.fromRotationTranslation(this,i,t),this}}();Array.prototype.quat2_setPositionRotationQuat=function(e,t){return z.fromRotationTranslation(this,t,e),this};Array.prototype.quat2_isNormalized=function(e=this._pp_normalizedEpsilon){return Math.abs(this.quat2_lengthSquared()-1)<e};Array.prototype.quat2_length=function(){return z.length(this)};Array.prototype.quat2_lengthSquared=function(){return z.squaredLength(this)};Array.prototype.quat2_mul=function(e,t=PP.quat2_create()){return z.mul(t,this,e),t};Array.prototype.quat2_getAxes=function(e=[PP.vec3_create(),PP.vec3_create(),PP.vec3_create()]){return this.quat2_getLeft(e[0]),this.quat2_getUp(e[1]),this.quat2_getForward(e[2]),e};Array.prototype.quat2_getForward=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return q.fromQuat(i,this),x.set(t,i[6],i[7],i[8]),x.normalize(t,t),t}}();Array.prototype.quat2_getBackward=function(e){return e=this.quat2_getForward(e),e.vec3_negate(e),e};Array.prototype.quat2_getLeft=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return q.fromQuat(i,this),x.set(t,i[0],i[1],i[2]),x.normalize(t,t),t}}();Array.prototype.quat2_getRight=function(e){return e=this.quat2_getLeft(e),e.vec3_negate(e),e};Array.prototype.quat2_getUp=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return q.fromQuat(i,this),x.set(t,i[3],i[4],i[5]),x.normalize(t,t),t}}();Array.prototype.quat2_getDown=function(e){return e=this.quat2_getUp(e),e.vec3_negate(e),e};Array.prototype.quat2_toWorld=function(e,t=PP.quat2_create()){return z.mul(t,e,this),t};Array.prototype.quat2_toLocal=function(){let i=PP.quat2_create();return function(t,n=PP.quat2_create()){return z.conjugate(i,t),z.mul(n,i,this),n}}();Array.prototype.quat2_rotateAxis=function(e,t,n){return this.quat2_rotateAxisDegrees(e,t,n)};Array.prototype.quat2_rotateAxisDegrees=function(e,t,n){return this.quat2_rotateAxisRadians(Q.toRadian(e),t,n)};Array.prototype.quat2_rotateAxisRadians=function(){let i=PP.quat_create();return function(t,n,a){return this.quat2_getRotationQuat(i),i.quat_rotateAxisRadians(t,n,i),a.quat2_copy(this),a.quat2_setRotationQuat(i),a}}();Array.prototype.quat2_toMatrix=function(e=PP.mat4_create()){return k.fromQuat2(e,this),e};Array.prototype.quat2_fromMatrix=function(e){return e.mat4_toQuat(this),this};Array.prototype.quat2_lerp=function(e,t,n=PP.quat2_create()){return t<=0?(n.quat2_copy(this),n):t>=1?(n.quat2_copy(e),n):(z.lerp(n,this,e,t),n)};Array.prototype.quat2_interpolate=function(e,t,n=PP.EasingFunction.linear,a=PP.quat2_create()){let s=n(t);return this.quat2_lerp(e,s,a)};Array.prototype.mat3_toDegrees=function(){let i=PP.quat_create();return function(t=PP.vec3_create()){return this.mat3_toQuat(i),i.quat_toDegrees(t),t}}();Array.prototype.mat3_toRadians=function(){let i=PP.quat_create();return function(t=PP.vec3_create()){return this.mat3_toQuat(i),i.quat_toRadians(t),t}}();Array.prototype.mat3_toQuat=function(e=PP.quat_create()){return W.fromMat3(e,this),e};Array.prototype.mat3_fromAxes=function(e,t,n){return q.set(this,e[0],e[1],e[2],t[0],t[1],t[2],n[0],n[1],n[2]),this};Array.prototype.mat4_copy=function(e){return k.copy(this,e),this};Array.prototype.mat4_identity=function(){return k.identity(this),this};Array.prototype.mat4_invert=function(e=PP.mat4_create()){return k.invert(e,this),e};Array.prototype.mat4_mul=function(e,t=PP.mat4_create()){return k.mul(t,this,e),t};Array.prototype.mat4_scale=function(e,t=PP.mat4_create()){return k.scale(t,this,e),t};Array.prototype.mat4_clone=function(e=PP.mat4_create()){return k.copy(e,this),e};Array.prototype.mat4_getPosition=function(e=PP.vec3_create()){return k.getTranslation(e,this),e};Array.prototype.mat4_getRotation=function(e=PP.vec3_create()){return this.mat4_getRotationDegrees(e)};Array.prototype.mat4_getRotationDegrees=function(){let i=PP.quat_create();return function(t=PP.vec3_create()){return this.mat4_getRotationQuat(i),i.quat_toDegrees(t),t}}();Array.prototype.mat4_getRotationRadians=function(){let i=PP.quat_create();return function(t=PP.vec3_create()){return this.mat4_getRotationQuat(i),i.quat_toRadians(t),t}}();Array.prototype.mat4_getRotationQuat=function(){let i=PP.vec3_create(),e=PP.mat4_create(),t=PP.vec3_create(),n=PP.vec3_create();return x.set(n,1,1,1),function(s=PP.quat_create()){return k.getScaling(i,this),x.divide(t,n,i),k.scale(e,this,t),k.getRotation(s,e),W.normalize(s,s),s}}();Array.prototype.mat4_getScale=function(e=PP.vec3_create()){return k.getScaling(e,this),e};Array.prototype.mat4_setPosition=function(e){return this[12]=e[0],this[13]=e[1],this[14]=e[2],this};Array.prototype.mat4_setRotation=function(e){return this.mat4_setRotationDegrees(e),this};Array.prototype.mat4_setRotationDegrees=function(){let i=PP.quat_create();return function(t){return this.mat4_setRotationQuat(t.vec3_degreesToQuat(i)),this}}();Array.prototype.mat4_setRotationRadians=function(){let i=PP.vec3_create();return function(t){return this.mat4_setRotationDegrees(t.vec3_toDegrees(i)),this}}();Array.prototype.mat4_setRotationQuat=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n){return this.mat4_getPosition(i),this.mat4_getScale(e),this.mat4_setPositionRotationQuatScale(i,n,e),this}}();Array.prototype.mat4_setScale=function(){let i=PP.vec3_create();return function(t){return k.getScaling(i,this),x.divide(i,t,i),k.scale(this,this,i),this}}();Array.prototype.mat4_setPositionRotationScale=function(e,t,n){return this.mat4_setPositionRotationDegreesScale(e,t,n),this};Array.prototype.mat4_setPositionRotationDegreesScale=function(){let i=PP.quat_create();return function(t,n,a){return this.mat4_setPositionRotationQuatScale(t,n.vec3_degreesToQuat(i),a),this}}();Array.prototype.mat4_setPositionRotationRadiansScale=function(){let i=PP.vec3_create();return function(t,n,a){return this.mat4_setPositionRotationDegreesScale(t,n.vec3_toDegrees(i),a),this}}();Array.prototype.mat4_setPositionRotationQuatScale=function(e,t,n){return k.fromRotationTranslationScale(this,t,e,n),this};Array.prototype.mat4_setPositionRotation=function(e,t){return this.mat4_setPositionRotationDegrees(e,t),this};Array.prototype.mat4_setPositionRotationDegrees=function(){let i=PP.quat_create();return function(t,n){return this.mat4_setPositionRotationQuat(t,n.vec3_degreesToQuat(i)),this}}();Array.prototype.mat4_setPositionRotationRadians=function(){let i=PP.vec3_create();return function(t,n){return this.mat4_setPositionRotationDegrees(t,n.vec3_toDegrees(i)),this}}();Array.prototype.mat4_setPositionRotationQuat=function(e,t){return k.fromRotationTranslation(this,t,e),this};Array.prototype.mat4_getAxes=function(e=[PP.vec3_create(),PP.vec3_create(),PP.vec3_create()]){return this.mat4_getLeft(e[0]),this.mat4_getUp(e[1]),this.mat4_getForward(e[2]),e};Array.prototype.mat4_getForward=function(e=PP.vec3_create()){return x.set(e,this[8],this[9],this[10]),x.normalize(e,e),e};Array.prototype.mat4_getBackward=function(e){return e=this.mat4_getForward(e),e.vec3_negate(e),e};Array.prototype.mat4_getLeft=function(e=PP.vec3_create()){return x.set(e,this[0],this[1],this[2]),x.normalize(e,e),e};Array.prototype.mat4_getRight=function(e){return e=this.mat4_getLeft(e),e.vec3_negate(e),e};Array.prototype.mat4_getUp=function(e=PP.vec3_create()){return x.set(e,this[4],this[5],this[6]),x.normalize(e,e),e};Array.prototype.mat4_getDown=function(e){return e=this.mat4_getUp(e),e.vec3_negate(e),e};Array.prototype.mat4_toWorld=function(){let i=PP.mat4_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create();return x.set(a,1,1,1),function(o,l=PP.mat4_create()){return o.mat4_hasUniformScale()?k.mul(l,o,this):(x.set(e,this[12],this[13],this[14]),e.vec3_convertPositionToWorldMatrix(o,e),k.getScaling(t,o),x.divide(n,a,t),k.scale(i,o,n),k.mul(l,i,this),k.scale(l,l,t),l[12]=e[0],l[13]=e[1],l[14]=e[2],l[15]=1),l}}();Array.prototype.mat4_toLocal=function(){let i=PP.mat4_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create();return x.set(a,1,1,1),function(o,l=PP.mat4_create()){return o.mat4_hasUniformScale()?(k.invert(i,o),k.mul(l,i,this)):(x.set(e,this[12],this[13],this[14]),e.vec3_convertPositionToLocalMatrix(o,e),k.getScaling(t,o),x.divide(n,a,t),k.scale(i,o,n),k.invert(i,i),k.mul(l,i,this),k.scale(l,l,n),l[12]=e[0],l[13]=e[1],l[14]=e[2],l[15]=1),l}}();Array.prototype.mat4_hasUniformScale=function(){let i=PP.vec3_create();return function(){return k.getScaling(i,this),Math.abs(i[0]-i[1])<this._pp_epsilon&&Math.abs(i[1]-i[2])<this._pp_epsilon&&Math.abs(i[0]-i[2])<this._pp_epsilon}}();Array.prototype.mat4_toQuat=function(){let i=PP.vec3_create(),e=PP.quat_create();return function(n=PP.quat2_create()){return k.getTranslation(i,this),this.mat4_getRotationQuat(e),z.fromRotationTranslation(n,e,i),n}}();Array.prototype.mat4_fromQuat=function(e){return e.quat2_toMatrix(this),this};Array.prototype._pp_epsilon=1e-6;Array.prototype._pp_epsilonSquared=Array.prototype._pp_epsilon*Array.prototype._pp_epsilon;Array.prototype._pp_degreesEpsilon=1e-5;Array.prototype._pp_normalizedEpsilon=1e-6;Array.prototype._pp_clamp=function(e,t,n){return Math.min(Math.max(e,t),n)};Array.prototype._vec_buildConsoleMessage=function(e){let t="[";for(let n=0;n<this.length;n++)n!=0&&(t=t.concat(", ")),e!=null?t=t.concat(this[n].toFixed(e)):t=t.concat(this[n].toString());return t=t.concat("]"),t};Array.prototype._vec_prepareOut=function(e){return e==null?e=this.pp_clone():e!=this&&e.pp_copy(this),e};Array.prototype._pp_findAllEqualOptimized=function(e,t){let n=[],a=-1;for(;(a=this.indexOf(e,a+1))>=0;)n.push(t?a:this[a]);return n};Array.prototype._quat_setAxes=function(){let i=[PP.vec3_create(),PP.vec3_create(),PP.vec3_create()],e=[[1,-1,1],[1,1,-1],[-1,1,-1]],t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.mat3_create(),m=PP.quat_create();return function(r,y){let u=r[y[0]],p=r[y[1]],d=r[y[2]];if(u==null||u.vec3_isZero(this._pp_epsilon))return;let _=!1;p!=null&&u.vec3_angleRadians(p)>this._pp_epsilon&&(_=!0);let h=!1;if(d!=null&&u.vec3_angleRadians(d)>this._pp_epsilon&&(h=!0),_||h){let P=null,T=null,v=null;_?(P=p,T=1,v=2):(P=d,T=2,v=1);let f=e[y[0]];x.cross(i[v],u,P),x.scale(i[v],i[v],f[y[v]]),x.cross(i[T],u,i[v]),x.scale(i[T],i[T],f[y[T]]),x.cross(i[0],i[1],i[2]),x.scale(i[0],i[0],f[y[0]]),x.normalize(t,i[y.pp_findIndexEqual(0)]),x.normalize(n,i[y.pp_findIndexEqual(1)]),x.normalize(a,i[y.pp_findIndexEqual(2)]),q.set(l,t[0],t[1],t[2],n[0],n[1],n[2],a[0],a[1],a[2]),W.fromMat3(m,l),W.normalize(m,m),this.quat_copy(m)}else{y[0]==0?this.quat_getLeft(s):y[0]==1?this.quat_getUp(s):this.quat_getForward(s);let P=u.vec3_angleRadians(s);P>this._pp_epsilon&&(x.cross(o,s,u),x.normalize(o,o),W.setAxisAngle(m,o,P),this.quat_rotateQuat(m,this))}return this}}();Array.prototype._pp_syncPrototypesProperties()});var Li=S(()=>{Math.PP_EPSILON_NUMBER=1e-5;Math.PP_EPSILON_NUMBER_SQUARED=Math.PP_EPSILON_NUMBER*Math.PP_EPSILON_NUMBER;Math.PP_EPSILON_DEGREES=1e-4;Math.pp_clamp=function(e,t,n){let a=t??-Number.MAX_VALUE,s=n??Number.MAX_VALUE,o=Math.min(a,s),l=Math.max(a,s);return Math.min(Math.max(e,o),l)};Math.pp_sign=function(e,t=1){let n=Math.sign(e);return n==0&&(n=Math.sign(t)),n};Math.pp_toDegrees=function(e){return e*(180/Math.PI)};Math.pp_toRadians=function(e){return e*(Math.PI/180)};Math.pp_roundDecimal=function(e,t){let n=Math.pow(10,t);return e=Math.round(e*n)/n,e};Math.pp_mapToRange=function(e,t,n,a,s){if(t==n)return a;let o=Math.pp_clamp(e,t,n);if(o==t)return a;if(o==n)return s;let l=a+(s-a)/(n-t)*(o-t);return Math.pp_clamp(l,a,s)};Math.pp_random=function(e=0,t=1){return Math.random()*(t-e)+e};Math.pp_randomInt=function(e,t){let n=Math.min(e,t),a=Math.max(e,t);return Math.floor(Math.random()*(a-n+1)+n)};Math.pp_randomBool=function(){return Math.pp_randomInt(0,1)==0};Math.pp_randomSign=function(){return Math.random()<.5?1:-1};Math.pp_randomPick=function(...e){let t=null;if(e.length>0)if(e.length==1&&e[0].length!=null){if(e[0].length>0){let n=Math.pp_randomInt(0,e[0].length-1);t=e[0][n]}}else{let n=Math.pp_randomInt(0,e.length-1);t=e[n]}return t};Math.pp_lerp=function(e,t,n){return n<=0?e:n>=1?t:n*(t-e)+e};PP.EasingFunction={linear:i=>i,easeIn:i=>i*i*i,easeOut:i=>(i-1)*(i-1)*(i-1)+1,easeInOut:i=>i<.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1};Math.pp_interpolate=function(e,t,n,a=PP.EasingFunction.linear){let s=a(n);return Math.pp_lerp(e,t,s)};Math.pp_angleDistance=function(e,t){return Math.pp_angleDistanceDegrees(e,t)};Math.pp_angleDistanceDegrees=function(e,t){return Math.abs(Math.pp_angleDistanceSignedDegrees(e,t))};Math.pp_angleDistanceRadians=function(e,t){return Math.abs(Math.pp_angleDistanceSignedRadians(e,t))};Math.pp_angleDistanceSigned=function(e,t){return Math.pp_angleDistanceSignedDegrees(e,t)};Math.pp_angleDistanceSignedDegrees=function(e,t){let n=Math.pp_angleClampDegrees(e,!0),a=Math.pp_angleClampDegrees(t,!0),s=a-n;return a-n>180?s=a-n-360:a-n<-180&&(s=a-n+360),s};Math.pp_angleDistanceSignedRadians=function(e,t){return Math.pp_toRadians(Math.pp_angleDistanceSignedDegrees(Math.pp_toDegrees(e),Math.pp_toDegrees(t)))};Math.pp_angleClamp=function(e,t=!1){return Math.pp_angleClampDegrees(e,t)};Math.pp_angleClampDegrees=function(e,t=!1){let n=e%360;return n<0&&(n+=360),t||n>180&&(n-=360),n};Math.pp_angleClampRadians=function(e,t=!1){return Math.pp_toRadians(Math.pp_angleClampDegrees(Math.pp_toDegrees(e),t))};Math.pp_isInsideAngleRange=function(e,t,n,a=!1){return Math.pp_isInsideAngleRangeDegrees(e,t,n,a)};Math.pp_isInsideAngleRangeDegrees=function(e,t,n,a=!1){let s=!1,o=Math.pp_angleClampDegrees(e,!0),l=Math.pp_angleClampDegrees(t,!0),m=Math.pp_angleClampDegrees(n,!0);if(a&&Math.pp_angleDistanceSignedDegrees(l,m)<0){let c=l;l=m,m=c}return l<m?s=o>=l&&o<=m:s=o>=l||o<=m,s};Math.pp_isInsideAngleRangeRadians=function(e,t,n,a=!1){return Math.pp_isInsideAngleRangeDegrees(Math.pp_toDegrees(e),Math.pp_toDegrees(t),Math.pp_toDegrees(n),a)};for(let i in Math){let e=["pp_","_pp_"],t=!1;for(let n of e)if(i.startsWith(n)){t=!0;break}t&&Object.defineProperty(Math,i,{enumerable:!1})}});var Bi=S(()=>{if(WL&&WL.Object){WL.Object.prototype.pp_getPosition=function(e){return this.pp_getPositionWorld(e)},WL.Object.prototype.pp_getPositionWorld=function(e=PP.vec3_create()){return this.getTranslationWorld(e),e},WL.Object.prototype.pp_getPositionLocal=function(e=PP.vec3_create()){return this.getTranslationLocal(e),e},WL.Object.prototype.pp_getRotation=function(e){return this.pp_getRotationWorld(e)},WL.Object.prototype.pp_getRotationDegrees=function(e){return this.pp_getRotationWorldDegrees(e)},WL.Object.prototype.pp_getRotationRadians=function(e){return this.pp_getRotationWorldRadians(e)},WL.Object.prototype.pp_getRotationMatrix=function(e){return this.pp_getRotationWorldMatrix(e)},WL.Object.prototype.pp_getRotationQuat=function(e){return this.pp_getRotationWorldQuat(e)},WL.Object.prototype.pp_getRotationWorld=function(e){return this.pp_getRotationWorldDegrees(e)},WL.Object.prototype.pp_getRotationWorldDegrees=function(e){return e=this.pp_getRotationWorldRadians(e),e.forEach(function(t,n,a){a[n]=this._pp_toDegrees(t)}.bind(this)),e},WL.Object.prototype.pp_getRotationWorldRadians=function(){let i=PP.quat_create();return function(t=PP.vec3_create()){return this.pp_getRotationWorldQuat(i),this._pp_quaternionToRadians(i,t),t}}(),WL.Object.prototype.pp_getRotationWorldMatrix=function(){let i=PP.quat_create();return function(t=PP.mat3_create()){return this.pp_getRotationWorldQuat(i),i.quat_toMatrix(t),t}}(),WL.Object.prototype.pp_getRotationWorldQuat=function(e=PP.quat_create()){return e.quat_copy(this.rotationWorld),e},WL.Object.prototype.pp_getRotationLocal=function(e){return this.pp_getRotationLocalDegrees(e)},WL.Object.prototype.pp_getRotationLocalDegrees=function(e){return e=this.pp_getRotationLocalRadians(e),e.forEach(function(t,n,a){a[n]=this._pp_toDegrees(t)}.bind(this)),e},WL.Object.prototype.pp_getRotationLocalRadians=function(){let i=PP.quat_create();return function(t=PP.vec3_create()){return this.pp_getRotationLocalQuat(i),this._pp_quaternionToRadians(i,t),t}}(),WL.Object.prototype.pp_getRotationLocalMatrix=function(){let i=PP.quat_create();return function(t=PP.mat3_create()){return this.pp_getRotationLocalQuat(i),i.quat_toMatrix(t),t}}(),WL.Object.prototype.pp_getRotationLocalQuat=function(e=PP.quat_create()){return e.quat_copy(this.rotationLocal),e},WL.Object.prototype.pp_getScale=function(e){return this.pp_getScaleWorld(e)},WL.Object.prototype.pp_getScaleWorld=function(e=PP.vec3_create()){return e.vec3_copy(this.scalingWorld),e},WL.Object.prototype.pp_getScaleLocal=function(e=PP.vec3_create()){return e.vec3_copy(this.scalingLocal),e},WL.Object.prototype.pp_getTransform=function(e){return this.pp_getTransformWorld(e)},WL.Object.prototype.pp_getTransformMatrix=function(e){return this.pp_getTransformWorldMatrix(e)},WL.Object.prototype.pp_getTransformQuat=function(e){return this.pp_getTransformWorldQuat(e)},WL.Object.prototype.pp_getTransformWorld=function(e){return this.pp_getTransformWorldMatrix(e)},WL.Object.prototype.pp_getTransformWorldMatrix=function(){let i=PP.quat2_create(),e=PP.vec3_create();return function(n=PP.mat4_create()){return this.pp_getTransformWorldQuat(i),this.pp_getScaleWorld(e),n.mat4_fromQuat(i),n.mat4_scale(e,n),n}}(),WL.Object.prototype.pp_getTransformWorldQuat=function(e=PP.quat2_create()){return e.quat2_copy(this.transformWorld),e},WL.Object.prototype.pp_getTransformLocal=function(i){return this.pp_getTransformLocalMatrix(i)},WL.Object.prototype.pp_getTransformLocalMatrix=function(){let e=PP.quat2_create(),t=PP.vec3_create();return function(a=PP.mat4_create()){return this.pp_getTransformLocalQuat(e),this.pp_getScaleLocal(t),a.mat4_fromQuat(e),a.mat4_scale(t,a),a}}(),WL.Object.prototype.pp_getTransformLocalQuat=function(e=PP.quat2_create()){return e.quat2_copy(this.transformLocal),e},WL.Object.prototype.pp_getAxes=function(e){return this.pp_getAxesWorld(e)},WL.Object.prototype.pp_getAxesWorld=function(e=[PP.vec3_create(),PP.vec3_create(),PP.vec3_create()]){return this.pp_getLeftWorld(e[0]),this.pp_getUpWorld(e[1]),this.pp_getForwardWorld(e[2]),e},WL.Object.prototype.pp_getAxesLocal=function(e=[PP.vec3_create(),PP.vec3_create(),PP.vec3_create()]){return this.pp_getLeftLocal(e[0]),this.pp_getUpLocal(e[1]),this.pp_getForwardLocal(e[2]),e},WL.Object.prototype.pp_getForward=function(e){return this.pp_getForwardWorld(e)},WL.Object.prototype.pp_getForwardWorld=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationWorldMatrix(i),t[0]=i[6],t[1]=i[7],t[2]=i[8],t}}(),WL.Object.prototype.pp_getForwardLocal=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationLocalMatrix(i),t[0]=i[6],t[1]=i[7],t[2]=i[8],t}}(),WL.Object.prototype.pp_getBackward=function(e){return this.pp_getBackwardWorld(e)},WL.Object.prototype.pp_getBackwardWorld=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationWorldMatrix(i),t[0]=-i[6],t[1]=-i[7],t[2]=-i[8],t}}(),WL.Object.prototype.pp_getBackwardLocal=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationLocalMatrix(i),t[0]=-i[6],t[1]=-i[7],t[2]=-i[8],t}}(),WL.Object.prototype.pp_getUp=function(e){return this.pp_getUpWorld(e)},WL.Object.prototype.pp_getUpWorld=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationWorldMatrix(i),t[0]=i[3],t[1]=i[4],t[2]=i[5],t}}(),WL.Object.prototype.pp_getUpLocal=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationLocalMatrix(i),t[0]=i[3],t[1]=i[4],t[2]=i[5],t}}(),WL.Object.prototype.pp_getDown=function(e){return this.pp_getDownWorld(e)},WL.Object.prototype.pp_getDownWorld=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationWorldMatrix(i),t[0]=-i[3],t[1]=-i[4],t[2]=-i[5],t}}(),WL.Object.prototype.pp_getDownLocal=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationLocalMatrix(i),t[0]=-i[3],t[1]=-i[4],t[2]=-i[5],t}}(),WL.Object.prototype.pp_getLeft=function(e){return this.pp_getLeftWorld(e)},WL.Object.prototype.pp_getLeftWorld=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationWorldMatrix(i),t[0]=i[0],t[1]=i[1],t[2]=i[2],t}}(),WL.Object.prototype.pp_getLeftLocal=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationLocalMatrix(i),t[0]=i[0],t[1]=i[1],t[2]=i[2],t}}(),WL.Object.prototype.pp_getRight=function(e){return this.pp_getRightWorld(e)},WL.Object.prototype.pp_getRightWorld=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationWorldMatrix(i),t[0]=-i[0],t[1]=-i[1],t[2]=-i[2],t}}(),WL.Object.prototype.pp_getRightLocal=function(){let i=PP.mat3_create();return function(t=PP.vec3_create()){return this.pp_getRotationLocalMatrix(i),t[0]=-i[0],t[1]=-i[1],t[2]=-i[2],t}}(),WL.Object.prototype.pp_setPosition=function(e){this.pp_setPositionWorld(e)},WL.Object.prototype.pp_setPositionWorld=function(e){this.setTranslationWorld(e)},WL.Object.prototype.pp_setPositionLocal=function(e){this.setTranslationLocal(e)},WL.Object.prototype.pp_setRotation=function(e){this.pp_setRotationWorld(e)},WL.Object.prototype.pp_setRotationDegrees=function(e){this.pp_setRotationWorldDegrees(e)},WL.Object.prototype.pp_setRotationRadians=function(e){this.pp_setRotationWorldRadians(e)},WL.Object.prototype.pp_setRotationMatrix=function(e){this.pp_setRotationWorldMatrix(e)},WL.Object.prototype.pp_setRotationQuat=function(e){this.pp_setRotationWorldQuat(e)},WL.Object.prototype.pp_setRotationWorld=function(e){this.pp_setRotationWorldDegrees(e)},WL.Object.prototype.pp_setRotationWorldDegrees=function(){let i=PP.quat_create();return function(t){this._pp_degreesToQuaternion(t,i),this.pp_setRotationWorldQuat(i)}}(),WL.Object.prototype.pp_setRotationWorldRadians=function(){let i=PP.vec3_create();return function(t){t.forEach(function(n,a,s){i[a]=this._pp_toDegrees(n)}.bind(this)),this.pp_setRotationWorldDegrees(i)}}(),WL.Object.prototype.pp_setRotationWorldMatrix=function(){let i=PP.quat_create();return function(t){t.mat3_toQuat(i),this.pp_setRotationWorldQuat(i)}}(),WL.Object.prototype.pp_setRotationWorldQuat=function(e){this.rotationWorld=e},WL.Object.prototype.pp_setRotationLocal=function(e){this.pp_setRotationLocalDegrees(e)},WL.Object.prototype.pp_setRotationLocalDegrees=function(){let i=PP.quat_create();return function(t){this._pp_degreesToQuaternion(t,i),this.pp_setRotationLocalQuat(i)}}(),WL.Object.prototype.pp_setRotationLocalRadians=function(){let i=PP.vec3_create();return function(t){t.forEach(function(n,a,s){i[a]=this._pp_toDegrees(n)}.bind(this)),this.pp_setRotationLocalDegrees(i)}}(),WL.Object.prototype.pp_setRotationLocalMatrix=function(){let i=PP.quat_create();return function(t){t.mat3_toQuat(i),this.pp_setRotationLocalQuat(i)}}(),WL.Object.prototype.pp_setRotationLocalQuat=function(e){this.rotationLocal=e},WL.Object.prototype.pp_setScale=function(e){this.pp_setScaleWorld(e)},WL.Object.prototype.pp_setScaleWorld=function(){let i=PP.vec3_create();return function(t){isNaN(t)?this.scalingWorld=t:(i.vec3_set(t),this.scalingWorld=i)}}(),WL.Object.prototype.pp_setScaleLocal=function(){let i=PP.vec3_create();return function(t){isNaN(t)?this.scalingLocal=t:(i.vec3_set(t),this.scalingLocal=i)}}(),WL.Object.prototype.pp_setAxes=function(e,t,n){this.pp_setAxesWorld(e,t,n)},WL.Object.prototype.pp_setAxesWorld=function(e,t,n){n!=null?this.pp_setForwardWorld(n,t,e):t!=null?this.pp_setUpWorld(t,n,e):this.pp_setLeftWorld(e,t,n)},WL.Object.prototype.pp_setAxesLocal=function(e,t,n){n!=null?this.pp_setForwardLocal(n,t,e):t!=null?this.pp_setUpLocal(t,n,e):this.pp_setLeftLocal(e,t,n)},WL.Object.prototype.pp_setForward=function(e,t,n){this.pp_setForwardWorld(e,t,n)},WL.Object.prototype.pp_setForwardWorld=function(e,t=null,n=null){this._pp_setAxes([n,t,e],[2,1,0],!1)},WL.Object.prototype.pp_setForwardLocal=function(e,t=null,n=null){this._pp_setAxes([n,t,e],[2,1,0],!0)},WL.Object.prototype.pp_setBackward=function(e,t,n){this.pp_setBackwardWorld(e,t,n)},WL.Object.prototype.pp_setBackwardWorld=function(){let i=PP.vec3_create();return function(t,n=null,a=null){t.vec3_negate(i),this._pp_setAxes([a,n,i],[2,1,0],!1)}}(),WL.Object.prototype.pp_setBackwardLocal=function(){let i=PP.vec3_create();return function(t,n=null,a=null){t.vec3_negate(i),this._pp_setAxes([a,n,i],[2,1,0],!0)}}(),WL.Object.prototype.pp_setUp=function(e,t,n){this.pp_setUpWorld(e,t,n)},WL.Object.prototype.pp_setUpWorld=function(e,t=null,n=null){this._pp_setAxes([n,e,t],[1,2,0],!1)},WL.Object.prototype.pp_setUpLocal=function(e,t=null,n=null){this._pp_setAxes([n,e,t],[1,2,0],!0)},WL.Object.prototype.pp_setDown=function(e,t,n){this.pp_setDownWorld(e,t,n)},WL.Object.prototype.pp_setDownWorld=function(){let i=PP.vec3_create();return function(t,n=null,a=null){t.vec3_negate(i),this._pp_setAxes([a,i,n],[1,2,0],!1)}}(),WL.Object.prototype.pp_setDownLocal=function(){let i=PP.vec3_create();return function(t,n=null,a=null){t.vec3_negate(i),this._pp_setAxes([a,i,n],[1,2,0],!0)}}(),WL.Object.prototype.pp_setLeft=function(e,t,n){this.pp_setLeftWorld(e,t,n)},WL.Object.prototype.pp_setLeftWorld=function(e,t=null,n=null){this._pp_setAxes([e,t,n],[0,1,2],!1)},WL.Object.prototype.pp_setLeftLocal=function(e,t=null,n=null){this._pp_setAxes([e,t,n],[0,1,2],!0)},WL.Object.prototype.pp_setRight=function(e,t,n){this.pp_setRightWorld(e,t,n)},WL.Object.prototype.pp_setRightWorld=function(){let i=PP.vec3_create();return function(t,n=null,a=null){t.vec3_negate(i),this._pp_setAxes([i,n,a],[0,1,2],!1)}}(),WL.Object.prototype.pp_setRightLocal=function(){let i=PP.vec3_create();return function(t,n=null,a=null){t.vec3_negate(i),this._pp_setAxes([i,n,a],[0,1,2],!0)}}(),WL.Object.prototype.pp_setTransform=function(e){this.pp_setTransformWorld(e)},WL.Object.prototype.pp_setTransformMatrix=function(e){this.pp_setTransformWorldMatrix(e)},WL.Object.prototype.pp_setTransformQuat=function(e){this.pp_setTransformWorldQuat(e)},WL.Object.prototype.pp_setTransformWorld=function(e){return this.pp_setTransformWorldMatrix(e)},WL.Object.prototype.pp_setTransformWorldMatrix=function(){let i=PP.vec3_create(),e=PP.quat_create(),t=PP.vec3_create(),n=PP.mat4_create(),a=PP.vec3_create(),s=PP.vec3_create(1);return function(l){l.mat4_getPosition(i),l.mat4_getScale(t),s.vec3_div(t,a),l.mat4_scale(a,n),n.mat4_getRotationQuat(e),e.quat_normalize(e),this.pp_setScaleWorld(t),this.pp_setRotationWorldQuat(e),this.pp_setPositionWorld(i)}}(),WL.Object.prototype.pp_setTransformWorldQuat=function(e){this.transformWorld=e},WL.Object.prototype.pp_setTransformLocal=function(e){return this.pp_setTransformLocalMatrix(e)},WL.Object.prototype.pp_setTransformLocalMatrix=function(){let i=PP.vec3_create(),e=PP.quat_create(),t=PP.vec3_create(),n=PP.mat4_create(),a=PP.vec3_create(),s=PP.vec3_create(1);return function(l){l.mat4_getPosition(i),l.mat4_getScale(t),s.vec3_div(t,a),l.mat4_scale(a,n),n.mat4_getRotationQuat(e),e.quat_normalize(e),this.pp_setScaleLocal(t),this.pp_setRotationLocalQuat(e),this.pp_setPositionLocal(i)}}(),WL.Object.prototype.pp_setTransformLocalQuat=function(e){this.transformLocal=e},WL.Object.prototype.pp_resetPosition=function(){this.pp_resetPositionWorld()},WL.Object.prototype.pp_resetPositionWorld=function(){let i=PP.vec3_create();return function(){this.pp_setPositionWorld(i)}}(),WL.Object.prototype.pp_resetPositionLocal=function(){let i=PP.vec3_create();return function(){this.pp_setPositionLocal(i)}}(),WL.Object.prototype.pp_resetRotation=function(){this.pp_resetRotationWorld()},WL.Object.prototype.pp_resetRotationWorld=function(){let i=PP.quat_create();return function(){this.pp_setRotationWorldQuat(i)}}(),WL.Object.prototype.pp_resetRotationLocal=function(){let i=PP.quat_create();return function(){this.pp_setRotationLocalQuat(i)}}(),WL.Object.prototype.pp_resetScale=function(){this.pp_resetScaleWorld()},WL.Object.prototype.pp_resetScaleWorld=function(){let i=PP.vec3_create(1);return function(){this.pp_setScaleWorld(i)}}(),WL.Object.prototype.pp_resetScaleLocal=function(){let i=PP.vec3_create(1);return function(){this.pp_setScaleLocal(i)}}(),WL.Object.prototype.pp_resetTransform=function(){this.pp_resetTransformWorld()},WL.Object.prototype.pp_resetTransformWorld=function(){this.pp_resetScaleWorld(),this.pp_resetRotationWorld(),this.pp_resetPositionWorld()},WL.Object.prototype.pp_resetTransformLocal=function(){this.pp_resetScaleLocal(),this.pp_resetRotationLocal(),this.pp_resetPositionLocal()},WL.Object.prototype.pp_translate=function(e){this.pp_translateWorld(e)},WL.Object.prototype.pp_translateWorld=function(e){this.translateWorld(e)},WL.Object.prototype.pp_translateLocal=function(e){this.translate(e)},WL.Object.prototype.pp_translateObject=function(e){this.translateObject(e)},WL.Object.prototype.pp_translateAxis=function(e,t){this.pp_translateAxisWorld(e,t)},WL.Object.prototype.pp_translateAxisWorld=function(){let i=PP.vec3_create();return function(t,n){n.vec3_scale(t,i),this.pp_translateWorld(i)}}(),WL.Object.prototype.pp_translateAxisLocal=function(){let i=PP.vec3_create();return function(t,n){n.vec3_scale(t,i),this.pp_translateLocal(i)}}(),WL.Object.prototype.pp_translateAxisObject=function(){let i=PP.vec3_create();return function(t,n){n.vec3_scale(t,i),this.pp_translateObject(i)}}(),WL.Object.prototype.pp_rotate=function(e){this.pp_rotateWorld(e)},WL.Object.prototype.pp_rotateDegrees=function(e){this.pp_rotateWorldDegrees(e)},WL.Object.prototype.pp_rotateRadians=function(e){this.pp_rotateWorldRadians(e)},WL.Object.prototype.pp_rotateMatrix=function(e){this.pp_rotateWorldMatrix(e)},WL.Object.prototype.pp_rotateQuat=function(e){this.pp_rotateWorldQuat(e)},WL.Object.prototype.pp_rotateWorld=function(e){this.pp_rotateWorldDegrees(e)},WL.Object.prototype.pp_rotateWorldDegrees=function(){let i=PP.quat_create();return function(t){this._pp_degreesToQuaternion(t,i),this.pp_rotateWorldQuat(i)}}(),WL.Object.prototype.pp_rotateWorldRadians=function(){let i=PP.vec3_create();return function(t){t.forEach(function(n,a,s){i[a]=this._pp_toDegrees(n)}.bind(this)),this.pp_rotateWorldDegrees(i)}}(),WL.Object.prototype.pp_rotateWorldMatrix=function(){let i=PP.quat_create();return function(t){t.mat3_toQuat(i),i.quat_normalize(i),this.pp_rotateWorldQuat(i)}}(),WL.Object.prototype.pp_rotateWorldQuat=function(){let i=PP.quat_create();return function(t){this.pp_getRotationWorldQuat(i),t.quat_mul(i,i),i.quat_normalize(i),this.pp_setRotationWorldQuat(i)}}(),WL.Object.prototype.pp_rotateLocal=function(e){this.pp_rotateLocalDegrees(e)},WL.Object.prototype.pp_rotateLocalDegrees=function(){let i=PP.quat_create();return function(t){this._pp_degreesToQuaternion(t,i),this.pp_rotateLocalQuat(i)}}(),WL.Object.prototype.pp_rotateLocalRadians=function(){let i=PP.vec3_create();return function(t){t.forEach(function(n,a,s){i[a]=this._pp_toDegrees(n)}.bind(this)),this.pp_rotateLocalDegrees(i)}}(),WL.Object.prototype.pp_rotateLocalMatrix=function(){let i=PP.quat_create();return function(t){t.mat3_toQuat(i),i.quat_normalize(i),this.pp_rotateLocalQuat(i)}}(),WL.Object.prototype.pp_rotateLocalQuat=function(){let i=PP.quat_create();return function(t){this.pp_getRotationLocalQuat(i),t.quat_mul(i,i),i.quat_normalize(i),this.pp_setRotationLocalQuat(i)}}(),WL.Object.prototype.pp_rotateObject=function(e){this.pp_rotateObjectDegrees(e)},WL.Object.prototype.pp_rotateObjectDegrees=function(){let i=PP.quat_create();return function(t){this._pp_degreesToQuaternion(t,i),this.pp_rotateObjectQuat(i)}}(),WL.Object.prototype.pp_rotateObjectRadians=function(){let i=PP.vec3_create();return function(t){t.forEach(function(n,a,s){i[a]=this._pp_toDegrees(n)}.bind(this)),this.pp_rotateObjectDegrees(i)}}(),WL.Object.prototype.pp_rotateObjectMatrix=function(){let i=PP.quat_create();return function(t){t.mat3_toQuat(i),i.quat_normalize(i),this.pp_rotateObjectQuat(i)}}(),WL.Object.prototype.pp_rotateObjectQuat=function(e){this.rotateObject(e)},WL.Object.prototype.pp_rotateAxis=function(e,t){this.pp_rotateAxisWorld(e,t)},WL.Object.prototype.pp_rotateAxisDegrees=function(e,t){this.pp_rotateAxisWorldDegrees(e,t)},WL.Object.prototype.pp_rotateAxisRadians=function(e,t){this.pp_rotateAxisWorldRadians(e,t)},WL.Object.prototype.pp_rotateAxisWorld=function(e,t){this.pp_rotateAxisWorldDegrees(e,t)},WL.Object.prototype.pp_rotateAxisWorldDegrees=function(e,t){this.pp_rotateAxisWorldRadians(Math.pp_toRadians(e),t)},WL.Object.prototype.pp_rotateAxisWorldRadians=function(){let i=PP.quat_create();return function(t,n){i.quat_fromAxisRadians(t,n),this.pp_rotateWorldQuat(i)}}(),WL.Object.prototype.pp_rotateAxisLocal=function(e,t){this.pp_rotateAxisLocalDegrees(e,t)},WL.Object.prototype.pp_rotateAxisLocalDegrees=function(e,t){this.pp_rotateAxisLocalRadians(Math.pp_toRadians(e),t)},WL.Object.prototype.pp_rotateAxisLocalRadians=function(){let i=PP.quat_create();return function(t,n){i.quat_fromAxisRadians(t,n),this.pp_rotateLocalQuat(i)}}(),WL.Object.prototype.pp_rotateAxisObject=function(e,t){this.pp_rotateAxisObjectDegrees(e,t)},WL.Object.prototype.pp_rotateAxisObjectDegrees=function(e,t){this.pp_rotateAxisObjectRadians(Math.pp_toRadians(e),t)},WL.Object.prototype.pp_rotateAxisObjectRadians=function(){let i=PP.quat_create();return function(t,n){i.quat_fromAxisRadians(t,n),this.pp_rotateObjectQuat(i)}}(),WL.Object.prototype.pp_rotateAround=function(e,t){this.pp_rotateAroundWorld(e,t)},WL.Object.prototype.pp_rotateAroundDegrees=function(e,t){this.pp_rotateAroundWorldDegrees(e,t)},WL.Object.prototype.pp_rotateAroundRadians=function(e,t){this.pp_rotateAroundWorldRadians(e,t)},WL.Object.prototype.pp_rotateAroundMatrix=function(e,t){this.pp_rotateAroundWorldMatrix(e,t)},WL.Object.prototype.pp_rotateAroundQuat=function(e,t){this.pp_rotateAroundWorldQuat(e,t)},WL.Object.prototype.pp_rotateAroundWorld=function(e,t){this.pp_rotateAroundWorldDegrees(e,t)},WL.Object.prototype.pp_rotateAroundWorldDegrees=function(){let i=PP.quat_create();return function(t,n){this._pp_degreesToQuaternion(t,i),this.pp_rotateAroundWorldQuat(i,n)}}(),WL.Object.prototype.pp_rotateAroundWorldRadians=function(){let i=PP.vec3_create();return function(t,n){t.forEach(function(a,s,o){i[s]=this._pp_toDegrees(a)}.bind(this)),this.pp_rotateAroundWorldDegrees(i,n)}}(),WL.Object.prototype.pp_rotateAroundWorldMatrix=function(){let i=PP.quat_create();return function(t,n){t.mat3_toQuat(i),i.quat_normalize(i),this.pp_rotateAroundWorldQuat(i,n)}}(),WL.Object.prototype.pp_rotateAroundWorldQuat=function(){let i=PP.vec3_create();return function(t,n){t.quat_getAxis(i);let a=t.quat_getAngleRadians();this.pp_rotateAroundAxisWorldRadians(a,i,n)}}(),WL.Object.prototype.pp_rotateAroundLocal=function(e,t){this.pp_rotateAroundLocalDegrees(e,t)},WL.Object.prototype.pp_rotateAroundLocalDegrees=function(){let i=PP.quat_create();return function(t,n){this._pp_degreesToQuaternion(t,i),this.pp_rotateAroundLocalQuat(i,n)}}(),WL.Object.prototype.pp_rotateAroundLocalRadians=function(){let i=PP.vec3_create();return function(t,n){t.forEach(function(a,s,o){i[s]=this._pp_toDegrees(a)}.bind(this)),this.pp_rotateAroundLocalDegrees(i,n)}}(),WL.Object.prototype.pp_rotateAroundLocalMatrix=function(){let i=PP.quat_create();return function(t,n){t.mat3_toQuat(i),i.quat_normalize(i),this.pp_rotateAroundLocalQuat(i,n)}}(),WL.Object.prototype.pp_rotateAroundLocalQuat=function(){let i=PP.vec3_create();return function(t,n){t.quat_getAxis(i);let a=t.quat_getAngleRadians();this.pp_rotateAroundAxisLocalRadians(a,i,n)}}(),WL.Object.prototype.pp_rotateAroundObject=function(e,t){this.pp_rotateAroundObjectDegrees(e,t)},WL.Object.prototype.pp_rotateAroundObjectDegrees=function(){let i=PP.quat_create();return function(t,n){this._pp_degreesToQuaternion(t,i),this.pp_rotateAroundObjectQuat(i,n)}}(),WL.Object.prototype.pp_rotateAroundObjectRadians=function(){let i=PP.vec3_create();return function(t,n){t.forEach(function(a,s,o){i[s]=this._pp_toDegrees(a)}.bind(this)),this.pp_rotateAroundObjectDegrees(i,n)}}(),WL.Object.prototype.pp_rotateAroundObjectMatrix=function(){let i=PP.quat_create();return function(t,n){t.mat3_toQuat(i),i.quat_normalize(i),this.pp_rotateAroundObjectQuat(i,n)}}(),WL.Object.prototype.pp_rotateAroundObjectQuat=function(){let i=PP.vec3_create();return function(t,n){t.quat_getAxis(i);let a=t.quat_getAngleRadians();this.pp_rotateAroundAxisObjectRadians(a,i,n)}}(),WL.Object.prototype.pp_rotateAroundAxis=function(e,t,n){this.pp_rotateAroundAxisWorld(e,t,n)},WL.Object.prototype.pp_rotateAroundAxisDegrees=function(e,t,n){this.pp_rotateAroundAxisWorldDegrees(e,t,n)},WL.Object.prototype.pp_rotateAroundAxisRadians=function(e,t,n){this.pp_rotateAroundAxisWorldRadians(e,t,n)},WL.Object.prototype.pp_rotateAroundAxisWorld=function(e,t,n){this.pp_rotateAroundAxisWorldDegrees(e,t,n)},WL.Object.prototype.pp_rotateAroundAxisWorldDegrees=function(e,t,n){this.pp_rotateAroundAxisWorldRadians(Math.pp_toRadians(e),t,n)},WL.Object.prototype.pp_rotateAroundAxisWorldRadians=function(){let i=PP.quat2_create(),e=PP.quat2_create(),t=PP.quat2_create(),n=PP.quat_create();return function(s,o,l){i.quat2_setPositionRotationQuat(l,n),this.pp_getTransformWorldQuat(t),i.quat2_conjugate(e),e.quat2_mul(t,t),i.quat2_rotateAxisRadians(s,o,i),i.quat2_mul(t,t),this.pp_setTransformWorldQuat(t)}}(),WL.Object.prototype.pp_rotateAroundAxisLocal=function(e,t,n){this.pp_rotateAroundAxisLocalDegrees(e,t,n)},WL.Object.prototype.pp_rotateAroundAxisLocalDegrees=function(e,t,n){this.pp_rotateAroundAxisLocalRadians(Math.pp_toRadians(e),t,n)},WL.Object.prototype.pp_rotateAroundAxisLocalRadians=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a,s){this.pp_convertPositionLocalToWorld(s,i),this.pp_convertDirectionLocalToWorld(a,e),this.pp_rotateAroundAxisWorldRadians(n,e,i)}}(),WL.Object.prototype.pp_rotateAroundAxisObject=function(e,t,n){this.pp_rotateAroundAxisObjectDegrees(e,t,n)},WL.Object.prototype.pp_rotateAroundAxisObjectDegrees=function(e,t,n){this.pp_rotateAroundAxisObjectRadians(Math.pp_toRadians(e),t,n)},WL.Object.prototype.pp_rotateAroundAxisObjectRadians=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a,s){this.pp_convertPositionObjectToWorld(s,i),this.pp_convertDirectionObjectToWorld(a,e),this.pp_rotateAroundAxisWorldRadians(n,e,i)}}(),WL.Object.prototype.pp_scaleObject=function(){let i=PP.vec3_create();return function(t){isNaN(t)?this.scale(t):(i.vec3_set(t),this.scale(i))}}(),WL.Object.prototype.pp_lookAt=function(e,t){this.pp_lookAtWorld(e,t)},WL.Object.prototype.pp_lookAtWorld=function(){let i=PP.vec3_create();return function(t,n){this.pp_getPositionWorld(i),t.vec3_sub(i,i),this.pp_lookToWorld(i,n)}}(),WL.Object.prototype.pp_lookAtLocal=function(){let i=PP.vec3_create();return function(t,n){this.pp_getPositionLocal(i),t.vec3_sub(i,i),this.pp_lookToLocal(i,n)}}(),WL.Object.prototype.pp_lookTo=function(e,t){this.pp_lookToWorld(e,t)},WL.Object.prototype.pp_lookToWorld=function(){let i=PP.vec3_create();return function(t,n=this.pp_getUpWorld(i)){this.pp_setForwardWorld(t,n)}}(),WL.Object.prototype.pp_lookToLocal=function(){let i=PP.vec3_create();return function(t,n=this.pp_getUpLocal(i)){this.pp_setForwardLocal(t,n)}}(),WL.Object.prototype.pp_setParent=function(){let i=PP.vec3_create(),e=PP.quat_create(),t=PP.vec3_create();return function(a,s=!0){s?(this.pp_getPositionWorld(i),this.pp_getRotationWorldQuat(e),this.pp_getScaleWorld(t),this.parent=a,this.pp_setScaleWorld(t),this.pp_setRotationWorldQuat(e),this.pp_setPositionWorld(i)):this.parent=a}}(),WL.Object.prototype.pp_getParent=function(){return this.parent},WL.Object.prototype.pp_convertPositionObjectToWorld=function(){let i=PP.mat4_create();return function(t,n=PP.vec3_create()){return this.pp_getTransformWorldMatrix(i),t.vec3_transformMat4(i,n),n}}(),WL.Object.prototype.pp_convertDirectionObjectToWorld=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return this.pp_getRotationWorldQuat(i),t.vec3_transformQuat(i,n),n}}(),WL.Object.prototype.pp_convertPositionWorldToObject=function(){let i=PP.mat4_create();return function(t,n=PP.vec3_create()){return this.pp_getTransformWorldMatrix(i),i.mat4_invert(i),t.vec3_transformMat4(i,n),n}}(),WL.Object.prototype.pp_convertDirectionWorldToObject=function(){let i=PP.quat_create();return function(t,n=PP.vec3_create()){return this.pp_getRotationWorldQuat(i),i.quat_conjugate(i),t.vec3_transformQuat(i,n),n}}(),WL.Object.prototype.pp_convertPositionLocalToWorld=function(e,t=PP.vec3_create()){return this.pp_getParent()?this.pp_getParent().pp_convertPositionObjectToWorld(e,t):t.vec3_copy(e),t},WL.Object.prototype.pp_convertDirectionLocalToWorld=function(e,t=PP.vec3_create()){return this.pp_getParent()?this.pp_getParent().pp_convertDirectionObjectToWorld(e,t):t.vec3_copy(e),t},WL.Object.prototype.pp_convertPositionWorldToLocal=function(e,t=PP.vec3_create()){return this.pp_getParent()?this.pp_getParent().pp_convertPositionWorldToObject(e,t):t.vec3_copy(e),t},WL.Object.prototype.pp_convertDirectionWorldToLocal=function(e,t=PP.vec3_create()){return this.pp_getParent()?this.pp_getParent().pp_convertDirectionWorldToObject(e,t):t.vec3_copy(e),t},WL.Object.prototype.pp_convertPositionObjectToLocal=function(e,t=PP.vec3_create()){return this.pp_convertPositionObjectToWorld(e,t),this.pp_convertPositionWorldToLocal(t,t),t},WL.Object.prototype.pp_convertDirectionObjectToLocal=function(e,t=PP.vec3_create()){return this.pp_convertDirectionObjectToWorld(e,t),this.pp_convertDirectionWorldToLocal(t,t),t},WL.Object.prototype.pp_convertPositionLocalToObject=function(e,t=PP.vec3_create()){return this.pp_convertPositionLocalToWorld(e,t),this.pp_convertPositionWorldToObject(t,t),t},WL.Object.prototype.pp_convertDirectionLocalToObject=function(e,t=PP.vec3_create()){return this.pp_convertDirectionLocalToWorld(e,t),this.pp_convertDirectionWorldToObject(t,t),t},WL.Object.prototype.pp_convertTransformObjectToWorld=function(e,t){return this.pp_convertTransformObjectToWorldMatrix(e,t)},WL.Object.prototype.pp_convertTransformObjectToWorldMatrix=function(){let i=PP.mat4_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(1);return function(o,l=PP.mat4_create()){return this.pp_getTransformWorldMatrix(i),this.pp_hasUniformScaleWorld()?i.mat4_mul(o,l):(e.vec3_set(o[12],o[13],o[14]),this.pp_convertPositionObjectToWorld(e,e),i.mat4_getScale(t),a.vec3_div(t,n),i.mat4_scale(n,i),i.mat4_mul(o,l),l.mat4_scale(t,l),l[12]=e[0],l[13]=e[1],l[14]=e[2],l[15]=1),l}}(),WL.Object.prototype.pp_convertTransformObjectToWorldQuat=function(){let i=PP.vec3_create(),e=PP.quat_create();return function(n,a=PP.quat2_create()){return this.pp_getRotationWorldQuat(e),e.quat_mul(n,e),n.quat2_getPosition(i),this.pp_convertPositionObjectToWorld(i,i),a.quat2_setPositionRotationQuat(i,e),a}}(),WL.Object.prototype.pp_convertTransformWorldToObject=function(e,t){return this.pp_convertTransformWorldToObjectMatrix(e,t)},WL.Object.prototype.pp_convertTransformWorldToObjectMatrix=function(){let i=PP.mat4_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(1);return function(o,l=PP.mat4_create()){return this.pp_getTransformWorldMatrix(i),this.pp_hasUniformScaleWorld()?(i.mat4_invert(i),i.mat4_mul(o,l)):(e.vec3_set(o[12],o[13],o[14]),this.pp_convertPositionWorldToObject(e,e),i.mat4_getScale(t),a.vec3_div(t,n),i.mat4_scale(n,i),i.mat4_invert(i),i.mat4_mul(o,l),l.mat4_scale(n,l),l[12]=e[0],l[13]=e[1],l[14]=e[2],l[15]=1),l}}(),WL.Object.prototype.pp_convertTransformWorldToObjectQuat=function(){let i=PP.vec3_create(),e=PP.quat_create();return function(n,a=PP.quat2_create()){return this.pp_getRotationWorldQuat(e),e.quat_conjugate(e),e.quat_mul(n,e),n.quat2_getPosition(i),this.pp_convertPositionWorldToObject(i,i),a.quat2_setPositionRotationQuat(i,e),a}}(),WL.Object.prototype.pp_convertTransformLocalToWorld=function(e,t){return this.pp_convertTransformLocalToWorldMatrix(e,t)},WL.Object.prototype.pp_convertTransformLocalToWorldMatrix=function(e,t=PP.mat4_create()){return this.pp_getParent()?this.pp_getParent().pp_convertTransformObjectToWorldMatrix(e,t):t.mat4_copy(e),t},WL.Object.prototype.pp_convertTransformLocalToWorldQuat=function(e,t=PP.quat2_create()){return this.pp_getParent()?this.pp_getParent().pp_convertTransformObjectToWorldQuat(e,t):t.quat2_copy(e),t},WL.Object.prototype.pp_convertTransformWorldToLocal=function(e,t){return this.pp_convertTransformWorldToLocalMatrix(e,t)},WL.Object.prototype.pp_convertTransformWorldToLocalMatrix=function(e,t=PP.mat4_create()){return this.pp_getParent()?this.pp_getParent().pp_convertTransformWorldToObjectMatrix(e,t):t.mat4_copy(e),t},WL.Object.prototype.pp_convertTransformWorldToLocalQuat=function(e,t=PP.quat2_create()){return this.pp_getParent()?this.pp_getParent().pp_convertTransformWorldToObjectQuat(e,t):t.quat2_copy(e),t},WL.Object.prototype.pp_convertTransformObjectToLocal=function(e,t){return this.pp_convertTransformObjectToLocalMatrix(e,t)},WL.Object.prototype.pp_convertTransformObjectToLocalMatrix=function(e,t=PP.mat4_create()){return this.pp_convertTransformObjectToWorldMatrix(e,t),this.pp_convertTransformWorldToLocalMatrix(t,t),t},WL.Object.prototype.pp_convertTransformObjectToLocalQuat=function(e,t=PP.quat2_create()){return this.pp_convertTransformObjectToWorldQuat(e,t),this.pp_convertTransformWorldToLocalQuat(t,t),t},WL.Object.prototype.pp_convertTransformLocalToObject=function(e,t){return this.pp_convertTransformLocalToObjectMatrix(e,t)},WL.Object.prototype.pp_convertTransformLocalToObjectMatrix=function(e,t=PP.mat4_create()){return this.pp_convertTransformLocalToWorldMatrix(e,t),this.pp_convertTransformWorldToObjectMatrix(t,t),t},WL.Object.prototype.pp_convertTransformLocalToObjectQuat=function(e,t=PP.quat2_create()){return this.pp_convertTransformLocalToWorldQuat(e,t),this.pp_convertTransformWorldToObjectQuat(t,t),t},WL.Object.prototype.pp_addComponent=function(e,t,n=null){let a=null;return typeof t=="boolean"?(a={},a.active=t):(a=t,n!=null&&(a==null&&(a={}),a.active=n)),this.addComponent(e,a)},WL.Object.prototype.pp_getComponent=function(e,t=0){return this.pp_getComponentHierarchy(e,t)},WL.Object.prototype.pp_getComponentSelf=function(e,t=0){return this.getComponent(e,t)},WL.Object.prototype.pp_getComponentHierarchy=function(e,t=0){return this.pp_getComponentHierarchyBreadth(e,t)},WL.Object.prototype.pp_getComponentHierarchyBreadth=function(e,t=0){let n=this.pp_getHierarchyBreadth();return WL.Object.pp_getComponentObjects(n,e,t)},WL.Object.prototype.pp_getComponentHierarchyDepth=function(e,t=0){let n=this.pp_getHierarchyDepth();return WL.Object.pp_getComponentObjects(n,e,t)},WL.Object.prototype.pp_getComponentDescendants=function(e,t=0){return this.pp_getComponentDescendantsBreadth(e,t)},WL.Object.prototype.pp_getComponentDescendantsBreadth=function(e,t=0){let n=this.pp_getDescendantsBreadth();return WL.Object.pp_getComponentObjects(n,e,t)},WL.Object.prototype.pp_getComponentDescendantsDepth=function(e,t=0){let n=this.pp_getDescendantsDepth();return WL.Object.pp_getComponentObjects(n,e,t)},WL.Object.prototype.pp_getComponentChildren=function(e,t=0){let n=this.pp_getChildren();return WL.Object.pp_getComponentObjects(n,e,t)},WL.Object.prototype.pp_getComponents=function(e){return this.pp_getComponentsHierarchy(e)},WL.Object.prototype.pp_getComponentsSelf=function(e){return this.getComponents(e)},WL.Object.prototype.pp_getComponentsHierarchy=function(e){return this.pp_getComponentsHierarchyBreadth(e)},WL.Object.prototype.pp_getComponentsHierarchyBreadth=function(e){let t=this.pp_getHierarchyBreadth();return WL.Object.pp_getComponentsObjects(t,e)},WL.Object.prototype.pp_getComponentsHierarchyDepth=function(e){let t=this.pp_getHierarchyDepth();return WL.Object.pp_getComponentsObjects(t,e)},WL.Object.prototype.pp_getComponentsDescendants=function(e){return this.pp_getComponentsDescendantsBreadth(e)},WL.Object.prototype.pp_getComponentsDescendantsBreadth=function(e){let t=this.pp_getDescendantsBreadth();return WL.Object.pp_getComponentsObjects(t,e)},WL.Object.prototype.pp_getComponentsDescendantsDepth=function(e){let t=this.pp_getDescendantsDepth();return WL.Object.pp_getComponentsObjects(t,e)},WL.Object.prototype.pp_getComponentsChildren=function(e){let t=this.pp_getChildren();return WL.Object.pp_getComponentsObjects(t,e)},WL.Object.prototype.pp_setActive=function(e,t=!0){t?this.pp_setActiveHierarchy(e):this.active=e},WL.Object.prototype.pp_setActiveSelf=function(e){this.pp_setActive(e,!1)},WL.Object.prototype.pp_setActiveHierarchy=function(e){this.pp_setActiveHierarchyBreadth(e)},WL.Object.prototype.pp_setActiveHierarchyBreadth=function(e){let t=this.pp_getHierarchyBreadth();return WL.Object.pp_setActiveObjects(t,e)},WL.Object.prototype.pp_setActiveHierarchyDepth=function(e){let t=this.pp_getHierarchyDepth();return WL.Object.pp_setActiveObjects(t,e)},WL.Object.prototype.pp_setActiveDescendants=function(e){this.pp_setActiveDescendantsBreadth(e)},WL.Object.prototype.pp_setActiveDescendantsBreadth=function(e){let t=this.pp_getDescendantsBreadth();return WL.Object.pp_setActiveObjects(t,e)},WL.Object.prototype.pp_setActiveDescendantsDepth=function(e){let t=this.pp_getDescendantsDepth();return WL.Object.pp_setActiveObjects(t,e)},WL.Object.prototype.pp_setActiveChildren=function(e){let t=this.pp_getChildren();return WL.Object.pp_setActiveObjects(t,e)},WL.Object.prototype.pp_hasUniformScale=function(){return this.pp_hasUniformScaleWorld()},WL.Object.prototype.pp_hasUniformScaleWorld=function(){let i=PP.vec3_create();return function(){return this.pp_getScaleWorld(i),Math.abs(i[0]-i[1])<this._pp_epsilon&&Math.abs(i[1]-i[2])<this._pp_epsilon&&Math.abs(i[0]-i[2])<this._pp_epsilon}}(),WL.Object.prototype.pp_hasUniformScaleLocal=function(){let i=PP.vec3_create();return function(){return this.pp_getScaleLocal(i),Math.abs(i[0]-i[1])<this._pp_epsilon&&Math.abs(i[1]-i[2])<this._pp_epsilon&&Math.abs(i[0]-i[2])<this._pp_epsilon}}(),PP.CloneParams=class{constructor(){this.myIgnoreNonCloneable=!1,this.myIgnoreComponents=!1,this.myIgnoreChildren=!1,this.myComponentsToIgnore=[],this.myComponentsToInclude=[],this.myIgnoreComponentCallback=null,this.myChildrenToIgnore=[],this.myChildrenToInclude=[],this.myIgnoreChildCallback=null,this.myDeepCloneParams=new PP.DeepCloneParams,this.myCustomParamsMap=new Map}},PP.DeepCloneParams=class{constructor(){this._myDeepCloneObject=!1,this._myOverrideDeepCloneComponentsMap=new Map,this._myOverrideDeepCloneComponentsVariablesMap=new Map}setDeepCloneObject(e){this._myDeepCloneObject=e}setDeepCloneComponent(e,t){this._myOverrideDeepCloneComponentsMap.set(e,t)}setDeepCloneComponentVariable(e,t,n){let a=null;this._myOverrideDeepCloneComponentsVariablesMap.has(e)||this._myOverrideDeepCloneComponentsVariablesMap.set(e,new Map),a=this._myOverrideDeepCloneComponentsVariablesMap.get(e),a.set(t,n)}isDeepCloneComponent(e){let t=this._myOverrideDeepCloneComponentsMap.get(e);return t??this._myDeepCloneObject}isDeepCloneComponentVariable(e,t){let n=this._myOverrideDeepCloneComponentsVariablesMap.get(e);if(n!=null){let a=n.get(t);if(a!=null)return a}return this.isDeepCloneComponent(e)}},WL.Object.prototype.pp_clone=function(){let i=PP.vec3_create(),e=PP.quat2_create();return function(n=new PP.CloneParams){let a=null;if(this.pp_isCloneable(n)){let s=[];s.push([this.parent,this]);let o=[];for(;s.length>0;){let c=s.shift(),r=c[0],y=c[1],u=WL.scene.addObject(r);if(u.name=y.name,u.pp_setScaleLocal(y.pp_getScaleLocal(i)),u.pp_setTransformLocalQuat(y.pp_getTransformLocalQuat(e)),n.myIgnoreComponents||o.push([y,u]),!n.myIgnoreChildren)for(let p of y.children){let d=!1;n.myChildrenToInclude.length>0?d=n.myChildrenToInclude.find(_=>_.pp_equals(p))!=null:d=n.myChildrenToIgnore.find(_=>_.pp_equals(p))==null,d&&n.myIgnoreChildCallback!=null&&(d=!n.myIgnoreChildCallback(p)),d&&s.push([u,p])}a==null&&(a=u)}let l=[];for(;o.length>0;){let c=o.shift(),r=c[0],y=c[1],u=r.pp_getComponentsSelf();for(let p of u)if(p.pp_clone!=null){let d=!1;n.myComponentsToInclude.length>0?d=n.myComponentsToInclude.indexOf(p.type)!=-1:d=n.myComponentsToIgnore.indexOf(p.type)==-1,d&&n.myIgnoreComponentCallback!=null&&(d=!n.myIgnoreComponentCallback(p)),d&&l.push([p,y])}}let m=[];for(;l.length>0;){let c=l.shift(),r=c[0],y=c[1],u=r.pp_clone(y,n.myDeepCloneParams,n.myCustomParamsMap);r.pp_clonePostProcess!=null&&m.push([r,u])}for(;l.length>0;){let c=l.shift(),r=c[0],y=c[1];r.pp_clonePostProcess(y,n.myDeepCloneParams,n.myCustomParamsMap)}}return a}}(),WL.Object.prototype.pp_isCloneable=function(e=new PP.CloneParams){if(e.myIgnoreNonCloneable||e.myIgnoreComponents)return!0;let t=!0,n=[];for(n.push(this);t&&n.length>0;){let a=n.shift(),s=this.pp_getComponentsSelf();for(let o of s){let l=!1;if(e.myComponentsToInclude.length>0?l=e.myComponentsToInclude.indexOf(o.type)!=-1:l=e.myComponentsToIgnore.indexOf(o.type)==-1,l&&e.myIgnoreComponentCallback!=null&&(l=!e.myIgnoreComponentCallback(o)),l&&o.pp_clone==null){t=!1;break}}if(t&&!e.myIgnoreChildren)for(let o of a.children){let l=!1;e.myChildrenToInclude.length>0?l=e.myChildrenToInclude.find(m=>m.pp_equals(o))!=null:l=e.myChildrenToIgnore.find(m=>m.pp_equals(o))==null,l&&e.myIgnoreChildCallback!=null&&(l=!e.myIgnoreChildCallback(o)),l&&n.push(o)}}return t},WL.Object.prototype.pp_toString=function(){return this.pp_toStringCompact()},WL.Object.prototype.pp_toStringExtended=function(){let i="    ",e=`
`,t="{",n="}",a="name: ",s="id: ",o="components: ",l="type: ",m="children: ",c="[",r="]",y=c,u=r,p=",",d=e.concat(i,i);return function(){let h="";h=h.concat(t,e);let P=this.pp_getComponentsSelf(),T=this.pp_getChildren(),v=this.pp_getName();if(P.length>0||T.length>0||v.length>0?h=h.concat(i,s,this.pp_getID(),p,e):h=h.concat(i,s,this.pp_getID(),e),v.length>0&&(P.length>0||T.length>0?h=h.concat(i,a,this.pp_getName(),p,e):h=h.concat(i,a,this.pp_getName(),e)),P.length>0){h=h.concat(i,o,e,i,c,e);for(let f=0;f<P.length;f++){let g=P[f];h=h.concat(i,i,t,e),h=h.concat(i,i,i,l,g.type,p,e),h=h.concat(i,i,i,s,g._id,p,e),h=h.concat(i,i,n),f!=P.length-1?h=h.concat(p,e):h=h.concat(e)}T.length>0?h=h.concat(i,r,p,e):h=h.concat(i,r,e)}if(T.length>0){h=h.concat(i,m,e,i,y,e);for(let f=0;f<T.length;f++){let C=T[f].pp_toStringExtended();C=C.replaceAll(e,d),C=i.concat(i,C),h=h.concat(C),f!=T.length-1?h=h.concat(p,e):h=h.concat(e)}h=h.concat(i,u,e)}return h=h.concat(n),h}}(),WL.Object.prototype.pp_toStringCompact=function(){let i="    ",e=`
`,t="<none>",n="name: ",a="components: ",s=", ",o=e.concat(i);return function(){let m="",c=this.pp_getName();c.length>0?m=m.concat(n,c):m=m.concat(n,t);let r=this.pp_getComponentsSelf();if(r.length>0){m=m.concat(s,a);for(let u=0;u<r.length;u++){let p=r[u];m=m.concat(p.type),u!=r.length-1&&(m=m.concat(s))}}let y=this.pp_getChildren();if(y.length>0){m=m.concat(e);for(let u=0;u<y.length;u++){let d=y[u].pp_toStringCompact();d=d.replaceAll(e,o),d=i.concat(d),m=m.concat(d),u!=y.length-1&&(m=m.concat(e))}}return m}}(),WL.Object.prototype.pp_getObjectByName=function(e){return this.pp_getObjectByNameHierarchy(e)},WL.Object.prototype.pp_getObjectByNameHierarchy=function(e){return this.pp_getObjectByNameHierarchyBreadth(e)},WL.Object.prototype.pp_getObjectByNameHierarchyBreadth=function(e){let t=this.pp_getHierarchyBreadth();return WL.Object.pp_getObjectByNameObjects(t,e)},WL.Object.prototype.pp_getObjectByNameHierarchyDepth=function(e){let t=this.pp_getHierarchyDepth();return WL.Object.pp_getObjectByNameObjects(t,e)},WL.Object.prototype.pp_getObjectByNameDescendants=function(e){return this.pp_getObjectByNameDescendantsBreadth(e)},WL.Object.prototype.pp_getObjectByNameDescendantsBreadth=function(e){let t=this.pp_getDescendantsBreadth();return WL.Object.pp_getObjectByNameObjects(t,e)},WL.Object.prototype.pp_getObjectByNameDescendantsDepth=function(e){let t=this.pp_getDescendantsDepth();return WL.Object.pp_getObjectByNameObjects(t,e)},WL.Object.prototype.pp_getObjectByNameChildren=function(e){let t=this.pp_getChildren();return WL.Object.pp_getObjectByNameObjects(t,e)},WL.Object.prototype.pp_getObjectsByName=function(e){return this.pp_getObjectsByNameHierarchy(e)},WL.Object.prototype.pp_getObjectsByNameHierarchy=function(e){return this.pp_getObjectsByNameHierarchyBreadth(e)},WL.Object.prototype.pp_getObjectsByNameHierarchyBreadth=function(e){let t=this.pp_getHierarchyBreadth();return WL.Object.pp_getObjectsByNameObjects(t,e)},WL.Object.prototype.pp_getObjectsByNameHierarchyDepth=function(e){let t=this.pp_getHierarchyDepth();return WL.Object.pp_getObjectsByNameObjects(t,e)},WL.Object.prototype.pp_getObjectsByNameDescendants=function(e){return this.pp_getObjectsByNameDescendantsBreadth(e)},WL.Object.prototype.pp_getObjectsByNameDescendantsBreadth=function(e){let t=this.pp_getDescendantsBreadth();return WL.Object.pp_getObjectsByNameObjects(t,e)},WL.Object.prototype.pp_getObjectsByNameDescendantsDepth=function(e){let t=this.pp_getDescendantsDepth();return WL.Object.pp_getObjectsByNameObjects(t,e)},WL.Object.prototype.pp_getObjectsByNameChildren=function(e){let t=this.pp_getChildren();return WL.Object.pp_getObjectsByNameObjects(t,e)},WL.Object.prototype.pp_getHierarchy=function(){return this.pp_getHierarchyBreadth()},WL.Object.prototype.pp_getHierarchyBreadth=function(){let e=this.pp_getDescendantsBreadth();return e.unshift(this),e},WL.Object.prototype.pp_getHierarchyDepth=function(){let e=this.pp_getDescendantsDepth();return e.unshift(this),e},WL.Object.prototype.pp_getDescendants=function(){return this.pp_getDescendantsBreadth()},WL.Object.prototype.pp_getDescendantsBreadth=function(){let e=[],t=this.children;for(;t.length>0;){let n=t.shift();e.push(n);for(let a of n.children)t.push(a)}return e},WL.Object.prototype.pp_getDescendantsDepth=function(){let e=[],t=this.pp_getChildren();for(let n of t){e.push(n);let a=n.pp_getDescendantsDepth();a.length>0&&e.push(...a)}return e},WL.Object.prototype.pp_getChildren=function(){return this.children},WL.Object.prototype.pp_getSelf=function(){return this},WL.Object.prototype.pp_addObject=function(){return WL.scene.addObject(this)},WL.Object.prototype.pp_getName=function(){return this.name},WL.Object.prototype.pp_setName=function(e){this.name=e},WL.Object.prototype.pp_getID=function(){return this.objectId},WL.Object.prototype.pp_markDirty=function(){return this.setDirty()},WL.Object.prototype.pp_equals=function(e){return this.equals(e)},WL.Object.prototype.pp_destroy=function(){return this.destroy()},WL.Object.prototype.pp_reserveObjects=function(e){this.pp_reserveObjectsHierarchy(e)},WL.Object.prototype.pp_reserveObjectsSelf=function(e){let t=this.pp_getComponentsAmountMapSelf();this._pp_reserveObjects(e,t)},WL.Object.prototype.pp_reserveObjectsHierarchy=function(e){let t=this.pp_getComponentsAmountMapHierarchy();this._pp_reserveObjects(e,t)},WL.Object.prototype.pp_reserveObjectsDescendants=function(e){let t=this.pp_getComponentsAmountMapDescendants();this._pp_reserveObjects(e,t)},WL.Object.prototype.pp_reserveObjectsChildren=function(e){let t=this.pp_getComponentsAmountMapChildren();this._pp_reserveObjects(e,t)},WL.Object.prototype.pp_getComponentsAmountMap=function(e=new Map){return this.pp_getComponentsAmountMapHierarchy(e)},WL.Object.prototype.pp_getComponentsAmountMapSelf=function(e=new Map){let t=e.get("object");t==null&&(t=0),t+=1,e.set("object",t);let n=this.pp_getComponentsSelf();for(let a of n){let s=a.type,o=e.get(s);o==null&&(o=0),o+=1,e.set(s,o)}return e},WL.Object.prototype.pp_getComponentsAmountMapHierarchy=function(e=new Map){let t=this.pp_getHierarchy();for(let n of t)n.pp_getComponentsAmountMapSelf(e);return e},WL.Object.prototype.pp_getComponentsAmountMapDescendants=function(e=new Map){let t=this.pp_getDescendants();for(let n of t)n.pp_getComponentsAmountMapSelf(e);return e},WL.Object.prototype.pp_getComponentsAmountMapChildren=function(e=new Map){let t=this.pp_getChildren();for(let n of t)n.pp_getComponentsAmountMapSelf(e);return e},WL.Object.pp_getComponentObjects=function(e,t,n=0){let a=null;for(let s of e)if(a=s.getComponent(t,n),a!=null)break;return a},WL.Object.pp_getComponentsObjects=function(e,t){let n=[];for(let a of e)n.push(...a.getComponents(t));return n},WL.Object.pp_setActiveObjects=function(e,t){for(let n of e)n.active=t},WL.Object.pp_getObjectByNameObjects=function(e,t){let n=null;for(let a of e)if(a.pp_getName()==t){n=a;break}return n},WL.Object.pp_getObjectsByNameObjects=function(e,t){let n=[];for(let a of e)a.pp_getName()==t&&n.push(a);return n},WL.Object.prototype._pp_epsilon=1e-6,WL.Object.prototype._pp_quaternionToRadians=function(){let i=PP.mat3_create();return function(t,n=PP.vec3_create()){return t.quat_toMatrix(i),n[1]=Math.asin(-this._pp_clamp(i[2],-1,1)),Math.abs(i[2])<.9999999?(n[0]=Math.atan2(i[5],i[8]),n[2]=Math.atan2(i[1],i[0])):(n[0]=0,n[2]=Math.atan2(-i[3],i[4])),n}}(),WL.Object.prototype._pp_degreesToQuaternion=function(e,t=PP.quat_create()){return t.quat_fromDegrees(e),t},WL.Object.prototype._pp_toDegrees=function(e){return e*(180/Math.PI)},WL.Object.prototype._pp_clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},WL.Object.prototype._pp_reserveObjects=function(e,t){let n=t.get("object")*e;t.delete("object");let a={};for(let[s,o]of t.entries())a[s]=o*e;WL.scene.reserveObjects(n,a)},WL.Object.prototype._pp_setAxes=function(){let i=[PP.vec3_create(),PP.vec3_create(),PP.vec3_create()],e=[[1,-1,1],[1,1,-1],[-1,1,-1]],t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.mat3_create(),m=PP.quat_create();return function(r,y,u){let p=r[y[0]],d=r[y[1]],_=r[y[2]];if(p==null||p.vec3_length()<=this._pp_epsilon)return;let h=!1;d!=null&&p.vec3_angleRadians(d)>this._pp_epsilon&&(h=!0);let P=!1;if(_!=null&&p.vec3_angleRadians(_)>this._pp_epsilon&&(P=!0),h||P){let T=null,v=null,f=null;h?(T=d,v=1,f=2):(T=_,v=2,f=1);let g=e[y[0]];p.vec3_cross(T,i[f]),i[f].vec3_scale(g[y[f]],i[f]),p.vec3_cross(i[f],i[v]),i[v].vec3_scale(g[y[v]],i[v]),i[1].vec3_cross(i[2],i[0]),i[0].vec3_scale(g[y[0]],i[0]),i[y.pp_findIndexEqual(0)].vec3_normalize(t),i[y.pp_findIndexEqual(1)].vec3_normalize(n),i[y.pp_findIndexEqual(2)].vec3_normalize(a),l.mat3_set(t[0],t[1],t[2],n[0],n[1],n[2],a[0],a[1],a[2]),l.mat3_toQuat(m),m.quat_normalize(m),u?this.pp_setRotationLocalQuat(m):this.pp_setRotationWorldQuat(m)}else{y[0]==0?u?this.pp_getLeftLocal(s):this.pp_getLeftWorld(s):y[0]==1?u?this.pp_getUpLocal(s):this.pp_getUpWorld(s):u?this.pp_getForwardLocal(s):this.pp_getForwardWorld(s);let T=p.vec3_angleRadians(s);T!=0&&(s.vec3_cross(p,o),o.vec3_normalize(o),m.quat_fromAxisRadians(T,o),u?this.pp_rotateLocalQuat(m):this.pp_rotateWorldQuat(m))}}}();for(let i in WL.Object.prototype){let e=["pp_","_pp_"],t=!1;for(let n of e)if(i.startsWith(n)){t=!0;break}t&&Object.defineProperty(WL.Object.prototype,i,{enumerable:!1})}}});var Oi=S(()=>{if(WL&&WL.Scene){WL.Scene.prototype.pp_getRoot=function(){return new WL.Object(0)},WL.Scene.prototype.pp_getObjects=function(){return this.pp_getObjectsBreadth()},WL.Scene.prototype.pp_getObjectsBreadth=function(){return this.pp_getRoot().pp_getHierarchyBreadth()},WL.Scene.prototype.pp_getObjectsDepth=function(){return this.pp_getRoot().pp_getHierarchyDepth()},WL.Scene.prototype.pp_getComponent=function(e,t=0){return this.pp_getComponentBreadth(e,t)},WL.Scene.prototype.pp_getComponentBreadth=function(e,t=0){return this.pp_getRoot().pp_getComponentHierarchyBreadth(e,t)},WL.Scene.prototype.pp_getComponentDepth=function(e,t=0){return this.pp_getRoot().pp_getComponentHierarchyDepth(e,t)},WL.Scene.prototype.pp_getComponents=function(e){return this.pp_getComponentsBreadth(e)},WL.Scene.prototype.pp_getComponentsBreadth=function(e){return this.pp_getRoot().pp_getComponentsHierarchyBreadth(e)},WL.Scene.prototype.pp_getComponentsDepth=function(e){return this.pp_getRoot().pp_getComponentsHierarchyDepth(e)},WL.Scene.prototype.pp_getObjectByName=function(e){return this.pp_getObjectByNameBreadth(e)},WL.Scene.prototype.pp_getObjectByNameBreadth=function(e){return this.pp_getRoot().pp_getObjectByNameHierarchyBreadth(e)},WL.Scene.prototype.pp_getObjectByNameDepth=function(e){return this.pp_getRoot().pp_getObjectByNameHierarchyDepth(e)},WL.Scene.prototype.pp_getObjectsByName=function(e){return this.pp_getObjectsByNameBreadth(e)},WL.Scene.prototype.pp_getObjectsByNameBreadth=function(e){return this.pp_getRoot().pp_getObjectsByNameHierarchyBreadth(e)},WL.Scene.prototype.pp_getObjectsByNameDepth=function(e){return this.pp_getRoot().pp_getObjectsByNameHierarchyDepth(e)},WL.Scene.prototype.pp_toString=function(){return this.pp_toStringCompact()},WL.Scene.prototype.pp_toStringCompact=function(){return this.pp_getRoot().pp_toStringCompact()},WL.Scene.prototype.pp_toStringExtended=function(){return this.pp_getRoot().pp_toStringExtended()},WL.Scene.prototype.pp_getComponentsAmountMap=function(e=new Map){return this.pp_getRoot().pp_getComponentsAmountMapHierarchy(e)};for(let i in WL.Scene.prototype){let e=["pp_","_pp_"],t=!1;for(let n of e)if(i.startsWith(n)){t=!0;break}t&&Object.defineProperty(WL.Scene.prototype,i,{enumerable:!1})}}});var Hi=S(()=>{WL&&WL.Object&&(WL.MeshComponent.prototype.pp_clone=function(e,t=new PP.DeepCloneParams,n=null){let a=e.pp_addComponent(this.type);return a.active=this.active,t.isDeepCloneComponentVariable("mesh","material")?a.material=this.material.clone():a.material=this.material,t.isDeepCloneComponentVariable("mesh","mesh")?a.mesh=PP.MeshUtils.cloneMesh(this.mesh):a.mesh=this.mesh,a.skin=this.skin,a},WL.CollisionComponent.prototype.pp_clone=function(e,t=new PP.DeepCloneParams,n=null){let a=e.pp_addComponent(this.type);return a.active=this.active,a.collider=this.collider,a.extents=this.extents.slice(0),a.group=this.group,a},WL.TextComponent.prototype.pp_clone=function(e,t=new PP.DeepCloneParams,n=null){let a=e.pp_addComponent(this.type);return a.active=this.active,t.isDeepCloneComponent("text")?a.text=this.text.slice(0):a.text=this.text,t.isDeepCloneComponentVariable("text","material")?a.material=this.material.clone():a.material=this.material,a.alignment=this.alignment,a.justification=this.justification,a},WL.PhysXComponent.prototype.pp_clone=function(e,t=new PP.DeepCloneParams,n=null){let a={static:this.static,simulate:this.simulate,angularDamping:this.angularDamping,dynamicFriction:this.dynamicFriction,extents:this.extents,kinematic:this.kinematic,linearDamping:this.linearDamping,mass:this.mass,restituition:this.restituition,shape:this.shape,shapeData:this.shapeData,staticFriction:this.staticFriction,bounciness:this.bounciness,allowQuery:this.allowQuery,allowSimulation:this.allowSimulation,gravity:this.gravity,trigger:this.trigger};this.static||(a.angularVelocity=this.angularVelocity,a.linearVelocity=this.linearVelocity);let s=e.pp_addComponent(this.type,a);return s.active=this.active,s},Object.defineProperty(WL.MeshComponent.prototype,"pp_clone",{enumerable:!1}),Object.defineProperty(WL.CollisionComponent.prototype,"pp_clone",{enumerable:!1}),Object.defineProperty(WL.TextComponent.prototype,"pp_clone",{enumerable:!1}),Object.defineProperty(WL.PhysXComponent.prototype,"pp_clone",{enumerable:!1}))});var oc={};var Ei=U(()=>{Mt();_WL&&_WL._componentTypes&&_WL._componentTypes[_WL._componentTypeIndices.cursor]?(_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.init=function(){this.session=null,this.collisionMask=1<<this.collisionGroup,this.maxDistance=100,this.doubleClickTimer=0,this.tripleClickTimer=0,this.multipleClickObject=null,this.multipleClickDelay=.3,this.visible=!1;let e=this.onDestroy.bind(this);WL.onSceneLoaded.push(e),this.onDestroyCallbacks=[()=>{let t=WL.onSceneLoaded.indexOf(e);t>=0&&WL.onSceneLoaded.splice(t,1)}],this.prevHitLocationLocalToTarget=PP.vec3_create(),this.pointerId=null,this.lastClientX=null,this.lastClientY=null,this.lastWidth=null,this.lastHeight=null},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.start=function(){if(this.handedness==0){let t=this.object.getComponent("input");t?(this.handedness=t.handedness,this.input=t):console.warn("cursor component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];this.globalTarget=this.object.addComponent("cursor-target"),this.transformQuat=PP.quat2_create(),this.rotationQuat=PP.quat_create(),this.transformMatrix=PP.mat4_create(),this.origin=new Float32Array(3),this.cursorObjScale=new Float32Array(3),this.direction=PP.vec3_create(),this.tempQuat=new Float32Array(4),this.setViewComponent(this.object.getComponent("view")),this.isHovering=!1,this.visible=!0,this.isDown=!1,this.lastIsDown=!1,this.isUpWithNoDown=!1,this.isRealDown=!1,this.cursorPos=new Float32Array(3),this.hoveringObject=null;let e=this.setupVREvents.bind(this);WL.onXRSessionStart.push(e),this.onDestroyCallbacks.push(()=>{let t=WL.onXRSessionStart.indexOf(e);t>=0&&WL.onXRSessionStart.splice(t,1)}),this.showRay=!0,this.cursorRayObject&&(this.cursorRayObject.pp_setActive(!0),this.showRay=!1,this.cursorRayOrigin=new Float32Array(3),this.cursorRayScale=new Float32Array(3),this.cursorRayScale.set(this.cursorRayObject.scalingLocal),this._setCursorRayTransform(null)),this._setCursorVisibility(!1)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.setViewComponent=function(e){if(this.viewComponent=e,this.viewComponent!=null){let t=this.onClick.bind(this);WL.canvas.addEventListener("click",t);let n=this.onPointerDown.bind(this);WL.canvas.addEventListener("pointerdown",n);let a=this.onPointerMove.bind(this);WL.canvas.addEventListener("pointermove",a);let s=this.onPointerUp.bind(this);WL.canvas.addEventListener("pointerup",s);let o=this.onPointerLeave.bind(this);WL.canvas.addEventListener("pointerleave",o),this.projectionMatrix=new Float32Array(16),k.invert(this.projectionMatrix,this.viewComponent.projectionMatrix);let l=this.onViewportResize.bind(this);window.addEventListener("resize",l),this.onDestroyCallbacks.push(()=>{WL.canvas.removeEventListener("click",t),WL.canvas.removeEventListener("pointerdown",n),WL.canvas.removeEventListener("pointermove",a),WL.canvas.removeEventListener("pointerup",s),WL.canvas.removeEventListener("pointerleave",o),window.removeEventListener("resize",l)})}},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onViewportResize=function(){!this.viewComponent||k.invert(this.projectionMatrix,this.viewComponent.projectionMatrix)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype._setCursorRayTransform=function(e){if(!!this.cursorRayObject&&this.cursorRayScalingAxis!=4&&(this.cursorRayObject.resetScaling(),e!=null)){this.cursorRayObject.getTranslationWorld(this.cursorRayOrigin);let t=x.dist(this.cursorRayOrigin,e);this.cursorRayScale[this.cursorRayScalingAxis]=t,this.cursorRayObject.scale(this.cursorRayScale)}},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype._setCursorVisibility=function(e){this.visible=e,this.cursorObject&&this.cursorObject.pp_setActive(e)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.update=function(e){this.doubleClickTimer>0&&(this.doubleClickTimer-=e),this.tripleClickTimer>0&&(this.tripleClickTimer-=e),this.doUpdate(!1)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.doUpdate=function(e){if(this.session){if(this.arTouchDown&&this.input&&WL.xrSession.inputSources[0].handedness==="none"&&WL.xrSession.inputSources[0].gamepad){let n=WL.xrSession.inputSources[0].gamepad.axes;this.direction.vec3_set(n[0],-n[1],-1),this.updateDirection()}else this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction);let t=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(this.origin,this.direction,this.collisionMask):WL.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);t.hitCount>0?this.cursorPos.set(t.locations[0]):this.cursorPos.fill(0),this.hoverBehaviour(t,e)}else if(this.viewComponent!=null&&this.lastClientX!=null){let t=this.updateMousePos(this.lastClientX,this.lastClientY,this.lastWidth,this.lastHeight);this.hoverBehaviour(t,!1)}this.cursorObject&&(this.hoveringObject&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this._setCursorVisibility(!0),this.cursorObject.setTranslationWorld(this.cursorPos),this.cursorObject.transformLocal=this.cursorObject.transformLocal.quat2_normalize(this.transformQuat),this._setCursorRayTransform(this.cursorPos)):(this.visible&&this.cursorRayObject&&this._setCursorRayTransform(null),this._setCursorVisibility(!1))),this.cursorRayObject&&this.cursorRayObject.pp_setActive(!0),this.hoveringObject==null&&(this.pointerId=null)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.hoverBehaviour=function(e,t,n=!1){if(!n&&e.hitCount>0){let a=!1;if(!this.hoveringObject||!this.hoveringObject.equals(e.objects[0])){if(this.hoveringObject){let l=this.hoveringObject.getComponent("cursor-target");l&&l.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this)}a=!0,this.hoveringObject=e.objects[0],this.styleCursor&&(document.body.style.cursor="pointer");let o=this.hoveringObject.getComponent("cursor-target");o&&o.onHover(this.hoveringObject,this),this.globalTarget.onHover(this.hoveringObject,this),!this._isDown()&&this.isRealDown&&(this.isDown=!1,this.lastIsDown=!1,this.isUpWithNoDown=!1,o&&o.onDownOnHover(this.hoveringObject,this),this.globalTarget.onDownOnHover(this.hoveringObject,this))}let s=this.hoveringObject.getComponent("cursor-target");!a&&this._isMoving(e.locations[0])&&(s&&s.onMove(this.hoveringObject,this),this.globalTarget.onMove(this.hoveringObject,this)),this._isDown()?(s&&s.onDown(this.hoveringObject,this),this.globalTarget.onDown(this.hoveringObject,this),this.tripleClickTimer>0&&this.multipleClickObject&&this.multipleClickObject.equals(this.hoveringObject)?(s&&s.onTripleClick(this.hoveringObject,this),this.globalTarget.onTripleClick(this.hoveringObject,this),this.tripleClickTimer=0):this.doubleClickTimer>0&&this.multipleClickObject&&this.multipleClickObject.equals(this.hoveringObject)?(s&&s.onDoubleClick(this.hoveringObject,this),this.globalTarget.onDoubleClick(this.hoveringObject,this),this.tripleClickTimer=this.multipleClickDelay,this.doubleClickTimer=0):(s&&s.onClick(this.hoveringObject,this),this.globalTarget.onClick(this.hoveringObject,this),this.tripleClickTimer=0,this.doubleClickTimer=this.multipleClickDelay,this.multipleClickObject=this.hoveringObject)):!this.isUpWithNoDown&&!a&&this._isUp()?(s&&s.onUp(this.hoveringObject,this),this.globalTarget.onUp(this.hoveringObject,this)):(this.isUpWithNoDown||a&&this._isUp())&&(s&&s.onUpWithNoDown(this.hoveringObject,this),this.globalTarget.onUpWithNoDown(this.hoveringObject,this)),this.prevHitLocationLocalToTarget=this.hoveringObject.pp_convertPositionWorldToLocal(e.locations[0],this.prevHitLocationLocalToTarget)}else if(this.hoveringObject&&(n||e.hitCount==0)){let a=this.hoveringObject.getComponent("cursor-target");a&&a.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this),this.hoveringObject=null,this.styleCursor&&(document.body.style.cursor="default")}this.hoveringObject?this.lastIsDown=this.isDown:(this.isDown=!1,this.lastIsDown=!1),this.isUpWithNoDown=!1},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.setupVREvents=function(e){this.session=e;let t=function(o){this.session=null}.bind(this);e.addEventListener("end",t);let n=this.onSelect.bind(this);e.addEventListener("select",n);let a=this.onSelectStart.bind(this);e.addEventListener("selectstart",a);let s=this.onSelectEnd.bind(this);e.addEventListener("selectend",s),this.onDestroyCallbacks.push(()=>{!this.session||(e.removeEventListener("end",t),e.removeEventListener("select",n),e.removeEventListener("selectstart",a),e.removeEventListener("selectend",s))}),this.onViewportResize()},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onSelect=function(e){},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onSelectStart=function(e){this.active&&(this.arTouchDown=!0,e.inputSource.handedness==this.handedness&&(this.isDown=!0)),e.inputSource.handedness==this.handedness&&(this.isRealDown=!0)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onSelectEnd=function(e){this.active&&(this.arTouchDown=!1,e.inputSource.handedness==this.handedness&&(this.isDown||(this.isUpWithNoDown=!0),this.isDown=!1)),e.inputSource.handedness==this.handedness&&(this.isRealDown=!1)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onPointerMove=function(e){if(this.active){if(this.pointerId!=null&&this.pointerId!=e.pointerId)return;let t=document.body.getBoundingClientRect(),n=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.hoverBehaviour(n,!1),this.hoveringObject!=null?this.pointerId=e.pointerId:this.pointerId=null}},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onClick=function(e){},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onPointerDown=function(e){if(!(this.pointerId!=null&&this.pointerId!=e.pointerId||e.button!==0))if(this.active){let t=document.body.getBoundingClientRect(),n=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.isDown=!0,this.isRealDown=!0,this.hoverBehaviour(n,!1),this.hoveringObject!=null?this.pointerId=e.pointerId:this.pointerId=null}else this.isRealDown=!0},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onPointerUp=function(e){if(!(this.pointerId!=null&&this.pointerId!=e.pointerId||e.button!==0))if(this.active){let t=document.body.getBoundingClientRect(),n=this.updateMousePos(e.clientX,e.clientY,t.width,t.height);this.isDown||(this.isUpWithNoDown=!0),this.isDown=!1,this.isRealDown=!1,this.hoverBehaviour(n,!1),this.hoveringObject!=null?this.pointerId=e.pointerId:this.pointerId=null}else this.isRealDown=!1},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onPointerLeave=function(e){(this.pointerId==null||this.pointerId==e.pointerId)&&(this.active&&this.hoverBehaviour(null,!1,!0),this.pointerId=null,this.lastClientX=null,this.lastClientY=null,this.lastWidth=null,this.lastHeight=null)},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.updateMousePos=function(e,t,n,a){this.lastClientX=e,this.lastClientY=t,this.lastWidth=n,this.lastHeight=a;let s=e/n,o=t/a;return this.direction.vec3_set(s*2-1,-o*2+1,-1),this.updateDirection()},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.updateDirection=function(){this.object.getTranslationWorld(this.origin),x.transformMat4(this.direction,this.direction,this.projectionMatrix),x.normalize(this.direction,this.direction),x.transformQuat(this.direction,this.direction,this.object.transformWorld);let e=this.rayHit=this.rayCastMode==0?WL.scene.rayCast(this.origin,this.direction,this.collisionMask):WL.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);return e.hitCount>0?this.cursorPos.set(e.locations[0]):this.cursorPos.fill(0),e},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onDeactivate=function(){if(this.hoveringObject){let e=this.hoveringObject.getComponent("cursor-target");e&&e.onUnhover(this.hoveringObject,this),this.globalTarget.onUnhover(this.hoveringObject,this)}this.hoveringObject=null,this.styleCursor&&(document.body.style.cursor="default"),this.isDown=!1,this.lastIsDown=!1,this.isUpWithNoDown=!1,this._setCursorVisibility(!1),this.cursorRayObject&&this.cursorRayObject.pp_setActive(!1),this.pointerId=null,this.lastClientX=null,this.lastClientY=null,this.lastWidth=null,this.lastHeight=null},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onActivate=function(){this.showRay=!0,this.isDown=!1,this.lastIsDown=!1,this.isUpWithNoDown=!1},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype.onDestroy=function(){for(let e of this.onDestroyCallbacks)e()},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype._isDown=function(){return this.isDown!==this.lastIsDown&&this.isDown},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype._isUp=function(){return this.isDown!==this.lastIsDown&&!this.isDown},_WL._componentTypes[_WL._componentTypeIndices.cursor].prototype._isMoving=function(){let i=PP.vec3_create();return function(t){let n=!1;return i=this.hoveringObject.pp_convertPositionWorldToLocal(t,i),i.vec_equals(this.prevHitLocationLocalToTarget,1e-4)||(n=!0),n}}()):console.error(`Wonderland Engine "cursor" component not found.
 Add the component to your project to avoid any issue with the PP bundle.`)});var ki=S(()=>{_WL&&_WL._componentTypes&&_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]]?(_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.init=function(){this.hoverFunctions=[],this.unHoverFunctions=[],this.clickFunctions=[],this.doubleClickFunctions=[],this.tripleClickFunctions=[],this.moveFunctions=[],this.downFunctions=[],this.upFunctions=[],this.downOnHoverFunctions=[],this.upWithNoDownFunctions=[],this.isSurface=!1},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onHover=function(e,t){for(let n of this.hoverFunctions)n(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onUnhover=function(e,t){for(let n of this.unHoverFunctions)n(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onClick=function(e,t){for(let n of this.clickFunctions)n(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onMove=function(e,t){for(let n of this.moveFunctions)n(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onDown=function(e,t){for(let n of this.downFunctions)n(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onUp=function(e,t){for(let n of this.upFunctions)n(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addHoverFunction=function(e){this._validateCallback(e),this.hoverFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeHoverFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.hoverFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addUnHoverFunction=function(e){this._validateCallback(e),this.unHoverFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeUnHoverFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.unHoverFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addClickFunction=function(e){this._validateCallback(e),this.clickFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeClickFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.clickFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addMoveFunction=function(e){this._validateCallback(e),this.moveFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeMoveFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.moveFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addDownFunction=function(e){this._validateCallback(e),this.downFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeDownFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.downFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addUpFunction=function(e){this._validateCallback(e),this.upFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeUpFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.upFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype._removeItemOnce=function(e,t){var n=e.indexOf(t);return n>-1&&e.splice(n,1),e},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype._validateCallback=function(e){if(typeof e!="function")throw new TypeError(this.object.name+".cursor-target: Argument needs to be a function")},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onDoubleClick=function(e,t){for(let n of this.doubleClickFunctions)n(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addDoubleClickFunction=function(e){this._validateCallback(e),this.doubleClickFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeDoubleClickFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.doubleClickFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onTripleClick=function(e,t){for(let n of this.tripleClickFunctions)n(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addTripleClickFunction=function(e){this._validateCallback(e),this.tripleClickFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeTripleClickFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.tripleClickFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onDownOnHover=function(e,t){for(let n of this.downOnHoverFunctions)n(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addDownOnHoverFunction=function(e){this._validateCallback(e),this.downOnHoverFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeDownOnHoverFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.downOnHoverFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onUpWithNoDown=function(e,t){for(let n of this.upWithNoDownFunctions)n(e,t)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.addUpWithNoDownFunction=function(e){this._validateCallback(e),this.upWithNoDownFunctions.push(e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.removeUpWithNoDownFunction=function(e){this._validateCallback(e),this._removeItemOnce(this.upWithNoDownFunctions,e)},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.start=function(){},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.update=function(e){},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onActivate=function(){},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onDeactivate=function(){},_WL._componentTypes[_WL._componentTypeIndices["cursor-target"]].prototype.onDestroy=function(){}):console.error(`Wonderland Engine "cursor-target" component not found.
 Add the component to your project to avoid any issue with the PP bundle.`)});var Fi=S(()=>{_WL&&_WL._componentTypes&&_WL._componentTypes[_WL._componentTypeIndices["mouse-look"]]?(_WL._componentTypes[_WL._componentTypeIndices["mouse-look"]].prototype.init=function(){this.pointerId=null,this.prevMoveEvent=null,this.resetMovingDelay=.15,this.resetMovingTimer=new PP.Timer(this.resetMovingDelay,!1),this.isMoving=!1,document.body.addEventListener("pointermove",this._onMove.bind(this)),this.requireMouseDown&&(this.mouseButtonIndex==2&&WL.canvas.addEventListener("contextmenu",function(e){e.preventDefault()},!1),WL.canvas.addEventListener("pointerdown",function(e){if(this.pointerId==null&&!this.mouseDown&&e.button==this.mouseButtonIndex&&(this.pointerId=e.pointerId,this.mouseDown=!0,document.body.style.cursor="grabbing",e.button==1))return e.preventDefault(),!1}.bind(this)),document.body.addEventListener("pointerup",function(e){e.pointerId==this.pointerId&&this.mouseDown&&e.button==this.mouseButtonIndex&&(this.mouseDown=!1,document.body.style.cursor="initial")}.bind(this))),document.body.addEventListener("pointerleave",function(e){e.pointerId==this.pointerId&&(this.pointerId=null,this.prevMoveEvent=null,this.mouseDown&&(this.mouseDown=!1,document.body.style.cursor="initial"))}.bind(this))},_WL._componentTypes[_WL._componentTypeIndices["mouse-look"]].prototype.update=function(e){this.resetMovingTimer.isRunning()&&(this.resetMovingTimer.update(e),this.resetMovingTimer.isDone()&&(this.resetMovingTimer.reset(),this.isMoving=!1)),this.isMoving||((!this.requireMouseDown||!this.mouseDown)&&(this.pointerId=null),this.prevMoveEvent=null)},_WL._componentTypes[_WL._componentTypeIndices["mouse-look"]].prototype._onMove=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create();return function(l){if(!(this.pointerId!=null&&l.pointerId!=this.pointerId)&&this.active&&(this.mouseDown||!this.requireMouseDown)){i=this.object.pp_getBackward(i),e=this.object.pp_getUp(e),t.vec3_set(0,1,0),this.object.pp_getParent()!=null&&(t=this.object.pp_getParent().pp_getUp(t)),a=i.vec3_cross(t,a);let m=1;i.vec3_angle(t)<m?a=e.vec3_negate(a).vec3_cross(t,a):i.vec3_angle(t.vec3_negate(n))<m?a=e.vec3_cross(t,a):e.vec3_isConcordant(t)||a.vec3_negate(a),a.vec3_normalize(a);let c=l.movementX,r=l.movementY;(c==null||r==null)&&(this.prevMoveEvent!=null?(c=l.pageX-this.prevMoveEvent.pageX,r=l.pageY-this.prevMoveEvent.pageY):(c=0,r=0)),this.rotationX=-this.sensitity*c,this.rotationY=-this.sensitity*r,this.object.pp_rotateAxis(this.rotationY,a);let y=90-.001;s=this.object.pp_getUp(s);let u=Math.pp_angleClamp(s.vec3_angleSigned(t,a));if(Math.abs(u)>y){let p=(Math.abs(u)-y)*Math.pp_sign(u);this.object.pp_rotateAxis(p,a)}this.object.pp_rotateAxis(this.rotationX,t),this.prevMoveEvent=l,this.pointerId=l.pointerId,this.resetMovingTimer.start(this.resetMovingDelay),this.isMoving=!0}}}()):console.error(`Wonderland Engine "mouse-look" component not found.
 Add the component to your project to avoid any issue with the PP bundle.`)});var Ae=S(ze=>{(function(){"use strict";var i=function(){this.init()};i.prototype={init:function(){var r=this||e;return r._counter=1e3,r._html5AudioPool=[],r.html5PoolSize=10,r._codecs={},r._howls=[],r._muted=!1,r._volume=1,r._canPlayEvent="canplaythrough",r._navigator=typeof window<"u"&&window.navigator?window.navigator:null,r.masterGain=null,r.noAudio=!1,r.usingWebAudio=!0,r.autoSuspend=!0,r.ctx=null,r.autoUnlock=!0,r._setup(),r},volume:function(r){var y=this||e;if(r=parseFloat(r),y.ctx||c(),typeof r<"u"&&r>=0&&r<=1){if(y._volume=r,y._muted)return y;y.usingWebAudio&&y.masterGain.gain.setValueAtTime(r,e.ctx.currentTime);for(var u=0;u<y._howls.length;u++)if(!y._howls[u]._webAudio)for(var p=y._howls[u]._getSoundIds(),d=0;d<p.length;d++){var _=y._howls[u]._soundById(p[d]);_&&_._node&&(_._node.volume=_._volume*r)}return y}return y._volume},mute:function(r){var y=this||e;y.ctx||c(),y._muted=r,y.usingWebAudio&&y.masterGain.gain.setValueAtTime(r?0:y._volume,e.ctx.currentTime);for(var u=0;u<y._howls.length;u++)if(!y._howls[u]._webAudio)for(var p=y._howls[u]._getSoundIds(),d=0;d<p.length;d++){var _=y._howls[u]._soundById(p[d]);_&&_._node&&(_._node.muted=r?!0:_._muted)}return y},stop:function(){for(var r=this||e,y=0;y<r._howls.length;y++)r._howls[y].stop();return r},unload:function(){for(var r=this||e,y=r._howls.length-1;y>=0;y--)r._howls[y].unload();return r.usingWebAudio&&r.ctx&&typeof r.ctx.close<"u"&&(r.ctx.close(),r.ctx=null,c()),r},codecs:function(r){return(this||e)._codecs[r.replace(/^x-/,"")]},_setup:function(){var r=this||e;if(r.state=r.ctx&&r.ctx.state||"suspended",r._autoSuspend(),!r.usingWebAudio)if(typeof Audio<"u")try{var y=new Audio;typeof y.oncanplaythrough>"u"&&(r._canPlayEvent="canplay")}catch{r.noAudio=!0}else r.noAudio=!0;try{var y=new Audio;y.muted&&(r.noAudio=!0)}catch{}return r.noAudio||r._setupCodecs(),r},_setupCodecs:function(){var r=this||e,y=null;try{y=typeof Audio<"u"?new Audio:null}catch{return r}if(!y||typeof y.canPlayType!="function")return r;var u=y.canPlayType("audio/mpeg;").replace(/^no$/,""),p=r._navigator?r._navigator.userAgent:"",d=p.match(/OPR\/([0-6].)/g),_=d&&parseInt(d[0].split("/")[1],10)<33,h=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,P=p.match(/Version\/(.*?) /),T=h&&P&&parseInt(P[1],10)<15;return r._codecs={mp3:!!(!_&&(u||y.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!u,opus:!!y.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!y.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!y.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(y.canPlayType('audio/wav; codecs="1"')||y.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!y.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!y.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(y.canPlayType("audio/x-m4a;")||y.canPlayType("audio/m4a;")||y.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(y.canPlayType("audio/x-m4b;")||y.canPlayType("audio/m4b;")||y.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(y.canPlayType("audio/x-mp4;")||y.canPlayType("audio/mp4;")||y.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!T&&y.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!T&&y.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!y.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(y.canPlayType("audio/x-flac;")||y.canPlayType("audio/flac;")).replace(/^no$/,"")},r},_unlockAudio:function(){var r=this||e;if(!(r._audioUnlocked||!r.ctx)){r._audioUnlocked=!1,r.autoUnlock=!1,!r._mobileUnloaded&&r.ctx.sampleRate!==44100&&(r._mobileUnloaded=!0,r.unload()),r._scratchBuffer=r.ctx.createBuffer(1,1,22050);var y=function(u){for(;r._html5AudioPool.length<r.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,r._releaseHtml5Audio(p)}catch{r.noAudio=!0;break}for(var d=0;d<r._howls.length;d++)if(!r._howls[d]._webAudio)for(var _=r._howls[d]._getSoundIds(),h=0;h<_.length;h++){var P=r._howls[d]._soundById(_[h]);P&&P._node&&!P._node._unlocked&&(P._node._unlocked=!0,P._node.load())}r._autoResume();var T=r.ctx.createBufferSource();T.buffer=r._scratchBuffer,T.connect(r.ctx.destination),typeof T.start>"u"?T.noteOn(0):T.start(0),typeof r.ctx.resume=="function"&&r.ctx.resume(),T.onended=function(){T.disconnect(0),r._audioUnlocked=!0,document.removeEventListener("touchstart",y,!0),document.removeEventListener("touchend",y,!0),document.removeEventListener("click",y,!0),document.removeEventListener("keydown",y,!0);for(var v=0;v<r._howls.length;v++)r._howls[v]._emit("unlock")}};return document.addEventListener("touchstart",y,!0),document.addEventListener("touchend",y,!0),document.addEventListener("click",y,!0),document.addEventListener("keydown",y,!0),r}},_obtainHtml5Audio:function(){var r=this||e;if(r._html5AudioPool.length)return r._html5AudioPool.pop();var y=new Audio().play();return y&&typeof Promise<"u"&&(y instanceof Promise||typeof y.then=="function")&&y.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(r){var y=this||e;return r._unlocked&&y._html5AudioPool.push(r),y},_autoSuspend:function(){var r=this;if(!(!r.autoSuspend||!r.ctx||typeof r.ctx.suspend>"u"||!e.usingWebAudio)){for(var y=0;y<r._howls.length;y++)if(r._howls[y]._webAudio){for(var u=0;u<r._howls[y]._sounds.length;u++)if(!r._howls[y]._sounds[u]._paused)return r}return r._suspendTimer&&clearTimeout(r._suspendTimer),r._suspendTimer=setTimeout(function(){if(!!r.autoSuspend){r._suspendTimer=null,r.state="suspending";var p=function(){r.state="suspended",r._resumeAfterSuspend&&(delete r._resumeAfterSuspend,r._autoResume())};r.ctx.suspend().then(p,p)}},3e4),r}},_autoResume:function(){var r=this;if(!(!r.ctx||typeof r.ctx.resume>"u"||!e.usingWebAudio))return r.state==="running"&&r.ctx.state!=="interrupted"&&r._suspendTimer?(clearTimeout(r._suspendTimer),r._suspendTimer=null):r.state==="suspended"||r.state==="running"&&r.ctx.state==="interrupted"?(r.ctx.resume().then(function(){r.state="running";for(var y=0;y<r._howls.length;y++)r._howls[y]._emit("resume")}),r._suspendTimer&&(clearTimeout(r._suspendTimer),r._suspendTimer=null)):r.state==="suspending"&&(r._resumeAfterSuspend=!0),r}};var e=new i,t=function(r){var y=this;if(!r.src||r.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}y.init(r)};t.prototype={init:function(r){var y=this;return e.ctx||c(),y._autoplay=r.autoplay||!1,y._format=typeof r.format!="string"?r.format:[r.format],y._html5=r.html5||!1,y._muted=r.mute||!1,y._loop=r.loop||!1,y._pool=r.pool||5,y._preload=typeof r.preload=="boolean"||r.preload==="metadata"?r.preload:!0,y._rate=r.rate||1,y._sprite=r.sprite||{},y._src=typeof r.src!="string"?r.src:[r.src],y._volume=r.volume!==void 0?r.volume:1,y._xhr={method:r.xhr&&r.xhr.method?r.xhr.method:"GET",headers:r.xhr&&r.xhr.headers?r.xhr.headers:null,withCredentials:r.xhr&&r.xhr.withCredentials?r.xhr.withCredentials:!1},y._duration=0,y._state="unloaded",y._sounds=[],y._endTimers={},y._queue=[],y._playLock=!1,y._onend=r.onend?[{fn:r.onend}]:[],y._onfade=r.onfade?[{fn:r.onfade}]:[],y._onload=r.onload?[{fn:r.onload}]:[],y._onloaderror=r.onloaderror?[{fn:r.onloaderror}]:[],y._onplayerror=r.onplayerror?[{fn:r.onplayerror}]:[],y._onpause=r.onpause?[{fn:r.onpause}]:[],y._onplay=r.onplay?[{fn:r.onplay}]:[],y._onstop=r.onstop?[{fn:r.onstop}]:[],y._onmute=r.onmute?[{fn:r.onmute}]:[],y._onvolume=r.onvolume?[{fn:r.onvolume}]:[],y._onrate=r.onrate?[{fn:r.onrate}]:[],y._onseek=r.onseek?[{fn:r.onseek}]:[],y._onunlock=r.onunlock?[{fn:r.onunlock}]:[],y._onresume=[],y._webAudio=e.usingWebAudio&&!y._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(y),y._autoplay&&y._queue.push({event:"play",action:function(){y.play()}}),y._preload&&y._preload!=="none"&&y.load(),y},load:function(){var r=this,y=null;if(e.noAudio){r._emit("loaderror",null,"No audio support.");return}typeof r._src=="string"&&(r._src=[r._src]);for(var u=0;u<r._src.length;u++){var p,d;if(r._format&&r._format[u])p=r._format[u];else{if(d=r._src[u],typeof d!="string"){r._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(d),p||(p=/\.([^.]+)$/.exec(d.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&e.codecs(p)){y=r._src[u];break}}if(!y){r._emit("loaderror",null,"No codec support for selected audio sources.");return}return r._src=y,r._state="loading",window.location.protocol==="https:"&&y.slice(0,5)==="http:"&&(r._html5=!0,r._webAudio=!1),new n(r),r._webAudio&&s(r),r},play:function(r,y){var u=this,p=null;if(typeof r=="number")p=r,r=null;else{if(typeof r=="string"&&u._state==="loaded"&&!u._sprite[r])return null;if(typeof r>"u"&&(r="__default",!u._playLock)){for(var d=0,_=0;_<u._sounds.length;_++)u._sounds[_]._paused&&!u._sounds[_]._ended&&(d++,p=u._sounds[_]._id);d===1?r=null:p=null}}var h=p?u._soundById(p):u._inactiveSound();if(!h)return null;if(p&&!r&&(r=h._sprite||"__default"),u._state!=="loaded"){h._sprite=r,h._ended=!1;var P=h._id;return u._queue.push({event:"play",action:function(){u.play(P)}}),P}if(p&&!h._paused)return y||u._loadQueue("play"),h._id;u._webAudio&&e._autoResume();var T=Math.max(0,h._seek>0?h._seek:u._sprite[r][0]/1e3),v=Math.max(0,(u._sprite[r][0]+u._sprite[r][1])/1e3-T),f=v*1e3/Math.abs(h._rate),g=u._sprite[r][0]/1e3,C=(u._sprite[r][0]+u._sprite[r][1])/1e3;h._sprite=r,h._ended=!1;var M=function(){h._paused=!1,h._seek=T,h._start=g,h._stop=C,h._loop=!!(h._loop||u._sprite[r][2])};if(T>=C){u._ended(h);return}var b=h._node;if(u._webAudio){var A=function(){u._playLock=!1,M(),u._refreshBuffer(h);var B=h._muted||u._muted?0:h._volume;b.gain.setValueAtTime(B,e.ctx.currentTime),h._playStart=e.ctx.currentTime,typeof b.bufferSource.start>"u"?h._loop?b.bufferSource.noteGrainOn(0,T,86400):b.bufferSource.noteGrainOn(0,T,v):h._loop?b.bufferSource.start(0,T,86400):b.bufferSource.start(0,T,v),f!==1/0&&(u._endTimers[h._id]=setTimeout(u._ended.bind(u,h),f)),y||setTimeout(function(){u._emit("play",h._id),u._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?A():(u._playLock=!0,u.once("resume",A),u._clearTimer(h._id))}else{var I=function(){b.currentTime=T,b.muted=h._muted||u._muted||e._muted||b.muted,b.volume=h._volume*e.volume(),b.playbackRate=h._rate;try{var B=b.play();if(B&&typeof Promise<"u"&&(B instanceof Promise||typeof B.then=="function")?(u._playLock=!0,M(),B.then(function(){u._playLock=!1,b._unlocked=!0,y?u._loadQueue():u._emit("play",h._id)}).catch(function(){u._playLock=!1,u._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),h._ended=!0,h._paused=!0})):y||(u._playLock=!1,M(),u._emit("play",h._id)),b.playbackRate=h._rate,b.paused){u._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}r!=="__default"||h._loop?u._endTimers[h._id]=setTimeout(u._ended.bind(u,h),f):(u._endTimers[h._id]=function(){u._ended(h),b.removeEventListener("ended",u._endTimers[h._id],!1)},b.addEventListener("ended",u._endTimers[h._id],!1))}catch(L){u._emit("playerror",h._id,L)}};b.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(b.src=u._src,b.load());var V=window&&window.ejecta||!b.readyState&&e._navigator.isCocoonJS;if(b.readyState>=3||V)I();else{u._playLock=!0,u._state="loading";var D=function(){u._state="loaded",I(),b.removeEventListener(e._canPlayEvent,D,!1)};b.addEventListener(e._canPlayEvent,D,!1),u._clearTimer(h._id)}}return h._id},pause:function(r){var y=this;if(y._state!=="loaded"||y._playLock)return y._queue.push({event:"pause",action:function(){y.pause(r)}}),y;for(var u=y._getSoundIds(r),p=0;p<u.length;p++){y._clearTimer(u[p]);var d=y._soundById(u[p]);if(d&&!d._paused&&(d._seek=y.seek(u[p]),d._rateSeek=0,d._paused=!0,y._stopFade(u[p]),d._node))if(y._webAudio){if(!d._node.bufferSource)continue;typeof d._node.bufferSource.stop>"u"?d._node.bufferSource.noteOff(0):d._node.bufferSource.stop(0),y._cleanBuffer(d._node)}else(!isNaN(d._node.duration)||d._node.duration===1/0)&&d._node.pause();arguments[1]||y._emit("pause",d?d._id:null)}return y},stop:function(r,y){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"stop",action:function(){u.stop(r)}}),u;for(var p=u._getSoundIds(r),d=0;d<p.length;d++){u._clearTimer(p[d]);var _=u._soundById(p[d]);_&&(_._seek=_._start||0,_._rateSeek=0,_._paused=!0,_._ended=!0,u._stopFade(p[d]),_._node&&(u._webAudio?_._node.bufferSource&&(typeof _._node.bufferSource.stop>"u"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),u._cleanBuffer(_._node)):(!isNaN(_._node.duration)||_._node.duration===1/0)&&(_._node.currentTime=_._start||0,_._node.pause(),_._node.duration===1/0&&u._clearSound(_._node))),y||u._emit("stop",_._id))}return u},mute:function(r,y){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"mute",action:function(){u.mute(r,y)}}),u;if(typeof y>"u")if(typeof r=="boolean")u._muted=r;else return u._muted;for(var p=u._getSoundIds(y),d=0;d<p.length;d++){var _=u._soundById(p[d]);_&&(_._muted=r,_._interval&&u._stopFade(_._id),u._webAudio&&_._node?_._node.gain.setValueAtTime(r?0:_._volume,e.ctx.currentTime):_._node&&(_._node.muted=e._muted?!0:r),u._emit("mute",_._id))}return u},volume:function(){var r=this,y=arguments,u,p;if(y.length===0)return r._volume;if(y.length===1||y.length===2&&typeof y[1]>"u"){var d=r._getSoundIds(),_=d.indexOf(y[0]);_>=0?p=parseInt(y[0],10):u=parseFloat(y[0])}else y.length>=2&&(u=parseFloat(y[0]),p=parseInt(y[1],10));var h;if(typeof u<"u"&&u>=0&&u<=1){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,y)}}),r;typeof p>"u"&&(r._volume=u),p=r._getSoundIds(p);for(var P=0;P<p.length;P++)h=r._soundById(p[P]),h&&(h._volume=u,y[2]||r._stopFade(p[P]),r._webAudio&&h._node&&!h._muted?h._node.gain.setValueAtTime(u,e.ctx.currentTime):h._node&&!h._muted&&(h._node.volume=u*e.volume()),r._emit("volume",h._id))}else return h=p?r._soundById(p):r._sounds[0],h?h._volume:0;return r},fade:function(r,y,u,p){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"fade",action:function(){d.fade(r,y,u,p)}}),d;r=Math.min(Math.max(0,parseFloat(r)),1),y=Math.min(Math.max(0,parseFloat(y)),1),u=parseFloat(u),d.volume(r,p);for(var _=d._getSoundIds(p),h=0;h<_.length;h++){var P=d._soundById(_[h]);if(P){if(p||d._stopFade(_[h]),d._webAudio&&!P._muted){var T=e.ctx.currentTime,v=T+u/1e3;P._volume=r,P._node.gain.setValueAtTime(r,T),P._node.gain.linearRampToValueAtTime(y,v)}d._startFadeInterval(P,r,y,u,_[h],typeof p>"u")}}return d},_startFadeInterval:function(r,y,u,p,d,_){var h=this,P=y,T=u-y,v=Math.abs(T/.01),f=Math.max(4,v>0?p/v:p),g=Date.now();r._fadeTo=u,r._interval=setInterval(function(){var C=(Date.now()-g)/p;g=Date.now(),P+=T*C,P=Math.round(P*100)/100,T<0?P=Math.max(u,P):P=Math.min(u,P),h._webAudio?r._volume=P:h.volume(P,r._id,!0),_&&(h._volume=P),(u<y&&P<=u||u>y&&P>=u)&&(clearInterval(r._interval),r._interval=null,r._fadeTo=null,h.volume(u,r._id),h._emit("fade",r._id))},f)},_stopFade:function(r){var y=this,u=y._soundById(r);return u&&u._interval&&(y._webAudio&&u._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(u._interval),u._interval=null,y.volume(u._fadeTo,r),u._fadeTo=null,y._emit("fade",r)),y},loop:function(){var r=this,y=arguments,u,p,d;if(y.length===0)return r._loop;if(y.length===1)if(typeof y[0]=="boolean")u=y[0],r._loop=u;else return d=r._soundById(parseInt(y[0],10)),d?d._loop:!1;else y.length===2&&(u=y[0],p=parseInt(y[1],10));for(var _=r._getSoundIds(p),h=0;h<_.length;h++)d=r._soundById(_[h]),d&&(d._loop=u,r._webAudio&&d._node&&d._node.bufferSource&&(d._node.bufferSource.loop=u,u&&(d._node.bufferSource.loopStart=d._start||0,d._node.bufferSource.loopEnd=d._stop,r.playing(_[h])&&(r.pause(_[h],!0),r.play(_[h],!0)))));return r},rate:function(){var r=this,y=arguments,u,p;if(y.length===0)p=r._sounds[0]._id;else if(y.length===1){var d=r._getSoundIds(),_=d.indexOf(y[0]);_>=0?p=parseInt(y[0],10):u=parseFloat(y[0])}else y.length===2&&(u=parseFloat(y[0]),p=parseInt(y[1],10));var h;if(typeof u=="number"){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,y)}}),r;typeof p>"u"&&(r._rate=u),p=r._getSoundIds(p);for(var P=0;P<p.length;P++)if(h=r._soundById(p[P]),h){r.playing(p[P])&&(h._rateSeek=r.seek(p[P]),h._playStart=r._webAudio?e.ctx.currentTime:h._playStart),h._rate=u,r._webAudio&&h._node&&h._node.bufferSource?h._node.bufferSource.playbackRate.setValueAtTime(u,e.ctx.currentTime):h._node&&(h._node.playbackRate=u);var T=r.seek(p[P]),v=(r._sprite[h._sprite][0]+r._sprite[h._sprite][1])/1e3-T,f=v*1e3/Math.abs(h._rate);(r._endTimers[p[P]]||!h._paused)&&(r._clearTimer(p[P]),r._endTimers[p[P]]=setTimeout(r._ended.bind(r,h),f)),r._emit("rate",h._id)}}else return h=r._soundById(p),h?h._rate:r._rate;return r},seek:function(){var r=this,y=arguments,u,p;if(y.length===0)r._sounds.length&&(p=r._sounds[0]._id);else if(y.length===1){var d=r._getSoundIds(),_=d.indexOf(y[0]);_>=0?p=parseInt(y[0],10):r._sounds.length&&(p=r._sounds[0]._id,u=parseFloat(y[0]))}else y.length===2&&(u=parseFloat(y[0]),p=parseInt(y[1],10));if(typeof p>"u")return 0;if(typeof u=="number"&&(r._state!=="loaded"||r._playLock))return r._queue.push({event:"seek",action:function(){r.seek.apply(r,y)}}),r;var h=r._soundById(p);if(h)if(typeof u=="number"&&u>=0){var P=r.playing(p);P&&r.pause(p,!0),h._seek=u,h._ended=!1,r._clearTimer(p),!r._webAudio&&h._node&&!isNaN(h._node.duration)&&(h._node.currentTime=u);var T=function(){P&&r.play(p,!0),r._emit("seek",p)};if(P&&!r._webAudio){var v=function(){r._playLock?setTimeout(v,0):T()};setTimeout(v,0)}else T()}else if(r._webAudio){var f=r.playing(p)?e.ctx.currentTime-h._playStart:0,g=h._rateSeek?h._rateSeek-h._seek:0;return h._seek+(g+f*Math.abs(h._rate))}else return h._node.currentTime;return r},playing:function(r){var y=this;if(typeof r=="number"){var u=y._soundById(r);return u?!u._paused:!1}for(var p=0;p<y._sounds.length;p++)if(!y._sounds[p]._paused)return!0;return!1},duration:function(r){var y=this,u=y._duration,p=y._soundById(r);return p&&(u=y._sprite[p._sprite][1]/1e3),u},state:function(){return this._state},unload:function(){for(var r=this,y=r._sounds,u=0;u<y.length;u++)y[u]._paused||r.stop(y[u]._id),r._webAudio||(r._clearSound(y[u]._node),y[u]._node.removeEventListener("error",y[u]._errorFn,!1),y[u]._node.removeEventListener(e._canPlayEvent,y[u]._loadFn,!1),y[u]._node.removeEventListener("ended",y[u]._endFn,!1),e._releaseHtml5Audio(y[u]._node)),delete y[u]._node,r._clearTimer(y[u]._id);var p=e._howls.indexOf(r);p>=0&&e._howls.splice(p,1);var d=!0;for(u=0;u<e._howls.length;u++)if(e._howls[u]._src===r._src||r._src.indexOf(e._howls[u]._src)>=0){d=!1;break}return a&&d&&delete a[r._src],e.noAudio=!1,r._state="unloaded",r._sounds=[],r=null,null},on:function(r,y,u,p){var d=this,_=d["_on"+r];return typeof y=="function"&&_.push(p?{id:u,fn:y,once:p}:{id:u,fn:y}),d},off:function(r,y,u){var p=this,d=p["_on"+r],_=0;if(typeof y=="number"&&(u=y,y=null),y||u)for(_=0;_<d.length;_++){var h=u===d[_].id;if(y===d[_].fn&&h||!y&&h){d.splice(_,1);break}}else if(r)p["_on"+r]=[];else{var P=Object.keys(p);for(_=0;_<P.length;_++)P[_].indexOf("_on")===0&&Array.isArray(p[P[_]])&&(p[P[_]]=[])}return p},once:function(r,y,u){var p=this;return p.on(r,y,u,1),p},_emit:function(r,y,u){for(var p=this,d=p["_on"+r],_=d.length-1;_>=0;_--)(!d[_].id||d[_].id===y||r==="load")&&(setTimeout(function(h){h.call(this,y,u)}.bind(p,d[_].fn),0),d[_].once&&p.off(r,d[_].fn,d[_].id));return p._loadQueue(r),p},_loadQueue:function(r){var y=this;if(y._queue.length>0){var u=y._queue[0];u.event===r&&(y._queue.shift(),y._loadQueue()),r||u.action()}return y},_ended:function(r){var y=this,u=r._sprite;if(!y._webAudio&&r._node&&!r._node.paused&&!r._node.ended&&r._node.currentTime<r._stop)return setTimeout(y._ended.bind(y,r),100),y;var p=!!(r._loop||y._sprite[u][2]);if(y._emit("end",r._id),!y._webAudio&&p&&y.stop(r._id,!0).play(r._id),y._webAudio&&p){y._emit("play",r._id),r._seek=r._start||0,r._rateSeek=0,r._playStart=e.ctx.currentTime;var d=(r._stop-r._start)*1e3/Math.abs(r._rate);y._endTimers[r._id]=setTimeout(y._ended.bind(y,r),d)}return y._webAudio&&!p&&(r._paused=!0,r._ended=!0,r._seek=r._start||0,r._rateSeek=0,y._clearTimer(r._id),y._cleanBuffer(r._node),e._autoSuspend()),!y._webAudio&&!p&&y.stop(r._id,!0),y},_clearTimer:function(r){var y=this;if(y._endTimers[r]){if(typeof y._endTimers[r]!="function")clearTimeout(y._endTimers[r]);else{var u=y._soundById(r);u&&u._node&&u._node.removeEventListener("ended",y._endTimers[r],!1)}delete y._endTimers[r]}return y},_soundById:function(r){for(var y=this,u=0;u<y._sounds.length;u++)if(r===y._sounds[u]._id)return y._sounds[u];return null},_inactiveSound:function(){var r=this;r._drain();for(var y=0;y<r._sounds.length;y++)if(r._sounds[y]._ended)return r._sounds[y].reset();return new n(r)},_drain:function(){var r=this,y=r._pool,u=0,p=0;if(!(r._sounds.length<y)){for(p=0;p<r._sounds.length;p++)r._sounds[p]._ended&&u++;for(p=r._sounds.length-1;p>=0;p--){if(u<=y)return;r._sounds[p]._ended&&(r._webAudio&&r._sounds[p]._node&&r._sounds[p]._node.disconnect(0),r._sounds.splice(p,1),u--)}}},_getSoundIds:function(r){var y=this;if(typeof r>"u"){for(var u=[],p=0;p<y._sounds.length;p++)u.push(y._sounds[p]._id);return u}else return[r]},_refreshBuffer:function(r){var y=this;return r._node.bufferSource=e.ctx.createBufferSource(),r._node.bufferSource.buffer=a[y._src],r._panner?r._node.bufferSource.connect(r._panner):r._node.bufferSource.connect(r._node),r._node.bufferSource.loop=r._loop,r._loop&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop||0),r._node.bufferSource.playbackRate.setValueAtTime(r._rate,e.ctx.currentTime),y},_cleanBuffer:function(r){var y=this,u=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&r.bufferSource&&(r.bufferSource.onended=null,r.bufferSource.disconnect(0),u))try{r.bufferSource.buffer=e._scratchBuffer}catch{}return r.bufferSource=null,y},_clearSound:function(r){var y=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);y||(r.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(r){this._parent=r,this.init()};n.prototype={init:function(){var r=this,y=r._parent;return r._muted=y._muted,r._loop=y._loop,r._volume=y._volume,r._rate=y._rate,r._seek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++e._counter,y._sounds.push(r),r.create(),r},create:function(){var r=this,y=r._parent,u=e._muted||r._muted||r._parent._muted?0:r._volume;return y._webAudio?(r._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),r._node.gain.setValueAtTime(u,e.ctx.currentTime),r._node.paused=!0,r._node.connect(e.masterGain)):e.noAudio||(r._node=e._obtainHtml5Audio(),r._errorFn=r._errorListener.bind(r),r._node.addEventListener("error",r._errorFn,!1),r._loadFn=r._loadListener.bind(r),r._node.addEventListener(e._canPlayEvent,r._loadFn,!1),r._endFn=r._endListener.bind(r),r._node.addEventListener("ended",r._endFn,!1),r._node.src=y._src,r._node.preload=y._preload===!0?"auto":y._preload,r._node.volume=u*e.volume(),r._node.load()),r},reset:function(){var r=this,y=r._parent;return r._muted=y._muted,r._loop=y._loop,r._volume=y._volume,r._rate=y._rate,r._seek=0,r._rateSeek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++e._counter,r},_errorListener:function(){var r=this;r._parent._emit("loaderror",r._id,r._node.error?r._node.error.code:0),r._node.removeEventListener("error",r._errorFn,!1)},_loadListener:function(){var r=this,y=r._parent;y._duration=Math.ceil(r._node.duration*10)/10,Object.keys(y._sprite).length===0&&(y._sprite={__default:[0,y._duration*1e3]}),y._state!=="loaded"&&(y._state="loaded",y._emit("load"),y._loadQueue()),r._node.removeEventListener(e._canPlayEvent,r._loadFn,!1)},_endListener:function(){var r=this,y=r._parent;y._duration===1/0&&(y._duration=Math.ceil(r._node.duration*10)/10,y._sprite.__default[1]===1/0&&(y._sprite.__default[1]=y._duration*1e3),y._ended(r)),r._node.removeEventListener("ended",r._endFn,!1)}};var a={},s=function(r){var y=r._src;if(a[y]){r._duration=a[y].duration,m(r);return}if(/^data:[^;]+;base64,/.test(y)){for(var u=atob(y.split(",")[1]),p=new Uint8Array(u.length),d=0;d<u.length;++d)p[d]=u.charCodeAt(d);l(p.buffer,r)}else{var _=new XMLHttpRequest;_.open(r._xhr.method,y,!0),_.withCredentials=r._xhr.withCredentials,_.responseType="arraybuffer",r._xhr.headers&&Object.keys(r._xhr.headers).forEach(function(h){_.setRequestHeader(h,r._xhr.headers[h])}),_.onload=function(){var h=(_.status+"")[0];if(h!=="0"&&h!=="2"&&h!=="3"){r._emit("loaderror",null,"Failed loading audio file with status: "+_.status+".");return}l(_.response,r)},_.onerror=function(){r._webAudio&&(r._html5=!0,r._webAudio=!1,r._sounds=[],delete a[y],r.load())},o(_)}},o=function(r){try{r.send()}catch{r.onerror()}},l=function(r,y){var u=function(){y._emit("loaderror",null,"Decoding audio data failed.")},p=function(d){d&&y._sounds.length>0?(a[y._src]=d,m(y,d)):u()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(r).then(p).catch(u):e.ctx.decodeAudioData(r,p,u)},m=function(r,y){y&&!r._duration&&(r._duration=y.duration),Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue())},c=function(){if(!!e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var r=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),y=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),u=y?parseInt(y[1],10):null;if(r&&u&&u<9){var p=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!p&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:e,Howl:t}}),typeof ze<"u"&&(ze.Howler=e,ze.Howl=t),typeof global<"u"?(global.HowlerGlobal=i,global.Howler=e,global.Howl=t,global.Sound=n):typeof window<"u"&&(window.HowlerGlobal=i,window.Howler=e,window.Howl=t,window.Sound=n)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var a=this;if(!a.ctx||!a.ctx.listener)return a;if(t=typeof t!="number"?a._pos[1]:t,n=typeof n!="number"?a._pos[2]:n,typeof e=="number")a._pos=[e,t,n],typeof a.ctx.listener.positionX<"u"?(a.ctx.listener.positionX.setTargetAtTime(a._pos[0],Howler.ctx.currentTime,.1),a.ctx.listener.positionY.setTargetAtTime(a._pos[1],Howler.ctx.currentTime,.1),a.ctx.listener.positionZ.setTargetAtTime(a._pos[2],Howler.ctx.currentTime,.1)):a.ctx.listener.setPosition(a._pos[0],a._pos[1],a._pos[2]);else return a._pos;return a},HowlerGlobal.prototype.orientation=function(e,t,n,a,s,o){var l=this;if(!l.ctx||!l.ctx.listener)return l;var m=l._orientation;if(t=typeof t!="number"?m[1]:t,n=typeof n!="number"?m[2]:n,a=typeof a!="number"?m[3]:a,s=typeof s!="number"?m[4]:s,o=typeof o!="number"?m[5]:o,typeof e=="number")l._orientation=[e,t,n,a,s,o],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(a,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(e,t,n,a,s,o);else return m;return l},Howl.prototype.init=function(e){return function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:typeof t.coneInnerAngle<"u"?t.coneInnerAngle:360,coneOuterAngle:typeof t.coneOuterAngle<"u"?t.coneOuterAngle:360,coneOuterGain:typeof t.coneOuterGain<"u"?t.coneOuterGain:0,distanceModel:typeof t.distanceModel<"u"?t.distanceModel:"inverse",maxDistance:typeof t.maxDistance<"u"?t.maxDistance:1e4,panningModel:typeof t.panningModel<"u"?t.panningModel:"HRTF",refDistance:typeof t.refDistance<"u"?t.refDistance:1,rolloffFactor:typeof t.rolloffFactor<"u"?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,t){var n=this;if(!n._webAudio)return n;if(n._state!=="loaded")return n._queue.push({event:"stereo",action:function(){n.stereo(e,t)}}),n;var a=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof t>"u")if(typeof e=="number")n._stereo=e,n._pos=[e,0,0];else return n._stereo;for(var s=n._getSoundIds(t),o=0;o<s.length;o++){var l=n._soundById(s[o]);if(l)if(typeof e=="number")l._stereo=e,l._pos=[e,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&i(l,a),a==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(e,0,0):l._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",l._id);else return l._stereo}return n},Howl.prototype.pos=function(e,t,n,a){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"pos",action:function(){s.pos(e,t,n,a)}}),s;if(t=typeof t!="number"?0:t,n=typeof n!="number"?-.5:n,typeof a>"u")if(typeof e=="number")s._pos=[e,t,n];else return s._pos;for(var o=s._getSoundIds(a),l=0;l<o.length;l++){var m=s._soundById(o[l]);if(m)if(typeof e=="number")m._pos=[e,t,n],m._node&&((!m._panner||m._panner.pan)&&i(m,"spatial"),typeof m._panner.positionX<"u"?(m._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),m._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),m._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):m._panner.setPosition(e,t,n)),s._emit("pos",m._id);else return m._pos}return s},Howl.prototype.orientation=function(e,t,n,a){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"orientation",action:function(){s.orientation(e,t,n,a)}}),s;if(t=typeof t!="number"?s._orientation[1]:t,n=typeof n!="number"?s._orientation[2]:n,typeof a>"u")if(typeof e=="number")s._orientation=[e,t,n];else return s._orientation;for(var o=s._getSoundIds(a),l=0;l<o.length;l++){var m=s._soundById(o[l]);if(m)if(typeof e=="number")m._orientation=[e,t,n],m._node&&(m._panner||(m._pos||(m._pos=s._pos||[0,0,-.5]),i(m,"spatial")),typeof m._panner.orientationX<"u"?(m._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),m._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),m._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):m._panner.setOrientation(e,t,n)),s._emit("orientation",m._id);else return m._orientation}return s},Howl.prototype.pannerAttr=function(){var e=this,t=arguments,n,a,s;if(!e._webAudio)return e;if(t.length===0)return e._pannerAttr;if(t.length===1)if(typeof t[0]=="object")n=t[0],typeof a>"u"&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),e._pannerAttr={coneInnerAngle:typeof n.pannerAttr.coneInnerAngle<"u"?n.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof n.pannerAttr.coneOuterAngle<"u"?n.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof n.pannerAttr.coneOuterGain<"u"?n.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof n.pannerAttr.distanceModel<"u"?n.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof n.pannerAttr.maxDistance<"u"?n.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof n.pannerAttr.refDistance<"u"?n.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof n.pannerAttr.rolloffFactor<"u"?n.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof n.pannerAttr.panningModel<"u"?n.pannerAttr.panningModel:e._panningModel});else return s=e._soundById(parseInt(t[0],10)),s?s._pannerAttr:e._pannerAttr;else t.length===2&&(n=t[0],a=parseInt(t[1],10));for(var o=e._getSoundIds(a),l=0;l<o.length;l++)if(s=e._soundById(o[l]),s){var m=s._pannerAttr;m={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:m.coneInnerAngle,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:m.coneOuterAngle,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:m.coneOuterGain,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:m.distanceModel,maxDistance:typeof n.maxDistance<"u"?n.maxDistance:m.maxDistance,refDistance:typeof n.refDistance<"u"?n.refDistance:m.refDistance,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:m.rolloffFactor,panningModel:typeof n.panningModel<"u"?n.panningModel:m.panningModel};var c=s._panner;c?(c.coneInnerAngle=m.coneInnerAngle,c.coneOuterAngle=m.coneOuterAngle,c.coneOuterGain=m.coneOuterGain,c.distanceModel=m.distanceModel,c.maxDistance=m.maxDistance,c.refDistance=m.refDistance,c.rolloffFactor=m.rolloffFactor,c.panningModel=m.panningModel):(s._pos||(s._pos=e._pos||[0,0,-.5]),i(s,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,t._stereo?n.stereo(t._stereo):t._pos?n.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,n._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var i=function(e,t){t=t||"spatial",t==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()});var rc={};var At,wi=U(()=>{At=Ve(Ae());WL.registerComponent("pp-spatial-audio-listener",{_myEnabled:{type:WL.Type.Enum,values:["always","vr","non vr"],default:"always"}},{init:function(){this._myOrigin=new Float32Array(3),this._myForward=new Float32Array(3),this._myUp=new Float32Array(3)},update:function(){(this._myEnabled==0||this._myEnabled==1&&WL.xrSession||this._myEnabled==2&&!WL.xrSession)&&(this.object.pp_getPosition(this._myOrigin),this.object.pp_getForward(this._myForward),this.object.pp_getUp(this._myUp),At.Howler.pos(this._myOrigin[0],this._myOrigin[1],this._myOrigin[2]),At.Howler.orientation(this._myForward[0],this._myForward[1],this._myForward[2],this._myUp[0],this._myUp[1],this._myUp[2]))}})});var Wi=U(()=>{});function mc(i){console.log("Allocating temp mem:",i),ie=i,H&&_free(H),H=_malloc(ie),yc()}function kt(i){ie>=i||mc(Math.ceil(i/1024)*1024)}function yc(){R=new Float32Array(HEAP8.buffer,H,ie>>2),xt=new Int32Array(HEAP8.buffer,H,ie>>2),ce=new Uint32Array(HEAP8.buffer,H,ie>>2),Ie=new Uint16Array(HEAP8.buffer,H,ie>>1),Zi=new Uint8Array(HEAP8.buffer,H,ie)}function cc(i){return kt(i*2),Ie}function uc(i){return kt(i*4),R}function It(i){return i&&(typeof i=="string"||i.constructor===String)}function Et(i){let e=zi[i]||(zi[i]=new re(i));return e.objectId=i,e}function Ue(i,e,t){if(t<0)return null;let n=ji[e]||(ji[e]=[]);if(n[t])return n[t];let a;if(i=="collision")a=new xe(e,t);else if(i=="text")a=new Rt(e,t);else if(i=="view")a=new Vt(e,t);else if(i=="mesh")a=new Ot(e,t);else if(i=="input")a=new Dt(e,t);else if(i=="light")a=new Lt(e,t);else if(i=="animation")a=new Bt(e,t);else if(i=="physx")a=new qe(e,t);else{let s=_WL._componentTypeIndices[i],o=_WL._componentTypes[s];a=new o}return a._manager=e,a._id=t,n[t]=a,a}var ji,zi,lc,$,ne,Gi,Ui,Ni,qi,ye,Qi,Xi,Ne,Ki,ve,Z,te,Ji,Ge,ge,H,ie,R,xt,ce,Ie,Zi,hc,Y,xe,Rt,Vt,Dt,Lt,Bt,Ot,qe,oe,he,Ht,pe,fe,Re,pc,Te,re,Qe,Yi=U(()=>{ji={},zi=[],lc=["_id","_manager","type","_type","active"];(function(i){i[i.Bool=2]="Bool",i[i.Int=4]="Int",i[i.Float=8]="Float",i[i.String=16]="String",i[i.Enum=32]="Enum",i[i.Object=64]="Object",i[i.Mesh=128]="Mesh",i[i.Texture=256]="Texture",i[i.Material=512]="Material",i[i.Animation=1024]="Animation",i[i.Skin=2048]="Skin"})($||($={}));ne=new Array(6);ne[$.Bool]=!1;ne[$.Int]=0;ne[$.Float]=0;ne[$.String]="";ne[$.Enum]=0;ne[$.Object]=null;ne[$.Mesh]=null;ne[$.Texture]=null;ne[$.Material]=null;ne[$.Animation]=null;ne[$.Skin]=null;(function(i){i[i.Sphere=0]="Sphere",i[i.AxisAlignedBox=1]="AxisAlignedBox",i[i.Box=2]="Box"})(Gi||(Gi={}));(function(i){i[i.Left=1]="Left",i[i.Center=2]="Center",i[i.Right=3]="Right"})(Ui||(Ui={}));(function(i){i[i.Line=1]="Line",i[i.Middle=2]="Middle",i[i.Top=3]="Top",i[i.Bottom=4]="Bottom"})(Ni||(Ni={}));(function(i){i[i.None=0]="None",i[i.Outline=1]="Outline"})(qi||(qi={}));(function(i){i[i.Head=0]="Head",i[i.EyeLeft=1]="EyeLeft",i[i.EyeRight=2]="EyeRight",i[i.ControllerLeft=3]="ControllerLeft",i[i.ControllerRight=4]="ControllerRight",i[i.RayLeft=5]="RayLeft",i[i.RayRight=6]="RayRight"})(ye||(ye={}));(function(i){i[i.Point=1]="Point",i[i.Spot=2]="Spot",i[i.Sun=3]="Sun"})(Qi||(Qi={}));(function(i){i[i.Playing=1]="Playing",i[i.Paused=2]="Paused",i[i.Stopped=3]="Stopped"})(Xi||(Xi={}));(function(i){i[i.Force=0]="Force",i[i.Impulse=1]="Impulse",i[i.VelocityChange=2]="VelocityChange",i[i.Acceleration=3]="Acceleration"})(Ne||(Ne={}));(function(i){i[i.Touch=0]="Touch",i[i.TouchLost=1]="TouchLost",i[i.TriggerTouch=2]="TriggerTouch",i[i.TriggerTouchLost=3]="TriggerTouchLost"})(Ki||(Ki={}));(function(i){i[i.None=0]="None",i[i.Sphere=1]="Sphere",i[i.Capsule=2]="Capsule",i[i.Box=3]="Box",i[i.Plane=4]="Plane",i[i.ConvexMesh=5]="ConvexMesh",i[i.TriangleMesh=6]="TriangleMesh"})(ve||(ve={}));(function(i){i[i.Position=0]="Position",i[i.Tangent=1]="Tangent",i[i.Normal=2]="Normal",i[i.TextureCoordinate=3]="TextureCoordinate",i[i.Color=4]="Color",i[i.JointId=5]="JointId",i[i.JointWeight=6]="JointWeight",i[i.SecondaryJointId=7]="SecondaryJointId",i[i.SecondaryJointWeight=8]="SecondaryJointWeight"})(Z||(Z={}));(function(i){i[i.UnsignedInt=0]="UnsignedInt",i[i.Int=1]="Int",i[i.Float=2]="Float",i[i.Sampler=3]="Sampler",i[i.Font=4]="Font"})(te||(te={}));Ji=null,ge=[],H=null,ie=0,R=null,xt=null,ce=null,Ie=null,Zi=null;hc=[0,1,0],Y=class{constructor(e=-1,t=-1){this._manager=e,this._id=t,this._object=null,this._type=null}get type(){return this._type||re._typeNameFor(this._manager)}get object(){if(!this._object){let e=_wl_component_get_object(this._manager,this._id);this._object=Et(e)}return this._object}set active(e){_wl_component_setActive(this._manager,this._id,e)}get active(){return _wl_component_isActive(this._manager,this._id)!=0}destroy(){_wl_component_remove(this._manager,this._id),this._manager=void 0,this._id=void 0}equals(e){return e?this._manager==e._manager&&this._id==e._id:!1}},xe=class extends Y{get collider(){return _wl_collision_component_get_collider(this._id)}set collider(e){_wl_collision_component_set_collider(this._id,e)}get extents(){return new Float32Array(HEAPF32.buffer,_wl_collision_component_get_extents(this._id),3)}set extents(e){this.extents.set(e)}get group(){return _wl_collision_component_get_group(this._id)}set group(e){_wl_collision_component_set_group(this._id,e)}queryOverlaps(){let e=_wl_collision_component_query_overlaps(this._id,H,ie>>1),t=new Array(e);for(let n=0;n<e;++n)t[n]=new xe(this._manager,Ie[n]);return t}},Rt=class extends Y{get alignment(){return _wl_text_component_get_horizontal_alignment(this._id)}set alignment(e){_wl_text_component_set_horizontal_alignment(this._id,e)}get justification(){return _wl_text_component_get_vertical_alignment(this._id)}set justification(e){_wl_text_component_set_vertical_alignment(this._id,e)}get characterSpacing(){return _wl_text_component_get_character_spacing(this._id)}set characterSpacing(e){_wl_text_component_set_character_spacing(this._id,e)}get lineSpacing(){return _wl_text_component_get_line_spacing(this._id)}set lineSpacing(e){_wl_text_component_set_line_spacing(this._id,e)}get effect(){return _wl_text_component_get_effect(this._id)}set effect(e){_wl_text_component_set_effect(this._id,e)}get text(){return UTF8ToString(_wl_text_component_get_text(this._id))}set text(e){let t=lengthBytesUTF8(e)+1,n=_malloc(t);stringToUTF8(e,n,t),_wl_text_component_set_text(this._id,n),_free(n)}set material(e){let t=e?e._index:0;_wl_text_component_set_material(this._id,t)}get material(){let e=_wl_text_component_get_material(this._id);return e>0?new pe(e):null}},Vt=class extends Y{get projectionMatrix(){return new Float32Array(HEAPF32.buffer,_wl_view_component_get_projection_matrix(this._id),16)}get near(){return _wl_view_component_get_near(this._id)}set near(e){_wl_view_component_set_near(this._id,e)}get far(){return _wl_view_component_get_far(this._id)}set far(e){_wl_view_component_set_far(this._id,e)}get fov(){return _wl_view_component_get_fov(this._id)}set fov(e){_wl_view_component_set_fov(this._id,e)}},Dt=class extends Y{get inputType(){return _wl_input_component_get_type(this._id)}set inputType(e){_wl_input_component_set_type(this._id,e)}get xrInputSource(){if(Ji){for(let e of Ji.inputSources)if(e.handedness==this.handedness)return e}return null}get handedness(){let e=this.inputType;return e==ye.ControllerRight||e==ye.RayRight||e==ye.EyeRight?"right":e==ye.ControllerLeft||e==ye.RayLeft||e==ye.EyeLeft?"left":null}},Lt=class extends Y{get color(){return new Float32Array(HEAPF32.buffer,_wl_light_component_get_color(this._id),4)}get lightType(){return _wl_light_component_get_type(this._id)}set lightType(e){_wl_light_component_set_type(this._id,e)}},Bt=class extends Y{set animation(e){_wl_animation_component_set_animation(this._id,e._index)}get animation(){return new Te(_wl_animation_component_get_animation(this._id))}set playCount(e){_wl_animation_component_set_playCount(this._id,e)}get playCount(){return _wl_animation_component_get_playCount(this._id)}set speed(e){_wl_animation_component_set_speed(this._id,e)}get speed(){return _wl_animation_component_get_speed(this._id)}get state(){return _wl_animation_component_state(this._id)}play(){_wl_animation_component_play(this._id)}stop(){_wl_animation_component_stop(this._id)}pause(){_wl_animation_component_pause(this._id)}},Ot=class extends Y{set material(e){_wl_mesh_component_set_material(this._id,e?e._index:0)}get material(){let e=_wl_mesh_component_get_material(this._id);return e>0?new pe(e):null}get mesh(){return new he(_wl_mesh_component_get_mesh(this._id))}set mesh(e){_wl_mesh_component_set_mesh(this._id,e?e._index:0)}get skin(){return new Qe(_wl_mesh_component_get_skin(this._id))}set skin(e){_wl_mesh_component_set_skin(this._id,e._index)}},qe=class extends Y{set static(e){_wl_physx_component_set_static(this._id,e)}get static(){return!!_wl_physx_component_get_static(this._id)}set kinematic(e){_wl_physx_component_set_kinematic(this._id,e)}get kinematic(){return!!_wl_physx_component_get_kinematic(this._id)}set shape(e){_wl_physx_component_set_shape(this._id,e)}get shape(){return _wl_physx_component_get_shape(this._id)}set shapeData(e){e==null||![ve.TriangleMesh,ve.ConvexMesh].includes(this.shape)||_wl_physx_component_set_shape_data(this._id,e.index)}get shapeData(){return[ve.TriangleMesh,ve.ConvexMesh].includes(this.shape)?{index:_wl_physx_component_get_shape_data(this._id)}:null}set extents(e){this.extents.set(e)}get extents(){let e=_wl_physx_component_get_extents(this._id);return new Float32Array(HEAPF32.buffer,e,3)}get staticFriction(){return _wl_physx_component_get_staticFriction(this._id)}set staticFriction(e){_wl_physx_component_set_staticFriction(this._id,e)}get dynamicFriction(){return _wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(e){_wl_physx_component_set_dynamicFriction(this._id,e)}get bounciness(){return _wl_physx_component_get_bounciness(this._id)}set bounciness(e){_wl_physx_component_set_bounciness(this._id,e)}get linearDamping(){return _wl_physx_component_get_linearDamping(this._id)}set linearDamping(e){_wl_physx_component_set_linearDamping(this._id,e)}get angularDamping(){return _wl_physx_component_get_angularDamping(this._id)}set angularDamping(e){_wl_physx_component_set_angularDamping(this._id,e)}set linearVelocity(e){_wl_physx_component_set_linearVelocity(this._id,e[0],e[1],e[2])}get linearVelocity(){return _wl_physx_component_get_linearVelocity(this._id,H),new Float32Array(HEAPF32.buffer,H,3)}set angularVelocity(e){_wl_physx_component_set_angularVelocity(this._id,e[0],e[1],e[2])}get angularVelocity(){return _wl_physx_component_get_angularVelocity(this._id,H),new Float32Array(HEAPF32.buffer,H,3)}set mass(e){_wl_physx_component_set_mass(this._id,e)}get mass(){return _wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(e){_wl_physx_component_set_massSpaceInertiaTensor(this._id,e[0],e[1],e[2])}addForce(e,t,n,a,s){t=t||Ne.Force,a?_wl_physx_component_addForceAt(this._id,e[0],e[1],e[2],t,!!n,a[0],a[1],a[2],!!s):_wl_physx_component_addForce(this._id,e[0],e[1],e[2],t,!!n)}addTorque(e,t=Ne.Force){_wl_physx_component_addTorque(this._id,e[0],e[1],e[2],t)}onCollision(e){return this.onCollisionWith(this,e)}onCollisionWith(e,t){return Ge._callbacks[this._id]=Ge._callbacks[this._id]||[],Ge._callbacks[this._id].push(t),_wl_physx_component_addCallback(this._id,e._id||this._id)}removeCollisionCallback(e){let t=_wl_physx_component_removeCallback(this._id,e);t&&Ge._callbacks[this._id].splice(-t)}};for(let i of["static","extents","staticFriction","dynamicFriction","bounciness","linearDamping","angularDamping","shape","shapeData","kinematic","linearVelocity","angularVelocity","mass"])Object.defineProperty(qe.prototype,i,{enumerable:!0});(function(i){i[i.UnsignedByte=1]="UnsignedByte",i[i.UnsignedShort=2]="UnsignedShort",i[i.UnsignedInt=4]="UnsignedInt"})(oe||(oe={}));he=class{static get VERTEX_FLOAT_SIZE(){return 3+3+2}static get VERTEX_SIZE(){return this.VERTEX_FLOAT_SIZE*4}static get POS(){return{X:0,Y:1,Z:2}}static get TEXCOORD(){return{U:3,V:4}}static get NORMAL(){return{X:5,Y:6,Z:7}}constructor(e){if(typeof e=="object"){if(!e.vertexCount&&e.vertexData&&(e.vertexCount=e.vertexData.length/he.VERTEX_FLOAT_SIZE),!e.vertexCount)throw new Error("Missing parameter 'vertexCount'");let t=0,n=0,a=0;if(e.indexData)switch(n=e.indexType||oe.UnsignedShort,a=e.indexData.length*n,t=_malloc(a),n){case oe.UnsignedByte:HEAPU8.set(e.indexData,t);break;case oe.UnsignedShort:HEAPU16.set(e.indexData,t>>1);break;case oe.UnsignedInt:HEAPU32.set(e.indexData,t>>2);break}let{skinned:s=!1}=e;if(this._index=_wl_mesh_create(t,a,n,e.vertexCount,s),e.vertexData){let o=this.attribute(Z.Position),l=this.attribute(Z.Normal),m=this.attribute(Z.TextureCoordinate);for(let c=0;c<e.vertexCount;++c){let r=c*he.VERTEX_FLOAT_SIZE;o.set(c,e.vertexData.subarray(r,r+3)),m?.set(c,e.vertexData.subarray(r+3,r+5)),l?.set(c,e.vertexData.subarray(r+5,r+8))}}}else this._index=e}get vertexData(){let e=_wl_mesh_get_vertexData(this._index,H);return new Float32Array(HEAPF32.buffer,e,he.VERTEX_FLOAT_SIZE*HEAPU32[H/4])}get vertexCount(){return _wl_mesh_get_vertexCount(this._index)}get indexData(){let e=_wl_mesh_get_indexData(this._index,H,H+4);if(e===null)return null;let t=HEAPU32[H/4];switch(HEAPU32[H/4+1]){case oe.UnsignedByte:return new Uint8Array(HEAPU8.buffer,e,t);case oe.UnsignedShort:return new Uint16Array(HEAPU16.buffer,e,t);case oe.UnsignedInt:return new Uint32Array(HEAPU32.buffer,e,t)}return null}update(){_wl_mesh_update(this._index)}getBoundingSphere(e=new Float32Array(4)){return _wl_mesh_get_boundingSphere(this._index,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e[3]=R[3],e}attribute(e){if(typeof e!="number")throw new TypeError("Expected number, but got "+typeof e);if(_wl_mesh_get_attribute(this._index,e,H),ce[0]==255)return null;let t=new Ht(e);return t._attribute=ce[0],t._offset=ce[1],t._stride=ce[2],t._formatSize=ce[3],t._componentCount=ce[4],t.length=this.vertexCount,t}destroy(){_wl_mesh_destroy(this._index)}},Ht=class{constructor(e=Z.Position){switch(this._attribute=-1,this._offset=0,this._stride=0,this._formatSize=0,this._componentCount=0,this.length=0,e){case Z.Position:case Z.Normal:case Z.TextureCoordinate:case Z.Tangent:case Z.Color:case Z.JointWeight:case Z.SecondaryJointWeight:this._bufferType=Float32Array,this._tempBufferGetter=uc;break;case Z.JointId:case Z.SecondaryJointId:this._bufferType=Uint16Array,this._tempBufferGetter=cc;break;default:throw new Error(`Invalid attribute accessor type: ${e}`)}}createArray(e=1){return e=e>this.length?this.length:e,new this._bufferType(e*this._componentCount)}get(e,t=this.createArray()){if(t.length%this._componentCount!==0)throw new Error(`out.length, ${t.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let n=this._tempBufferGetter(t.length),a=this._bufferType.BYTES_PER_ELEMENT,s=a*t.length,o=this._componentCount*a;_wl_mesh_get_attribute_values(this._attribute,this._formatSize,this._offset+e*this._stride,this._stride,o,n.byteOffset,s);for(let l=0;l<t.length;++l)t[l]=n[l];return t}set(e,t){if(t.length%this._componentCount!==0)throw new Error(`out.length, ${t.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let n=this._bufferType.BYTES_PER_ELEMENT,a=n*t.length,s=this._componentCount*n;if(t.buffer!=HEAPU8.buffer){let o=this._tempBufferGetter(t.length);o.set(t),t=o}return _wl_mesh_set_attribute_values(this._attribute,s,t.byteOffset,a,this._formatSize,this._offset+e*this._stride,this._stride),this}},pe=class{constructor(e){if(typeof e!="number"){if(!e?.pipeline)throw new Error("Missing parameter 'pipeline'");let t=e.pipeline,n=lengthBytesUTF8(t)+1;if(stringToUTF8(t,H,n),this._index=_wl_material_create(H),this._index<0)throw new Error(`No such pipeline '${t}'`)}else this._index=e;if(this._definition=_wl_material_get_definition(this._index),!_WL._materialDefinitions[this._definition])throw new Error(`Material Definition ${this._definition} not found for material with index ${this._index}`);return new Proxy(this,{get(t,n){let s=_WL._materialDefinitions[t._definition].get(n);if(!s)return t[n];if(_wl_material_get_param_value(t._index,s.index,H)){let o=s.type;switch(o.type){case te.UnsignedInt:return o.componentCount==1?ce[0]:new Uint32Array(HEAPU32.buffer,H,o.componentCount);case te.Int:return o.componentCount==1?xt[0]:new Int32Array(HEAP32.buffer,H,o.componentCount);case te.Float:return o.componentCount==1?R[0]:new Float32Array(HEAPF32.buffer,H,o.componentCount);case te.Sampler:return new Re(xt[0]);default:throw new Error(`Invalid type ${o} on parameter ${s.index} for material ${t._index}`)}}},set(t,n,a){let o=_WL._materialDefinitions[t._definition].get(n);if(!o)return t[n]=a,!0;switch(o.type.type){case te.UnsignedInt:case te.Int:case te.Sampler:let m=a instanceof Re?a.id:a;_wl_material_set_param_value_uint(t._index,o.index,m);break;case te.Float:let c=1;if(typeof a=="number")R[0]=a;else{c=a.length;for(let r=0;r<c;++r)R[r]=a[r]}_wl_material_set_param_value_float(t._index,o.index,H,c);break;case te.Font:throw new Error("Setting font properties is currently unsupported.")}return!0}})}get shader(){return UTF8ToString(_wl_material_get_shader(this._index))}clone(){let e=_wl_material_clone(this._index);return e>0?new pe(e):null}static wrap(e){return e>0?new pe(e):null}},fe=null,Re=class{constructor(e){if(this._id=0,this._imageIndex=void 0,e instanceof HTMLImageElement||e instanceof HTMLVideoElement||e instanceof HTMLCanvasElement){let t=ge.length;ge.push(e),this._imageIndex=t,this._id=_wl_renderer_addImage(t)}else this._id=e;pc[this._id]=this}get valid(){return this._id>=0}get id(){return this._id}update(){!this.valid||_wl_renderer_updateImage(this._id,this._imageIndex)}get width(){return _wl_texture_width(this._id)}get height(){return _wl_texture_height(this._id)}updateSubImage(e,t,n,a){var s;if(!this.valid)return;fe||(fe=document.createElement("canvas"));let o=ge[this._imageIndex];if(!!o){fe.width=n,fe.height=a,(s=fe.getContext("2d"))===null||s===void 0||s.drawImage(o,e,t,n,a,0,0,n,a),ge[this._imageIndex]=fe;try{_wl_renderer_updateImage(this._id,this._imageIndex,e,(o.videoHeight||o.height)-t-a)}finally{ge[this._imageIndex]=o}}}destroy(){_wl_texture_destroy(this._id),this._imageIndex&&(ge[this._imageIndex]=null,this._imageIndex=void 0)}},pc={load:function(i,e){let t=new Image;return e!==void 0&&(t.crossOrigin=e),t.src=i,new Promise((n,a)=>{t.onload=function(){let s=new Re(t);s.valid||a("Failed to add image "+t.src+" to texture atlas. Probably incompatible format."),n(s)}})}},Te=class{constructor(e){this._index=e}get duration(){return _wl_animation_get_duration(this._index)}get trackCount(){return _wl_animation_get_trackCount(this._index)}retarget(e){if(e instanceof Qe){let a=_wl_animation_retargetToSkin(this._index,e._index);return new Te(a)}if(e.length!=this.trackCount)throw Error("Expected "+this.trackCount.toString()+" targets, but got "+e.length.toString());let t=_malloc(2*e.length);for(let a=0;a<e.length;++a)HEAPU16[t>>1+a]=e[a].objectId;let n=_wl_animation_retarget(this._index,t);return _free(t),new Te(n)}},re=class{constructor(e){this.objectId=e}get name(){return UTF8ToString(_wl_object_name(this.objectId))}set name(e){let t=lengthBytesUTF8(e)+1,n=_malloc(t);stringToUTF8(e,n,t),_wl_object_set_name(this.objectId,n),_free(n)}get parent(){let e=_wl_object_parent(this.objectId);return e==0?null:Et(e)}get children(){let e=_wl_object_get_children_count(this.objectId);if(e===0)return[];kt(e*2),_wl_object_get_children(this.objectId,H,ie>>1);let t=new Array(e);for(let n=0;n<e;++n)t[n]=Et(Ie[n]);return t}set parent(e){_wl_object_set_parent(this.objectId,e==null?0:e.objectId)}resetTransform(){_wl_object_reset_translation_rotation(this.objectId),_wl_object_reset_scaling(this.objectId)}resetTranslationRotation(){_wl_object_reset_translation_rotation(this.objectId)}resetRotation(){_wl_object_reset_rotation(this.objectId)}resetTranslation(){_wl_object_reset_translation(this.objectId)}resetScaling(){_wl_object_reset_scaling(this.objectId)}translate(e){_wl_object_translate(this.objectId,e[0],e[1],e[2])}translateObject(e){_wl_object_translate_obj(this.objectId,e[0],e[1],e[2])}translateWorld(e){_wl_object_translate_world(this.objectId,e[0],e[1],e[2])}rotateAxisAngleDeg(e,t){_wl_object_rotate_axis_angle(this.objectId,e[0],e[1],e[2],t)}rotateAxisAngleRad(e,t){_wl_object_rotate_axis_angle_rad(this.objectId,e[0],e[1],e[2],t)}rotateAxisAngleDegObject(e,t){_wl_object_rotate_axis_angle_obj(this.objectId,e[0],e[1],e[2],t)}rotateAxisAngleRadObject(e,t){_wl_object_rotate_axis_angle_rad_obj(this.objectId,e[0],e[1],e[2],t)}rotate(e){_wl_object_rotate_quat(this.objectId,e[0],e[1],e[2],e[3])}rotateObject(e){_wl_object_rotate_quat_obj(this.objectId,e[0],e[1],e[2],e[3])}scale(e){_wl_object_scale(this.objectId,e[0],e[1],e[2])}get transformLocal(){return new Float32Array(HEAPF32.buffer,_wl_object_trans_local(this.objectId),8)}set transformLocal(e){this.transformLocal.set(e),this.setDirty()}getTranslationLocal(e){return _wl_object_get_translation_local(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e}getTranslationWorld(e){return _wl_object_get_translation_world(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e}setTranslationLocal(e){_wl_object_set_translation_local(this.objectId,e[0],e[1],e[2])}setTranslationWorld(e){_wl_object_set_translation_world(this.objectId,e[0],e[1],e[2])}get transformWorld(){return new Float32Array(HEAPF32.buffer,_wl_object_trans_world(this.objectId),8)}set transformWorld(e){this.transformWorld.set(e),_wl_object_trans_world_to_local(this.objectId)}get scalingLocal(){return new Float32Array(HEAPF32.buffer,_wl_object_scaling_local(this.objectId),3)}set scalingLocal(e){this.scalingLocal.set(e),this.setDirty()}get scalingWorld(){return new Float32Array(HEAPF32.buffer,_wl_object_scaling_world(this.objectId),3)}set scalingWorld(e){this.scalingWorld.set(e),_wl_object_scaling_world_to_local(this.objectId)}get rotationLocal(){return this.transformLocal.subarray(0,4)}get rotationWorld(){return this.transformWorld.subarray(0,4)}set rotationLocal(e){_wl_object_set_rotation_local(this.objectId,e[0],e[1],e[2],e[3])}set rotationWorld(e){_wl_object_set_rotation_world(this.objectId,e[0],e[1],e[2],e[3])}getForward(e){return e[0]=0,e[1]=0,e[2]=-1,this.transformVectorWorld(e),e}getUp(e){return e[0]=0,e[1]=1,e[2]=0,this.transformVectorWorld(e),e}getRight(e){return e[0]=1,e[1]=0,e[2]=0,this.transformVectorWorld(e),e}transformVectorWorld(e,t){return t=t||e,R[0]=t[0],R[1]=t[1],R[2]=t[2],_wl_object_transformVectorWorld(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e}transformVectorLocal(e,t){return t=t||e,R[0]=t[0],R[1]=t[1],R[2]=t[2],_wl_object_transformVectorLocal(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e}transformPointWorld(e,t){return t=t||e,R[0]=t[0],R[1]=t[1],R[2]=t[2],_wl_object_transformPointWorld(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e}transformPointLocal(e,t){return t=t||e,R[0]=t[0],R[1]=t[1],R[2]=t[2],_wl_object_transformPointLocal(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e}transformVectorInverseWorld(e,t){return t=t||e,R[0]=t[0],R[1]=t[1],R[2]=t[2],_wl_object_transformVectorInverseWorld(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e}transformVectorInverseLocal(e,t){return t=t||e,R[0]=t[0],R[1]=t[1],R[2]=t[2],_wl_object_transformVectorInverseLocal(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e}transformPointInverseWorld(e,t){return t=t||e,R[0]=t[0],R[1]=t[1],R[2]=t[2],_wl_object_transformPointInverseWorld(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e}transformPointInverseLocal(e,t){return t=t||e,R.set(t),_wl_object_transformPointInverseLocal(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e}toWorldSpaceTransform(e,t){return t=t||e,R.set(t),_wl_object_toWorldSpaceTransform(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e[3]=R[3],e[4]=R[4],e[5]=R[5],e[6]=R[6],e[7]=R[7],e}toLocalSpaceTransform(e,t){let n=this.parent;return t=t||e,n?n.toObjectSpaceTransform(t):e!==t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7]),e}toObjectSpaceTransform(e,t){return t=t||e,R.set(t),_wl_object_toObjectSpaceTransform(this.objectId,H),e[0]=R[0],e[1]=R[1],e[2]=R[2],e[3]=R[3],e[4]=R[4],e[5]=R[5],e[6]=R[6],e[7]=R[7],e}lookAt(e,t=hc){_wl_object_lookAt(this.objectId,e[0],e[1],e[2],t[0],t[1],t[2])}destroy(){_wl_scene_remove_object(this.objectId),this.objectId=null}setDirty(){_wl_object_set_dirty(this.objectId)}set active(e){let t=this.getComponents();for(let n of t)n.active=e}getComponent(e,t){let n=It(e)?e:e.TypeName,a=lengthBytesUTF8(n)+1,s=_malloc(a);stringToUTF8(n,s,a);let o=_wl_get_component_manager_index(s);if(_free(s),o<0){let m=_WL._componentTypeIndices[n],c=_wl_get_js_component_index(this.objectId,m,t||0);return c<0?null:_WL._components[c]}let l=_wl_get_component_id(this.objectId,o,t||0);return Ue(n,o,l)}getComponents(e){let t=null,n=null;e&&(n=It(e)?e:e.TypeName,t=re._typeIndexFor(n));let a=[],s=Math.floor(ie/3*2),o=_wl_object_get_components(this.objectId,H,s),l=2*o;_wl_object_get_component_types(this.objectId,H+l,s);let m=re._typeIndexFor("js");for(let c=0;c<o;++c){let r=Zi[c+l],y=Ie[c];if(r==m){let u=_WL._components[_wl_get_js_component_index_for_id(y)];(t===null||u.type==n)&&a.push(u);continue}if(t===null){let u=re._typeNameFor(r);a.push(Ue(u,r,y))}else r==t&&a.push(Ue(n,t,y))}return a}addComponent(e,t){let n=It(e)?e:e.TypeName,a=re._typeIndexFor(n),s=null,o=null;if(a<0){if(!(n in _WL._componentTypeIndices))throw new TypeError("Unknown component type '"+n+"'");let l=_wl_object_add_js_component(this.objectId,_WL._componentTypeIndices[n]);o=_wl_get_js_component_index_for_id(l),s=_WL._components[o]}else{let l=_wl_object_add_component(this.objectId,a);s=Ue(n,a,l)}if(t!==void 0)for(let l in t)lc.includes(l)||(s[l]=t[l]);return a<0&&_wljs_component_init(o),(!t||!("active"in t&&!t.active))&&(s.active=!0),s}get changed(){return!!_wl_object_is_changed(this.objectId)}equals(e){return e?this.objectId==e.objectId:!1}static _typeIndexFor(e){let t=lengthBytesUTF8(e)+1,n=_malloc(t);stringToUTF8(e,n,t);let a=_wl_get_component_manager_index(n);return _free(n),a}static _typeNameFor(e){return UTF8ToString(_wl_component_manager_name(e))}},Qe=class{constructor(e){this._index=e}get jointCount(){return _wl_skin_get_joint_count(this._index)}get jointIds(){return new Uint16Array(HEAPU16.buffer,_wl_skin_joint_ids(this._index),this.jointCount)}get inverseBindTransforms(){return new Float32Array(HEAPF32.buffer,_wl_skin_inverse_bind_transforms(this._index),8*this.jointCount)}get inverseBindScalings(){return new Float32Array(HEAPF32.buffer,_wl_skin_inverse_bind_scalings(this._index),3*this.jointCount)}}});var Ft=U(()=>{Wi();Yi()});var dc={};var Xe,$i=U(()=>{Ft();PP.myAudioManager=null;PP.AudioManagerComponent=(Xe=class extends Y{init(){PP.myAudioManager=new PP.AudioManager}start(){}update(e){}},Pe(Xe,"TypeName","pp-audio-manager"),Pe(Xe,"Properties",{}),Xe);WL.registerComponent(PP.AudioManagerComponent)});var _c={};var Ke,en=U(()=>{Ke=Ve(Ae());PP.AudioManager=class{constructor(){this._myAudioSetups=new Map}createAudioPlayer(e){return this.getAudioSetup(e)!=null?new PP.AudioPlayer(this.getAudioSetup(e)):null}getAudioSetup(e){return this._myAudioSetups.get(e)}addAudioSetup(e,t,n=!0){this._myAudioSetups.set(e,t),n&&this.createAudioPlayer(e)}removeAudioSetup(e){this._myAudioSetups.delete(e)}setVolume(e){Ke.Howler.volume(e)}setMute(e){Ke.Howler.mute(e)}stop(){Ke.Howler.stop()}}});var Pc={};var tn,nn=U(()=>{tn=Ve(Ae());PP.AudioEvent={END:"end",STOP:"stop",LOAD:"load",LOAD_ERROR:"loaderror",PLAY:"play",PLAY_ERROR:"playerror",PAUSE:"pause",MUTE:"mute",VOLUME:"volume",RATE:"rate",SEEK:"seek",FADE:"fade",UNLOCK:"unlock"};PP.AudioPlayer=class{constructor(e,t=!0){e==null?this._myAudioSetup=new PP.AudioSetup:typeof e=="string"?this._myAudioSetup=new PP.AudioSetup(audioSetupOrAudioFile):this._myAudioSetup=e.clone(),this._myAudio=null,t&&(this._myAudio=new tn.Howl({src:[this._myAudioSetup.myAudioFilePath],loop:this._myAudioSetup.myLoop,volume:this._myAudioSetup.myVolume,autoplay:this._myAudioSetup.myAutoplay,rate:this._myAudioSetup.myRate,pool:this._myAudioSetup.myPool,pos:this._myAudioSetup.mySpatial?this._myAudioSetup.myPosition:null,refDistance:this._myAudioSetup.myReferenceDistance,preload:this._myAudioSetup.myPreload}),this._myAudio._pannerAttr.refDistance=this._myAudioSetup.myReferenceDistance),this._myLastAudioID=null,this._myCallbacks=new Map;for(let n in PP.AudioEvent)this._myCallbacks.set(PP.AudioEvent[n],new Map);t&&this._addListeners()}isValid(){return this._myAudio!=null}play(){if(Howler.state!="running"&&this._myAudioSetup.myPreventPlayWhenAudioContextNotRunning)return!1;let e=this._myAudio.play();return e!=null&&(this._myLastAudioID=e,this.updatePosition(this._myAudioSetup.myPosition,!0),this.updatePitch(this._myAudioSetup.myPitch,!0),this.updateVolume(this._myAudioSetup.myVolume,!0)),e!=null}stop(){this._myAudio.stop()}pause(){this._myAudio.pause()}resume(){this._myAudio.play()}isPlaying(e=!1){let t=!1;return e?t=this._myAudio.playing(this._myLastAudioID):t=this._myAudio.playing(),t}isLoaded(){return this._myAudio.state()=="loaded"}fade(e,t,n,a=!1){this.setVolume(t),a?this._myAudio.fade(e,t,n*1e3,this._myLastAudioID):this._myAudio.fade(e,t,n*1e3)}updatePosition(e,t=!1){this.setPosition(e),this._myAudioSetup.mySpatial&&e&&(t?this._myAudio.pos(e[0],e[1],e[2],this._myLastAudioID):this._myAudio.pos(e[0],e[1],e[2]))}updatePitch(e,t=!1){this.updateRate(e,t)}updateRate(e,t=!1){this.setRate(e),e!=null&&(t?this._myAudio.rate(e,this._myLastAudioID):this._myAudio.rate(e))}updateVolume(e,t=!1){this.setVolume(e),e!=null&&(t?this._myAudio.volume(e,this._myLastAudioID):this._myAudio.volume(e))}setSpatial(e){this._myAudioSetup.mySpatial=e}setPosition(e){this._myAudioSetup.myPosition=e}setPitch(e){this._myAudioSetup.myPitch=e}setRate(e){this._myAudioSetup.myRate=e}setVolume(e){this._myAudioSetup.myVolume=e}getDuration(){return this._myAudio.duration()}getVolume(){return this._myAudioSetup.myVolume}getPitch(){return this._myAudioSetup.myPitch}getRate(){return this._myAudioSetup.myRate}registerAudioEventListener(e,t,n){this._myCallbacks.get(e).set(t,n)}unregisterAudioEventListener(e,t){this._myCallbacks.get(e).delete(t)}_addListeners(){if(this._myAudio!=null)for(let e in PP.AudioEvent){let t=PP.AudioEvent[e];this._myAudio.on(t,function(n){let a=this._myCallbacks.get(t);for(let s of a.values())s(n)}.bind(this))}}}});var an=S(()=>{PP.AudioSetup=class{constructor(e=null){this.myAudioFilePath=e?e.slice(0):null,this.myLoop=!1,this.myAutoplay=!1,this.myVolume=1,this._myRate=1,this.myPool=5,this.myPreload=!0,this.myPreventPlayWhenAudioContextNotRunning=!1,this.myPosition=null,this.mySpatial=!0,this.myReferenceDistance=1}clone(){let e=new PP.AudioSetup;return e.myAudioFilePath=this.myAudioFilePath.slice(0),e.myLoop=this.myLoop,e.myAutoplay=this.myAutoplay,e.myVolume=this.myVolume,e.myPitch=this.myPitch,e.myRate=this.myRate,e.myPool=this.myPool,e.myPreload=this.myPreload,e.myPreventPlayWhenAudioContextNotRunning=this.myPreventPlayWhenAudioContextNotRunning,this.myPosition!=null?e.myPosition=this.myPosition.vec3_clone():e.myPosition=null,e.mySpatial=this.mySpatial,e.myReferenceDistance=this.myReferenceDistance,e}get myPitch(){return this._myRate}get myRate(){return this._myRate}set myPitch(e){this._myRate=e}set myRate(e){this._myRate=e}}});var gc={};var sn,on=U(()=>{sn=Ve(Ae());WL.registerComponent("pp-mute-everything",{},{init:function(){},start:function(){sn.Howler.mute(!0)},update:function(i){}})});var rn=S(()=>{PP.AudioUtils={isAudioPlaybackBlocked:function(){let i=!1;return Howler!=null&&Howler.state!="running"&&(i=!0),i}}});var ln=S(()=>{PP.HowlerAudioPlayer=class extends PP.AudioPlayer{constructor(e,t=null){super(t,!1),this._myAudio=e,t==null?(this._myAudioSetup.myAudioFilePath=this._myAudio._src,this._myAudioSetup.myLoop=this._myAudio._loop,this._myAudioSetup.myAutoplay=this._myAudio._autoplay,this._myAudioSetup.myVolume=this._myAudio._volume,this._myAudioSetup.myRate=this._myAudio._rate,this._myAudioSetup.myPool=this._myAudio._pool,this._myAudioSetup.myPreload=this._myAudio._preload,this._myAudioSetup.myPosition=this._myAudio._pos!=null?this._myAudio._pos.vec3_clone():null,this._myAudioSetup.mySpatial=this._myAudio._pos!=null,this._myAudioSetup.myReferenceDistance=this._myAudio._pannerAttr.refDistance):(this._myAudioSetup.myAudioFilePath=this._myAudio._src,this._myAudio.loop(this._myAudioSetup.myLoop),this._myAudio._autoplay=this._myAudioSetup.myAutoplay,this._myAudio.volume(this._myAudioSetup.myVolume),this._myAudio.rate(this._myAudioSetup.myRate),this._myAudio._pool=this._myAudioSetup.myPool,this._myAudio._preload=this._myAudioSetup.myPreload,this.updatePosition(this._myAudioSetup.myPosition),this._myAudio._pannerAttr.refDistance=this._myAudioSetup.myReferenceDistance,this._myAudioSetup.myAutoplay&&this._myAudio.play()),this._addListeners()}}});var mn=S(()=>{WL.registerComponent("pp-benchmark-max-physx",{_myStaticDomeSize:{type:WL.Type.Float,default:40},_myStaticPhysXCount:{type:WL.Type.Int,default:1e3},_myDynamicDomeSize:{type:WL.Type.Float,default:80},_myDynamicPhysXCount:{type:WL.Type.Int,default:250},_myKinematicDomeSize:{type:WL.Type.Float,default:120},_myKinematicPhysXCount:{type:WL.Type.Int,default:250},_myRaycastCount:{type:WL.Type.Int,default:100},_myVisualizeRaycast:{type:WL.Type.Bool,default:!1},_myVisualizeRaycastDelay:{type:WL.Type.Float,default:.5},_myUseConvexMesh:{type:WL.Type.Bool,default:!1},_myShapeIndex:{type:WL.Type.Int,default:0},_myShapeScaleMultiplier:{type:WL.Type.Float,default:1},_myEnableLog:{type:WL.Type.Bool,default:!0}},{start:function(){this._myRootObject=WL.scene.addObject(this.object),this._myRaycastSetup=new PP.RaycastSetup,this._myRaycastResults=new PP.RaycastResults,this._myStaticPhysXObjects=[],this._myStaticPhysXComponents=[],this._myStaticPhysXCollectors=[],this._myDynamicPhysXObjects=[],this._myDynamicPhysXComponents=[],this._myDynamicPhysXCollectors=[],this._myKinematicPhysXObjects=[],this._myKinematicPhysXComponents=[],this._myKinematicPhysXCollectors=[],this._spawnDome(!0,!1),this._spawnDome(!1,!1),this._spawnDome(!1,!0),this._myStartTimer=new PP.Timer(1),this._myTimer=new PP.Timer(0),this._myDebugTimer=new PP.Timer(this._myVisualizeRaycastDelay),this._myEnableLogTimer=new PP.Timer(1),this._myFPSHistory=[];for(let i=0;i<7;i++)this._myFPSHistory.push(0);this._myAddVelocityDelay=10,this._myTranslateVec3=PP.vec3_create(),this._myRotateVec3=PP.vec3_create()},update:function(i){if(this._myStartTimer.update(i),this._myStartTimer.isDone()){if(this._myTimer.update(i),this._myDebugTimer.update(i),this._myEnableLogTimer.update(i),this._myTimer.isDone()){this._myTimer.start();let e=!1;this._myDebugTimer.isDone()&&(this._myDebugTimer.start(),e=!0),e=e&&this._myVisualizeRaycast,this._raycastTest(e)}if(this._myFPSHistory.pop(),this._myFPSHistory.unshift(Math.round(1/i)),this._myEnableLog&&this._myEnableLogTimer.isDone()){this._myEnableLogTimer.start(),console.clear(),console.log("Static PhysX Dome Size:",this._myStaticPhysXObjects.length),console.log("Dynamic PhysX Dome Size:",this._myDynamicPhysXObjects.length),console.log("Kinematic PhysX Dome Size:",this._myKinematicPhysXObjects.length);let e=0;for(let o of this._myStaticPhysXCollectors)e+=o.getCollisions().length;let t=0;for(let o of this._myDynamicPhysXCollectors)t+=o.getCollisions().length;let n=0;for(let o of this._myKinematicPhysXCollectors)n+=o.getCollisions().length;let a=(e+t+n)/2;console.log("Current Collisions Count:",a),console.log("Raycast Count:",this._myRaycastCount),console.log("FPS History:");let s="";for(let o of this._myFPSHistory)s=s.concat(o,`
`);console.log(s)}}if(this._myAddVelocityDelay>0&&(this._myAddVelocityDelay--,this._myAddVelocityDelay==0))for(let e of this._myDynamicPhysXComponents){e.kinematic=!1;let t=50;e.linearVelocity=[Math.pp_random(-t,t),Math.pp_random(-t,t),Math.pp_random(-t,t)],e.angularVelocity=[Math.pp_random(-t,t),Math.pp_random(-t,t),Math.pp_random(-t,t)]}for(let e of this._myKinematicPhysXObjects){let t=5*i;this._myTranslateVec3.vec3_set(Math.pp_random(-t,t),Math.pp_random(-t,t),Math.pp_random(-t,t)),e.pp_translate(this._myTranslateVec3),rotateStrength=50*i,this._myRotateVec3.vec3_set(Math.pp_random(-rotateStrength,rotateStrength),Math.pp_random(-rotateStrength,rotateStrength),Math.pp_random(-rotateStrength,rotateStrength)),e.pp_rotate(this._myRotateVec3)}},_raycastTest(i){let e=this._myRaycastCount,t=1e4;for(let n=0;n<e;n++){let a=[Math.pp_random(1,2)*Math.pp_randomSign(),Math.pp_random(1,2)*Math.pp_randomSign(),Math.pp_random(1,2)*Math.pp_randomSign()],s=[Math.pp_random(-1,1),Math.pp_random(-1,1),Math.pp_random(-1,1)];s.vec3_normalize(s),this._myRaycastSetup.myOrigin.vec3_copy(a),this._myRaycastSetup.myDirection.vec3_copy(s),this._myRaycastSetup.myDistance=t,this._myRaycastSetup.myBlockLayerFlags.setMask(255);let o=PP.PhysicsUtils.raycast(this._myRaycastSetup,this._myRaycastResults);i&&PP.myDebugVisualManager.drawRaycast(this._myDebugTimer.getDuration(),o,!0,5,.015)}},_spawnDome(i,e){let t=this._myStaticPhysXCount,n=this._myStaticPhysXObjects,a=Math.ceil(Math.sqrt(this._myStaticPhysXCount));i||(e?(a=Math.ceil(Math.sqrt(this._myDynamicPhysXCount)),t=this._myDynamicPhysXCount,n=this._myDynamicPhysXObjects):(a=Math.ceil(Math.sqrt(this._myKinematicPhysXCount)),t=this._myKinematicPhysXCount,n=this._myKinematicPhysXObjects));let s=Math.PI*2/a,o=Math.max(0,this._myStaticDomeSize-20),l=this._myStaticDomeSize+20;i||(e?(o=Math.max(0,this._myDynamicDomeSize-20),l=this._myDynamicDomeSize+20):(o=Math.max(0,this._myKinematicDomeSize-20),l=this._myKinematicDomeSize+20));let m=0,c=Math.pp_toRadians(10),r=PP.vec3_create(0,1,0),y=PP.vec3_create(0,0,-1);for(let u=0;u<a/2;u++){let p=PP.vec3_create(0,1,0),d=PP.vec3_create();y.vec3_cross(p,d),d.vec3_normalize(d);for(let _=0;_<a;_++){if(n.length<t){let h=Math.random()*(l-o)+o,P=(Math.random()*2-1)*(c-m)+m,T=(Math.random()*2-1)*(c-m)+m,v=p.slice(0);v.vec3_rotateAxisRadians(P,d,v),v.vec3_rotateAxisRadians(T,r,v),v.vec3_scale(h,v),this._addPhysX(v,i,e)}if(p.vec3_rotateAxisRadians(s/2,d,p),n.length<t){let h=Math.random()*(l-o)+o,P=(Math.random()*2-1)*(c-m)+m,T=(Math.random()*2-1)*(c-m)+m,v=p.slice(0);v.vec3_rotateAxisRadians(P,d,v),v.vec3_rotateAxisRadians(T,r,v),v.vec3_scale(h,v),this._addPhysX(v,i,e)}p.vec3_rotateAxisRadians(s/2,d,p)}y.vec3_rotateAxisRadians(s,r,y)}},_addPhysX(i,e,t){let n=i,a=Math.pp_random(1,10),s=Math.pp_randomPick(WL.Shape.Sphere,WL.Shape.Box);this._myUseConvexMesh&&(s=WL.Shape.ConvexMesh,a*=this._myShapeScaleMultiplier);let o=WL.scene.addObject(this._myRootObject);o.pp_setPosition(n);let l=o.pp_addComponent("physx",{shape:s,shapeData:{index:this._myShapeIndex},extents:PP.vec3_create(a,a,a),static:e,kinematic:!t,mass:1});e?(this._myStaticPhysXObjects.push(o),this._myStaticPhysXComponents.push(l),this._myStaticPhysXCollectors.push(new PP.PhysicsCollisionCollector(l))):t?(this._myDynamicPhysXObjects.push(o),this._myDynamicPhysXComponents.push(l),this._myDynamicPhysXCollectors.push(new PP.PhysicsCollisionCollector(l))):(this._myKinematicPhysXObjects.push(o),this._myKinematicPhysXComponents.push(l),this._myKinematicPhysXCollectors.push(new PP.PhysicsCollisionCollector(l)))}})});var yn=S(()=>{WL.registerComponent("pp-benchmark-max-visible-triangles",{_myTargetFrameRate:{type:WL.Type.Int,default:-1},_myTargetFrameRateThreshold:{type:WL.Type.Int,default:3},_myStartPlaneCount:{type:WL.Type.Int,default:1},_myPlaneTriangles:{type:WL.Type.Int,default:100},_mySecondsBeforeDoubling:{type:WL.Type.Float,default:.5},_myDTHistoryToIgnorePercentage:{type:WL.Type.Float,default:.25},_myCloneMaterial:{type:WL.Type.Bool,default:!1},_myCloneMesh:{type:WL.Type.Bool,default:!1},_myEnableLog:{type:WL.Type.Bool,default:!0},_myPlaneMaterial:{type:WL.Type.Material},_myBackgroundMaterial:{type:WL.Type.Material},_myTextMaterial:{type:WL.Type.Material,default:null}},{_start(){this._myBackgroundSize=4,this._myBackgroundObject.pp_setActive(!0),this._myBackgroundObject.pp_setScale(this._myBackgroundSize+.1),this._myBackgroundObject.pp_translate(PP.vec3_create(0,0,-.001)),this._myDoubleTimer=new PP.Timer(this._mySecondsBeforeDoubling),this._myIsDone=!1,this._myCurrentPlanes=this._myStartPlaneCount,this._myDTHistory=[],this._myUpperLimit=-1,this._myLowerLimit=0,this._myPlanes=[],this._mySkipNextFrames=0,this._myMaxWaitFrames=0,this._myMaxPlanesReached=!1,this._myFirstTime=!0},_update(i){{if(i<1e-5)return;if(i>.5&&this._myMaxWaitFrames>0){this._myMaxWaitFrames--;return}if(this._myMaxWaitFrames=10,this._mySkipNextFrames>0){this._mySkipNextFrames--;return}}if(!this._myIsDone&&(this._myDoubleTimer.update(i),this._myDTHistory.push(i),this._myDoubleTimer.isDone())){this._myDoubleTimer.start();let e=this._computeAverageFrameRate(!1);if(this._myFirstTime)this._myFirstTime=!1;else{let t=!1;e<this._myStableFrameRate-this._myTargetFrameRateThreshold?(this._myUpperLimit=this._myCurrentPlanes,t=!0,this._myUpperLimit==1&&(this._myLowerLimit=1)):(this._myLowerLimit=this._myCurrentPlanes,this._myUpperLimit>0&&(this._myUpperLimit=Math.max(this._myUpperLimit,this._myLowerLimit))),this._myTriangleTextComponent.text="Triangles: "+this._myCurrentPlanes*this._myRealTrianglesAmount,this._myPlaneTextComponent.text="Planes: "+this._myCurrentPlanes,this._myFPSTextComponent.text="FPS: "+e+" / "+this._myStableFrameRate,t?(this._myTriangleTextComponent.material.color=this._myLagColor,this._myPlaneTextComponent.material.color=this._myLagColor,this._myFPSTextComponent.material.color=this._myLagColor):(this._myTriangleTextComponent.material.color=this._myNormalColor,this._myPlaneTextComponent.material.color=this._myNormalColor,this._myFPSTextComponent.material.color=this._myNormalColor);let n=!1;(this._myUpperLimit>0&&!t&&this._myUpperLimit-this._myLowerLimit<=Math.max(2,1e3/this._myRealTrianglesAmount)||t&&this._myUpperLimit-this._myLowerLimit<=1||!t&&this._myMaxPlanesReached)&&(e<this._myStableFrameRate-this._myTargetFrameRateThreshold?(this._myLowerLimit=Math.max(1,Math.floor(this._myUpperLimit/2.5)),this._myUpperLimit=0,n=!0,this._myEnableLog&&console.log("Rst - Triangles:",this._myCurrentPlanes*this._myRealTrianglesAmount,"- Planes:",this._myCurrentPlanes,"- Frame Rate:",e)):(this._myMaxPlanesReached?this._myEnableLog&&(console.log("Aborted - Max Planes Reached"),this._myDoneTextComponent.text="Aborted - Max Planes Reached"):(this._displayPlanes(this._myLowerLimit),this._myEnableLog&&(console.log(`
End - Triangles:`,this._myLowerLimit*this._myRealTrianglesAmount,"- Planes:",this._myLowerLimit,"- Frame Rate:",e),console.log("Plane Triangles (Adjusted):",this._myRealTrianglesAmount),console.log("Target Frame Rate:",this._myStableFrameRate,"- Threshold: ",this._myStableFrameRate-this._myTargetFrameRateThreshold)),this._myTriangleTextComponent.text="Triangles: "+this._myLowerLimit*this._myRealTrianglesAmount,this._myPlaneTextComponent.text="Planes: "+this._myLowerLimit,this._myFPSTextComponent.text="FPS: "+e+" / "+this._myStableFrameRate,this._myDoneTextComponent.text="End"),this._myIsDone=!0)),t&&!n&&this._myEnableLog&&console.log("Lag - Triangles:",this._myCurrentPlanes*this._myRealTrianglesAmount,"- Planes:",this._myCurrentPlanes,"- Frame Rate:",e),this._myIsDone||(this._myUpperLimit>0?(this._myCurrentPlanes=Math.floor((this._myUpperLimit+this._myLowerLimit)/2),this._myCurrentPlanes=Math.max(this._myCurrentPlanes,1)):n?this._myCurrentPlanes=this._myLowerLimit:this._myCurrentPlanes=this._myLowerLimit*2,this._myCurrentPlanes>5e4?(this._myCurrentPlanes=5e4,this._myMaxPlanesReached=!0):this._myMaxPlanesReached=!1)}this._myIsDone||(this._displayPlanes(this._myCurrentPlanes),this._myElapsedTime=0,this._myFrameCount=0,this._mySkipNextFrames=30)}},_displayPlanes(i){for(;this._myPlanes.length>i;){let o=this._myPlanes.pop();this._myPlanePool.release(o)}for(;this._myPlanes.length<i;){let o=this._myPlanePool.get();this._myPlanes.push(o)}let e=1;for(;e*e<i;)e++;let t=.01,n=t*(e-1),a=(this._myBackgroundSize*2-n)/(e*2),s=i;for(let o=0;o<e&&s>0;o++)for(let l=0;l<e&&s>0;l++){let m=this._myPlanes[s-1];m.pp_setScale(a);let c=[-this._myBackgroundSize+a+l*a*2+l*t,this._myBackgroundSize-a-o*a*2-o*t,0];m.pp_setPositionLocal(c),m.pp_setActive(!0),s--}},start(){this._myLagColor=PP.vec4_create(.5,0,0,1),this._myNormalColor=PP.vec4_create(0,0,0,1),this._myRealTrianglesAmount=0,this._myTrianglesObject=WL.scene.addObject(this.object),this._myBackgroundObject=WL.scene.addObject(this._myTrianglesObject);{let e=this._myBackgroundObject.addComponent("mesh");e.mesh=PP.MeshUtils.createPlaneMesh(),e.material=this._myBackgroundMaterial.clone()}this._myPlaneObject=WL.scene.addObject(this._myTrianglesObject);{let e=this._myPlaneObject.addComponent("mesh");e.mesh=this._createPlaneMesh(this._myPlaneTriangles),this._myRealTrianglesAmount=e.mesh.indexData.length/3,e.material=this._myPlaneMaterial.clone()}let i=new PP.ObjectPoolParams;this._myCloneMesh?this._myRealTrianglesAmount<=4?i.myInitialPoolSize=15e3:this._myRealTrianglesAmount<=8?i.myInitialPoolSize=1e4:this._myRealTrianglesAmount<=64?i.myInitialPoolSize=7500:i.myInitialPoolSize=5e3:i.myInitialPoolSize=3e4,i.myPercentageToAddWhenEmpty=0,i.myAmountToAddWhenEmpty=1e4,i.myCloneParams=new PP.CloneParams,i.myCloneParams.myDeepCloneParams.setDeepCloneComponentVariable("mesh","material",this._myCloneMaterial),i.myCloneParams.myDeepCloneParams.setDeepCloneComponentVariable("mesh","mesh",this._myCloneMesh),this._myPlanePool=new PP.ObjectPool(this._myPlaneObject,i),this._myBackgroundObject.pp_setActive(!1),this._myPlaneObject.pp_setActive(!1),this._myStartTimer=new PP.Timer(this._mySecondsBeforeDoubling*2),this._mySessionStarted=!1,this._myTextsObject=WL.scene.addObject(this._myTrianglesObject),this._myTriangleTextObject=WL.scene.addObject(this._myTextsObject),this._myTriangleTextComponent=this._myTriangleTextObject.addComponent("text"),this._myTriangleTextComponent.alignment=WL.Alignment.Left,this._myTriangleTextComponent.justification=WL.Justification.Line,this._myTriangleTextComponent.material=this._myTextMaterial.clone(),this._myTriangleTextComponent.material.color=this._myNormalColor,this._myTriangleTextComponent.text=" ",this._myPlaneTextObject=WL.scene.addObject(this._myTextsObject),this._myPlaneTextComponent=this._myPlaneTextObject.addComponent("text"),this._myPlaneTextComponent.alignment=WL.Alignment.Left,this._myPlaneTextComponent.justification=WL.Justification.Line,this._myPlaneTextComponent.material=this._myTextMaterial.clone(),this._myPlaneTextComponent.material.color=this._myNormalColor,this._myPlaneTextComponent.text=" ",this._myFPSTextObject=WL.scene.addObject(this._myTextsObject),this._myFPSTextComponent=this._myFPSTextObject.addComponent("text"),this._myFPSTextComponent.alignment=WL.Alignment.Left,this._myFPSTextComponent.justification=WL.Justification.Line,this._myFPSTextComponent.material=this._myTextMaterial.clone(),this._myFPSTextComponent.material.color=this._myNormalColor,this._myFPSTextComponent.text=" ",this._myDoneTextObject=WL.scene.addObject(this._myTrianglesObject),this._myDoneTextComponent=this._myDoneTextObject.addComponent("text"),this._myDoneTextComponent.alignment=WL.Alignment.Center,this._myDoneTextComponent.justification=WL.Justification.Line,this._myDoneTextComponent.material=this._myTextMaterial.clone(),this._myDoneTextComponent.material.color=this._myNormalColor,this._myDoneTextComponent.text=" ",this._myTextsObject.pp_setPositionLocal(PP.vec3_create(0,4.3,0)),this._myTextsObject.pp_setScale(2.75),this._myTriangleTextObject.pp_setPositionLocal(PP.vec3_create(-1.4,0,0)),this._myPlaneTextObject.pp_setPositionLocal(PP.vec3_create(.55,0,0)),this._myFPSTextObject.pp_setPositionLocal(PP.vec3_create(-.315,0,0)),this._myDoneTextObject.pp_setPositionLocal(PP.vec3_create(0,-4.6,0)),this._myDoneTextObject.pp_setScale(4),this._myDTHistory=[]},update(i){this._mySessionStarted?this._myStartTimer.isRunning()?(this._myStartTimer.update(i),this._myDTHistory.push(i),this._myStartTimer.isDone()&&(this._myStableFrameRate=this._computeAverageFrameRate(!0),this._myTargetFrameRate>0&&(this._myStableFrameRate=this._myTargetFrameRate),this._myEnableLog&&(console.log(`
Plane Triangles (Adjusted):`,this._myRealTrianglesAmount),console.log("Target Frame Rate:",this._myStableFrameRate,"- Threshold: ",this._myStableFrameRate-this._myTargetFrameRateThreshold),console.log("")),this._start())):this._update(i):this._mySessionStarted=WL.xrSession!=null},_computeAverageFrameRate(i){let e=0;this._myDTHistory.sort();let t=Math.floor(this._myDTHistory.length)*Math.min(.9,this._myDTHistoryToIgnorePercentage*(i?2:1));for(let a=0;a<t;a++)this._myDTHistory.pop();let n=0;for(let a of this._myDTHistory)n+=a;return n/=this._myDTHistory.length,e=Math.round(1/n),this._myDTHistory=[],e},_createPlaneMesh(i){let e=Math.ceil(i/2),t=1,n=1,a=1;for(;a*a<e;)a++;for(t=a,n=a;t>1&&n>1&&t*n>e&&(t-1)*n>=e;)t--;let s=new PP.MeshCreationParams;for(let l=0;l<t+1;l++)for(let m=0;m<n+1;m++){let c=2/n*m,r=2/t*l,y=new PP.MeshCreationVertexParams;y.myPosition=new PP.vec3_create,y.myPosition[0]=c-1,y.myPosition[1]=r-1,y.myPosition[2]=0,y.myTextureCoordinates=new PP.vec2_create,y.myTextureCoordinates[0]=c/2,y.myTextureCoordinates[1]=r/2,y.myNormal=new PP.vec3_create,y.myNormal[0]=0,y.myNormal[1]=0,y.myNormal[2]=1,s.myVertexes.push(y)}for(let l=0;l<t;l++)for(let m=0;m<n;m++){let c=new PP.MeshCreationTriangleParams;c.myIndexes[0]=l*(n+1)+m,c.myIndexes[1]=l*(n+1)+m+1,c.myIndexes[2]=(l+1)*(n+1)+m;let r=new PP.MeshCreationTriangleParams;r.myIndexes[0]=(l+1)*(n+1)+m,r.myIndexes[1]=l*(n+1)+m+1,r.myIndexes[2]=(l+1)*(n+1)+m+1,s.myTriangles.push(c),s.myTriangles.push(r)}return PP.MeshUtils.createMesh(s)}})});var cn=S(()=>{PP.ObjectPoolManager=class{constructor(){this._myPools=new Map}addPool(e,t,n=new PP.ObjectPoolParams){if(this._myPools.has(e))console.error("Pool already created with this ID");else{let a=new PP.ObjectPool(t,n);this._myPools.set(e,a)}}increasePool(e,t){let n=this._myPools.get(e);n&&n.increase(t)}increasePoolPercentage(e,t){let n=this._myPools.get(e);n&&n.increasePercentage(t)}getPool(e){return this._myPools.get(e)}hasPool(e){return this._myPools.has(e)}getObject(e){return this._myPools.has(e)?this._myPools.get(e).get():null}releaseObject(e,t){this._myPools.get(e).release(t)}};PP.ObjectPoolParams=class{constructor(){this.myInitialPoolSize=0,this.myAmountToAddWhenEmpty=0,this.myPercentageToAddWhenEmpty=0,this.myCloneParams=void 0,this.myOptimizeObjectsAllocation=!0,this.myCloneCallback=void 0,this.mySetActiveCallback=void 0,this.myEqualCallback=void 0,this.myOptimizeObjectsAllocationCallback=void 0,this.myEnableDebugLog=!0}};PP.ObjectPool=class{constructor(e,t){this._myObjectPoolParams=t,this._myPrototype=this._clone(e),this._myAvailableObjects=[],this._myBusyObjects=[],this._addToPool(t.myInitialPoolSize,!1)}get(){let e=this._myAvailableObjects.shift();if(e==null){let t=Math.ceil(this._myBusyObjects.length*this._myObjectPoolParams.myPercentageToAddWhenEmpty);t+=this._myObjectPoolParams.myAmountToAddWhenEmpty,this._addToPool(t,this._myObjectPoolParams.myEnableDebugLog),e=this._myAvailableObjects.shift()}return e!=null&&this._myBusyObjects.push(e),e}release(e){let t=this._myBusyObjects.pp_remove(this._equals.bind(this,e));t&&(this._setActive(t,!1),this._myAvailableObjects.push(t))}increase(e){this._addToPool(e,!1)}increasePercentage(e){let t=Math.ceil(this.getSize()*e);this._addToPool(t,!1)}getSize(){return this._myBusyObjects.length+this._myAvailableObjects.length}getAvailableSize(){return this._myAvailableObjects.length}getBusySize(){return this._myAvailableObjects.length}_addToPool(e,t){if(!(e<=0)){this._myObjectPoolParams.myOptimizeObjectsAllocation&&(this._myObjectPoolParams.myOptimizeObjectsAllocationCallback?this._myObjectPoolParams.myOptimizeObjectsAllocationCallback(this._myPrototype,e):this._myPrototype.pp_reserveObjectsHierarchy!=null&&this._myPrototype.pp_reserveObjectsHierarchy(e));for(let n=0;n<e;n++)this._myAvailableObjects.push(this._clone(this._myPrototype));t&&console.warn("Added new elements to the pool:",e)}}_clone(e){let t=null;return this._myObjectPoolParams.myCloneCallback!=null?t=this._myObjectPoolParams.myCloneCallback(e,this._myObjectPoolParams.myCloneParams):e.pp_clone!=null?t=e.pp_clone(this._myObjectPoolParams.myCloneParams):e.clone!=null&&(t=e.clone(this._myObjectPoolParams.myCloneParams)),t==null?console.error("Object not cloneable, pool will return null"):this._setActive(t,!1),t}_setActive(e,t){this._myObjectPoolParams.mySetActiveCallback!=null?this._myObjectPoolParams.mySetActiveCallback(e,t):e.pp_setActive!=null?e.pp_setActive(t):e.setActive!=null&&e.setActive(t)}_equals(e,t){let n=!1;return this._myObjectPoolParams.myEqualCallback!=null?n=this._myObjectPoolParams.myEqualCallback(e,t):e.pp_equals!=null?n=e.pp_equals(t):e.equals!=null?n=e.equals(t):n=e==t,n}}});var un=S(()=>{PP.SaveManager=class{constructor(){this._mySaveCache=new Map,this._myCacheEnabled=!0,this._myCommitSavesDelayTimer=new PP.Timer(0,!1),this._myDelaySavesCommit=!0,this._myIDsToCommit=[],this._myCacheDefaultValueOnFail=!0,WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this)),this._myClearCallbacks=new Map,this._myDeleteCallbacks=new Map,this._myDeleteIDCallbacks=new Map,this._mySaveCallbacks=new Map,this._mySaveValueChangedCallbacks=new Map,this._mySaveIDCallbacks=new Map,this._mySaveValueChangedIDCallbacks=new Map,this._myCommitSaveCallbacks=new Map,this._myCommitSaveIDCallbacks=new Map,this._myCommitSavesCallbacks=new Map,this._myLoadCallbacks=new Map,this._myLoadIDCallbacks=new Map}setCommitSavesDelay(e){this._myCommitSavesDelayTimer.start(e)}setDelaySavesCommit(e){this._myDelaySavesCommit=e}setCacheDefaultValueOnFail(e){this._myCacheDefaultValueOnFail=e}setCacheEnabled(e){this._myCacheEnabled=e}update(e){this._myCommitSavesDelayTimer.isRunning()&&(this._myCommitSavesDelayTimer.update(e),this._myCommitSavesDelayTimer.isDone()&&this.commitSaves())}save(e,t,n=null,a=null){let s=!1;if(this._mySaveCache.has(e)&&this._isCacheEnabled(a)&&(s=this._mySaveCache.get(e)===t),!s)if(this._mySaveCache.set(e,t),this._myDelaySavesCommit&&n==null||n!=null&&n)this._myIDsToCommit.pp_pushUnique(e),this._myCommitSavesDelayTimer.isRunning()||this._myCommitSavesDelayTimer.start();else{let o=this._commitSave(e,!1);if(this._myCommitSavesCallbacks.size>0){let l=!1;this._myCommitSavesCallbacks.forEach(function(m){m(l,o)})}}if(this._mySaveCallbacks.size>0&&this._mySaveCallbacks.forEach(function(o){o(e,t)}),this._mySaveIDCallbacks.size>0){let o=this._mySaveIDCallbacks.get(e);o?.forEach(function(l){l(e,t)})}if(!s&&(this._mySaveValueChangedCallbacks.size>0&&this._mySaveValueChangedCallbacks.forEach(function(o){o(e,t)}),this._mySaveValueChangedIDCallbacks.size>0)){let o=this._mySaveValueChangedIDCallbacks.get(e);o?.forEach(function(l){l(e,t)})}}commitSaves(){if(this._myIDsToCommit.length>0){let e=!1;for(let t of this._myIDsToCommit)if(this._mySaveCache.has(t)){let n=this._commitSave(t,!0);e=e||n}if(this._myIDsToCommit=[],this._myCommitSavesCallbacks.size>0){let t=!0;this._myCommitSavesCallbacks.forEach(function(n){n(t,e)})}}}has(e,t=null){return this._mySaveCache.has(e)&&this._isCacheEnabled(t)||PP.SaveUtils.has(e)}delete(e){if(this._mySaveCache.delete(e),PP.SaveUtils.delete(e),this._myDeleteCallbacks.size>0&&this._myDeleteCallbacks.forEach(function(t){t(e)}),this._myDeleteIDCallbacks.size>0){let t=this._myDeleteIDCallbacks.get(e);t?.forEach(function(n){n(e)})}}clear(){this._mySaveCache.clear(),PP.SaveUtils.clear(),this._myClearCallbacks.size>0&&this._myClearCallbacks.forEach(function(e){e()})}load(e,t=null,n=null){return this._load(e,t,"load",n)}loadString(e,t=null,n=null){return this._load(e,t,"loadString",n)}loadNumber(e,t=null,n=null){return this._load(e,t,"loadNumber",n)}loadBool(e,t=null,n=null){return this._load(e,t,"loadBool",n)}getCommitSavesDelay(){return this._myCommitSavesDelayTimer.getDuration()}isDelaySavesCommit(){return this._myDelaySavesCommit}isCacheDefaultValueOnFail(){return this._myCacheDefaultValueOnFail}isCacheEnabled(){return this._myCacheEnabled}_commitSave(e,t){let n=this._mySaveCache.get(e),a=!1;try{PP.SaveUtils.save(e,n)}catch{a=!0}if(this._myCommitSaveCallbacks.size>0&&this._myCommitSaveCallbacks.forEach(function(s){s(e,n,t,a)}),this._myCommitSaveIDCallbacks.size>0){let s=this._myCommitSaveIDCallbacks.get(e);s?.forEach(function(o){o(e,n,t,a)})}return a}_load(e,t,n,a=null){let s=null,o=!1,l=!1;if(this._mySaveCache.has(e)&&this._isCacheEnabled(a))s=this._mySaveCache.get(e),s==null&&t!=null&&(s=t,this._myCacheDefaultValueOnFail&&this._mySaveCache.set(e,s)),l=!0;else{let m=null;try{m=PP.SaveUtils[n](e,null)}catch{m=null,o=!0}m==null?s=t:s=m,m!=null||this._myCacheDefaultValueOnFail?this._mySaveCache.set(e,s):this._mySaveCache.set(e,null)}if(this._myLoadCallbacks.size>0&&this._myLoadCallbacks.forEach(function(m){m(e,s,l,o)}),this._myLoadIDCallbacks.size>0){let m=this._myLoadIDCallbacks.get(e);m?.forEach(function(c){c(e,s,l,o)})}return s}_onXRSessionStart(e){e.addEventListener("visibilitychange",function(t){t.session.visibilityState!="visible"&&this._onXRSessionInterrupt()}.bind(this))}_onXRSessionEnd(){this._onXRSessionInterrupt()}_onXRSessionInterrupt(){this.commitSaves()}registerClearEventListener(e,t){this._myClearCallbacks.set(e,t)}unregisterClearEventListener(e){this._myClearCallbacks.delete(e)}registerDeleteEventListener(e,t){this._myDeleteCallbacks.set(e,t)}unregisterDeleteEventListener(e){this._myDeleteCallbacks.delete(e)}registerDeleteIDEventListener(e,t,n){let a=this._myDeleteIDCallbacks.get(e);a==null&&(this._myDeleteIDCallbacks.set(e,new Map),a=this._myDeleteIDCallbacks.get(e)),a.set(t,n)}unregisterDeleteIDEventListener(e,t){let n=this._myDeleteIDCallbacks.get(e);n!=null&&(n.delete(t),n.size<=0&&this._myDeleteIDCallbacks.delete(e))}registerSaveEventListener(e,t){this._mySaveCallbacks.set(e,t)}unregisterSaveEventListener(e){this._mySaveCallbacks.delete(e)}registerSaveIDEventListener(e,t,n){let a=this._mySaveIDCallbacks.get(e);a==null&&(this._mySaveIDCallbacks.set(e,new Map),a=this._mySaveIDCallbacks.get(e)),a.set(t,n)}unregisterSaveIDEventListener(e,t){let n=this._mySaveIDCallbacks.get(e);n!=null&&(n.delete(t),n.size<=0&&this._mySaveIDCallbacks.delete(e))}registerSaveValueChangedEventListener(e,t){this._mySaveValueChangedCallbacks.set(e,t)}unregisterSaveValueChangedEventListener(e){this._mySaveValueChangedCallbacks.delete(e)}registerSaveValueChangedIDEventListener(e,t,n){let a=this._mySaveValueChangedIDCallbacks.get(e);a==null&&(this._mySaveValueChangedIDCallbacks.set(e,new Map),a=this._mySaveValueChangedIDCallbacks.get(e)),a.set(t,n)}unregisterSaveValueChangedIDEventListener(e,t){let n=this._mySaveValueChangedIDCallbacks.get(e);n!=null&&(n.delete(t),n.size<=0&&this._mySaveValueChangedIDCallbacks.delete(e))}registerCommitSavesEventListener(e,t){this._myCommitSavesCallbacks.set(e,t)}unregisterCommitSavesEventListener(e){this._myCommitSavesCallbacks.delete(e)}registerCommitSaveEventListener(e,t){this._myCommitSaveCallbacks.set(e,t)}unregisterCommitSaveEventListener(e){this._myCommitSaveCallbacks.delete(e)}registerCommitSaveIDEventListener(e,t,n){let a=this._myCommitSaveIDCallbacks.get(e);a==null&&(this._myCommitSaveIDCallbacks.set(e,new Map),a=this._myCommitSaveIDCallbacks.get(e)),a.set(t,n)}unregisterCommitSaveIDEventListener(e,t){let n=this._myCommitSaveIDCallbacks.get(e);n!=null&&(n.delete(t),n.size<=0&&this._myCommitSaveIDCallbacks.delete(e))}registerLoadEventListener(e,t){this._myLoadCallbacks.set(e,t)}unregisterLoadEventListener(e){this._myLoadCallbacks.delete(e)}registerLoadIDEventListener(e,t,n){let a=this._myLoadIDCallbacks.get(e);a==null&&(this._myLoadIDCallbacks.set(e,new Map),a=this._myLoadIDCallbacks.get(e)),a.set(t,n)}unregisterLoadIDEventListener(e,t){let n=this._myLoadIDCallbacks.get(e);n!=null&&(n.delete(t),n.size<=0&&this._myLoadIDCallbacks.delete(e))}_isCacheEnabled(e=null){return this._myCacheEnabled&&e==null||e!=null&&e}}});var hn=S(()=>{PP.Timer=class{constructor(e,t=!0){this._myDuration=e,this._myOnEndCallbacks=new Map,this._myDone=!1,this._myJustDone=!1,this._myStarted=!1,t?this.start():this.reset()}start(e=null){this.reset(e),this._myStarted=!0}end(){this._done()}reset(e=null){e!=null&&(this._myDuration=Math.max(0,e)),this._myTimeLeft=this._myDuration,this._myDone=!1,this._myJustDone=!1,this._myStarted=!1}update(e){this._myJustDone=!1,this.isRunning()&&(this._myTimeLeft=Math.max(0,this._myTimeLeft-e),this._myTimeLeft==0&&this._done())}isDone(){return this._myDone}isJustDone(){return this._myJustDone}isStarted(){return this._myStarted}isRunning(){return this.isStarted()&&!this.isDone()}getDuration(){return this._myDuration}setDuration(e){this._myDuration=Math.max(0,e)}getTimeLeft(){return this._myTimeLeft}getPercentage(){let e=1;return this._myTimeLeft>0&&this._myDuration>0&&(e=(this._myDuration-this._myTimeLeft)/this._myDuration),Math.pp_clamp(e,0,1)}setPercentage(e){if(this.isRunning()){let t=Math.pp_clamp(1-e,0,1);this._myTimeLeft=this._myDuration*t}}onEnd(e,t=null){this._myOnEndCallbacks.set(t,e)}unregisterOnEnd(e=null){this._myOnEndCallbacks.delete(e)}_done(){if(this._myTimeLeft=0,this._myDone=!0,this._myJustDone=!0,this._myOnEndCallbacks.size>0)for(let e of this._myOnEndCallbacks.values())e()}}});var pn=S(()=>{WL.registerComponent("pp-clear-console-on-xr-session-start",{},{init:function(){},start:function(){this._myFirstTime=!0,WL.onXRSessionStart.push(function(){this._myFirstTime&&(this._myFirstTime=!1,console.clear())}.bind(this))},update:function(i){}})});var dn=S(()=>{WL.registerComponent("pp-set-active",{_myActive:{type:WL.Type.Bool,default:!0},_mySetActiveOn:{type:WL.Type.Enum,values:["self","children","descendants","hierarchy"],default:"hierarchy"},_mySetActiveWhen:{type:WL.Type.Enum,values:["init","start","first_update"],default:"init"}},{init:function(){this.active&&this._mySetActiveWhen==0&&this._setActive()},start:function(){this._mySetActiveWhen==1&&this._setActive(),this._myFirst=!0},update:function(i){this._mySetActiveWhen==2&&this._myFirst&&(this._myFirst=!1,this._setActive())},_setActive(){this._mySetActiveOn==0?this.object.pp_setActiveSelf(this._myActive):this._mySetActiveOn==1?this.object.pp_setActiveChildren(this._myActive):this._mySetActiveOn==2?this.object.pp_setActiveDescendants(this._myActive):this.object.pp_setActiveHierarchy(this._myActive)}})});var _n=S(()=>{WL.registerComponent("pp-adjust-hierarchy-physx-scale",{_myWhen:{type:WL.Type.Enum,values:["init","start","first_update"],default:"start"}},{init:function(){this.active&&this._myWhen==0&&this._adjustScale()},start:function(){this._myWhen==1&&this._adjustScale(),this._myFirst=!0},update:function(i){this._myWhen==2&&this._myFirst&&(this._myFirst=!1,this._adjustScale())},_adjustScale(){let i=this.object.pp_getScale(),e=this.object.pp_getComponentsHierarchy("physx");for(let t of e)t.extents[0]=t.extents[0]*i[0],t.extents[1]=t.extents[1]*i[1],t.extents[2]=t.extents[2]*i[2],t.active&&(t.active=!1,t.active=!0)}})});var Pn=S(()=>{WL.registerComponent("pp-get-player-objects",{_myPlayer:{type:WL.Type.Object},_myPlayerPivot:{type:WL.Type.Object},_myNonVRCamera:{type:WL.Type.Object},_myEyeLeft:{type:WL.Type.Object},_myEyeRight:{type:WL.Type.Object},_myHead:{type:WL.Type.Object},_myNonVRHead:{type:WL.Type.Object},_myVRHead:{type:WL.Type.Object},_myHandLeft:{type:WL.Type.Object},_myHandRight:{type:WL.Type.Object}},{init:function(){PP.myPlayerObjects.myPlayer=this._myPlayer,PP.myPlayerObjects.myPlayerPivot=this._myPlayerPivot,PP.myPlayerObjects.myNonVRCamera=this._myNonVRCamera,PP.myPlayerObjects.myHead=this._myHead,PP.myPlayerObjects.myNonVRHead=this._myNonVRHead,PP.myPlayerObjects.myVRHead=this._myVRHead,PP.myPlayerObjects.myEyeLeft=this._myEyeLeft,PP.myPlayerObjects.myEyeRight=this._myEyeRight,PP.myPlayerObjects.myHandLeft=this._myHandLeft,PP.myPlayerObjects.myHandRight=this._myHandRight,PP.myPlayerObjects.myEyes=[],PP.myPlayerObjects.myEyes[PP.Handedness.LEFT]=this._myEyeLeft,PP.myPlayerObjects.myEyes[PP.Handedness.RIGHT]=this._myEyeRight,PP.myPlayerObjects.myHands=[],PP.myPlayerObjects.myHands[PP.Handedness.LEFT]=this._myHandLeft,PP.myPlayerObjects.myHands[PP.Handedness.RIGHT]=this._myHandRight,PP.myPlayerObjects.myPlayerPivot==null&&(PP.myPlayerObjects.myPlayerPivot=PP.myPlayerObjects.myPlayer)}});PP.myPlayerObjects={myPlayer:null,myPlayerPivot:null,myNonVRCamera:null,myNonVRHead:null,myVRHead:null,myHead:null,myEyeLeft:null,myEyeRight:null,myEyes:[],myHandLeft:null,myHandRight:null,myHands:[]}});var gn=S(()=>{WL.registerComponent("pp-get-default-resources",{_myPlane:{type:WL.Type.Mesh},_myCube:{type:WL.Type.Mesh},_mySphere:{type:WL.Type.Mesh},_myCone:{type:WL.Type.Mesh},_myCylinder:{type:WL.Type.Mesh},_myCircle:{type:WL.Type.Mesh},_myFlatOpaque:{type:WL.Type.Material},_myFlatTransparentNoDepth:{type:WL.Type.Material},_myPhongOpaque:{type:WL.Type.Material},_myText:{type:WL.Type.Material}},{init(){PP.myDefaultResources.myMeshes.myPlane=PP.MeshUtils.cloneMesh(this._myPlane),PP.myDefaultResources.myMeshes.myCube=PP.MeshUtils.cloneMesh(this._myCube),PP.myDefaultResources.myMeshes.mySphere=PP.MeshUtils.cloneMesh(this._mySphere),PP.myDefaultResources.myMeshes.myCone=PP.MeshUtils.cloneMesh(this._myCone),PP.myDefaultResources.myMeshes.myCylinder=PP.MeshUtils.cloneMesh(this._myCylinder),PP.myDefaultResources.myMeshes.myCircle=PP.MeshUtils.cloneMesh(this._myCircle),PP.myDefaultResources.myMeshes.myInvertedCube=PP.MeshUtils.invertMesh(this._myCube),PP.myDefaultResources.myMeshes.myInvertedSphere=PP.MeshUtils.invertMesh(this._mySphere),PP.myDefaultResources.myMeshes.myInvertedCone=PP.MeshUtils.invertMesh(this._myCone),PP.myDefaultResources.myMeshes.myInvertedCylinder=PP.MeshUtils.invertMesh(this._myCylinder),this._myFlatOpaque!=null&&(PP.myDefaultResources.myMaterials.myFlatOpaque=this._myFlatOpaque.clone()),this._myFlatTransparentNoDepth!=null&&(PP.myDefaultResources.myMaterials.myFlatTransparentNoDepth=this._myFlatTransparentNoDepth.clone()),this._myPhongOpaque!=null&&(PP.myDefaultResources.myMaterials.myPhongOpaque=this._myPhongOpaque.clone()),this._myText!=null&&(PP.myDefaultResources.myMaterials.myText=this._myText.clone())}});PP.myDefaultResources={myMeshes:{myPlane:null,myCube:null,mySphere:null,myCone:null,myCylinder:null,myCircle:null,myInvertedCube:null,myInvertedSphere:null,myInvertedCone:null,myInvertedCylinder:null},myMaterials:{myFlatOpaque:null,myFlatTransparentNoDepth:null,myPhongOpaque:null,myText:null}}});var fn=S(()=>{WL.registerComponent("pp-show-fps",{_myRefreshSeconds:{type:WL.Type.Float,default:.25},_myTextMaterial:{type:WL.Type.Material}},{init:function(){},start(){this._myTimer=new PP.Timer(this._myRefreshSeconds),this._myTotalDT=0,this._myFrames=0,this._myVisualFPSParent=this.object.pp_addObject();let i=new PP.VisualTextParams;i.myText="00",i.myTransform.mat4_setPositionRotationScale(PP.vec3_create(-.115,-.115,.35),PP.vec3_create(0,180,0),PP.vec3_create(.3,.3,.3)),this._myTextMaterial!=null?i.myMaterial=this._myTextMaterial.clone():(i.myMaterial=PP.myDefaultResources.myMaterials.myText.clone(),i.myMaterial.color=PP.vec4_create(1,1,1,1)),i.myParent=this._myVisualFPSParent,i.myIsLocal=!0,this._myVisualFPS=new PP.VisualText(i)},update:function(){let i=PP.quat2_create();return function(t){if(this._myTotalDT+=t,this._myFrames++,this._myTimer.update(t),this._myTimer.isDone()){this._myTimer.start();let n=Math.round(this._myFrames/this._myTotalDT),a=this._myVisualFPS.getParams();PP.XRUtils.isSessionActive()?a.myTransform.mat4_setPositionRotationScale(PP.vec3_create(-.115,-.115,.35),PP.vec3_create(0,180,0),PP.vec3_create(.3,.3,.3)):a.myTransform.mat4_setPositionRotationScale(PP.vec3_create(-.25,-.13,.35),PP.vec3_create(0,180,0),PP.vec3_create(.3,.3,.3)),a.myText=n.toFixed(0),this._myVisualFPS.paramsUpdated(),this._myTotalDT=0,this._myFrames=0}this._myVisualFPSParent.pp_setTransformQuat(PP.myPlayerObjects.myHead.pp_getTransformQuat(i))}}()})});var vn=S(()=>{PP.StateData=class{constructor(e,t){this.myID=e,this.myObject=t}};PP.TransitionData=class{constructor(e,t,n,a,s){this.myID=e,this.myFromState=t,this.myToState=n,this.myObject=a,this.mySkipStateFunction=s}};PP.PendingPerform=class{constructor(e,...t){this.myID=e,this.myArgs=t}};PP.PerformMode={IMMEDIATE:0,DELAYED:1};PP.PerformDelayedMode={QUEUE:0,KEEP_FIRST:1,KEEP_LAST:2};PP.SkipStateFunction={NONE:0,END:1,START:2,BOTH:3};PP.FSM=class{constructor(e=PP.PerformMode.IMMEDIATE,t=PP.PerformDelayedMode.QUEUE){this._myCurrentStateData=null,this._myStates=new Map,this._myTransitions=new Map,this._myDebugLogActive=!1,this._myDebugShowDelayedInfo=!1,this._myDebugLogName="FSM",this._myPerformMode=e,this._myPerformDelayedMode=t,this._myPendingPerforms=[],this._myCurrentlyPerformedTransition=null,this._myInitCallbacks=new Map,this._myInitIDCallbacks=new Map,this._myTransitionCallbacks=new Map,this._myTransitionIDCallbacks=[]}addState(e,t=null){let n=null;!t||typeof t=="function"?(n={},typeof t=="function"?n.update=function(){return t(...arguments)}:n.update=null,n.clone=function(){let o={};return o.update=this.update,o.clone=this.clone,o}):n=t;let a=new PP.StateData(e,n);this._myStates.set(e,a),this._myTransitions.set(e,new Map)}addTransition(e,t,n,a=null,s=PP.SkipStateFunction.NONE){let o=null;if(!a||typeof a=="function"?(o={},typeof a=="function"?o.perform=function(){return a(...arguments)}:o.perform=null,o.clone=function(){let m={};return m.perform=this.perform,m.clone=this.clone,m}):o=a,this.hasState(e)&&this.hasState(t)){let l=this._getTransitionsFromState(e),m=new PP.TransitionData(n,this.getState(e),this.getState(t),o,s);l.set(n,m)}else!this.hasState(e)&&!this.hasState(t)?console.error("Can't add transition:",n,"- from state not found:",e,"- to state not found:",t):this.hasState(e)?this.hasState(t)||console.error("Can't add transition:",n,"- to state not found:",t):console.error("Can't add transition:",n,"- from state not found:",e)}init(e,t=null,...n){let a=t;if(t&&typeof t=="function"&&(a={},a.performInit=t),this.hasState(e)){let s=this._myStates.get(e);if(this._myDebugLogActive&&console.log(this._myDebugLogName,"- Init:",e),a&&a.performInit?a.performInit(this,s,...n):s.myObject&&s.myObject.init&&s.myObject.init(this,s,...n),this._myCurrentStateData=s,this._myInitCallbacks.size>0&&this._myInitCallbacks.forEach(function(o){o(this,s,a,...n)}.bind(this)),this._myInitIDCallbacks.size>0){let o=this._myInitIDCallbacks.get(e);o?.forEach(function(l){l(this,s,a,...n)}.bind(this))}}else this._myDebugLogActive&&console.warn(this._myDebugLogName,"- Init state not found:",e)}update(e,...t){if(this._myPendingPerforms.length>0){for(let n=0;n<this._myPendingPerforms.length;n++)this._perform(this._myPendingPerforms[n].myID,PP.PerformMode.DELAYED,...this._myPendingPerforms[n].myArgs);this._myPendingPerforms=[]}this._myCurrentStateData&&this._myCurrentStateData.myObject&&this._myCurrentStateData.myObject.update&&this._myCurrentStateData.myObject.update(e,this,...t)}perform(e,...t){this._myPerformMode==PP.PerformMode.DELAYED?this.performDelayed(e,...t):this.performImmediate(e,...t)}performDelayed(e,...t){let n=!1;switch(this._myPerformDelayedMode){case PP.PerformDelayedMode.QUEUE:this._myPendingPerforms.push(new PP.PendingPerform(e,...t)),n=!0;break;case PP.PerformDelayedMode.KEEP_FIRST:this.hasPendingPerforms()||(this._myPendingPerforms.push(new PP.PendingPerform(e,...t)),n=!0);break;case PP.PerformDelayedMode.KEEP_LAST:this.resetPendingPerforms(),this._myPendingPerforms.push(new PP.PendingPerform(e,...t)),n=!0;break}return n}performImmediate(e,...t){return this._perform(e,PP.PerformMode.IMMEDIATE,...t)}canPerform(e){return this.hasTransitionFromState(this._myCurrentStateData.myID,e)}canGoTo(e,t=null){return this.hasTransitionFromStateToState(this._myCurrentStateData.myID,e,t)}isInState(e){return this._myCurrentStateData!=null&&this._myCurrentStateData.myID==e}isPerformingTransition(){return this._myCurrentlyPerformedTransition!=null}getCurrentlyPerformedTransition(){return this._myCurrentlyPerformedTransition}hasBeenInit(){return this._myCurrentStateData!=null}reset(){this.resetState(),this.resetPendingPerforms()}resetState(){this._myCurrentStateData=null}resetPendingPerforms(){this._myPendingPerforms=[]}getCurrentState(){return this._myCurrentStateData}getCurrentTransitions(){return this.getTransitionsFromState(this._myCurrentStateData.myID)}getCurrentTransitionsToState(e){return this.getTransitionsFromStateToState(this._myCurrentStateData.myID,e)}getState(e){return this._myStates.get(e)}getStates(){return this._myStates.values()}getTransitions(){let e=[];for(let t of this._myTransitions.values())for(let n of t.values())e.push(n);return e}getTransitionsFromState(e){let t=this._getTransitionsFromState(e);return Array.from(t.values())}getTransitionsFromStateToState(e,t){let n=this._getTransitionsFromState(e),a=[];for(let s of n.values())s.myToState.myID==t&&a.push(s);return a}removeState(e){if(this.hasState(e)){this._myStates.delete(e),this._myTransitions.delete(e);for(let t of this._myTransitions.values()){let n=[];for(let[a,s]of t.entries())s.myToState.myID==e&&n.push(a);for(let a of n)t.delete(a)}return!0}return!1}removeTransitionFromState(e,t){let n=this._getTransitionsFromState(e);return n?n.delete(t):!1}hasState(e){return this._myStates.has(e)}hasTransitionFromState(e,t){return this.getTransitionsFromState(e).findIndex(function(s){return s.myID==t})>=0}hasTransitionFromStateToState(e,t,n=null){let a=this.getTransitionsFromStateToState(e,t),s=!1;return n?s=a.findIndex(function(l){return l.myID==n})>=0:s=a.length>0,s}setPerformMode(e){this._myPerformMode=e}getPerformMode(){return this._myPerformMode}setPerformDelayedMode(e){this._myPerformDelayedMode=e}getPerformDelayedMode(){return this._myPerformDelayedMode}hasPendingPerforms(){return this._myPendingPerforms.length>0}getPendingPerforms(){return this._myPendingPerforms.slice(0)}clone(e=!1){if(!this.isCloneable(e))return null;let t=new PP.FSM;t._myDebugLogActive=this._myDebugLogActive,t._myDebugShowDelayedInfo=this._myDebugShowDelayedInfo,t._myDebugLogName=this._myDebugLogName.slice(0),t._myPerformMode=this._myPerformMode,t._myPerformDelayedMode=this._myPerformDelayedMode,t._myPendingPerforms=this._myPendingPerforms.slice(0);for(let n of this._myStates.entries()){let a=null;e?a=new PP.StateData(n[1].myID,n[1].myObject.clone()):a=new PP.StateData(n[1].myID,n[1].myObject),t._myStates.set(a.myID,a)}for(let n of this._myTransitions.entries()){let a=new Map;t._myTransitions.set(n[0],a);for(let s of n[1].entries()){let o=null,l=t.getState(s[1].myFromState.myID),m=t.getState(s[1].myToState.myID);e?o=new PP.TransitionData(s[1].myID,l,m,s[1].myObject.clone(),s[1].mySkipStateFunction):o=new PP.TransitionData(s[1].myID,l,m,s[1].myObject,s[1].mySkipStateFunction),a.set(o.myID,o)}}return this._myCurrentStateData&&(t._myCurrentStateData=t.getState(this._myCurrentStateData.myID)),t}isCloneable(e=!1){if(!e)return!0;let t=!0;for(let n of this._myStates.entries())t=t&&n[1].myObject.clone!=null;for(let n of this._myTransitions.entries())for(let a of n[1].entries())t=t&&a[1].myObject.clone!=null;return t}setDebugLogActive(e,t=null,n=!1){this._myDebugLogActive=e,this._myDebugShowDelayedInfo=n,t&&(this._myDebugLogName="FSM: ".concat(t))}registerInitEventListener(e,t){this._myInitCallbacks.set(e,t)}unregisterInitEventListener(e){this._myInitCallbacks.delete(e)}registerInitIDEventListener(e,t,n){let a=this._myInitIDCallbacks.get(e);a==null&&(this._myInitIDCallbacks.set(e,new Map),a=this._myInitIDCallbacks.get(e)),a.set(t,n)}unregisterInitIDEventListener(e,t){let n=this._myInitIDCallbacks.get(e);n!=null&&(n.delete(t),n.size<=0&&this._myInitIDCallbacks.delete(e))}registerTransitionEventListener(e,t){this._myTransitionCallbacks.set(e,t)}unregisterTransitionEventListener(e){this._myTransitionCallbacks.delete(e)}registerTransitionIDEventListener(e,t,n,a,s){let o=null;for(let l of this._myTransitionIDCallbacks)if(l[0]==e&&l[1]==t&&l[2]==n){o=l[3];break}if(o==null){let l=[];l[0]=e,l[1]=t,l[2]=n,l[3]=new Map,o=l[3],this._myTransitionIDCallbacks.push(l)}o.set(a,s)}unregisterTransitionIDEventListener(e,t,n,a){let s=null;for(let o of this._myTransitionIDCallbacks)if(o[0]==e&&o[1]==t&&o[2]==n){s=o[3];break}s!=null&&(s.delete(a),s.size<=0&&this._myTransitionIDCallbacks.pp_remove(o=>o[0]==e&&o[1]==t&&o[2]==n))}_perform(e,t,...n){if(this.isPerformingTransition()){let a=this.getCurrentlyPerformedTransition(),s=[this._myDebugLogName,"- Trying to perform:",e];return this._myDebugShowDelayedInfo&&s.push(t==PP.PerformMode.DELAYED?"- Delayed":"- Immediate"),s.push("- But another transition is currently being performed -",a.myID),console.warn(...s),!1}if(this._myCurrentStateData){if(this.canPerform(e)){let s=this._myTransitions.get(this._myCurrentStateData.myID).get(e);this._myCurrentlyPerformedTransition=s;let o=this._myCurrentStateData,l=this._myStates.get(s.myToState.myID);if(this._myDebugLogActive){let m=[this._myDebugLogName,"- From:",o.myID,"- To:",l.myID,"- With:",e];this._myDebugShowDelayedInfo&&m.push(t==PP.PerformMode.DELAYED?"- Delayed":"- Immediate"),console.log(...m)}if(s.mySkipStateFunction!=PP.SkipStateFunction.END&&s.mySkipStateFunction!=PP.SkipStateFunction.BOTH&&o.myObject&&o.myObject.end&&o.myObject.end(this,s,...n),s.myObject&&s.myObject.perform&&s.myObject.perform(this,s,...n),s.mySkipStateFunction!=PP.SkipStateFunction.START&&s.mySkipStateFunction!=PP.SkipStateFunction.BOTH&&l.myObject&&l.myObject.start&&l.myObject.start(this,s,...n),this._myCurrentStateData=s.myToState,this._myTransitionCallbacks.size>0&&this._myTransitionCallbacks.forEach(function(m){m(this,o,l,s,t,...n)}.bind(this)),this._myTransitionIDCallbacks.length>0){let m=[];for(let c of this._myTransitionIDCallbacks)(c[0]==null||c[0]==o.myID)&&(c[1]==null||c[1]==l.myID)&&(c[2]==null||c[2]==s.myID)&&m.push(c[3]);for(let c of this.internalTransitionIDCallbacks)c.forEach(function(r){r(this,o,l,s,t,...n)}.bind(this))}return this._myCurrentlyPerformedTransition=null,!0}else if(this._myDebugLogActive){let a=[this._myDebugLogName,"- No Transition:",e,"- From:",this._myCurrentStateData.myID];this._myDebugShowDelayedInfo&&a.push(t==PP.PerformMode.DELAYED?"- Delayed":"- Immediate"),console.warn(...a)}}else if(this._myDebugLogActive){let a=[this._myDebugLogName,"- FSM not initialized yet"];this._myDebugShowDelayedInfo&&a.push(t==PP.PerformMode.DELAYED?"- Delayed":"- Immediate"),console.warn(...a)}return!1}_getTransitionsFromState(e){return this._myTransitions.get(e)}}});var Tn=S(()=>{PP.State=class{update(e,t,...n){}init(e,t,...n){}start(e,t,...n){}end(e,t,...n){}}});var Cn=S(()=>{PP.Transition=class{performInit(e,t,...n){}perform(e,t,...n){}}});var Sn=S(()=>{PP.TimerState=class extends PP.State{constructor(e=0,t=null,...n){super(),this._myTransitionToPerformOnEnd=t,this._myTransitionArgs=n,this._myTimer=new PP.Timer(e,!1)}setDuration(e){this._myTimer.setDuration(e)}setTransitionToPerformOnEnd(e,...t){this._myTransitionToPerformOnEnd=e,this._myTransitionArgs=t}onEnd(e,t=null){this._myTimer.onEnd(e,t)}unregisterOnEnd(e=null){this._myTimer.unregisterOnEnd(e)}update(e,t){this._myTimer.update(e),this._myTimer.isDone()&&this._myTransitionToPerformOnEnd!=null&&t.perform(this._myTransitionToPerformOnEnd,...this._myTransitionArgs)}start(e,t,n=null,a=null,...s){this._myTimer.start(n),a!=null&&(this._myTransitionToPerformOnEnd=a,this._myTransitionArgs=s)}init(e,t,n=null,a=null,...s){this._myTimer.start(n),a!=null&&(this._myTransitionToPerformOnEnd=a,this._myTransitionArgs=s)}}});var bn=S(()=>{PP.ColorUtils={rgbToHsv:function(i){let e=i.pp_clone(),t=i[0],n=i[1],a=i[2];var s=Math.max(t,n,a),o=Math.min(t,n,a),l=s-o,m,c=s===0?0:l/s,r=s;switch(s){case o:m=0;break;case t:m=n-a+l*(n<a?6:0),m/=6*l;break;case n:m=a-t+l*2,m/=6*l;break;case a:m=t-n+l*4,m/=6*l;break}return e[0]=m,e[1]=c,e[2]=r,e},hsvToRgb:function(i){let e=i.pp_clone(),t=i[0],n=i[1],a=i[2],s,o,l,m,c,r,y,u;switch(m=Math.floor(t*6),c=t*6-m,r=a*(1-n),y=a*(1-c*n),u=a*(1-(1-c)*n),m%6){case 0:s=a,o=u,l=r;break;case 1:s=y,o=a,l=r;break;case 2:s=r,o=a,l=u;break;case 3:s=r,o=y,l=a;break;case 4:s=u,o=r,l=a;break;case 5:s=a,o=r,l=y;break}return e[0]=s,e[1]=o,e[2]=l,e},rgbCodeToHuman(i){return PP.ColorUtils.color1To255(i)},rgbHumanToCode(i){return PP.ColorUtils.color255To1(i)},hsvCodeToHuman(i){return PP.ColorUtils.color1To255(i)},hsvHumanToCode(i){return PP.ColorUtils.color255To1(i)},color255To1(i){let e=i.pp_clone();for(let t=0;t<e.length;t++)e[t]/=255,e[t]=Math.pp_clamp(e[t],0,1);return e},color1To255(i){let e=i.pp_clone();for(let t=0;t<e.length;t++)e[t]=Math.round(e[t]*255),e[t]=Math.pp_clamp(e[t],0,255);return e}}});var Mn=S(()=>{PP.MaterialUtils={setAlpha:function(){let i=PP.vec4_create();return function(t,n){t.color!=null&&(i.vec4_copy(t.color),i[3]=n,t.color=i),t.diffuseColor!=null&&(i.vec4_copy(t.diffuseColor),i[3]=n,t.diffuseColor=i),t.ambientColor!=null&&(i.vec4_copy(t.ambientColor),i[3]=n,t.ambientColor=i)}}(),setObjectAlpha:function(i,e){let t=i.pp_getComponentsHierarchy("mesh");for(let n of t)n.material!=null&&PP.MaterialUtils.setAlpha(n.material,e)},setObjectMaterial:function(i,e,t=!1){let n=i.pp_getComponentsHierarchy("mesh");for(let a of n)t?a.material=e.clone():a.material=e},setObjectClonedMaterials:function(i){let e=i.pp_getComponentsHierarchy("mesh");for(let t of e)t.material=t.material.clone()},setObjectSpecularColor:function(i,e){let t=i.pp_getComponentsHierarchy("mesh");for(let n of t)n.material.specularColor!=null&&(n.material.specularColor=e)},setObjectFogColor:function(i,e){let t=i.pp_getComponentsHierarchy("mesh");for(let n of t)n.material.fogColor!=null&&(n.material.fogColor=e)}}});var An=S(()=>{PP.MeshCreationVertexParams=class{constructor(){this.myPosition=null,this.myTextureCoordinates=null,this.myNormal=null,this.myColor=null}};PP.MeshCreationTriangleParams=class{constructor(){this.myIndexes=new Uint32Array(3)}};PP.MeshCreationParams=class{constructor(){this.myVertexes=[],this.myTriangles=[]}};PP.MeshUtils={createPlaneMesh:function(){let i=4,e=new PP.MeshCreationParams;for(let s=0;s<i;++s){let o=new PP.MeshCreationVertexParams;o.myPosition=new PP.vec3_create,o.myPosition[0]=-1+(s&1)*2,o.myPosition[1]=-1+((s&2)>>1)*2,o.myPosition[2]=0,o.myTextureCoordinates=new PP.vec2_create,o.myTextureCoordinates[0]=s&1,o.myTextureCoordinates[1]=(s&2)>>1,o.myNormal=new PP.vec3_create,o.myNormal[0]=0,o.myNormal[1]=0,o.myNormal[2]=1,e.myVertexes.push(o)}let t=new PP.MeshCreationTriangleParams;t.myIndexes[0]=0,t.myIndexes[1]=1,t.myIndexes[2]=2;let n=new PP.MeshCreationTriangleParams;return n.myIndexes[0]=2,n.myIndexes[1]=1,n.myIndexes[2]=3,e.myTriangles.push(t),e.myTriangles.push(n),PP.MeshUtils.createMesh(e)},createMesh:function(i){let e=[];for(let c of i.myTriangles)e.push(c.myIndexes[0]),e.push(c.myIndexes[1]),e.push(c.myIndexes[2]);let t=new Uint32Array(e.length);t.pp_copy(e);let n=i.myVertexes.length,a=new WL.Mesh({vertexCount:n,indexData:t,indexType:WL.MeshIndexType.UnsignedInt}),s=null,o=null,l=null,m=null;try{s=a.attribute(WL.MeshAttribute.Position)}catch{s=null}try{o=a.attribute(WL.MeshAttribute.TextureCoordinate)}catch{o=null}try{l=a.attribute(WL.MeshAttribute.Normal)}catch{l=null}try{m=a.attribute(WL.MeshAttribute.Color)}catch{m=null}for(let c=0;c<i.myVertexes.length;c++){let r=i.myVertexes[c];s!=null&&r.myPosition&&s.set(c,r.myPosition),o!=null&&r.myTextureCoordinates&&o.set(c,r.myTextureCoordinates),l!=null&&r.myNormal&&l.set(c,r.myNormal),m!=null&&r.myColor&&m.set(c,r.myColor)}return a},cloneMesh:function(){let i=PP.vec3_create(),e=PP.vec2_create(),t=PP.vec3_create(),n=PP.vec4_create();return function(s){if(s==null)return null;let o=new Uint32Array(s.indexData.length);for(let h=0;h<s.indexData.length;h++)o[h]=s.indexData[h];let l=new WL.Mesh({vertexCount:s.vertexCount,indexData:o,indexType:WL.MeshIndexType.UnsignedInt}),m=null,c=null,r=null,y=null,u=null,p=null,d=null,_=null;try{m=s.attribute(WL.MeshAttribute.Position),u=l.attribute(WL.MeshAttribute.Position)}catch{m=null,u=null}try{c=s.attribute(WL.MeshAttribute.TextureCoordinate),p=l.attribute(WL.MeshAttribute.TextureCoordinate)}catch{c=null,p=null}try{r=s.attribute(WL.MeshAttribute.Normal),d=l.attribute(WL.MeshAttribute.Normal)}catch{r=null,d=null}try{y=s.attribute(WL.MeshAttribute.Color),_=l.attribute(WL.MeshAttribute.Color)}catch{y=null,_=null}for(let h=0;h<s.vertexCount;h++)m!=null&&u!=null&&u.set(h,m.get(h,i)),c!=null&&p!=null&&p.set(h,c.get(h,e)),r!=null&&d!=null&&d.set(h,r.get(h,t)),y!=null&&_!=null&&_.set(h,y.get(h,n));return l}}(),invertMesh:function(){let i=PP.vec3_create(),e=PP.vec2_create(),t=PP.vec3_create(),n=PP.vec4_create();return function(s){if(s==null)return null;let o=new Uint32Array(s.indexData.length);for(let h=0;h<s.indexData.length/3;h++)o[h*3+0]=s.indexData[h*3+2],o[h*3+1]=s.indexData[h*3+1],o[h*3+2]=s.indexData[h*3+0];let l=new WL.Mesh({vertexCount:s.vertexCount,indexData:o,indexType:WL.MeshIndexType.UnsignedInt}),m=null,c=null,r=null,y=null,u=null,p=null,d=null,_=null;try{m=s.attribute(WL.MeshAttribute.Position),u=l.attribute(WL.MeshAttribute.Position)}catch{m=null,u=null}try{c=s.attribute(WL.MeshAttribute.TextureCoordinate),p=l.attribute(WL.MeshAttribute.TextureCoordinate)}catch{c=null,p=null}try{r=s.attribute(WL.MeshAttribute.Normal),d=l.attribute(WL.MeshAttribute.Normal)}catch{r=null,d=null}try{y=s.attribute(WL.MeshAttribute.Color),_=l.attribute(WL.MeshAttribute.Color)}catch{y=null,_=null}for(let h=0;h<s.vertexCount;h++)m!=null&&u!=null&&u.set(h,m.get(h,i)),c!=null&&p!=null&&p.set(h,c.get(h,e)),r!=null&&d!=null&&(r.get(h,t),t.vec3_negate(t),d.set(h,t)),y!=null&&_!=null&&_.set(h,y.get(h,n));return l}}()}});var In=S(()=>{PP.SaveUtils={save:function(i,e){e!=null&&localStorage.setItem(i,e)},has:function(i){return PP.SaveUtils.loadString(i,null)!=null},delete:function(i){return localStorage.removeItem(i)},clear:function(){return localStorage.clear()},load:function(i,e=null){return PP.SaveUtils.loadString(i,e)},loadString:function(i,e=null){let t=localStorage.getItem(i);return t==null&&(t=e),t},loadNumber:function(i,e=null){let t=PP.SaveUtils.loadString(i);return t!=null?Number(t):e},loadBool:function(i,e=null){let t=PP.SaveUtils.loadString(i);return t=="true"?!0:t=="false"?!1:e}}});var xn=S(()=>{PP.TextUtils={setClonedMaterials:function(i){let e=i.pp_getComponentsHierarchy("text");for(let t of e)t.material=t.material.clone()}}});var Rn=S(()=>{PP.XRUtils={isDeviceEmulated:function(){return"CustomWebXRPolyfill"in window},isSessionActive:function(){return WL.xrSession!=null},isReferenceSpaceLocalFloor:function(){return!["local","viewer"].includes(WebXR.refSpace)}}});var Vn=S(()=>{PP.BrowserUtils={isMobile:function(){return/Mobi/i.test(window.navigator.userAgent)},isDesktop:function(){return!PP.BrowserUtils.isMobile()}}});var Dn=S(()=>{PP.JSUtils={getReferencePrototypes(i){let e=[];e.push(i);let t=Object.getPrototypeOf(i);for(;t!=null;)e.pp_pushUnique(t),t=Object.getPrototypeOf(t);let n=[i];for(;n.length>0;){let a=n.shift();a!=null&&(e.pp_pushUnique(a),n.pp_pushUnique(Object.getPrototypeOf(a)),n.pp_pushUnique(a.prototype))}return e},getReferencePropertyNames:function(i){let e=[],t=this.getReferencePrototypes(i);for(let n of t)if(n!=null){let a=Object.getOwnPropertyNames(n);for(let s of a)e.pp_pushUnique(s)}return e},getReferencePropertyDescriptor:function(i,e){let t=null,n=this.getReferencePropertyOwnParent(i,e);return n!=null&&(t=Object.getOwnPropertyDescriptor(n,e)),t},getReferenceProperty:function(i,e){let t,n=this.getReferencePropertyDescriptor(i,e);return n!=null&&(n.get!=null?t=n.get.bind(i)():t=n.value),t},setReferenceProperty:function(i,e,t){let n=this.getReferencePropertyDescriptor(e,t),a=!1;if(n!=null&&n.set!=null&&(a=!0,n.set.bind(e)(i)),!a){let s=this.getReferencePropertyOwnParent(e,t);s==null&&(s=e),Object.defineProperty(s,t,{value:i})}},getReferencePropertyOwnParent:function(i,e){let t=null,n=this.getReferencePropertyOwnParents(i,e);return n.length>0&&(t=n[0]),t},getReferencePropertyOwnParents:function(i,e){let t=[],n=this.getReferencePrototypes(i);for(let a of n)Object.getOwnPropertyNames(a).pp_hasEqual(e)&&t.push(a);return t},getReferenceFromPath:function(i,e=window){let t=null,n=this.getReferenceNameFromPath(i);return n!=null&&(t=this.getReferenceProperty(this.getReferenceParentFromPath(i,e),n)),t},getReferenceNameFromPath:function(i){let e=null;if(i!=null){let t=i.split(".");t.length>0&&(e=t[t.length-1])}return e},getReferenceParentFromPath:function(i,e=window){let t=i.split("."),n=e;for(let a=0;a<t.length-1;a++)n=this.getReferenceProperty(n,t[a]);return n},overwriteReferenceProperty:function(i,e,t,n=!0,a=!1,s=!1){let o=!1;try{let l=this.getReferencePropertyOwnParent(e,t);if(l!=null){let m=Object.getOwnPropertyDescriptor(l,t);if(m!=null){if(m.get==null&&m.set==null&&m.value!=null){let r=m.value;this.copyReferenceProperties(r,i,!0,a,s)}let c=e;n&&(c=l),Object.defineProperty(c,t,{value:i,enumerable:m.enumerable,configurable:m.configurable,writable:m.writable}),o=!0}}}catch{s&&console.error("Property:",t,"of:",e,"can't be overwritten.")}return o},copyReferenceProperties(i,e,t=!1,n=!1,a=!1){if(i!=null){t&&this.cleanReferenceProperties(e),Object.setPrototypeOf(e,Object.getPrototypeOf(i));let s=Object.getOwnPropertyNames(i);for(let o of s)try{let l=Object.getOwnPropertyDescriptor(i,o);Object.defineProperty(e,o,{value:l.value,enumerable:l.enumerable,configurable:l.configurable,writable:l.writable})}catch{a&&console.error("Property:",o,"of:",i.name,"can't be overwritten.")}n&&this._javascriptObjectFunctionsSpecialCopy(i,e)}},cleanReferenceProperties(i){let e=Object.getOwnPropertyNames(i);e.pp_pushUnique("__proto__");for(let t of e){try{Object.defineProperty(i,t,{value:void 0})}catch{}try{delete i[t]}catch{}}Object.setPrototypeOf(i,null)},doesReferencePropertyUseAccessors(i,e){let t=!1,n=this.getReferencePropertyDescriptor(i,e);return n!=null&&(n.get!=null||n.set!=null)&&(t=!0),t},isFunctionByName(i,e){let t=!1,n=this.getReferenceProperty(i,e);return n!=null&&(t=typeof n=="function"&&!this.isClassByName(i,e)),t},isClassByName(i,e){let t=!1,n=this.getReferenceProperty(i,e);return n!=null&&(t=typeof n=="function"&&e!="constructor"&&n.prototype!=null&&typeof n.prototype.constructor=="function"&&n.toString!=null&&typeof n.toString=="function"&&/^class/.test(n.toString())),t},isObjectByName(i,e){let t=!1,n=this.getReferenceProperty(i,e);return n!=null&&(t=typeof n=="object"),t},_javascriptObjectFunctionsSpecialCopy(i,e){try{if(typeof e=="function"&&typeof i=="function"){let t=["toString","toLocaleString","valueOf"];for(let n of t){let a=this.getReferencePropertyDescriptor(i,n);if(a!=null&&a.value!=null&&a.value==Object[n]){let s=Object[n].bind(i)(),o=function(){return s};this.overwriteReferenceProperty(o,e,n,!1,!1)}}}}catch{}}}});var Ln=S(()=>{PP.PhysicsUtils={_myLayerFlagsAmount:8,_myLayerFlagsNames:["0","1","2","3","4","5","6","7"],setLayerFlagsAmount:function(i){PP.PhysicsUtils._myLayerFlagsAmount=i},setLayerFlagsNames:function(i){PP.PhysicsUtils._myLayerFlagsNames=i},getLayerFlagsAmount:function(){return PP.PhysicsUtils._myLayerFlagsAmount},getLayerFlagsNames:function(){return PP.PhysicsUtils._myLayerFlagsNames},raycast:function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=(n,a)=>n.pp_equals(a);return function(a,s=new PP.RaycastResults){let o=WL.physics.rayCast(a.myOrigin,a.myDirection,a.myBlockLayerFlags.getMask(),a.myDistance);s.myRaycastSetup==null&&(s.myRaycastSetup=new PP.RaycastSetup),s.myRaycastSetup.copy(a);let l=0,m=0,c=o.hitCount;if(c!=0){let r=null,y=null,u=null,p=null;e=a.myDirection.vec3_negate(e);for(let d=0;d<c;d++){if(a.myObjectsToIgnore.length!=0&&(r==null&&(r=o.objects),a.myObjectsToIgnore.pp_hasEqual(r[d],t)))continue;y==null&&(y=o.distances);let _=y[d]==0;if(_&&(u==null&&(u=o.locations),_&&=a.myOrigin.vec3_sub(u[d],i).vec3_isZero(Math.PP_EPSILON_NUMBER),_&&(p||(p=o.normals),_&&=e.vec3_equals(p[d],Math.PP_EPSILON_DEGREES))),!a.myIgnoreHitsInsideCollision||!_){let h=null;l<s.myHits.length?h=s.myHits[l]:s._myUnusedHits!=null&&s._myUnusedHits.length>0?(h=s._myUnusedHits.pop(),s.myHits.push(h)):(h=new PP.RaycastHit,s.myHits.push(h)),r==null&&(r=o.objects),u==null&&(u=o.locations),p==null&&(p=o.normals),h.myPosition.vec3_copy(u[d]),h.myNormal.vec3_copy(p[d]),h.myDistance=y[d],h.myObject=r[d],h.myIsInsideCollision=_,m++,l++}}}if(s.myHits.length>m){s._myUnusedHits==null&&(s._myUnusedHits=[]);let r=s.myHits.length-m;for(let y=0;y<r;y++)s._myUnusedHits.push(s.myHits.pop())}return s}}()}});var Bn=S(()=>{PP.RaycastSetup=class{constructor(){this.myOrigin=PP.vec3_create(),this.myDirection=PP.vec3_create(),this.myDistance=0,this.myBlockLayerFlags=new PP.PhysicsLayerFlags,this.myObjectsToIgnore=[],this.myIgnoreHitsInsideCollision=!1}copy(e){this.myOrigin.vec3_copy(e.myOrigin),this.myDirection.vec3_copy(e.myDirection),this.myDistance=e.myDistance,this.myBlockLayerFlags.copy(e.myBlockLayerFlags),this.myObjectsToIgnore.pp_copy(e.myObjectsToIgnore),this.myIgnoreHitsInsideCollision=e.myIgnoreHitsInsideCollision}reset(){this.myOrigin.vec3_zero(),this.myDirection.vec3_zero(),this.myDistance=0,this.myBlockLayerFlags.setAllFlagsActive(!1),this.myObjectsToIgnore.pp_clear(),this.myIgnoreHitsInsideCollision=!1}};PP.RaycastResults=class{constructor(){this.myRaycastSetup=null,this.myHits=[],this._myUnusedHits=null}isColliding(e=!1){return e?this.getFirstHitOutsideCollision()!=null:this.myHits.length>0}getFirstHitInsideCollision(){let e=null;for(let t of this.myHits)if(t.myIsInsideCollision){e=t;break}return e}getFirstHitOutsideCollision(){let e=null;for(let t of this.myHits)if(!t.myIsInsideCollision){e=t;break}return e}getHitsInsideCollision(){let e=[];for(let t of this.myHits)t.myIsInsideCollision&&e.push(t);return e}getHitsOutsideCollision(){let e=[];for(let t of this.myHits)t.myIsInsideCollision||e.push(t);return e}removeHit(e){let t=this.myHits.pp_removeIndex(e);return t!=null&&(this._myUnusedHits==null&&(this._myUnusedHits=[]),this._myUnusedHits.push(t)),t}removeAllHits(){this._myUnusedHits==null&&(this._myUnusedHits=[]),this._myUnusedHits.push(...this.myHits),this.myHits.pp_clear()}copy(e){}reset(){this.myRaycastSetup!=null&&this.myRaycastSetup.reset(),this.removeAllHits()}};PP.RaycastHit=class{constructor(){this.myPosition=PP.vec3_create(),this.myNormal=PP.vec3_create(),this.myDistance=0,this.myObject=null,this.myIsInsideCollision=!1}isValid(){return this.myObject!=null}copy(e){this.myPosition.vec3_copy(e.myPosition),this.myNormal.vec3_copy(e.myNormal),this.myDistance=e.myDistance,this.myObject=e.myObject,this.myIsInsideCollision=e.myIsInsideCollision}reset(){this.myPosition.vec3_zero(),this.myNormal.vec3_zero(),this.myDistance=0,this.myObject=null,this.myIsInsideCollision=!1}};PP.RaycastResults.prototype.copy=function(){let i=function(e,t){return e==null&&(e=new PP.RaycastHit),e.copy(t),e};return function(t){if(t.myRaycastSetup==null?this.myRaycastSetup=null:(this.myRaycastSetup==null&&(this.myRaycastSetup=new PP.RaycastSetup),this.myRaycastSetup.copy(t.myRaycastSetup)),this.myHits.length>t.myHits.length){this._myUnusedHits==null&&(this._myUnusedHits=[]);for(let n=0;n<this.myHits.length-t.myHits.length;n++)this._myUnusedHits.push(this.myHits.pop())}else if(this.myHits.length<t.myHits.length&&this._myUnusedHits!=null){let n=Math.min(this._myUnusedHits.length,t.myHits.length-this.myHits.length);for(let a=0;a<n;a++)this.myHits.push(this._myUnusedHits.pop())}this.myHits.pp_copy(t.myHits,i)}}();Object.defineProperty(PP.RaycastResults.prototype,"copy",{enumerable:!1})});var On=S(()=>{PP.PhysicsLayerFlags=class{constructor(){this._myLayerMask=0}setFlagActive(e,t){let n=e;if(isNaN(e)&&(n=PP.PhysicsUtils.getLayerFlagsNames().pp_findIndexEqual(e)),n>=0&&n<PP.PhysicsUtils.getLayerFlagsAmount()){let a=1<<n;t?this._myLayerMask=this._myLayerMask|a:this._myLayerMask=this._myLayerMask&~a}}isFlagActive(e){let t=e;isNaN(e)&&(t=PP.PhysicsUtils.getLayerFlagsNames().pp_findIndexEqual(e));let n=!1;if(t>=0&&t<PP.PhysicsUtils.getLayerFlagsAmount()){let a=1<<t;n=!!(this._myLayerMask&a)}return n}setAllFlagsActive(e){e?this._myLayerMask=Math.pow(2,PP.PhysicsUtils.getLayerFlagsAmount())-1:this._myLayerMask=0}add(e){this._myLayerMask=this._myLayerMask|e.getMask()}remove(e){this._myLayerMask=this._myLayerMask&~e.getMask()}intersect(e){this._myLayerMask=this._myLayerMask&e.getMask()}copy(e){this._myLayerMask=e._myLayerMask}getMask(){return this._myLayerMask}setMask(e){this._myLayerMask=e}}});var Hn=S(()=>{PP.PhysicsCollisionCollector=class{constructor(e,t=!1){this._myPhysX=e,this._myIsTrigger=t,this._myCollisions=[],this._myCollisionsStart=[],this._myCollisionsEnd=[],this._myUpdateActive=!1,this._myCollisionsStartToProcess=[],this._myCollisionsEndToProcess=[],this._myCollisionCallbackID=null,this._myIsActive=!1,this.setActive(!0),this._myDebugActive=!1,this._myTriggerDesyncFixDelay=new PP.Timer(.1),this._myCollisionCallbacks=new Map,this._myCollisionStartCallbacks=new Map,this._myCollisionEndCallbacks=new Map}getPhysX(){return this._myPhysX}getCollisions(){return this._myCollisions}getCollisionsStart(){return this._myCollisionsStart}getCollisionsEnd(){return this._myCollisionsEnd}setActive(e){this._myIsActive!=e&&(this._myIsActive=e,this._myCollisions=[],this._myCollisionsStart=[],this._myCollisionsEnd=[],this._myUpdateActive=!1,this._myCollisionsStartToProcess=[],this._myCollisionsEndToProcess=[],this._myIsActive?this._myCollisionCallbackID=this._myPhysX.onCollision(this._onCollision.bind(this)):this._myCollisionCallbackID!=null&&(this._myPhysX.removeCollisionCallback(this._myCollisionCallbackID),this._myCollisionCallbackID=null))}setUpdateActive(e){this._myUpdateActive=e}update(e){!this._myIsActive||(this._myUpdateActive=!0,this._myCollisionsStart=this._myCollisionsStartToProcess,this._myCollisionsStartToProcess=[],this._myCollisionsEnd=this._myCollisionsEndToProcess,this._myCollisionsEndToProcess=[],this._myIsTrigger&&this._triggerDesyncFix(e))}destroy(){this._myCollisionCallbackID!=null&&(this._myPhysX.removeCollisionCallback(this._myCollisionCallbackID),this._myCollisionCallbackID=null)}setDebugActive(e){this._myDebugActive=e}registerCollisionEventListener(e,t){this._myCollisionCallbacks.set(e,t)}unregisterCollisionEventListener(e){this._myCollisionCallbacks.delete(e)}registerCollisionStartEventListener(e,t){this._myCollisionStartCallbacks.set(e,t)}unregisterCollisionStartEventListener(e){this._myCollisionStartCallbacks.delete(e)}registerCollisionEndEventListener(e,t){this._myCollisionEndCallbacks.set(e,t)}unregisterCollisionEndEventListener(e){this._myCollisionEndCallbacks.delete(e)}_onCollision(e,t){e==WL.CollisionEventType.Touch||e==WL.CollisionEventType.TriggerTouch?this._onCollisionStart(t):(e==WL.CollisionEventType.TouchLost||e==WL.CollisionEventType.TriggerTouchLost)&&this._onCollisionEnd(t),this._myCollisionCallbacks.size>0&&this._myCollisionCallbacks.forEach(function(n){n(this._myPhysX,t,e)})}_onCollisionStart(e){if(this._myDebugActive){let t=!1;for(let n of this._myCollisions)if(n.pp_equals(e.object)){t=!0;break}t&&console.error("Collision Start on object already collected")}this._myCollisions.push(e.object),this._myUpdateActive&&(this._myCollisionsStartToProcess.push(e.object),this._myCollisionsEndToProcess.pp_removeAll(function(t){return t.pp_equals(e.object)})),this._myDebugActive&&console.log("Collision Start -",this._myCollisions.length),this._myCollisionStartCallbacks.size>0&&this._myCollisionStartCallbacks.forEach(function(t){t(this._myPhysX,e,type)})}_onCollisionEnd(e){if(this._myDebugActive){let t=!1;for(let n of this._myCollisions)if(n.pp_equals(e.object)){t=!0;break}t||console.error("Collision End on object not collected")}this._myCollisions.pp_removeAll(function(t){return t.pp_equals(e.object)}),this._myUpdateActive&&(this._myCollisionsEndToProcess.push(e.object),this._myCollisionsStartToProcess.pp_removeAll(function(t){return t.pp_equals(e.object)})),this._myDebugActive&&console.log("Collision End -",this._myCollisions.length),this._myCollisionEndCallbacks.size>0&&this._myCollisionEndCallbacks.forEach(function(t){t(this._myPhysX,e,type)})}_triggerDesyncFix(e){if(this._myTriggerDesyncFixDelay.update(e),this._myTriggerDesyncFixDelay.isDone()){this._myTriggerDesyncFixDelay.start();let t=this._myCollisions.pp_findAll(function(n){let a=n.pp_getComponentSelf("physx");return a==null||!a.active});if(t.length>0)for(let n of t){let a=n.pp_getComponentSelf("physx");a?this._onCollisionEnd(a):console.error("NO PHYSX, HOW?")}}}}});var En=S(()=>{PP.VisualManager=class{constructor(){this._myVisualElementPrototypeCreationCallbacks=new Map,this._myVisualElementsTypeMap=new Map,this._myVisualElementLastID=0,this._myVisualElementsPool=new PP.ObjectPoolManager,this._myVisualElementsToShow=[],this._myActive=!0,this._addStandardVisualElementTypes()}setActive(e){this._myActive!=e&&(this._myActive=e,this._myActive||this.clearDraw())}isActive(){return this._myActive}start(){}update(e){this._updateDraw(e)}draw(e,t=0,n=null){if(!this._myActive)return 0;let a=null,s=!1;if(n!=null&&this._myVisualElementsTypeMap.has(e.myType)){let m=this._myVisualElementsTypeMap.get(e.myType);m.has(n)&&(a=m.get(n)[0],a.copyParams(e),a.setVisible(!1),s=!0)}if(a==null&&(a=this._getVisualElement(e)),a==null)return console.error("Couldn't create the requested visual element"),null;this._myVisualElementsTypeMap.has(e.myType)||this._myVisualElementsTypeMap.set(e.myType,new Map);let o=this._myVisualElementsTypeMap.get(e.myType),l=null;if(!s)l=this._myVisualElementLastID+1,this._myVisualElementLastID=l,o.set(l,[a,new PP.Timer(t,t!=null)]);else{l=n;let m=o.get(l);m[0]=a,m[1].reset(t),t!=null&&m[1].start()}return this._myVisualElementsToShow.push(a),l}getDraw(e){let t=null;for(let n of this._myVisualElementsTypeMap.values())if(n.has(e)){t=n.get(e)[0];break}return t}clearDraw(e=null){if(e==null){for(let t of this._myVisualElementsTypeMap.values())for(let n of t.values())this._myVisualElementsPool.releaseObject(n[0].getParams().myType,n[0]);this._myVisualElementsToShow=[],this._myVisualElementsTypeMap=new Map,this._myVisualElementLastID=0}else for(let t of this._myVisualElementsTypeMap.values())if(t.has(e)){let n=t.get(e);this._myVisualElementsPool.releaseObject(n[0].getParams().myType,n[0]),t.delete(e),this._myVisualElementsToShow.pp_removeEqual(n[0]);break}}allocateDraw(e,t){this._myVisualElementsPool.hasPool(e)||this._addVisualElementTypeToPool(e);let n=this._myVisualElementsPool.getPool(e),a=n.getAvailableSize()-t;a<0&&n.increase(-a)}addVisualElementType(e,t){this._myVisualElementPrototypeCreationCallbacks.set(e,t)}removeVisualElementType(e){this._myVisualElementPrototypeCreationCallbacks.delete(e)}_updateDraw(e){for(let t of this._myVisualElementsToShow)t.setVisible(!0);this._myVisualElementsToShow=[];for(let t of this._myVisualElementsTypeMap.values()){let n=[];for(let a of t.entries()){let s=a[1];s[1].isDone()&&(this._myVisualElementsPool.releaseObject(s[0].getParams().myType,s[0]),n.push(a[0])),s[1].update(e)}for(let a of n)t.delete(a)}}_getVisualElement(e){let t=null;return this._myVisualElementsPool.hasPool(e.myType)||this._addVisualElementTypeToPool(e.myType),t=this._myVisualElementsPool.getObject(e.myType),t?.copyParams(e),t}_addVisualElementTypeToPool(e){let t=new PP.ObjectPoolParams;t.myInitialPoolSize=10,t.myAmountToAddWhenEmpty=0,t.myPercentageToAddWhenEmpty=.5,t.myEnableDebugLog=!1,t.mySetActiveCallback=function(a,s){a.setVisible(s)};let n=null;this._myVisualElementPrototypeCreationCallbacks.has(e)&&(n=this._myVisualElementPrototypeCreationCallbacks.get(e)()),n!=null?(n.setVisible(!1),n.setAutoRefresh(!0),this._myVisualElementsPool.addPool(e,n,t)):console.error("Visual element type not supported")}_addStandardVisualElementTypes(){this.addVisualElementType(PP.VisualElementType.LINE,()=>new PP.VisualLine),this.addVisualElementType(PP.VisualElementType.MESH,()=>new PP.VisualMesh),this.addVisualElementType(PP.VisualElementType.POINT,()=>new PP.VisualPoint),this.addVisualElementType(PP.VisualElementType.ARROW,()=>new PP.VisualArrow),this.addVisualElementType(PP.VisualElementType.TEXT,()=>new PP.VisualText),this.addVisualElementType(PP.VisualElementType.TRANSFORM,()=>new PP.VisualTransform),this.addVisualElementType(PP.VisualElementType.RAYCAST,()=>new PP.VisualRaycast),this.addVisualElementType(PP.VisualElementType.TORUS,()=>new PP.VisualTorus)}}});var kn=S(()=>{PP.VisualElementType={MESH:0,LINE:1,POINT:2,TEXT:3,ARROW:4,TRANSFORM:5,RAYCAST:6,TORUS:7}});var Fn=S(()=>{PP.VisualLineParams=class{constructor(){this.myStart=PP.vec3_create(),this.myDirection=PP.vec3_create(0,0,1),this.myLength=0,this.myThickness=.005,this.myMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=PP.myVisualData.myRootObject,this.myIsLocal=!1,this.myType=PP.VisualElementType.LINE}setStartEnd(e,t){return t.vec3_sub(e,this.myDirection),this.myLength=this.myDirection.vec3_length(),this.myDirection.vec3_normalize(this.myDirection),this.myStart.vec3_copy(e),this}copy(e){}};PP.VisualLine=class{constructor(e=new PP.VisualLineParams){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myLineRootObject=null,this._myLineObject=null,this._myLineMeshComponent=null,this._myFlatOpaqueMaterial=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myLineRootObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_build(){this._myLineRootObject=WL.scene.addObject(null),this._myLineObject=WL.scene.addObject(this._myLineRootObject),this._myLineMeshComponent=this._myLineObject.addComponent("mesh")}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new PP.VisualLineParams;e.copy(this._myParams);let t=new PP.VisualLine(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}};PP.VisualLine.prototype._refresh=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(0,1,0);return function(){this._myLineRootObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myIsLocal?this._myLineRootObject.pp_setPositionLocal(this._myParams.myStart):this._myLineRootObject.pp_setPosition(this._myParams.myStart),i.vec3_set(this._myParams.myThickness/2,this._myParams.myLength/2,this._myParams.myThickness/2),this._myParams.myIsLocal?this._myLineObject.pp_setScaleLocal(i):this._myLineObject.pp_setScale(i),this._myParams.myIsLocal?this._myLineObject.pp_setUpLocal(this._myParams.myDirection,t):this._myLineObject.pp_setUp(this._myParams.myDirection,t),this._myLineObject.pp_resetPositionLocal(),e.vec3_set(0,this._myParams.myLength/2,0),this._myLineObject.pp_translateObject(e),this._myParams.myMesh!=null?this._myLineMeshComponent.mesh=this._myParams.myMesh:this._myLineMeshComponent.mesh=PP.myDefaultResources.myMeshes.myCylinder,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myLineMeshComponent.material=PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone()),this._myLineMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myLineMeshComponent.material=this._myParams.myMaterial}}();PP.VisualLineParams.prototype.copy=function(e){this.myStart.vec3_copy(e.myStart),this.myDirection.vec3_copy(e.myDirection),this.myLength=e.myLength,this.myThickness=e.myThickness,this.myMesh=e.myMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myIsLocal=e.myIsLocal,this.myType=e.myType};Object.defineProperty(PP.VisualLine.prototype,"_refresh",{enumerable:!1});Object.defineProperty(PP.VisualLineParams.prototype,"copy",{enumerable:!1})});var wn=S(()=>{PP.VisualMeshParams=class{constructor(){this.myTransform=PP.mat4_create(),this.myMesh=null,this.myMaterial=null,this.myParent=PP.myVisualData.myRootObject,this.myIsLocal=!1,this.myType=PP.VisualElementType.MESH}copy(e){}};PP.VisualMesh=class{constructor(e=new PP.VisualMeshParams){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myMeshObject=null,this._myMeshComponent=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myMeshObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_refresh(){this._myMeshObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myIsLocal?this._myMeshObject.pp_setTransformLocal(this._myParams.myTransform):this._myMeshObject.pp_setTransform(this._myParams.myTransform),this._myParams.myMesh==null?this._myMeshComponent.mesh=PP.myDefaultResources.myMeshes.mySphere:this._myMeshComponent.mesh=this._myParams.myMesh,this._myParams.myMaterial==null?this._myMeshComponent.material=PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial:this._myMeshComponent.material=this._myParams.myMaterial}_build(){this._myMeshObject=WL.scene.addObject(null),this._myMeshComponent=this._myMeshObject.addComponent("mesh")}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new PP.VisualMeshParams;e.copy(this._myParams);let t=new PP.VisualMesh(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}};PP.VisualMeshParams.prototype.copy=function(e){this.myTransform.pp_copy(e.myTransform),e.myMesh!=null?this.myMesh=e.myMesh:this.myMesh=null,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,this.myParent=e.myParent,this.myIsLocal=e.myIsLocal,this.myType=e.myType};Object.defineProperty(PP.VisualMeshParams.prototype,"copy",{enumerable:!1})});var Wn=S(()=>{PP.VisualPointParams=class{constructor(){this.myPosition=PP.vec3_create(),this.myRadius=.005,this.myMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=PP.myVisualData.myRootObject,this.myIsLocal=!1,this.myType=PP.VisualElementType.POINT}copy(e){}};PP.VisualPoint=class{constructor(e=new PP.VisualPointParams){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myPointObject=null,this._myPointMeshComponent=null,this._myFlatOpaqueMaterial=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myPointObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_build(){this._myPointObject=WL.scene.addObject(null),this._myPointMeshComponent=this._myPointObject.addComponent("mesh")}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new PP.VisualPointParams;e.copy(this._myParams);let t=new PP.VisualPoint(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}};PP.VisualPoint.prototype._refresh=function(){let i=PP.vec3_create(0,0,0);return function(){this._myPointObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myIsLocal?(this._myPointObject.pp_setPositionLocal(this._myParams.myPosition),this._myPointObject.pp_setRotationLocal(i),this._myPointObject.pp_setScaleLocal(this._myParams.myRadius)):(this._myPointObject.pp_setPosition(this._myParams.myPosition),this._myPointObject.pp_setRotation(i),this._myPointObject.pp_setScale(this._myParams.myRadius)),this._myParams.myMesh!=null?this._myPointMeshComponent.mesh=this._myParams.myMesh:this._myPointMeshComponent.mesh=PP.myDefaultResources.myMeshes.mySphere,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myPointMeshComponent.material=PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone()),this._myPointMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myPointMeshComponent.material=this._myParams.myMaterial}}();PP.VisualPointParams.prototype.copy=function(e){this.myPosition.vec3_copy(e.myPosition),this.myRadius=e.myRadius,this.myMesh=e.myMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myIsLocal=e.myIsLocal,this.myType=e.myType};Object.defineProperty(PP.VisualPoint.prototype,"_refresh",{enumerable:!1});Object.defineProperty(PP.VisualPointParams.prototype,"copy",{enumerable:!1})});var jn=S(()=>{PP.VisualArrowParams=class{constructor(){this.myStart=PP.vec3_create(),this.myDirection=PP.vec3_create(0,0,1),this.myLength=0,this.myThickness=.005,this.myLineMesh=null,this.myArrowMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=PP.myVisualData.myRootObject,this.myIsLocal=!1,this.myType=PP.VisualElementType.ARROW}setStartEnd(e,t){return t.vec3_sub(e,this.myDirection),this.myLength=this.myDirection.vec3_length(),this.myDirection.vec3_normalize(this.myDirection),this.myStart.vec3_copy(e),this}copy(e){}};PP.VisualArrow=class{constructor(e=new PP.VisualArrowParams){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualLine=new PP.VisualLine,this._myVisualLine.setAutoRefresh(!1),this._myArrowRootObject=null,this._myArrowObject=null,this._myArrowMeshComponent=null,this._myFlatOpaqueMaterial=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myVisualLine.setVisible(e),this._myArrowRootObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh(),this._myVisualLine.forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualLine.update(e)}_build(){this._myArrowRootObject=WL.scene.addObject(null),this._myArrowObject=WL.scene.addObject(this._myArrowRootObject),this._myArrowMeshComponent=this._myArrowObject.addComponent("mesh")}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new PP.VisualArrowParams;e.copy(this._myParams);let t=new PP.VisualArrow(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}};PP.VisualArrow.prototype._refresh=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(0,1,0);return function(){this._myArrowRootObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myDirection.vec3_scale(Math.max(.001,this._myParams.myLength-this._myParams.myThickness*4),i),i.vec3_add(this._myParams.myStart,i),this._myParams.myIsLocal?(this._myArrowRootObject.pp_setPositionLocal(i),this._myArrowRootObject.pp_setUpLocal(this._myParams.myDirection,a)):(this._myArrowRootObject.pp_setPosition(i),this._myArrowRootObject.pp_setUp(this._myParams.myDirection,a)),e.vec3_set(0,this._myParams.myThickness*2-1e-5,0),this._myArrowRootObject.pp_translateObject(e),t.vec3_set(this._myParams.myThickness*1.25,this._myParams.myThickness*2,this._myParams.myThickness*1.25),this._myParams.myIsLocal?this._myArrowObject.pp_setScaleLocal(t):this._myArrowObject.pp_setScale(t),this._myParams.myArrowMesh!=null?this._myArrowMeshComponent.mesh=this._myParams.myArrowMesh:this._myArrowMeshComponent.mesh=PP.myDefaultResources.myMeshes.myCone,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myArrowMeshComponent.material=PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone()),this._myArrowMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myArrowMeshComponent.material=this._myParams.myMaterial,n=i.vec3_sub(this._myParams.myStart,n);let o=this._myVisualLine.getParams();o.myStart.vec3_copy(this._myParams.myStart),o.myDirection=n.vec3_normalize(o.myDirection),o.myLength=n.vec3_length(),o.myThickness=this._myParams.myThickness,o.myMesh=this._myParams.myLineMesh,o.myMaterial=this._myArrowMeshComponent.material,o.myParent=this._myParams.myParent,o.myIsLocal=this._myParams.myIsLocal,this._myVisualLine.paramsUpdated()}}();PP.VisualArrowParams.prototype.copy=function(e){this.myStart.vec3_copy(e.myStart),this.myDirection.vec3_copy(e.myDirection),this.myLength=e.myLength,this.myThickness=e.myThickness,this.myArrowMesh=e.myArrowMesh,this.myLineMesh=e.myLineMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myIsLocal=e.myIsLocal,this.myType=e.myType};Object.defineProperty(PP.VisualArrow.prototype,"_refresh",{enumerable:!1});Object.defineProperty(PP.VisualArrowParams.prototype,"copy",{enumerable:!1})});var zn=S(()=>{PP.VisualTextParams=class{constructor(){this.myText="",this.myAlignment=WL.Alignment.Center,this.myJustification=WL.Justification.Middle,this.myTransform=PP.mat4_create(),this.myMaterial=null,this.myColor=null,this.myParent=PP.myVisualData.myRootObject,this.myIsLocal=!1,this.myType=PP.VisualElementType.TEXT}copy(e){}};PP.VisualText=class{constructor(e=new PP.VisualTextParams){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myTextObject=null,this._myTextComponent=null,this._myTextMaterial=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myTextObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_refresh(){this._myTextObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myIsLocal?this._myTextObject.pp_setTransformLocal(this._myParams.myTransform):this._myTextObject.pp_setTransform(this._myParams.myTransform),this._myParams.myMaterial==null?this._myParams.myColor==null?this._myTextComponent.material=PP.myVisualData.myDefaultMaterials.myDefaultTextMaterial:(this._myTextMaterial==null&&(this._myTextMaterial=PP.myDefaultResources.myMaterials.myText.clone()),this._myTextComponent.material=this._myTextMaterial,this._myTextMaterial.color=this._myParams.myColor):this._myTextComponent.material=this._myParams.myMaterial,this._myTextComponent.text=this._myParams.myText,this._myTextComponent.alignment=this._myParams.myAlignment,this._myTextComponent.justification=this._myParams.myJustification,this._myDirty=!1}_build(){this._myTextObject=WL.scene.addObject(null),this._myTextComponent=this._myTextObject.addComponent("text")}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new PP.VisualTextParams;e.copy(this._myParams);let t=new PP.VisualText(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}};PP.VisualTextParams.prototype.copy=function(e){this.myText=e.myText,this.myAlignment=e.myAlignment,this.myJustification=e.myJustification,this.myTransform.mat4_copy(e.myTransform),e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myIsLocal=e.myIsLocal,this.myType=e.myType};Object.defineProperty(PP.VisualTextParams.prototype,"copy",{enumerable:!1})});var Gn=S(()=>{PP.VisualTransformParams=class{constructor(){this.myTransform=PP.mat4_create(),this.myLength=.2,this.myThickness=.005,this.myForwardMaterial=null,this.myUpMaterial=null,this.myRightMaterial=null,this.myParent=PP.myVisualData.myRootObject,this.myIsLocal=!1,this.myType=PP.VisualElementType.TRANSFORM}copy(e){}};PP.VisualTransform=class{constructor(e=new PP.VisualTransformParams){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualRight=new PP.VisualArrow,this._myVisualUp=new PP.VisualArrow,this._myVisualForward=new PP.VisualArrow,this._myVisualRight.setAutoRefresh(!1),this._myVisualUp.setAutoRefresh(!1),this._myVisualForward.setAutoRefresh(!1),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myVisualRight.setVisible(e),this._myVisualUp.setVisible(e),this._myVisualForward.setVisible(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh(),this._myVisualRight.forceRefresh(),this._myVisualUp.forceRefresh(),this._myVisualForward.forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualRight.update(e),this._myVisualUp.update(e),this._myVisualForward.update(e)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new PP.VisualTransformParams;e.copy(this._myParams);let t=new PP.VisualTransform(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}};PP.VisualTransform.prototype._refresh=function(){let i=[PP.vec3_create(),PP.vec3_create(),PP.vec3_create()],e=PP.vec3_create(),t=PP.vec3_create();return function(){i=this._myParams.myTransform.mat4_getAxes(i),e=this._myParams.myTransform.mat4_getScale(e);let a=0;for(let s of e)a=Math.max(s,a);a==0?(e[0]=1,e[1]=1,e[2]=1):(e[0]=e[0]/a,e[1]=e[1]/a,e[2]=e[2]/a),t=this._myParams.myTransform.mat4_getPosition(t);{let s=this._myVisualRight.getParams();s.myStart.vec3_copy(t),s.myDirection=i[0].vec3_negate(s.myDirection).vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[0],.001),s.myThickness=this._myParams.myThickness,this._myParams.myRightMaterial==null?s.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultRightMaterial:s.myMaterial=this._myParams.myRightMaterial,s.myParent=this._myParams.myParent,s.myIsLocal=this._myParams.myIsLocal,this._myVisualRight.paramsUpdated()}{let s=this._myVisualUp.getParams();s.myStart.vec3_copy(t),s.myDirection=i[1].vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[1],.001),s.myThickness=this._myParams.myThickness,this._myParams.myUpMaterial==null?s.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultUpMaterial:s.myMaterial=this._myParams.myUpMaterial,s.myParent=this._myParams.myParent,s.myIsLocal=this._myParams.myIsLocal,this._myVisualUp.paramsUpdated()}{let s=this._myVisualForward.getParams();s.myStart.vec3_copy(t),s.myDirection=i[2].vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[2],.001),s.myThickness=this._myParams.myThickness,this._myParams.myForwardMaterial==null?s.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultForwardMaterial:s.myMaterial=this._myParams.myForwardMaterial,s.myParent=this._myParams.myParent,s.myIsLocal=this._myParams.myIsLocal,this._myVisualForward.paramsUpdated()}}}();PP.VisualTransformParams.prototype.copy=function(e){this.myTransform.mat4_copy(e.myTransform),this.myLength=e.myLength,this.myThickness=e.myThickness,e.myRightMaterial!=null?this.myRightMaterial=e.myRightMaterial.clone():this.myRightMaterial=null,e.myUpMaterial!=null?this.myUpMaterial=e.myUpMaterial.clone():this.myUpMaterial=null,e.myForwardMaterial!=null?this.myForwardMaterial=e.myForwardMaterial.clone():this.myForwardMaterial=null,this.myParent=e.myParent,this.myIsLocal=e.myIsLocal,this.myType=e.myType};Object.defineProperty(PP.VisualTransform.prototype,"_refresh",{enumerable:!1});Object.defineProperty(PP.VisualTransformParams.prototype,"copy",{enumerable:!1})});var Un=S(()=>{PP.VisualRaycastParams=class{constructor(){this._myRaycastResults=new PP.RaycastResults,this.myHitNormalLength=.2,this.myThickness=.005,this.myShowOnlyFirstHit=!0,this.myRayMaterial=null,this.myHitNormalMaterial=null,this.myParent=PP.myVisualData.myRootObject,this.myIsLocal=!1,this.myType=PP.VisualElementType.RAYCAST}get myRaycastResults(){return this._myRaycastResults}set myRaycastResults(e){this._myRaycastResults.copy(e)}copy(e){}};PP.VisualRaycast=class{constructor(e=new PP.VisualRaycastParams){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualRaycast=new PP.VisualArrow,this._myVisualRaycast.setAutoRefresh(!1),this._myVisualRaycastHitList=[],this._addVisualRaycastHit(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){if(this._myVisible!=e)if(this._myVisible=e,this._myVisible){if(this._myParams.myRaycastResults.myRaycastSetup!=null&&this._myVisualRaycast.setVisible(!0),this._myParams.myRaycastResults.myHits.length>0){let t=Math.min(this._myParams.myRaycastResults.myHits.length,this._myVisualRaycastHitList.length);for(let n=0;n<t;n++)this._myVisualRaycastHitList[n].setVisible(!0)}}else{this._myVisualRaycast.setVisible(!1);for(let t of this._myVisualRaycastHitList)t.setVisible(!1)}}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){if(this._refresh(),this._myVisualRaycast.forceRefresh(),this._myParams.myRaycastResults.myHits.length>0){let e=Math.min(this._myParams.myRaycastResults.myHits.length,this._myVisualRaycastHitList.length);for(let t=0;t<e;t++)this._myVisualRaycastHitList[t].forceRefresh()}}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualRaycast.update(e);for(let t of this._myVisualRaycastHitList)t.update(e)}_refresh(){for(let e of this._myVisualRaycastHitList)e.setVisible(!1);if(this._myParams.myRaycastResults.myHits.length>0){let e=this._myParams.myShowOnlyFirstHit?this._myParams.myRaycastResults.myHits.pp_first().myDistance:this._myParams.myRaycastResults.myHits.pp_last().myDistance;{let n=this._myVisualRaycast.getParams();n.myStart.vec3_copy(this._myParams.myRaycastResults.myRaycastSetup.myOrigin),n.myDirection.vec3_copy(this._myParams.myRaycastResults.myRaycastSetup.myDirection),n.myLength=e,n.myThickness=this._myParams.myThickness,this._myParams.myRayMaterial==null?n.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultRayMaterial:n.myMaterial=this._myParams.myRayMaterial,n.myParent=this._myParams.myParent,n.myIsLocal=this._myParams.myIsLocal,this._myVisualRaycast.paramsUpdated(),this._myVisualRaycast.setVisible(this._myVisible)}let t=this._myParams.myShowOnlyFirstHit?1:this._myParams.myRaycastResults.myHits.length;for(;t>this._myVisualRaycastHitList.length;)this._addVisualRaycastHit();for(let n=0;n<t;n++){let a=this._myVisualRaycastHitList[n];{let s=a.getParams();s.myStart.vec3_copy(this._myParams.myRaycastResults.myHits[n].myPosition),s.myDirection.vec3_copy(this._myParams.myRaycastResults.myHits[n].myNormal),s.myLength=this._myParams.myHitNormalLength,s.myThickness=this._myParams.myThickness,this._myParams.myHitNormalMaterial==null?s.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultHitNormalMaterial:s.myMaterial=this._myParams.myHitNormalMaterial,s.myParent=this._myParams.myParent,s.myIsLocal=this._myParams.myIsLocal,a.paramsUpdated(),a.setVisible(this._myVisible)}}}else if(this._myParams.myRaycastResults.myRaycastSetup!=null){let e=this._myVisualRaycast.getParams();e.myStart.vec3_copy(this._myParams.myRaycastResults.myRaycastSetup.myOrigin),e.myDirection.vec3_copy(this._myParams.myRaycastResults.myRaycastSetup.myDirection),e.myLength=this._myParams.myRaycastResults.myRaycastSetup.myDistance,e.myThickness=this._myParams.myThickness,this._myParams.myRayMaterial==null?e.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultRayMaterial:e.myMaterial=this._myParams.myRayMaterial,e.myParent=this._myParams.myParent,e.myIsLocal=this._myParams.myIsLocal,this._myVisualRaycast.paramsUpdated(),this._myVisualRaycast.setVisible(this._myVisible)}else this._myVisualRaycast.setVisible(!1)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new PP.VisualRaycastParams;e.copy(this._myParams);let t=new PP.VisualRaycast(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_addVisualRaycastHit(){let e=new PP.VisualArrow;e.setAutoRefresh(!1),e.setVisible(!1),this._myVisualRaycastHitList.push(e)}};PP.VisualRaycastParams.prototype.copy=function(e){this.myRaycastResults=e.myRaycastResults,this.myHitNormalLength=e.myHitNormalLength,this.myThickness=e.myThickness,this.myShowOnlyFirstHit=e.myShowOnlyFirstHit,e.myRayMaterial!=null?this.myRayMaterial=e.myRayMaterial.clone():this.myRayMaterial=null,e.myHitNormalMaterial!=null?this.myHitNormalMaterial=e.myHitNormalMaterial.clone():this.myHitNormalMaterial=null,this.myParent=e.myParent,this.myIsLocal=e.myIsLocal,this.myType=e.myType};Object.defineProperty(PP.VisualRaycastParams.prototype,"copy",{enumerable:!1})});var Nn=S(()=>{PP.VisualTorusParams=class{constructor(){this.myTransform=PP.mat4_create(),this.myRadius=0,this.mySegmentsAmount=12,this.mySegmentThickness=.05,this.mySegmentMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=PP.myVisualData.myRootObject,this.myIsLocal=!1,this.myType=PP.VisualElementType.TORUS}copy(e){}};PP.VisualTorus=class{constructor(e=new PP.VisualTorusParams){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myTorusRootObject=null,this._myVisualSegmentList=[],this._myFlatOpaqueMaterial=null,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){if(this._myVisible!=e)if(this._myVisible=e,this._myVisible){let t=Math.min(this._myParams.mySegmentsAmount,this._myVisualSegmentList.length);for(let n=0;n<t;n++)this._myVisualSegmentList[n].setVisible(!0)}else for(let t of this._myVisualSegmentList)t.setVisible(!1)}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh();let e=Math.min(this._myParams.mySegmentsAmount,this._myVisualSegmentList.length);for(let t=0;t<e;t++)this._myVisualSegmentList[t].forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1);for(let t of this._myVisualSegmentList)t.update(e)}_build(){this._myTorusRootObject=WL.scene.addObject(null),this._fillSegmentList()}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}_fillSegmentList(){for(;this._myVisualSegmentList.length<this._myParams.mySegmentsAmount;){let e=new PP.VisualLine;e.setAutoRefresh(!1),e.setVisible(!1),e.getParams().myParent=this._myTorusRootObject,e.getParams().myIsLocal=!0,this._myVisualSegmentList.push(e)}}clone(){let e=new PP.VisualTorusParams;e.copy(this._myParams);let t=new PP.VisualTorus(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}};PP.VisualTorus.prototype._refresh=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(0,1,0);return function(){this._fillSegmentList();for(let m of this._myVisualSegmentList)m.setVisible(!1);this._myTorusRootObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myIsLocal?this._myTorusRootObject.pp_setTransformLocal(this._myParams.myTransform):this._myTorusRootObject.pp_setTransform(this._myParams.myTransform);let l=2*Math.PI/this._myParams.mySegmentsAmount;i.vec3_set(this._myParams.myRadius,0,0);for(let m=0;m<this._myParams.mySegmentsAmount;m++){e=i.vec3_rotateAxisRadians(l,s,e),t=e.vec3_sub(i,t).vec3_normalize(t);let c=Math.tan(l/2)*this._myParams.mySegmentThickness/2;n=i.vec3_sub(t.vec3_scale(c,n),n),a=e.vec3_add(t.vec3_scale(c,a),a);let r=this._myVisualSegmentList[m],y=r.getParams();y.setStartEnd(n,a),y.myThickness=this._myParams.mySegmentThickness,y.myMesh=this._myParams.mySegmentMesh,this._myParams.myMaterial==null?this._myParams.myColor==null?y.myMaterial=PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone()),y.myMaterial=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):y.myMaterial=this._myParams.myMaterial,r.paramsUpdated(),r.setVisible(this._myVisible),i.vec3_copy(e)}}}();PP.VisualTorusParams.prototype.copy=function(e){this.myRadius=e.myRadius,this.mySegmentsAmount=e.mySegmentsAmount,this.mySegmentThickness=e.mySegmentThickness,this.myTransform.mat4_copy(e.myTransform),this.mySegmentMesh=e.mySegmentMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myIsLocal=e.myIsLocal,this.myType=e.myType};Object.defineProperty(PP.VisualTorus.prototype,"_refresh",{enumerable:!1});Object.defineProperty(PP.VisualTorusParams.prototype,"copy",{enumerable:!1})});var qn=S(()=>{WL.registerComponent("pp-visual-manager",{},{init:function(){this.active&&(PP.myVisualData.myRootObject=WL.scene.addObject(null),PP.myVisualManager=new PP.VisualManager)},start(){PP.myVisualData.myDefaultMaterials.myDefaultMeshMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultTextMaterial=PP.myDefaultResources.myMaterials.myText.clone(),PP.myVisualData.myDefaultMaterials.myDefaultRightMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultRightMaterial.color=PP.vec4_create(1,0,0,1),PP.myVisualData.myDefaultMaterials.myDefaultUpMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultUpMaterial.color=PP.vec4_create(0,1,0,1),PP.myVisualData.myDefaultMaterials.myDefaultForwardMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultForwardMaterial.color=PP.vec4_create(0,0,1,1),PP.myVisualData.myDefaultMaterials.myDefaultRayMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultRayMaterial.color=PP.vec4_create(0,1,0,1),PP.myVisualData.myDefaultMaterials.myDefaultHitNormalMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),PP.myVisualData.myDefaultMaterials.myDefaultHitNormalMaterial.color=PP.vec4_create(1,0,0,1),PP.myVisualManager.start()},update(i){PP.myVisualManager.update(i)}});PP.myVisualManager=null;PP.myVisualData={myRootObject:null,myDefaultMaterials:{myDefaultMeshMaterial:null,myDefaultTextMaterial:null,myDefaultRightMaterial:null,myDefaultUpMaterial:null,myDefaultForwardMaterial:null,myDefaultRayMaterial:null,myDefaultHitNormalMaterial:null}}});var Qn=S(()=>{PP.DebugManager=class{constructor(){this._myDebugVisualManager=new PP.DebugVisualManager}getDebugVisualManager(){return this._myDebugVisualManager}start(){this._myDebugVisualManager.start()}update(e){this._myDebugVisualManager.update(e)}}});var Xn=S(()=>{PP.DebugVisualManager=class extends PP.VisualManager{drawLine(e,t,n,a,s=PP.vec4_create(0,1,0,1),o=.005){let l=new PP.VisualLineParams;l.myStart.vec3_copy(t),l.myDirection.vec3_copy(n),l.myLength=a,l.myThickness=o,l.myColor=PP.vec4_create(),l.myColor.vec4_copy(s),this.draw(l,e)}drawLineEnd(e,t,n,a=PP.vec4_create(0,1,0,1),s=.005){}drawArrow(e,t,n,a,s=PP.vec4_create(0,1,0,1),o=.005){let l=new PP.VisualArrowParams;l.myStart.vec3_copy(t),l.myDirection.vec3_copy(n),l.myLength=a,l.myThickness=o,l.myColor=PP.vec4_create(),l.myColor.vec4_copy(s),this.draw(l,e)}drawArrowEnd(e,t,n,a=PP.vec4_create(0,1,0,1),s=.005){}drawPoint(e,t,n=PP.vec4_create(0,1,0,1),a=.005){let s=new PP.VisualPointParams;s.myPosition.vec3_copy(t),s.myRadius=a,s.myColor=PP.vec4_create(),s.myColor.vec4_copy(n),this.draw(s,e)}drawText(e,t,n,a=PP.vec4_create(0,1,0,1),s=WL.Alignment.Center,o=WL.Justification.Middle){let l=new PP.VisualTextParams;l.myText=t,l.myAlignment=s,l.myJustification=o,l.myTransform.mat4_copy(n),l.myColor=PP.vec4_create(),l.myColor.vec4_copy(a),this.draw(l,e)}drawRaycast(e,t,n=!0,a=.2,s=.005){let o=new PP.VisualRaycastParams;o.myRaycastResults=t,o.myShowOnlyFirstHit=n,o.myHitNormalLength=a,o.myThickness=s,this.draw(o,e)}drawTransform(e,t,n=.2,a=.005){let s=new PP.VisualTransformParams;s.myTransform.mat4_copy(t),s.myLength=n,s.myThickness=a,this.draw(s,e)}};PP.DebugVisualManager.prototype.drawLineEnd=function(){let i=PP.vec3_create();return function(t,n,a,s=PP.vec4_create(0,1,0,1),o=.005){i=a.vec3_sub(n,i),length=i.vec3_length(),i.vec3_normalize(i),this.drawLine(t,n,i,length,s,o)}}();PP.DebugVisualManager.prototype.drawArrowEnd=function(){let i=PP.vec3_create();return function(t,n,a,s=PP.vec4_create(0,1,0,1),o=.005){i=a.vec3_sub(n,i),length=i.vec3_length(),i.vec3_normalize(i),this.drawArrow(t,n,i,length,s,o)}}();Object.defineProperty(PP.DebugVisualManager.prototype,"drawLineEnd",{enumerable:!1});Object.defineProperty(PP.DebugVisualManager.prototype,"drawArrowEnd",{enumerable:!1})});var Kn=S(()=>{WL.registerComponent("pp-debug-transform",{_myLength:{type:WL.Type.Float,default:.1},_myThickness:{type:WL.Type.Float,default:.005}},{init:function(){},start:function(){this._myDebugTransformParams=new PP.VisualTransformParams,this._myDebugTransformParams.myLength=this._myLength,this._myDebugTransformParams.myThickness=this._myThickness,this._myDebugVisualTransform=new PP.VisualTransform(this._myDebugTransformParams)},update:function(i){this.object.pp_getTransform(this._myDebugTransformParams.myTransform),this._myDebugVisualTransform.paramsUpdated()}})});var Jn=S(()=>{WL.registerComponent("pp-debug-manager",{},{init:function(){this.active&&(PP.myDebugManager=new PP.DebugManager,PP.myDebugVisualManager=PP.myDebugManager.getDebugVisualManager())},start(){PP.myDebugManager.start()},update(i){PP.myDebugManager.update(i)}});PP.myDebugManager=null;PP.myDebugVisualManager=null});var Zn=S(()=>{PP.DebugFunctionsOverwriterParams=class{constructor(){this.myObjectsByReference=[],this.myObjectsByPath=[],this.myClassesByReference=[],this.myClassesByPath=[],this.myFunctionsByPath=[],this.myExcludeConstructors=!1,this.myExcludeJavascriptObjectFunctions=!1,this.myFunctionNamesToInclude=[],this.myFunctionNamesToExclude=[],this.myFunctionPathsToInclude=[],this.myFunctionPathsToExclude=[],this.myObjectAddObjectDescendantsDepthLevel=0,this.myObjectAddClassDescendantsDepthLevel=0,this.myObjectNamesToInclude=[],this.myObjectNamesToExclude=[],this.myClassNamesToInclude=[],this.myClassNamesToExclude=[],this.myObjectPathsToInclude=[],this.myObjectPathsToExclude=[],this.myClassPathsToInclude=[],this.myClassPathsToExclude=[],this.myDebugLogActive=!1}};PP.DebugFunctionsOverwriter=class{constructor(e=new PP.DebugFunctionsOverwriterParams){this._myParams=e,this._myPropertiesAlreadyOverwritten=new Map}overwriteFunctions(){let e=this._getReferencesAndParents(this._myParams.myClassesByReference,this._myParams.myClassesByPath,!0),t=this._getReferencesAndParents(this._myParams.myObjectsByReference,this._myParams.myObjectsByPath,!1),n=this._getReferencesAndParents([],this._myParams.myFunctionsByPath,!1);this._objectAddDescendants(t,e);for(let a of e){let s=a[0],o=a[1],l=a[2],m=a[3],c=a[4];this._overwriteReferenceFunctions(s,o,l,m,c,!0)}for(let a of t){let s=a[0],o=a[1],l=a[2],m=a[3],c=a[4];this._overwriteReferenceFunctions(s,o,l,m,c,!1)}for(let a of n){let s=a[1],o=a[2],l=a[3];this._overwriteFunction(s,o,null,null,l,!1,!0)}}_getOverwrittenFunction(e,t,n,a,s){return PP.JSUtils.getReferenceProperty(e,t)}_getOverwrittenConstructor(e,t,n,a,s){return PP.JSUtils.getReferenceProperty(e,t)}_onOverwriteSuccess(e,t,n,a,s,o,l,m){}_onOverwriteFailure(e,t,n,a,s,o,l,m){}_overwriteReferenceFunctions(e,t,n,a,s,o){let l=this._myParams.myObjectPathsToInclude,m=this._myParams.myObjectPathsToExclude,c=this._myParams.myObjectNamesToInclude,r=this._myParams.myObjectNamesToExclude;o&&(l=this._myParams.myClassPathsToInclude,m=this._myParams.myClassPathsToExclude,c=this._myParams.myClassNamesToInclude,r=this._myParams.myClassNamesToExclude);let y=this._filterName(a,l,m),u=this._filterName(s,c,r);if(y&&u){let p=PP.JSUtils.getReferencePropertyNames(e);p.pp_hasEqual("constructor")&&p.unshift("constructor");for(let d of p){let _=null,h=null,P=null;if(o){let T=e;if(t!=null){let v=Object.getOwnPropertyDescriptor(t,n);v!=null&&v.value!=null&&(T=v.value)}if(_=T.prototype,_==null)_=T;else try{PP.JSUtils.getReferenceProperty(_,d)==null&&(_=T)}catch{_=T}h=t,P=n}else _=e;this._overwriteFunction(_,d,h,P,a,o,!1)}}}_overwriteFunction(e,t,n,a,s,o,l){try{if(!(this._myPropertiesAlreadyOverwritten.get(t)!=null&&this._myPropertiesAlreadyOverwritten.get(t).pp_hasEqual(e))&&PP.JSUtils.isFunctionByName(e,t)&&(!this._myParams.myExcludeJavascriptObjectFunctions||!this._isJavascriptObjectFunction(t))){let c=this._filterName(t,this._myParams.myFunctionNamesToInclude,this._myParams.myFunctionNamesToExclude),r=this._filterName((s!=null?s+".":"")+t,this._myParams.myFunctionPathsToInclude,this._myParams.myFunctionPathsToExclude);if(c&&r){this._myPropertiesAlreadyOverwritten.has(t)||this._myPropertiesAlreadyOverwritten.set(t,[]);let y=!1,u=!1;if(t!="constructor")try{let p=this._getOverwrittenFunction(e,t,s,o,l);p!=PP.JSUtils.getReferenceProperty(e,t)?y=PP.JSUtils.overwriteReferenceProperty(p,e,t,!1,!0,this._myParams.myDebugLogActive):y=!0}catch(p){y=!1,this._myParams.myDebugLogActive&&console.error(p)}else if(!this._myParams.myExcludeConstructors&&o&&n!=null){let p=PP.JSUtils.getReferenceProperty(n,a);if(p!=null&&p.prototype!=null){u=!0;try{let d=this._getOverwrittenConstructor(n,a,s,o,l);d!=p?(y=PP.JSUtils.overwriteReferenceProperty(d,n,a,!1,!0,this._myParams.myDebugLogActive),y&&(y=PP.JSUtils.overwriteReferenceProperty(d,p.prototype,t,!1,!0,this._myParams.myDebugLogActive))):y=!0}catch(d){y=!1,this._myParams.myDebugLogActive&&console.error(d)}}}y?(this._myPropertiesAlreadyOverwritten.get(t).push(e),this._onOverwriteSuccess(e,t,n,a,s,o,l,u)):this._onOverwriteFailure(e,t,n,a,s,o,l,u)}}}catch(m){this._myParams.myDebugLogActive&&console.error(m)}}_getReferencesAndParents(e,t,n){let a=[],s=(o,l)=>o[0]==l[0];for(let o of t){let l=o,m="",c=o,r="";o!=null&&Array.isArray(o)&&o.length!=null&&o.length==2&&typeof o[1]=="string"&&(l=o[0],c=o[1]),m=PP.JSUtils.getReferenceNameFromPath(l),r=PP.JSUtils.getReferenceNameFromPath(c);let y=PP.JSUtils.getReferenceFromPath(l),u=PP.JSUtils.getReferenceParentFromPath(l);y!=null&&a.pp_pushUnique([y,u,m,c,r],s)}for(let o of e){let l=o,m="",c="",r="";o!=null&&o.length!=null&&o.length==2&&typeof o[1]=="string"?(l=o[0],c=o[1],r=PP.JSUtils.getReferenceNameFromPath(c)):(c=n?l.name:null,r=n?l.name:null),n?m=l.name:m=PP.JSUtils.getReferenceNameFromPath(c),l!=null&&a.pp_pushUnique([l,null,m,c,r],s)}return a}_objectAddDescendants(e,t){let n=(s,o)=>s[0]==o[0],a=[];for(let s of e)a.pp_pushUnique([s[0],0,s[3]],n);for(;a.length>0;){let s=a.shift(),o=s[0],l=s[1],m=s[2];if(l+1<=this._myParams.myObjectAddObjectDescendantsDepthLevel||this._myParams.myObjectAddObjectDescendantsDepthLevel==-1||l+1<=this._myParams.myObjectAddClassDescendantsDepthLevel||this._myParams.myObjectAddClassDescendantsDepthLevel==-1){let c=PP.JSUtils.getReferencePropertyNames(o);for(let r of c){let y=null;try{if(y=PP.JSUtils.getReferenceProperty(o,r),y==null)continue}catch{continue}let u="",p="";m!=null?m=="_WL._components"&&y._type!=null?(p="["+r+']{"'+y._type+'"}',u=m+p):m=="_WL._componentTypes"&&y.TypeName!=null?(p=y.TypeName,u=m+'["'+p+'"]'):(p=r,u=m+"."+p):(p=r,u=p);let d=PP.JSUtils.isClassByName(o,r),_=PP.JSUtils.isObjectByName(o,r),h=this._myParams.myObjectPathsToInclude,P=this._myParams.myObjectPathsToExclude,T=this._myParams.myObjectNamesToInclude,v=this._myParams.myObjectNamesToExclude;d&&(h=this._myParams.myClassPathsToInclude,P=this._myParams.myClassPathsToExclude,T=this._myParams.myClassNamesToInclude,v=this._myParams.myClassNamesToExclude);let f=this._filterName(u,h,P),g=this._filterName(r,T,v);f&&g&&(_&&(l+1<=this._myParams.myObjectAddObjectDescendantsDepthLevel||this._myParams.myObjectAddObjectDescendantsDepthLevel==-1)&&e.pp_pushUnique([y,o,r,u,p],n),d&&(l+1<=this._myParams.myObjectAddClassDescendantsDepthLevel||this._myParams.myObjectAddClassDescendantsDepthLevel==-1)&&t.pp_pushUnique([y,o,r,u,p],n),_&&a.pp_pushUnique([y,l+1,u],n))}}}}_filterName(e,t,n){let a=t.length==0;for(let s of t)if(e.match(new RegExp(s))!=null){a=!0;break}if(a){for(let s of n)if(e.match(new RegExp(s))!=null){a=!1;break}}return a}};PP.DebugFunctionsOverwriter.prototype._isJavascriptObjectFunction=function(){let i=["__defineGetter__","__defineSetter__","hasOwnProperty","__lookupGetter__","__lookupSetter__","isPrototypeOf","propertyIsEnumerable","toString","valueOf","__proto__","toLocaleString","arguments","caller","apply","bind","call","callee"];return function(t){return i.pp_hasEqual(t)}}();Object.defineProperty(PP.DebugFunctionsOverwriter.prototype,"_isJavascriptObjectFunction",{enumerable:!1})});var Yn=S(()=>{PP.DebugFunctionsPerformanceAnalyzerParams=class extends PP.DebugFunctionsOverwriterParams{constructor(){super(),this.myExecutionTimeAnalysisEnabled=!0,this.myAddPathPrefixToFunctionID=!0,this.myFilterDebugFunctionsPerformanceAnalyzerClasses=!0}};PP.DebugFunctionPerformanceAnalysisResults=class{constructor(){this.myReference=null,this.myName="",this.myPath="",this.myID="",this.myCallsCount=0,this.myTotalExecutionTime=0,this.myTotalExecutionTimePercentage=0,this.myAverageExecutionTime=0,this.myTimeElapsedSinceLastReset=0,this._myTotalExecutionTimeInternal=0}reset(){this.myCallsCount=0,this.myTotalExecutionTime=0,this.myTotalExecutionTimePercentage=0,this.myAverageExecutionTime=0,this.myTimeElapsedSinceLastReset=0,this._myTotalExecutionTimeInternal=0}max(e){this.myCallsCount=Math.max(this.myCallsCount,e.myCallsCount),this.myTotalExecutionTime=Math.max(this.myTotalExecutionTime,e.myTotalExecutionTime),this.myTotalExecutionTimePercentage=Math.max(this.myTotalExecutionTimePercentage,e.myTotalExecutionTimePercentage),this.myAverageExecutionTime=Math.max(this.myAverageExecutionTime,e.myAverageExecutionTime)}copy(e){this.myReference=e.myReference,this.myName=e.myName,this.myPath=e.myPath,this.myID=e.myID,this.myCallsCount=e.myCallsCount,this.myTotalExecutionTime=e.myTotalExecutionTime,this.myTotalExecutionTimePercentage=e.myTotalExecutionTimePercentage,this.myAverageExecutionTime=e.myAverageExecutionTime,this.myTimeElapsedSinceLastReset=e.myTimeElapsedSinceLastReset,this._myTotalExecutionTimeInternal=e._myTotalExecutionTimeInternal}};PP.DebugFunctionsPerformanceAnalyzerSortOrder={NONE:0,CALLS_COUNT:1,TOTAL_EXECUTION_TIME:2,AVERAGE_EXECUTION_TIME:3};PP.DebugFunctionsPerformanceAnalyzer=class extends PP.DebugFunctionsOverwriter{constructor(e=new PP.DebugFunctionsOverwriterParams){super(e),this._myFunctionPerformanceAnalysisResults=new Map,this._myFunctionPerformanceAnalysisMaxResults=new Map,this._myResultsAlreadyAdded=!1,this._myExecutionTimes={myOverheadExecutionTimeSinceLastReset:0,myLastFunctionExecutionTime:0,myOriginalFunctionOverheadExecutionTimes:[]},this._myTimeOfLastReset=window.performance.now(),this._myMaxTimeElapsedSinceLastReset=0;let t=Array.prototype.push,n=Array.prototype.pop;this._myExecutionTimes.myOriginalFunctionOverheadExecutionTimes.push=function(){return t.bind(this)(...arguments)},this._myExecutionTimes.myOriginalFunctionOverheadExecutionTimes.pop=function(){return n.bind(this)(...arguments)}}overwriteFunctions(){super.overwriteFunctions(),this.resetResults(),this.resetMaxResults()}getTimeElapsedSinceLastReset(){return window.performance.now()-this._myTimeOfLastReset-this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset}getMaxTimeElapsedSinceLastReset(){return this._myMaxTimeElapsedSinceLastReset=Math.max(this._myMaxTimeElapsedSinceLastReset,this.getTimeElapsedSinceLastReset()),this._myMaxTimeElapsedSinceLastReset}resetResults(){this._updateDerivatesResults(),this._updateMaxResults();for(let e of this._myFunctionPerformanceAnalysisResults.keys())this._myFunctionPerformanceAnalysisResults.get(e).reset();this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset=0,this._myTimeOfLastReset=window.performance.now()}resetMaxResults(){this._myMaxTimeElapsedSinceLastReset=0;for(let e of this._myFunctionPerformanceAnalysisMaxResults.keys())this._myFunctionPerformanceAnalysisMaxResults.get(e).reset()}getResults(e=PP.DebugFunctionsPerformanceAnalyzerSortOrder.NONE){this._updateDerivatesResults(),this._updateMaxResults();let t=this._myFunctionPerformanceAnalysisResults;return t=this._sortResults(t,e),t}getMaxResults(e=PP.DebugFunctionsPerformanceAnalyzerSortOrder.NONE){this._updateDerivatesResults(),this._updateMaxResults();let t=this._myFunctionPerformanceAnalysisMaxResults;return t=this._sortResults(t,e),t}_getOverwrittenFunction(e,t,n,a,s){return this._getOverwrittenFunctionInternal(e,t,n,a,s,!1)}_getOverwrittenConstructor(e,t,n,a,s){return this._getOverwrittenFunctionInternal(e,t,n,a,s,!0)}_onOverwriteSuccess(e,t,n,a,s,o,l,m){this._myResultsAlreadyAdded=!1}_onOverwriteFailure(e,t,n,a,s,o,l,m){if(this._myResultsAlreadyAdded){let c=this._getPropertyID(t,s,l,m);this._myFunctionPerformanceAnalysisResults.delete(c)}}_sortResults(e,t){let n=e;return t!=PP.DebugFunctionsPerformanceAnalyzerSortOrder.NONE&&(n=new Map([...e.entries()].sort(function(a,s){let o=0;return t==PP.DebugFunctionsPerformanceAnalyzerSortOrder.CALLS_COUNT?(o=-(a[1].myCallsCount-s[1].myCallsCount),o==0&&(o=-(a[1].myTotalExecutionTime-s[1].myTotalExecutionTime),o==0&&(o=-(a[1].myAverageExecutionTime-s[1].myAverageExecutionTime)))):t==PP.DebugFunctionsPerformanceAnalyzerSortOrder.TOTAL_EXECUTION_TIME?(o=-(a[1].myTotalExecutionTime-s[1].myTotalExecutionTime),o==0&&(o=-(a[1].myAverageExecutionTime-s[1].myAverageExecutionTime),o==0&&(o=-(a[1].myCallsCount-s[1].myCallsCount)))):(o=-(a[1].myAverageExecutionTime-s[1].myAverageExecutionTime),o==0&&(o=-(a[1].myTotalExecutionTime-s[1].myTotalExecutionTime),o==0&&(o=-(a[1].myCallsCount-s[1].myCallsCount)))),o}))),n}_getPropertyID(e,t,n,a){let s=a?"constructor":e;return t!=null&&this._myParams.myAddPathPrefixToFunctionID&&(n?s=t:s=t+"."+s),s}_updateDerivatesResults(){let e=this.getTimeElapsedSinceLastReset(),t=window.performance.now();for(let n of this._myFunctionPerformanceAnalysisResults.keys()){let a=this._myFunctionPerformanceAnalysisResults.get(n);e!=0?a.myTotalExecutionTimePercentage=a.myTotalExecutionTime/e:a.myCallsCount!=0?a.myTotalExecutionTimePercentage=1:a.myTotalExecutionTimePercentage=0,a.myCallsCount!=0?a.myAverageExecutionTime=a.myTotalExecutionTime/a.myCallsCount:a.myAverageExecutionTime=0,a.myTimeElapsedSinceLastReset=e}this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset+=window.performance.now()-t}_updateMaxResults(){let e=window.performance.now();this._myMaxTimeElapsedSinceLastReset=Math.max(this._myMaxTimeElapsedSinceLastReset,this.getTimeElapsedSinceLastReset());for(let t of this._myFunctionPerformanceAnalysisResults.keys())if(this._myFunctionPerformanceAnalysisMaxResults.has(t))this._myFunctionPerformanceAnalysisMaxResults.get(t).max(this._myFunctionPerformanceAnalysisResults.get(t));else{let n=new PP.DebugFunctionPerformanceAnalysisResults;n.copy(this._myFunctionPerformanceAnalysisResults.get(t)),this._myFunctionPerformanceAnalysisMaxResults.set(t,n)}this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset+=window.performance.now()-e}_getOverwrittenFunctionInternal(e,t,n,a,s,o){let l=PP.JSUtils.getReferenceProperty(e,t);if((!this._myParams.myFilterDebugFunctionsPerformanceAnalyzerClasses||!this._isPerformanceAnalyzer(e,t,a))&&t!="_myPerformanceAnalyzerOriginalFunction"){let m=this._getPropertyID(t,n,s,o);this._myResultsAlreadyAdded=this._myFunctionPerformanceAnalysisResults.has(m);let c=new PP.DebugFunctionPerformanceAnalysisResults;c.myReference=e,c.myName=t,c.myPath=n,c.myID=n,this._myFunctionPerformanceAnalysisResults.set(m,c);try{let r=this._myFunctionPerformanceAnalysisResults.get(m),y=this._myExecutionTimes,u=e[t],p=175e-6,d=35e-5,_=this._myParams.myExecutionTimeAnalysisEnabled;o?l=function(){let h=window.performance.now(),P=null,T,v=null,f=0,g=0,C=0,M=0,b=0,A=0,I=0;if(_){y.myOriginalFunctionOverheadExecutionTimes.push(0),f=window.performance.now(),g=window.performance.now();try{f=window.performance.now(),T=new u(...arguments),g=window.performance.now()}catch(V){g=window.performance.now(),P=V}}else try{T=new u(...arguments)}catch(V){P=V}if(r.myCallsCount+=1,_&&(C=y.myOriginalFunctionOverheadExecutionTimes.pop(),M=g-f-C,b=M-p,u._myPerformanceAnalyzerHasBeenOverwritten&&(b=y.myLastFunctionExecutionTime),r._myTotalExecutionTimeInternal+=b,r.myTotalExecutionTime=Math.max(0,r._myTotalExecutionTimeInternal),y.myLastFunctionExecutionTime=b,A=f-h,I=A-g-d,y.myOriginalFunctionOverheadExecutionTimes.length>0&&(y.myOriginalFunctionOverheadExecutionTimes[y.myOriginalFunctionOverheadExecutionTimes.length-1]+=I+C+d*2.75,y.myOriginalFunctionOverheadExecutionTimes[y.myOriginalFunctionOverheadExecutionTimes.length-1]+=window.performance.now()),y.myOverheadExecutionTimeSinceLastReset+=I,y.myOverheadExecutionTimeSinceLastReset+=window.performance.now()),P!=null)throw P;return T}:l=function(){let h=window.performance.now(),P=null,T,v=null,f=0,g=0,C=0,M=0,b=0,A=0,I=0;if(_){y.myOriginalFunctionOverheadExecutionTimes.push(0),f=window.performance.now(),g=window.performance.now();try{v=u.bind(this),f=window.performance.now(),T=v(...arguments),g=window.performance.now()}catch(V){g=window.performance.now(),P=V}}else try{v=u.bind(this),T=v(...arguments)}catch(V){P=V}if(r.myCallsCount+=1,_&&(C=y.myOriginalFunctionOverheadExecutionTimes.pop(),M=g-f-C,b=M-p,u._myPerformanceAnalyzerHasBeenOverwritten&&(b=y.myLastFunctionExecutionTime),r._myTotalExecutionTimeInternal+=b,r.myTotalExecutionTime=Math.max(0,r._myTotalExecutionTimeInternal),y.myLastFunctionExecutionTime=b,A=f-h,I=A-g-d,y.myOriginalFunctionOverheadExecutionTimes.length>0&&(y.myOriginalFunctionOverheadExecutionTimes[y.myOriginalFunctionOverheadExecutionTimes.length-1]+=I+C+d*2.75,y.myOriginalFunctionOverheadExecutionTimes[y.myOriginalFunctionOverheadExecutionTimes.length-1]+=window.performance.now()),y.myOverheadExecutionTimeSinceLastReset+=I,y.myOverheadExecutionTimeSinceLastReset+=window.performance.now()),P!=null)throw P;return T},l!=null&&(Object.defineProperty(l,"_myPerformanceAnalyzerHasBeenOverwritten",{value:!0,enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(l,"_myPerformanceAnalyzerOriginalFunction",{value:u,enumerable:!1,configurable:!1,writable:!1}))}catch(r){this._myParams.myDebugLogActive&&console.error("Function:",t,"of:",e,`can't be overwritten.
Error:`,r)}}return l}_isPerformanceAnalyzer(e,t,n){let a=!1;return n&&(e==PP.DebugFunctionsPerformanceAnalyzer.prototype||e==PP.DebugFunctionPerformanceAnalysisResults.prototype)&&(a=!0),a}}});var $n=S(()=>{PP.DebugFunctionsPerformanceAnalysisResultsLoggerParams=class{constructor(){this.myPerformanceAnalyzer=null,this.myLogTitle="Functions Performance Analysis Results",this.mySecondsBetweenLogs=1,this.myLogFunction="log",this.myFormatLog=!0,this.myFormatLogIndentationCharacter="-",this.myLogMaxResults=!1,this.myLogSortOrder=PP.DebugFunctionsPerformanceAnalyzerSortOrder.NONE,this.myLogMaxAmountOfFunctions=null,this.myLogFunctionsWithCallsCountAbove=null,this.myLogFunctionsWithTotalExecutionTimePercentageAbove=null,this.myLogCallsCountResults=!1,this.myLogTotalExecutionTimeResults=!1,this.myLogTotalExecutionTimePercentageResults=!1,this.myLogAverageExecutionTimeResults=!1,this.myClearConsoleBeforeLog=!1}};PP.DebugFunctionsPerformanceAnalysisResultsLogger=class{constructor(e){this._myParams=e,this._myLogTimer=new PP.Timer(this._myParams.mySecondsBetweenLogs),this._myMaxNameLength=0,this._myMaxCallsCountLength=0,this._myMaxTotalExecutionTimeLength=0,this._myMaxTotalExecutionTimePercentageLength=0,this._myMaxAverageExecutionTimeLength=0}update(e){if(this._myParams.myPerformanceAnalyzer!=null&&(this._myLogTimer.update(e),this._myLogTimer.isDone())){this._myLogTimer.start();let t=this._myParams.myPerformanceAnalyzer.getTimeElapsedSinceLastReset();this._myParams.myLogMaxResults&&(t=this._myParams.myPerformanceAnalyzer.getMaxTimeElapsedSinceLastReset());let n=null;if(this._myParams.myLogMaxResults?n=this._myParams.myPerformanceAnalyzer.getMaxResults(this._myParams.myLogSortOrder):n=this._myParams.myPerformanceAnalyzer.getResults(this._myParams.myLogSortOrder),this._myParams.myLogFunctionsWithCallsCountAbove!=null){let o=new Map(n);n=new Map;let l=[...o.keys()];for(let m=0;m<l.length;m++){let c=o.get(l[m]);c.myCallsCount>this._myParams.myLogFunctionsWithCallsCountAbove&&n.set(l[m],c)}}if(this._myParams.myLogFunctionsWithTotalExecutionTimePercentageAbove!=null){let o=new Map(n);n=new Map;let l=[...o.keys()];for(let m=0;m<l.length;m++){let c=o.get(l[m]);c.myTotalExecutionTimePercentage*100>this._myParams.myLogFunctionsWithTotalExecutionTimePercentageAbove&&n.set(l[m],c)}}if(this._myParams.myLogMaxAmountOfFunctions!=null){let o=new Map(n);n=new Map;let l=[...o.keys()];for(let m=0;m<this._myParams.myLogMaxAmountOfFunctions&&m<l.length;m++){let c=o.get(l[m]);n.set(l[m],c)}}this._myParams.myClearConsoleBeforeLog&&console.clear();let a=new Map;for(let o of n.keys()){let l=n.get(o),m={};this._myParams.myLogCallsCountResults&&(m.myCallsCount=l.myCallsCount),this._myParams.myLogTotalExecutionTimeResults&&(m.myTotalExecutionTime=l.myTotalExecutionTime),this._myParams.myLogTotalExecutionTimePercentageResults&&(m.myTotalExecutionTimePercentage=l.myTotalExecutionTimePercentage),this._myParams.myLogAverageExecutionTimeResults&&(m.myAverageExecutionTime=l.myAverageExecutionTime),a.set(o,m)}let s="";for(let o of n.entries()){let l=o[0],m=o[1];this._myMaxNameLength=Math.max(this._myMaxNameLength,l.length),this._myMaxCallsCountLength=Math.max(this._myMaxCallsCountLength,m.myCallsCount.toFixed(0).length),this._myMaxTotalExecutionTimeLength=Math.max(this._myMaxTotalExecutionTimeLength,m.myTotalExecutionTime.toFixed(5).length),this._myMaxTotalExecutionTimePercentageLength=Math.max(this._myMaxTotalExecutionTimePercentageLength,(m.myTotalExecutionTimePercentage*100).toFixed(2).length),this._myMaxAverageExecutionTimeLength=Math.max(this._myMaxAverageExecutionTimeLength,m.myAverageExecutionTime.toFixed(5).length)}for(let o of n.entries()){let l=o[0],m=o[1],c=0;this._myParams.myLogCallsCountResults&&c++,this._myParams.myLogTotalExecutionTimeResults&&c++,this._myParams.myLogTotalExecutionTimePercentageResults&&c++,this._myParams.myLogAverageExecutionTimeResults&&c++;let r=[],y=c>1?"Calls Count: ":"";if(this._myParams.myFormatLog)for(let h=0;h<this._myMaxCallsCountLength-m.myCallsCount.toFixed(0).length;h++)y+=" ";y+=m.myCallsCount.toFixed(0);let u=c>1?"Total Time: ":"";if(this._myParams.myFormatLog)for(let h=0;h<this._myMaxTotalExecutionTimeLength-m.myTotalExecutionTime.toFixed(5).length;h++)u+=" ";u+=m.myTotalExecutionTime.toFixed(5)+"ms";let p=c>1?"Total Time: ":"";if(this._myParams.myFormatLog)for(let h=0;h<this._myMaxTotalExecutionTimePercentageLength-(m.myTotalExecutionTimePercentage*100).toFixed(2).length;h++)p+=" ";p+=(m.myTotalExecutionTimePercentage*100).toFixed(2)+"%";let d=c>1?"Average Time: ":"";if(this._myParams.myFormatLog)for(let h=0;h<this._myMaxAverageExecutionTimeLength-m.myAverageExecutionTime.toFixed(5).length;h++)d+=" ";switch(d+=m.myAverageExecutionTime.toFixed(5)+"ms",this._myParams.myLogCallsCountResults||(y=null),this._myParams.myLogTotalExecutionTimeResults||(u=null),this._myParams.myLogTotalExecutionTimePercentageResults||(p=null),this._myParams.myLogAverageExecutionTimeResults||(d=null),this._myParams.myLogSortOrder){case PP.DebugFunctionsPerformanceAnalyzerSortOrder.CALLS_COUNT:r.push(y),r.push(u),r.push(p),r.push(d);break;case PP.DebugFunctionsPerformanceAnalyzerSortOrder.TOTAL_EXECUTION_TIME:r.push(u),r.push(p),r.push(d),r.push(y);break;case PP.DebugFunctionsPerformanceAnalyzerSortOrder.AVERAGE_EXECUTION_TIME:r.push(d),r.push(u),r.push(p),r.push(y);break;default:r.push(y),r.push(u),r.push(p),r.push(d)}if(s+=`
`,this._myParams.myFormatLog){let h=l+" ";for(;h.length<this._myMaxNameLength+1;)h+=this._myParams.myFormatLogIndentationCharacter;h+=this._myParams.myFormatLogIndentationCharacter+" ",s+=h}else s+=l+" - ";let _=!0;for(let h of r)h!=null&&(_?_=!1:s+=" - ",s+=h)}this._myParams.myLogTotalExecutionTimeResults||this._myParams.myLogTotalExecutionTimePercentageResults||this._myParams.myLogAverageExecutionTimeResults?console[this._myParams.myLogFunction](`
`+this._myParams.myLogTitle,`

Total Time:`,t.toFixed(5),`ms
`,s):console[this._myParams.myLogFunction](`
`+this._myParams.myLogTitle,`
`,s)}}}});var ea=S(()=>{WL.registerComponent("pp-debug-functions-performance-analyzer",{_myObjectsByPath:{type:WL.Type.String,default:""},_myClassesByPath:{type:WL.Type.String,default:""},_myFunctionsByPath:{type:WL.Type.String,default:""},_myDelayStart:{type:WL.Type.Float,default:0},_myLogTitle:{type:WL.Type.String,default:"Functions Performance Analysis Results"},_myLogFunction:{type:WL.Type.Enum,values:["log","error","warn","debug"],default:"log"},_mySecondsBetweenLogs:{type:WL.Type.Float,default:1},_myLogMaxResults:{type:WL.Type.Bool,default:!1},_myLogSortOrder:{type:WL.Type.Enum,values:["none","calls count","total execution time","average execution time"],default:"none"},_myLogCallsCountResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimePercentageResults:{type:WL.Type.Bool,default:!0},_myLogAverageExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogMaxAmountOfFunctions:{type:WL.Type.Int,default:-1},_myLogFunctionsWithCallsCountAbove:{type:WL.Type.Int,default:-1},_myLogFunctionsWithTotalExecutionTimePercentageAbove:{type:WL.Type.Float,default:-1},_myFunctionPathsToInclude:{type:WL.Type.String,default:""},_myFunctionPathsToExclude:{type:WL.Type.String,default:""},_myExcludeConstructors:{type:WL.Type.Bool,default:!1},_myExcludeJavascriptObjectFunctions:{type:WL.Type.Bool,default:!0},_myAddPathPrefixToFunctionID:{type:WL.Type.Bool,default:!0},_myObjectAddObjectDescendantsDepthLevel:{type:WL.Type.Int,default:0},_myObjectAddClassDescendantsDepthLevel:{type:WL.Type.Int,default:0},_myClearConsoleBeforeLog:{type:WL.Type.Bool,default:!1},_myResetMaxResultsShortcutEnabled:{type:WL.Type.Bool,default:!1}},{init(){this._myFunctionsPerformanceAnalyzer=null,this._myFunctionsPerformanceAnalysisResultsLogger=null,this._mySkipFirstUpdate=!0,this._myStartTimer=new PP.Timer(this._myDelayStart),this._myDelayStart==0&&(this._myStartTimer.end(),this._mySkipFirstUpdate=!1,this._start())},update(i){if(this._mySkipFirstUpdate){this._mySkipFirstUpdate=!1;return}this._myStartTimer.isRunning()?(this._myStartTimer.update(i),this._myStartTimer.isDone()&&this._start()):(this._myFunctionsPerformanceAnalysisResultsLogger.update(i),this._myFunctionsPerformanceAnalyzer.resetResults()),this._myResetMaxResultsShortcutEnabled&&PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.SELECT).isPressEnd(3)&&this._myFunctionsPerformanceAnalyzer.resetMaxResults()},_start(){let i=new PP.DebugFunctionsPerformanceAnalyzerParams;if(this._myObjectsByPath.length>0){let t=[...this._myObjectsByPath.split(",")];for(let n=0;n<t.length;n++)t[n]=t[n].trim();i.myObjectsByPath.push(...t)}if(this._myClassesByPath.length>0){let t=[...this._myClassesByPath.split(",")];for(let n=0;n<t.length;n++)t[n]=t[n].trim();i.myClassesByPath.push(...t)}if(this._myFunctionsByPath.length>0){let t=[...this._myFunctionsByPath.split(",")];for(let n=0;n<t.length;n++)t[n]=t[n].trim();i.myFunctionsByPath.push(...t)}if(i.myExcludeConstructors=this._myExcludeConstructors,i.myExcludeJavascriptObjectFunctions=this._myExcludeJavascriptObjectFunctions,i.myAddPathPrefixToFunctionID=this._myAddPathPrefixToFunctionID,this._myFunctionPathsToInclude.length>0){let t=[...this._myFunctionPathsToInclude.split(",")];for(let n=0;n<t.length;n++)t[n]=t[n].trim();i.myFunctionPathsToInclude.push(...t)}if(this._myFunctionPathsToExclude.length>0){let t=[...this._myFunctionPathsToExclude.split(",")];for(let n=0;n<t.length;n++)t[n]=t[n].trim();i.myFunctionPathsToExclude.push(...t)}i.myObjectAddObjectDescendantsDepthLevel=this._myObjectAddObjectDescendantsDepthLevel,i.myObjectAddClassDescendantsDepthLevel=this._myObjectAddClassDescendantsDepthLevel,i.myExecutionTimeAnalysisEnabled=this._myLogTotalExecutionTimeResults||this._myLogTotalExecutionTimePercentageResults||this._myLogAverageExecutionTimeResults,i.myClassesByReference=this._myClassesByReference!=null?this._myClassesByReference:[],i.myObjectsByReference=this._myObjectsByReference!=null?this._myObjectsByReference:[],this._myFunctionsPerformanceAnalyzer=new PP.DebugFunctionsPerformanceAnalyzer(i),this._myFunctionsPerformanceAnalyzer.overwriteFunctions();let e=new PP.DebugFunctionsPerformanceAnalysisResultsLoggerParams;e.myPerformanceAnalyzer=this._myFunctionsPerformanceAnalyzer,e.myLogTitle=this._myLogTitle,e.mySecondsBetweenLogs=this._mySecondsBetweenLogs,e.myLogFunction=["log","error","warn","debug"][this._myLogFunction],e.myLogMaxAmountOfFunctions=this._myLogMaxAmountOfFunctions>=0?this._myLogMaxAmountOfFunctions:null,e.myLogFunctionsWithCallsCountAbove=this._myLogFunctionsWithCallsCountAbove>=0?this._myLogFunctionsWithCallsCountAbove:null,e.myLogFunctionsWithTotalExecutionTimePercentageAbove=this._myLogFunctionsWithTotalExecutionTimePercentageAbove>=0?this._myLogFunctionsWithTotalExecutionTimePercentageAbove:null,e.myLogMaxResults=this._myLogMaxResults,e.myClearConsoleBeforeLog=this._myClearConsoleBeforeLog,e.myLogSortOrder=this._myLogSortOrder,e.myLogCallsCountResults=this._myLogCallsCountResults,e.myLogTotalExecutionTimeResults=this._myLogTotalExecutionTimeResults,e.myLogTotalExecutionTimePercentageResults=this._myLogTotalExecutionTimePercentageResults,e.myLogAverageExecutionTimeResults=this._myLogAverageExecutionTimeResults,this._myFunctionsPerformanceAnalysisResultsLogger=new PP.DebugFunctionsPerformanceAnalysisResultsLogger(e)}})});var ta=S(()=>{WL.registerComponent("pp-debug-pp-functions-performance-analyzer",{_myAnalyzePPObjects:{type:WL.Type.Bool,default:!1},_myDelayStart:{type:WL.Type.Float,default:0},_myLogFunction:{type:WL.Type.Enum,values:["log","error","warn","debug"],default:"log"},_mySecondsBetweenLogs:{type:WL.Type.Float,default:1},_myLogMaxResults:{type:WL.Type.Bool,default:!1},_myLogSortOrder:{type:WL.Type.Enum,values:["none","calls count","total execution time","average execution time"],default:"none"},_myLogCallsCountResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimePercentageResults:{type:WL.Type.Bool,default:!0},_myLogAverageExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogMaxAmountOfFunctions:{type:WL.Type.Int,default:-1},_myLogFunctionsWithCallsCountAbove:{type:WL.Type.Int,default:-1},_myLogFunctionsWithTotalExecutionTimePercentageAbove:{type:WL.Type.Float,default:-1},_myFunctionPathsToInclude:{type:WL.Type.String,default:""},_myFunctionPathsToExclude:{type:WL.Type.String,default:""},_myExcludeConstructors:{type:WL.Type.Bool,default:!1},_myClearConsoleBeforeLog:{type:WL.Type.Bool,default:!1},_myResetMaxResultsShortcutEnabled:{type:WL.Type.Bool,default:!1}},{init(){this.object.pp_addComponent("pp-debug-functions-performance-analyzer",{_myObjectsByPath:"PP",_myDelayStart:this._myDelayStart,_myLogTitle:"PP Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJavascriptObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddObjectDescendantsDepthLevel:this._myAnalyzePPObjects?1:0,_myObjectAddClassDescendantsDepthLevel:3,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}})});var ia=S(()=>{WL.registerComponent("pp-debug-array-functions-performance-analyzer",{_myIncludeOnlyMainArrayTypes:{type:WL.Type.Bool,default:!0},_myIncludeOnlyArrayExtensionFunctions:{type:WL.Type.Bool,default:!1},_myDelayStart:{type:WL.Type.Float,default:0},_myLogFunction:{type:WL.Type.Enum,values:["log","error","warn","debug"],default:"log"},_mySecondsBetweenLogs:{type:WL.Type.Float,default:1},_myLogMaxResults:{type:WL.Type.Bool,default:!1},_myLogSortOrder:{type:WL.Type.Enum,values:["none","calls count","total execution time","average execution time"],default:"none"},_myLogCallsCountResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimePercentageResults:{type:WL.Type.Bool,default:!0},_myLogAverageExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogMaxAmountOfFunctions:{type:WL.Type.Int,default:-1},_myLogFunctionsWithCallsCountAbove:{type:WL.Type.Int,default:-1},_myLogFunctionsWithTotalExecutionTimePercentageAbove:{type:WL.Type.Float,default:-1},_myFunctionPathsToInclude:{type:WL.Type.String,default:""},_myFunctionPathsToExclude:{type:WL.Type.String,default:""},_myExcludeConstructors:{type:WL.Type.Bool,default:!1},_myClearConsoleBeforeLog:{type:WL.Type.Bool,default:!1},_myResetMaxResultsShortcutEnabled:{type:WL.Type.Bool,default:!1}},{init(){let i="Array, Uint8ClampedArray, Uint8Array, Uint16Array, Uint32Array, Int8Array, Int16Array, Int32Array, Float32Array, Float64Array";this._myIncludeOnlyMainArrayTypes&&(i="Array, Uint8Array, Uint16Array, Float32Array"),this.object.pp_addComponent("pp-debug-functions-performance-analyzer",{_myClassesByPath:i,_myDelayStart:this._myDelayStart,_myLogTitle:"Array Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude+(this._myFunctionPathsToInclude.length>0&&this._myIncludeOnlyArrayExtensionFunctions?", ":"")+(this._myIncludeOnlyArrayExtensionFunctions?"pp_, vec_, vec2_, vec3_, vec4_, quat_, quat2_, mat3_, mat4_, _pp_, _vec_, _quat_":""),_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJavascriptObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}})});var na=S(()=>{WL.registerComponent("pp-debug-pp-array-creation-performance-analyzer",{_myDelayStart:{type:WL.Type.Float,default:0},_myLogFunction:{type:WL.Type.Enum,values:["log","error","warn","debug"],default:"log"},_mySecondsBetweenLogs:{type:WL.Type.Float,default:1},_myLogMaxResults:{type:WL.Type.Bool,default:!1},_myLogSortOrder:{type:WL.Type.Enum,values:["none","calls count","total execution time","average execution time"],default:"none"},_myLogCallsCountResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimePercentageResults:{type:WL.Type.Bool,default:!0},_myLogAverageExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogMaxAmountOfFunctions:{type:WL.Type.Int,default:-1},_myLogFunctionsWithCallsCountAbove:{type:WL.Type.Int,default:-1},_myLogFunctionsWithTotalExecutionTimePercentageAbove:{type:WL.Type.Float,default:-1},_myClearConsoleBeforeLog:{type:WL.Type.Bool,default:!1},_myResetMaxResultsShortcutEnabled:{type:WL.Type.Bool,default:!1}},{init(){this.object.pp_addComponent("pp-debug-functions-performance-analyzer",{_myObjectsByPath:"PP",_myDelayStart:this._myDelayStart,_myLogTitle:"PP Array Creation Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:"vec2_create, vec3_create, vec4_create, quat_create, quat2_create, mat3_create, mat4_create",_myExcludeConstructors:!0,_myExcludeJavascriptObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}})});var aa=S(()=>{WL.registerComponent("pp-debug-wl-functions-performance-analyzer",{_myAnalyzeWLObjects:{type:WL.Type.Bool,default:!1},_myDelayStart:{type:WL.Type.Float,default:0},_myLogFunction:{type:WL.Type.Enum,values:["log","error","warn","debug"],default:"log"},_mySecondsBetweenLogs:{type:WL.Type.Float,default:1},_myLogMaxResults:{type:WL.Type.Bool,default:!1},_myLogSortOrder:{type:WL.Type.Enum,values:["none","calls count","total execution time","average execution time"],default:"none"},_myLogCallsCountResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimePercentageResults:{type:WL.Type.Bool,default:!0},_myLogAverageExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogMaxAmountOfFunctions:{type:WL.Type.Int,default:-1},_myLogFunctionsWithCallsCountAbove:{type:WL.Type.Int,default:-1},_myLogFunctionsWithTotalExecutionTimePercentageAbove:{type:WL.Type.Float,default:-1},_myFunctionPathsToInclude:{type:WL.Type.String,default:""},_myFunctionPathsToExclude:{type:WL.Type.String,default:""},_myExcludeConstructors:{type:WL.Type.Bool,default:!1},_myClearConsoleBeforeLog:{type:WL.Type.Bool,default:!1},_myResetMaxResultsShortcutEnabled:{type:WL.Type.Bool,default:!1}},{init(){this.object.pp_addComponent("pp-debug-functions-performance-analyzer",{_myObjectsByPath:"WL",_myDelayStart:this._myDelayStart,_myLogTitle:"WL Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJavascriptObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddObjectDescendantsDepthLevel:this._myAnalyzeWLObjects?1:0,_myObjectAddClassDescendantsDepthLevel:3,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}})});var sa=S(()=>{WL.registerComponent("pp-debug-wl-components-functions-performance-analyzer",{_myAnalyzeComponentTypes:{type:WL.Type.Bool,default:!0},_myAnalyzeComponentInstances:{type:WL.Type.Bool,default:!1},_myDelayStart:{type:WL.Type.Float,default:0},_myLogFunction:{type:WL.Type.Enum,values:["log","error","warn","debug"],default:"log"},_mySecondsBetweenLogs:{type:WL.Type.Float,default:1},_myLogMaxResults:{type:WL.Type.Bool,default:!1},_myLogSortOrder:{type:WL.Type.Enum,values:["none","calls count","total execution time","average execution time"],default:"none"},_myLogCallsCountResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogTotalExecutionTimePercentageResults:{type:WL.Type.Bool,default:!0},_myLogAverageExecutionTimeResults:{type:WL.Type.Bool,default:!0},_myLogMaxAmountOfFunctions:{type:WL.Type.Int,default:-1},_myLogFunctionsWithCallsCountAbove:{type:WL.Type.Int,default:-1},_myLogFunctionsWithTotalExecutionTimePercentageAbove:{type:WL.Type.Float,default:-1},_myFunctionPathsToInclude:{type:WL.Type.String,default:""},_myFunctionPathsToExclude:{type:WL.Type.String,default:""},_myExcludeConstructors:{type:WL.Type.Bool,default:!1},_myClearConsoleBeforeLog:{type:WL.Type.Bool,default:!1},_myResetMaxResultsShortcutEnabled:{type:WL.Type.Bool,default:!1}},{init(){let i="";this._myAnalyzeComponentTypes&&(i+="_WL._componentTypes"),this._myAnalyzeComponentInstances&&(i.length>0&&(i+=", "),i+="_WL._components");let e=[],t=["mesh","physx","animation","collision","input","light","text","view"];for(let n of t)e.push([Object.getPrototypeOf(WL._wrapComponent(n,WL.Object._typeIndexFor(n),0)),'_WL._componentTypes["'+n+'"]']);this._myAnalyzerComponent=this.object.pp_addComponent("pp-debug-functions-performance-analyzer",{_myObjectsByReference:e,_myObjectsByPath:i,_myDelayStart:this._myDelayStart+.001,_myLogTitle:"WL Components Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude+(this._myFunctionPathsToExclude.length>0?", ":"")+"_WL\\._components\\., _WL\\._componentTypes\\., functions-performance-analyzer",_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJavascriptObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddObjectDescendantsDepthLevel:1,_myObjectAddClassDescendantsDepthLevel:1,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})},update(i){let t=2*2}})});var oa=S(()=>{PP.Direction2DTo3DConverterParams=class{constructor(){this.myStartFlyingForward=!1,this.myStartFlyingRight=!1,this.myAutoUpdateFlyForward=!1,this.myAutoUpdateFlyRight=!1,this.myResetFlyForwardWhenZero=!1,this.myResetFlyRightWhenZero=!1,this.myMinAngleToFlyForwardUp=90,this.myMinAngleToFlyForwardDown=90,this.myMinAngleToFlyRightUp=90,this.myMinAngleToFlyRightDown=90}};PP.Direction2DTo3DConverter=class{constructor(e=new PP.Direction2DTo3DConverterParams){this._myParams=e,this._myIsFlyingForward=this._myParams.myStartFlyingForward,this._myIsFlyingRight=this._myParams.myStartFlyingRight,this._myLastValidFlatForward=PP.vec3_create(),this._myLastValidFlatRight=PP.vec3_create(),this._myMinAngleToBeValid=5}convert(e,t,n=null,a=PP.vec3_create()){return this.convertTransform(e,t,n,a)}isFlying(){return this._myIsFlyingForward||this._myIsFlyingRight}isFlyingForward(){return this._myIsFlyingForward}isFlyingRight(){return this._myIsFlyingRight}startFlying(){this._myIsFlyingForward=!0,this._myIsFlyingRight=!0}startFlyingForward(){this._myIsFlyingForward=!0}startFlyingRight(){this._myIsFlyingRight=!0}stopFlying(){this._myIsFlyingForward=!1,this._myIsFlyingRight=!1}stopFlyingForward(){this._myIsFlyingForward=!1}stopFlyingRight(){this._myIsFlyingRight=!1}resetFly(){this.resetFlyForward(),this.resetFlyRight()}resetFlyForward(){this._myParams.myStartFlyingForward?this.startFlyingForward():this.stopFlyingForward(),this._myLastValidFlatForward.vec3_zero()}resetFlyRight(){this._myParams.myStartFlyingRight?this.startFlyingRight():this.stopFlyingRight(),this._myLastValidFlatRight.vec3_zero()}convertForward(e,t,n=null,a=PP.vec3_create()){}convertTransform(e,t,n=null,a=PP.vec3_create()){return this.convertTransformMatrix(e,t,n,a)}convertTransformMatrix(e,t,n=null,a=PP.vec3_create()){}convertTransformQuat(e,t,n=null,a=PP.vec3_create()){}convertRotationQuat(e,t,n=null,a=PP.vec3_create()){}};PP.Direction2DTo3DConverter.prototype.convertForward=function(){let i=PP.quat_create();return function(t,n,a=null,s=PP.vec3_create()){return i.quat_identity(),i.quat_setForward(n,a),this.convertRotationQuat(t,i,a,s)}}();PP.Direction2DTo3DConverter.prototype.convertTransformMatrix=function(){let i=PP.quat_create();return function(t,n,a=null,s=PP.vec3_create()){return i=n.mat4_getRotationQuat(i),this.convertRotationQuat(t,i,a,s)}}();PP.Direction2DTo3DConverter.prototype.convertTransformQuat=function(){let i=PP.quat_create();return function(t,n,a=null,s=PP.vec3_create()){return i=n.quat2_getRotationQuat(i),this.convertRotationQuat(t,i,a,s)}}();PP.Direction2DTo3DConverter.prototype.convertRotationQuat=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create();return function(o,l,m=null,c=PP.vec3_create()){if(o.vec2_isZero())return this._myParams.myAutoUpdateFlyForward&&this._myParams.myResetFlyForwardWhenZero&&this.resetFlyForward(),this._myParams.myAutoUpdateFlyRight&&this._myParams.myResetFlyRightWhenZero&&this.resetFlyRight(),c.vec3_zero(),c;if(o[0]==0&&this._myLastValidFlatRight.vec3_zero(),o[1]==0&&this._myLastValidFlatForward.vec3_zero(),i=l.quat_getForward(i),e=l.quat_getRight(e),m!=null){if(t=m.vec3_negate(t),this._myParams.myAutoUpdateFlyForward){let r=i.vec3_angle(m);this._myIsFlyingForward=this._myIsFlyingForward||r<90-this._myParams.myMinAngleToFlyForwardUp||r>90+this._myParams.myMinAngleToFlyForwardDown}if(this._myParams.myAutoUpdateFlyRight){let r=e.vec3_angle(m);this._myIsFlyingRight=this._myIsFlyingRight||r<90-this._myParams.myMinAngleToFlyRightUp||r>90+this._myParams.myMinAngleToFlyRightDown}this._myIsFlyingForward||(!this._myLastValidFlatForward.vec3_isZero(1e-6)&&(i.vec3_angle(m)<this._myMinAngleToBeValid||i.vec3_angle(t)<this._myMinAngleToBeValid)&&(i.vec3_isConcordant(this._myLastValidFlatForward)?i.pp_copy(this._myLastValidFlatForward):i=this._myLastValidFlatForward.vec3_negate(i)),i=i.vec3_removeComponentAlongAxis(m,i),i.vec3_normalize(i)),this._myIsFlyingRight||(!this._myLastValidFlatRight.vec3_isZero(1e-6)&&(e.vec3_angle(m)<this._myMinAngleToBeValid||e.vec3_angle(t)<this._myMinAngleToBeValid)&&(e.vec3_isConcordant(this._myLastValidFlatRight)?e.pp_copy(this._myLastValidFlatRight):e=this._myLastValidFlatRight.vec3_negate(e)),e=e.vec3_removeComponentAlongAxis(m,e),e.vec3_normalize(e)),(i.vec3_angle(m)>this._myMinAngleToBeValid&&i.vec3_angle(t)>this._myMinAngleToBeValid||o[1]!=0&&this._myLastValidFlatForward.vec3_isZero(1e-6))&&(this._myLastValidFlatForward=i.vec3_removeComponentAlongAxis(m,this._myLastValidFlatForward),this._myLastValidFlatForward.vec3_normalize(this._myLastValidFlatForward)),(e.vec3_angle(m)>this._myMinAngleToBeValid&&e.vec3_angle(t)>this._myMinAngleToBeValid||o[0]!=0&&this._myLastValidFlatRight.vec3_isZero(1e-6))&&(this._myLastValidFlatRight=e.vec3_removeComponentAlongAxis(m,this._myLastValidFlatRight),this._myLastValidFlatRight.vec3_normalize(this._myLastValidFlatRight))}return c=e.vec3_scale(o[0],a).vec3_add(i.vec3_scale(o[1],n),c),m!=null&&!this._myIsFlyingForward&&!this._myIsFlyingRight&&(c=c.vec3_removeComponentAlongAxis(m,c)),c.vec3_normalize(c),c}}()});var ra=S(()=>{Number.prototype.get=function(){return this.valueOf()};Object.defineProperty(Number.prototype,"get",{enumerable:!1});PP.NumberOverValue=class{constructor(e,t=null,n=0,a=0,s=PP.EasingFunction.linear,o=null){t==null&&(t=e),this._myStartNumber=e,this._myEndNumber=t,this._myStartInterpolationValue=n,this._myEndInterpolationValue=a,this._myEasingFunction=s,this._myRoundingFunction=o}get(e){let t=this._myEasingFunction(Math.pp_mapToRange(e,this._myStartInterpolationValue,this._myEndInterpolationValue,0,1)),n=Math.pp_lerp(this._myStartNumber,this._myEndNumber,t);return this._myRoundingFunction&&(n=this._myRoundingFunction(n,this._myStartNumber,this._myEndNumber)),n}getAverage(e){return this.get(e)}getRange(e){let t=this.get(e);return[t,t]}getMax(e){return this.get(e)}getMin(e){return this.get(e)}isInside(e,t){return this.get(t)==e}isInsideAngleRange(e,t){return this.isInsideAngleRangeDegrees(e,t)}isInsideAngleRangeDegrees(e,t){let n=this.get(t),a=Math.pp_angleClampDegrees(e),s=Math.pp_angleClampDegrees(n);return a==s}isInsideAngleRangeRadians(e,t){let n=this.get(t),a=Math.pp_angleClampRadians(e),s=Math.pp_angleClampRadians(n);return a==s}};PP.IntOverValue=class extends PP.NumberOverValue{constructor(e,t,n,a,s=PP.EasingFunction.linear,o=null){o==null&&(o=function(l,m,c){let r=null;return m<=c?r=Math.floor(l):r=Math.ceil(l),r}),super(e,t,n,a,s,o)}};PP.NumberRangeOverValue=class{constructor(e,t=null,n=0,a=0,s=PP.EasingFunction.linear,o=null){t==null&&(t=e),this._myStartNumberOverValue=new PP.NumberOverValue(e[0],t[0],n,a,s,o),this._myEndNumberOverValue=new PP.NumberOverValue(e[1],t[1],n,a,s,o),this._myRoundingFunction=o}get(e){let t=this._myStartNumberOverValue.get(e),n=this._myEndNumberOverValue.get(e),a=null;return this._myRoundingFunction?a=Math.pp_randomInt(t,n):a=Math.pp_random(t,n),a}getAverage(e){let t=this._myStartNumberOverValue.get(e),n=this._myEndNumberOverValue.get(e),a=(t+n)/2;return this._myRoundingFunction&&(a=this._myRoundingFunction(a,t,n)),a}getRange(e){let t=this._myStartNumberOverValue.get(e),n=this._myEndNumberOverValue.get(e);return[t,n]}getMax(e){let t=this._myStartNumberOverValue.get(e),n=this._myEndNumberOverValue.get(e);return Math.max(t,n)}getMin(e){let t=this._myStartNumberOverValue.get(e),n=this._myEndNumberOverValue.get(e);return Math.min(t,n)}isInside(e,t){let n=this._myStartNumberOverValue.get(t),a=this._myEndNumberOverValue.get(t),s=Math.min(n,a),o=Math.max(n,a);return e>=s&&e<=o}isInsideAngleRange(e,t){return this.isInsideAngleRangeDegrees(e,t)}isInsideAngleRangeDegrees(e,t){let n=this._myStartNumberOverValue.get(t),a=this._myEndNumberOverValue.get(t);return Math.pp_isInsideAngleRangeDegrees(e,n,a)}isInsideAngleRangeRadians(e,t){let n=this._myStartNumberOverValue.get(t),a=this._myEndNumberOverValue.get(t);return Math.pp_isInsideAngleRangeRadians(e,n,a)}};PP.IntRangeOverValue=class extends PP.NumberRangeOverValue{constructor(e,t,n,a,s=PP.EasingFunction.linear,o=null){o==null&&(o=function(l,m,c){let r=null;return m<=c?r=Math.floor(l):r=Math.ceil(l),r}),super(e,t,n,a,s,o)}}});var la=S(()=>{WL.registerComponent("pp-grabbable",{_myThrowLinearVelocityMultiplier:{type:WL.Type.Float,default:1},_myThrowAngularVelocityMultiplier:{type:WL.Type.Float,default:1},_myKinematicValueOnRelease:{type:WL.Type.Enum,values:["true","false","own"],default:"false"},_myParentOnRelease:{type:WL.Type.Enum,values:["null","own"],default:"own"}},{init:function(){this._myIsGrabbed=!1,this._myGrabber=null,this._myGrabCallbacks=new Map,this._myThrowCallbacks=new Map,this._myReleaseCallbacks=new Map},start:function(){this._myOldParent=this.object.parent,this._myPhysX=this.object.pp_getComponent("physx"),this._myOldKinematicValue=null},onDeactivate:function(){this.release()},grab:function(i){this.isGrabbed()||(this._myOldKinematicValue=this._myPhysX.kinematic),this.release(),this._myPhysX.kinematic=!0,this._myOldParent=this.object.parent,this.object.pp_setParent(i),this._myIsGrabbed=!0,this._myGrabCallbacks.forEach(function(e){e(i,this)}.bind(this))},throw:function(i,e){if(this._myIsGrabbed){let t=this._myGrabber;this._release(),this._myPhysX.linearVelocity=i.vec3_scale(this._myThrowLinearVelocityMultiplier),this._myPhysX.angularVelocity=e.vec3_scale(this._myThrowAngularVelocityMultiplier),this._myThrowCallbacks.forEach(function(n){n(t,this)}.bind(this)),this._myReleaseCallbacks.forEach(function(n){n(t,this,!0)}.bind(this))}},release(){if(this._myIsGrabbed){let i=this._myGrabber;this._release(),this._myReleaseCallbacks.forEach(function(e){e(i,this,!1)}.bind(this))}},getLinearVelocity(){let i=PP.vec3_create();return this._myPhysX.linearVelocity.vec3_clone(i),i},getAngularVelocity(){return this.getAngularVelocityDegrees()},getAngularVelocityDegrees(){let i=PP.vec3_create();return this._myPhysX.angularVelocity.vec3_toDegrees(i),i},getAngularVelocityRadians(){let i=PP.vec3_create();return this._myPhysX.angularVelocity.vec3_clone(i),i},isGrabbed(){return this._myIsGrabbed},getGrabber(){return this._myGrabber},registerGrabEventListener(i,e){this._myGrabCallbacks.set(i,e)},unregisterGrabEventListener(i){this._myGrabCallbacks.delete(i)},registerThrowEventListener(i,e){this._myThrowCallbacks.set(i,e)},unregisterThrowEventListener(i){this._myThrowCallbacks.delete(i)},registerReleaseEventListener(i,e){this._myReleaseCallbacks.set(i,e)},unregisterReleaseEventListener(i){this._myReleaseCallbacks.delete(i)},_release(){this._myParentOnRelease==0?this.object.pp_setParent(null):this.object.pp_setParent(this._myOldParent),this._myIsGrabbed=!1,this._myGrabber=null,this._myKinematicValueOnRelease==0?this._myPhysX.kinematic=!0:this._myKinematicValueOnRelease==1?this._myPhysX.kinematic=!1:this._myOldKinematicValue!=null&&(this._myPhysX.kinematic=this._myOldKinematicValue),this._myPhysX.kinematic&&(this._myPhysX.linearVelocity=PP.vec3_create(),this._myPhysX.angularVelocity=PP.vec3_create())},pp_clone(i){let e=i.pp_addComponent(this.type);return e._myThrowLinearVelocityMultiplier=this._myThrowLinearVelocityMultiplier,e._myThrowAngularVelocityMultiplier=this._myThrowAngularVelocityMultiplier,e._myKinematicValueOnRelease=this._myKinematicValueOnRelease,e},pp_clonePostProcess(){this.start()}})});var ma=S(()=>{WL.registerComponent("pp-grabber-hand",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myGrabButton:{type:WL.Type.Enum,values:["select","squeeze","both","both_exclusive"],default:"squeeze"},_mySnapOnPivot:{type:WL.Type.Bool,default:!1},_myMaxNumberOfObjects:{type:WL.Type.Int,default:1},_myThrowVelocitySource:{type:WL.Type.Enum,values:["hand","grabbable"],default:"hand"},_myThrowLinearVelocityMultiplier:{type:WL.Type.Float,default:1},_myThrowMaxLinearSpeed:{type:WL.Type.Float,default:15},_myThrowAngularVelocityMultiplier:{type:WL.Type.Float,default:.5},_myThrowMaxAngularSpeed:{type:WL.Type.Float,default:1080},_myThrowLinearVelocityBoost:{type:WL.Type.Float,default:1.75},_myThrowLinearVelocityBoostMinSpeedThreshold:{type:WL.Type.Float,default:.6},_myThrowLinearVelocityBoostMaxSpeedThreshold:{type:WL.Type.Float,default:2.5}},{init:function(){this._myGrabbables=[],this._myGamepad=null,this._myActiveGrabButton=null,this._myLinearVelocityHistorySize=5,this._myLinearVelocityHistorySpeedAverageSamplesFromStart=1,this._myLinearVelocityHistoryDirectionAverageSamplesFromStart=3,this._myLinearVelocityHistoryDirectionAverageSkipFromStart=0,this._myHandLinearVelocityHistory=new Array(this._myLinearVelocityHistorySize),this._myHandLinearVelocityHistory.fill(PP.vec3_create()),this._myAngularVelocityHistorySize=1,this._myHandAngularVelocityHistory=new Array(this._myAngularVelocityHistorySize),this._myHandAngularVelocityHistory.fill(PP.vec3_create()),this._myThrowMaxAngularSpeedRadians=Math.pp_toRadians(this._myThrowMaxAngularSpeed),this._myGrabCallbacks=new Map,this._myThrowCallbacks=new Map,this._myDebugActive=!1},start:function(){this._myHandedness==PP.HandednessIndex.LEFT?this._myGamepad=PP.myLeftGamepad:this._myGamepad=PP.myRightGamepad,this._myPhysX=this.object.pp_getComponent("physx"),this._myCollisionsCollector=new PP.PhysicsCollisionCollector(this._myPhysX,!0)},update:function(i){this._myCollisionsCollector.update(i),this._myGrabbables.length>0&&(this._updateLinearVelocityHistory(),this._updateAngularVelocityHistory())},grab:function(i=null){this._grab(i)},throw:function(i=null){this._throw(i)},registerGrabEventListener(i,e){this._myGrabCallbacks.set(i,e)},unregisterGrabEventListener(i){this._myGrabCallbacks.delete(i)},registerThrowEventListener(i,e){this._myThrowCallbacks.set(i,e)},unregisterThrowEventListener(i){this._myThrowCallbacks.delete(i)},onActivate(){this._myGamepad!=null&&(this._myGrabButton==0?(this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_START,this,this._grab.bind(this,PP.GamepadButtonID.SELECT)),this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_END,this,this._throw.bind(this,PP.GamepadButtonID.SELECT))):this._myGrabButton==1?(this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_START,this,this._grab.bind(this,PP.GamepadButtonID.SQUEEZE)),this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_END,this,this._throw.bind(this,PP.GamepadButtonID.SQUEEZE))):(this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_START,this,this._grab.bind(this,PP.GamepadButtonID.SQUEEZE)),this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_END,this,this._throw.bind(this,PP.GamepadButtonID.SQUEEZE)),this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_START,this,this._grab.bind(this,PP.GamepadButtonID.SELECT)),this._myGamepad.registerButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_END,this,this._throw.bind(this,PP.GamepadButtonID.SELECT))))},onDeactivate(){this._myGamepad!=null&&(this._myGrabButton==0?(this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_END,this)):this._myGrabButton==1?(this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_END,this)):(this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.PRESS_END,this),this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.PRESS_END,this)))},_grab:function(i){if(!(this._myGrabbables.length>=this._myMaxNumberOfObjects)&&(this._myGrabButton==2||this._myActiveGrabButton==null||this._myActiveGrabButton==i||i==null)){let e=[],t=this._myCollisionsCollector.getCollisions();for(let a=0;a<t.length;a++){let s=t[a].getComponent("pp-grabbable");s&&s.active&&e.push(s)}let n=this.object.pp_getPosition();e.sort(function(a,s){let o=a.object.pp_getPosition(),l=s.object.pp_getPosition(),m=o.vec3_distance(n),c=l.vec3_distance(n);return Math.pp_sign(m-c,0)});for(let a of e){if(!this._isAlreadyGrabbed(a)){let s=new PP.GrabberHandGrabbableData(a,this._myThrowVelocitySource==1,this._myLinearVelocityHistorySize,this._myAngularVelocityHistorySize);this._myGrabbables.push(s),a.grab(this.object),a.registerReleaseEventListener(this,this._onRelease.bind(this)),this._mySnapOnPivot&&a.object.resetTranslation(),this._myGrabCallbacks.forEach(function(o){o(this,a)}.bind(this))}if(this._myGrabbables.length>=this._myMaxNumberOfObjects)break}this._myGrabbables.length>0&&this._myActiveGrabButton==null&&(this._myActiveGrabButton=i)}},_throw:function(i){if(this._myGrabButton==2||this._myActiveGrabButton==null||this._myActiveGrabButton==i||i==null){if(this._myGrabbables.length>0){let e=null,t=null;this._myThrowVelocitySource==0&&(e=this._computeReleaseLinearVelocity(this._myHandLinearVelocityHistory),t=this._computeReleaseAngularVelocity(this._myHandAngularVelocityHistory));for(let n of this._myGrabbables){let a=n.getGrabbable();a.unregisterReleaseEventListener(this),this._myThrowVelocitySource==1&&(e=this._computeReleaseLinearVelocity(n.getLinearVelocityHistory()),t=this._computeReleaseAngularVelocity(n.getAngularVelocityHistory())),a.throw(e,t),this._myThrowCallbacks.forEach(function(s){s(this,a)}.bind(this))}this._myGrabbables=[]}this._myActiveGrabButton=null}},_onRelease(i,e){e.unregisterReleaseEventListener(this),this._myGrabbables.pp_remove(t=>t.getGrabbable()==e),this._myGrabbables.length<=0&&(this._myActiveGrabButton=null)},_updateLinearVelocityHistory(){let i=this._myGamepad.getHandPose();this._myHandLinearVelocityHistory.unshift(i.getLinearVelocity().pp_clone()),this._myHandLinearVelocityHistory.pop();for(let e of this._myGrabbables)e.updateLinearVelocityHistory()},_updateAngularVelocityHistory(){let i=this._myGamepad.getHandPose();this._myHandAngularVelocityHistory.unshift(i.getAngularVelocityRadians().pp_clone()),this._myHandAngularVelocityHistory.pop();for(let e of this._myGrabbables)e.updateAngularVelocityHistory()},_computeReleaseLinearVelocity(i){let e=i[0].vec3_length();for(let l=1;l<this._myLinearVelocityHistorySpeedAverageSamplesFromStart;l++)e+=i[l].vec3_length();e/=this._myLinearVelocityHistorySpeedAverageSamplesFromStart;let t=Math.pp_mapToRange(e,this._myThrowLinearVelocityBoostMinSpeedThreshold,this._myThrowLinearVelocityBoostMaxSpeedThreshold,0,1);t=PP.EasingFunction.easeIn(t),e+=e*(t*this._myThrowLinearVelocityBoost),e*=this._myThrowLinearVelocityMultiplier,e=Math.pp_clamp(e,0,this._myThrowMaxLinearSpeed),this._myDebugActive&&this._debugDirectionLines(i);let a=this._myLinearVelocityHistoryDirectionAverageSamplesFromStart,s=this._myLinearVelocityHistoryDirectionAverageSkipFromStart+this._myLinearVelocityHistoryDirectionAverageSamplesFromStart,o=PP.vec3_create();for(let l=this._myLinearVelocityHistoryDirectionAverageSkipFromStart;l<s;l++){let m=i[l];m.vec3_scale(a,m),o.vec3_add(m,o),a--}return o.vec3_normalize(o),o.vec3_scale(e,o),o},_computeReleaseAngularVelocity(i){let e=i[0],t=e.vec3_length();t=Math.pp_clamp(t*this._myThrowAngularVelocityMultiplier,0,this._myThrowMaxAngularSpeedRadians);let n=e;return n.vec3_normalize(n),n.vec3_scale(t,n),n},_debugDirectionLines(i){for(let e=this._myLinearVelocityHistoryDirectionAverageSkipFromStart+this._myLinearVelocityHistoryDirectionAverageSamplesFromStart;e>this._myLinearVelocityHistoryDirectionAverageSkipFromStart;e--){let t=e-this._myLinearVelocityHistoryDirectionAverageSkipFromStart,n=e-this._myLinearVelocityHistoryDirectionAverageSkipFromStart,a=PP.vec3_create();for(let o=this._myLinearVelocityHistoryDirectionAverageSkipFromStart;o<n;o++){let l=i[o].pp_clone();l.vec3_scale(t,l),a.vec3_add(l,a),t--}a.vec3_normalize(a);let s=1/e;PP.myDebugVisualManager.drawLine(5,this.object.pp_getPosition(),a,.2,PP.vec4_create(olor,s,s,1))}},_isAlreadyGrabbed(i){return this._myGrabbables.pp_find(t=>t.getGrabbable()==i)!=null}});PP.GrabberHandGrabbableData=class{constructor(e,t,n,a){this._myGrabbable=e,this._myUseGrabbableAsVelocitySource=t,this._myUseGrabbableAsVelocitySource&&(this._myLinearVelocityHistory=new Array(n),this._myLinearVelocityHistory.fill(PP.vec3_create()),this._myAngularVelocityHistory=new Array(a),this._myAngularVelocityHistory.fill(PP.vec3_create()))}getGrabbable(){return this._myGrabbable}getLinearVelocityHistory(){return this._myLinearVelocityHistory}getAngularVelocityHistory(){return this._myAngularVelocityHistory}updateLinearVelocityHistory(){this._myUseGrabbableAsVelocitySource&&(this._myLinearVelocityHistory.unshift(this._myGrabbable.getLinearVelocity()),this._myLinearVelocityHistory.pop())}updateAngularVelocityHistory(){this._myUseGrabbableAsVelocitySource&&(this._myAngularVelocityHistory.unshift(this._myGrabbable.getAngularVelocityRadians()),this._myAngularVelocityHistory.pop())}}});var ya=S(()=>{PP.CAError={DUMMY_NOT_INITIALIZED:0,CA_SDK_MISSING:1,SUBMIT_SCORE_FAILED:2,GET_LEADERBOARD_FAILED:3,GET_USER_FAILED:4,USER_HAS_NO_SCORE:5};PP.CAUtils={_myDummyServer:null,_myUseDummyServerOnSDKMissing:!1,_myUseDummyServerOnError:!1,setUseDummyServerOnSDKMissing:function(i){PP.CAUtils._myUseDummyServerOnSDKMissing=i},setUseDummyServerOnError:function(i){PP.CAUtils._myUseDummyServerOnError=i},setDummyServer:function(i){PP.CAUtils._myDummyServer=i},isUseDummyServerOnSDKMissing:function(){return PP.CAUtils._myUseDummyServerOnSDKMissing},isUseDummyServerOnError:function(){return PP.CAUtils._myUseDummyServerOnError},getDummyServer:function(){return PP.CAUtils._myDummyServer},isSDKAvailable:function(){return"casdk"in window},getLeaderboard:function(i,e,t,n,a,s,o=null){if(PP.CAUtils.isSDKAvailable())t?PP.CAUtils.getUser(function(l){let m=l.displayName;casdk.getLeaderboard(i,e,t,n).then(function(c){if(c.leaderboard){let r=!1;for(let y of c.leaderboard)if(y.displayName==m&&y.score!=0){r=!0;break}if(r)a&&a(c.leaderboard);else if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.getLeaderboard!=null&&PP.CAUtils._myUseDummyServerOnError&&o==null||o!=null&&o)PP.CAUtils.getLeaderboardDummy(i,e,t,n,a,s);else if(s){let y={};y.reason="Searching for around player but the user has not submitted a score yet",y.type=PP.CAError.USER_HAS_NO_SCORE,s(y,c)}}else if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.getLeaderboard!=null&&PP.CAUtils._myUseDummyServerOnError&&o==null||o!=null&&o)PP.CAUtils.getLeaderboardDummy(i,e,t,n,a,s);else if(s){let r={};r.reason="Get leaderboard failed",r.type=PP.CAError.GET_LEADERBOARD_FAILED,s(r,c)}}).catch(function(c){if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.getLeaderboard!=null&&PP.CAUtils._myUseDummyServerOnError&&o==null||o!=null&&o)PP.CAUtils.getLeaderboardDummy(i,e,t,n,a,s);else if(s){let r={};r.reason="Get leaderboard failed",r.type=PP.CAError.GET_LEADERBOARD_FAILED,s(r,c)}})},function(){if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.getLeaderboard!=null&&PP.CAUtils._myUseDummyServerOnError&&o==null||o!=null&&o)PP.CAUtils.getLeaderboardDummy(i,e,t,n,a,s);else if(s){let l={};l.reason="Searching for around player but the user can't be retrieved",l.type=PP.CAError.GET_USER_FAILED,s(l,result)}},!1):casdk.getLeaderboard(i,e,t,n).then(function(l){if(l.leaderboard)a&&a(l.leaderboard);else if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.getLeaderboard!=null&&PP.CAUtils._myUseDummyServerOnError&&o==null||o!=null&&o)PP.CAUtils.getLeaderboardDummy(i,e,t,n,a,s);else if(s){let m={};m.reason="Get leaderboard failed",m.type=PP.CAError.GET_LEADERBOARD_FAILED,s(m,l)}}).catch(function(l){if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.getLeaderboard!=null&&PP.CAUtils._myUseDummyServerOnError&&o==null||o!=null&&o)PP.CAUtils.getLeaderboardDummy(i,e,t,n,a,s);else if(s){let m={};m.reason="Get leaderboard failed",m.type=PP.CAError.GET_LEADERBOARD_FAILED,s(m,l)}});else if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.getLeaderboard!=null&&PP.CAUtils._myUseDummyServerOnSDKMissing&&o==null||o!=null&&o)PP.CAUtils.getLeaderboardDummy(i,e,t,n,a,s);else if(s){let l={};l.reason="Construct Arcade SDK missing",l.type=PP.CAError.CA_SDK_MISSING,s(l,null)}},getLeaderboardDummy(i,e,t,n,a,s){if(PP.CAUtils._myDummyServer)PP.CAUtils._myDummyServer.getLeaderboard(i,e,t,n,a,s);else if(s){let o={};o.reason="Dummy server not initialized",o.type=PP.CAError.DUMMY_NOT_INITIALIZED,s(o)}},submitScore:function(i,e,t,n,a=null){if(PP.CAUtils.isSDKAvailable())casdk.submitScore(i,e).then(function(s){if(s.error){if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.submitScore!=null&&PP.CAUtils._myUseDummyServerOnError&&a==null||a!=null&&a)PP.CAUtils.submitScoreDummy(i,e,t,n);else if(n){let o={};o.reason="Submit score failed",o.type=PP.CAError.SUBMIT_SCORE_FAILED,n(o,s)}}else t()}).catch(function(s){if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.submitScore!=null&&PP.CAUtils._myUseDummyServerOnError&&a==null||a!=null&&a)PP.CAUtils.submitScoreDummy(i,e,t,n);else if(n){let o={};o.reason="Submit score failed",o.type=PP.CAError.SUBMIT_SCORE_FAILED,n(o,s)}});else if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.submitScore!=null&&PP.CAUtils._myUseDummyServerOnSDKMissing&&a==null||a!=null&&a)PP.CAUtils.submitScoreDummy(i,e,t,n);else if(n){let s={};s.reason="Construct Arcade SDK missing",s.type=PP.CAError.CA_SDK_MISSING,n(s,null)}},submitScoreDummy(i,e,t,n){if(PP.CAUtils._myDummyServer)PP.CAUtils._myDummyServer.submitScore(i,e,t,n);else if(n){let a={};a.reason="Dummy server not initialized",a.type=PP.CAError.DUMMY_NOT_INITIALIZED,n(a)}},getUser:function(i,e,t=null){if(PP.CAUtils.isSDKAvailable())casdk.getUser().then(function(n){if(n.user)i&&i(n.user);else if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.getUser!=null&&PP.CAUtils._myUseDummyServerOnError&&t==null||t!=null&&t)PP.CAUtils.getUserDummy(i,e);else if(e){let a={};a.reason="Get user failed",a.type=PP.CAError.GET_USER_FAILED,e(a,n)}}).catch(function(n){if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.getUser!=null&&PP.CAUtils._myUseDummyServerOnError&&t==null||t!=null&&t)PP.CAUtils.getUserDummy(i,e);else if(e){let a={};a.reason="Get user failed",a.type=PP.CAError.GET_USER_FAILED,e(a,n)}});else if(PP.CAUtils._myDummyServer!=null&&PP.CAUtils._myDummyServer.getUser!=null&&PP.CAUtils._myUseDummyServerOnSDKMissing&&t==null||t!=null&&t)PP.CAUtils.getUserDummy(i,e);else if(e){let n={};n.reason="Construct Arcade SDK missing",n.type=PP.CAError.CA_SDK_MISSING,e(n,null)}},getUserDummy(i,e){if(PP.CAUtils._myDummyServer)PP.CAUtils._myDummyServer.getUser(i,e);else if(e){let t={};t.reason="Dummy server not initialized",t.type=PP.CAError.DUMMY_NOT_INITIALIZED,e(t)}}}});var ca=S(()=>{PP.CADummyServer=class{constructor(){}getLeaderboard(e,t,n,a,s,o){let l=null;for(PP.CAUtils.isSDKAvailable()?l=[{rank:0,displayName:"An",score:0},{rank:1,displayName:"Error",score:0},{rank:2,displayName:"Has",score:0},{rank:3,displayName:"Occurred",score:0},{rank:4,displayName:"While",score:0},{rank:5,displayName:"Trying",score:0},{rank:6,displayName:"To",score:0},{rank:7,displayName:"Retrieve",score:0},{rank:8,displayName:"The",score:0},{rank:9,displayName:"Leaderboard",score:0}]:n?l=[{rank:0,displayName:"Sign In",score:0},{rank:1,displayName:"And",score:0},{rank:2,displayName:"Play",score:0},{rank:3,displayName:"On",score:0},{rank:4,displayName:"HeyVR",score:0},{rank:5,displayName:"To",score:0},{rank:6,displayName:"Submit",score:0},{rank:7,displayName:"Your",score:0},{rank:8,displayName:"Own",score:0},{rank:9,displayName:"Score",score:0}]:l=[{rank:0,displayName:"The",score:0},{rank:1,displayName:"Top 10",score:0},{rank:2,displayName:"Leaderboard",score:0},{rank:3,displayName:"Is",score:0},{rank:4,displayName:"Available",score:0},{rank:5,displayName:"Only",score:0},{rank:5,displayName:"When",score:0},{rank:7,displayName:"Playing",score:0},{rank:8,displayName:"On",score:0},{rank:9,displayName:"HeyVR",score:0}];l.length>a;)l.pop();s&&s(l)}submitScore(e,t,n,a){n&&n()}getUser(e,t){let n={};n.displayName="J",e&&e(n)}}});var ua=S(()=>{WL.registerComponent("pp-ca-display-leaderboard",{_myLeaderboardID:{type:WL.Type.String,default:""},_myIsLocal:{type:WL.Type.Bool,default:!1},_myIsAscending:{type:WL.Type.Bool,default:!1},_myScoresAmount:{type:WL.Type.Int,default:10},_myScoreFormat:{type:WL.Type.Enum,values:["value","hours:minutes:seconds","minutes:seconds","seconds","hours:minutes","minutes"],default:"value"},_myPositionAndUsernameSeparator:{type:WL.Type.String,default:" - "},_myNumberOfLinesBetweenScores:{type:WL.Type.Int,default:1}},{init:function(){},start:function(){this._myNamesTextComponent=null,this._myScoresTextComponent=null,this._myStarted=!1,PP.CAUtils.setDummyServer(new PP.CADummyServer),PP.CAUtils.setUseDummyServerOnSDKMissing(!0),PP.CAUtils.setUseDummyServerOnError(!0)},update:function(i){if(!this._myStarted){this._myStarted=!0;let e=this.object.pp_getObjectByName("Names"),t=this.object.pp_getObjectByName("Scores");e!=null&&t!=null&&(this._myNamesTextComponent=e.pp_getComponent("text"),this._myScoresTextComponent=t.pp_getComponent("text")),this.updateLeaderboard()}},updateLeaderboard:function(){PP.CAUtils.getLeaderboard(this._myLeaderboardID,this._myIsAscending,this._myIsLocal,this._myScoresAmount,this._onLeaderboardRetrieved.bind(this))},_onLeaderboardRetrieved(i){let e="",t="",n=0;for(let a of i){let s=a.rank+1;s.toFixed(0).length>n&&(n=s.toFixed(0).length)}for(let a of i){let o=(a.rank+1).toFixed(0);for(;o.length<n;)o="0".concat(o);let l=`
`;for(let c=0;c<this._myNumberOfLinesBetweenScores;c++)l=l+`
`;e=e.concat(o,this._myPositionAndUsernameSeparator,a.displayName,l);let m=this._formatScore(a.score);t=t.concat(m,l)}this._myNamesTextComponent!=null&&this._myScoresTextComponent!=null&&(this._myNamesTextComponent.text=e,this._myScoresTextComponent.text=t)},_formatScore(i){let e=i.toString();return this._myScoreFormat==1?e=this._formatTime(i,!0,!0,!0):this._myScoreFormat==2?e=this._formatTime(i,!1,!0,!0):this._myScoreFormat==3?e=this._formatTime(i,!1,!1,!0):this._myScoreFormat==4?e=this._formatTime(i,!0,!0,!1):this._myScoreFormat==5&&(e=this._formatTime(i,!1,!0,!1)),e},_formatTime(i,e,t,n){let a=Math.floor(i/1e3),s=0;e&&(s=Math.floor(a/3600),a-=s*3600);let o=0;t&&(o=Math.floor(a/60),a-=o*60);let l=0;n&&(l=Math.floor(a));let m="";return n&&(m=l.toFixed(0).length<2&&(t||e)?"0".concat(l.toFixed(0)):l.toFixed(0)),t&&(m=(o.toFixed(0).length<2&&(n||e)?"0".concat(o.toFixed(0)):o.toFixed(0))+(n?":"+m:"")),e&&(m=(s.toFixed(0).length<2&&(n||t)?"0".concat(s.toFixed(0)):s.toFixed(0))+(t?":"+m:"")),m},pp_clone(i){let e=i.pp_addComponent(this.type);return e._myLeaderboardID=this._myLeaderboardID,e._myIsLocal=this._myIsLocal,e._myPositionAndUsernameSeparator=this._myPositionAndUsernameSeparator,e._myNumberOfLinesBetweenScores=this._myNumberOfLinesBetweenScores,e}})});var ha=S(()=>{PP.PlayerHeadController=class{constructor(){}}});var pa=S(()=>{PP.PlayerOcclusion=class{constructor(){}}});var da=S(()=>{PP.CollisionCheckParams=class{constructor(){this.mySplitMovementEnabled=!1,this.mySplitMovementMaxLength=0,this.mySplitMovementMaxStepsEnabled=!1,this.mySplitMovementMaxSteps=0,this.mySplitMovementStepEqualLength=!1,this.mySplitMovementStepEqualLengthMinLength=0,this.mySplitMovementStopWhenHorizontalMovementCanceled=!1,this.mySplitMovementStopWhenVerticalMovementCanceled=!1,this.mySplitMovementStopCallback=null,this.mySplitMovementStopReturnPrevious=!1,this.myRadius=0,this.myDistanceFromFeetToIgnore=0,this.myDistanceFromHeadToIgnore=0,this.myPositionOffsetLocal=PP.vec3_create(),this.myRotationOffsetLocalQuat=PP.quat_create(),this.myHorizontalMovementCheckEnabled=!1,this.myHorizontalMovementStepEnabled=!1,this.myHorizontalMovementStepMaxLength=0,this.myHorizontalMovementRadialStepAmount=0,this.myHorizontalMovementCheckDiagonalOutward=!1,this.myHorizontalMovementCheckDiagonalInward=!1,this.myHorizontalMovementCheckStraight=!1,this.myHorizontalMovementCheckHorizontalBorder=!1,this.myHorizontalMovementCheckVerticalStraight=!1,this.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!1,this.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!1,this.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=!1,this.myHorizontalMovementCheckVerticalDiagonalDownwardInward=!1,this.myHorizontalMovementCheckVerticalStraightDiagonalUpward=!1,this.myHorizontalMovementCheckVerticalStraightDiagonalDownward=!1,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=!1,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=!1,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,this.myHorizontalPositionCheckEnabled=!1,this.myHalfConeAngle=0,this.myHalfConeSliceAmount=0,this.myCheckConeBorder=!1,this.myCheckConeRay=!1,this.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!0,this.myHorizontalPositionCheckVerticalDirectionType=0,this.myCheckHorizontalFixedForwardEnabled=!1,this.myCheckHorizontalFixedForward=PP.vec3_create(),this.myVerticalMovementCheckEnabled=!1,this.myVerticalPositionCheckEnabled=!1,this.myFeetRadius=0,this.myAdjustVerticalMovementWithGroundAngleDownhill=!1,this.myAdjustVerticalMovementWithGroundAngleUphill=!1,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=null,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=null,this.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=null,this.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,this.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=null,this.myAdjustVerticalMovementWithCeilingAngleDownhill=!1,this.myAdjustVerticalMovementWithCeilingAngleUphill=!1,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=null,this.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,this.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=null,this.myCheckVerticalFixedForwardEnabled=!1,this.myCheckVerticalFixedForward=PP.vec3_create(),this.myCheckVerticalBothDirection=!1,this.mySnapOnGroundEnabled=!1,this.mySnapOnGroundExtraDistance=0,this.mySnapOnCeilingEnabled=!1,this.mySnapOnCeilingExtraDistance=0,this.myGroundPopOutEnabled=!1,this.myGroundPopOutExtraDistance=0,this.myCeilingPopOutEnabled=!1,this.myCeilingPopOutExtraDistance=0,this.myVerticalMovementReduceEnabled=!1,this.myGroundCircumferenceAddCenter=!1,this.myGroundCircumferenceSliceAmount=0,this.myGroundCircumferenceStepAmount=0,this.myGroundCircumferenceRotationPerStep=0,this.myVerticalAllowHitInsideCollisionIfOneOk=!1,this.myCheckHeight=!1,this.myCheckHeightVerticalMovement=!1,this.myCheckHeightVerticalPosition=!1,this.myCheckHeightTopMovement=!1,this.myCheckHeightTopPosition=!1,this.myCheckHeightConeOnCollision=!1,this.myCheckHeightConeOnCollisionKeepHit=!1,this.myHeightCheckStepAmountMovement=0,this.myHeightCheckStepAmountPosition=0,this.myCheckVerticalStraight=!1,this.myCheckVerticalDiagonalRayOutward=!1,this.myCheckVerticalDiagonalRayInward=!1,this.myCheckVerticalDiagonalBorderOutward=!1,this.myCheckVerticalDiagonalBorderInward=!1,this.myCheckVerticalDiagonalBorderRayOutward=!1,this.myCheckVerticalDiagonalBorderRayInward=!1,this.myCheckVerticalSearchFartherVerticalHit=!1,this.myGroundAngleToIgnore=0,this.myGroundAngleToIgnoreWithPerceivedAngle=null,this.myCeilingAngleToIgnore=0,this.myCeilingAngleToIgnoreWithPerceivedAngle=null,this.myHorizontalMovementGroundAngleIgnoreHeight=null,this.myHorizontalMovementCeilingAngleIgnoreHeight=null,this.myHorizontalPositionGroundAngleIgnoreHeight=null,this.myHorizontalPositionCeilingAngleIgnoreHeight=null,this.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=null,this.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=null,this.myHeight=0,this.myComputeGroundInfoEnabled=!1,this.myComputeCeilingInfoEnabled=!1,this.myDistanceToBeOnGround=0,this.myDistanceToComputeGroundInfo=0,this.myDistanceToBeOnCeiling=0,this.myDistanceToComputeCeilingInfo=0,this.myVerticalFixToBeOnGround=0,this.myVerticalFixToComputeGroundInfo=0,this.myVerticalFixToBeOnCeiling=0,this.myVerticalFixToComputeCeilingInfo=0,this.myGroundIsBaseInsideCollisionCheckEnabled=!1,this.myCeilingIsBaseInsideCollisionCheckEnabled=!1,this.myIsOnGroundIfInsideHit=!1,this.myIsOnCeilingIfInsideHit=!1,this.myIsOnGroundMaxSurfaceAngle=null,this.myIsOnCeilingMaxSurfaceAngle=null,this.myFindGroundDistanceMaxOutsideDistance=0,this.myFindGroundDistanceMaxInsideDistance=0,this.myFindCeilingDistanceMaxOutsideDistance=0,this.myFindCeilingDistanceMaxInsideDistance=0,this.myAllowGroundSteepFix=!1,this.myAllowCeilingSteepFix=!1,this.myMustStayOnGround=!1,this.myMustStayOnCeiling=!1,this.myMustStayOnValidGroundAngleDownhill=!1,this.myMustStayOnValidCeilingAngleDownhill=!1,this.myRegatherGroundInfoOnSurfaceCheckFail=!1,this.myRegatherCeilingInfoOnSurfaceCheckFail=!1,this.myMustStayBelowIgnorableGroundAngleDownhill=!1,this.myMustStayBelowIgnorableCeilingAngleDownhill=!1,this.myMustStayBelowGroundAngleDownhill=null,this.myMustStayBelowCeilingAngleDownhill=null,this.myMovementMustStayOnGroundHitAngle=null,this.myMovementMustStayOnCeilingHitAngle=null,this.myTeleportMustBeOnIgnorableGroundAngle=!1,this.myCheckTransformMustBeOnIgnorableGroundAngle=!1,this.myTeleportMustBeOnIgnorableCeilingAngle=!1,this.myCheckTransformMustBeOnIgnorableCeilingAngle=!1,this.myTeleportMustBeOnGroundAngle=null,this.myCheckTransformMustBeOnGroundAngle=null,this.myTeleportMustBeOnCeilingAngle=null,this.myCheckTransformMustBeOnCeilingAngle=null,this.myTeleportMustBeOnGround=!1,this.myCheckTransformMustBeOnGround=!1,this.myTeleportMustBeOnCeiling=!1,this.myCheckTransformMustBeOnCeiling=!1,this.mySlidingEnabled=!1,this.mySlidingHorizontalMovementCheckBetterNormal=!1,this.mySlidingMaxAttempts=0,this.mySlidingCheckBothDirections=!1,this.mySlidingFlickeringPreventionType=0,this.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingAdjustSign90Degrees=!1,this.myHorizontalBlockLayerFlags=new PP.PhysicsLayerFlags,this.myHorizontalObjectsToIgnore=[],this.myVerticalBlockLayerFlags=new PP.PhysicsLayerFlags,this.myVerticalObjectsToIgnore=[],this.myExtraMovementCheckCallback=null,this.myExtraTeleportCheckCallback=null,this.myExtraCheckTransformCheckCallback=null,this.myDebugActive=!1,this.myDebugHorizontalMovementActive=!1,this.myDebugHorizontalPositionActive=!1,this.myDebugVerticalMovementActive=!1,this.myDebugVerticalPositionActive=!1,this.myDebugSlidingActive=!1,this.myDebugGroundInfoActive=!1,this.myDebugCeilingInfoActive=!1,this.myDebugRuntimeParamsActive=!1,this.myDebugMovementActive=!1}copy(e){this.mySplitMovementEnabled=e.mySplitMovementEnabled,this.mySplitMovementMaxLength=e.mySplitMovementMaxLength,this.mySplitMovementMaxStepsEnabled=e.mySplitMovementMaxStepsEnabled,this.mySplitMovementMaxSteps=e.mySplitMovementMaxSteps,this.mySplitMovementStepEqualLength=e.mySplitMovementStepEqualLength,this.mySplitMovementStepEqualLengthMinLength=e.mySplitMovementStepEqualLengthMinLength,this.mySplitMovementStopWhenHorizontalMovementCanceled=e.mySplitMovementStopWhenHorizontalMovementCanceled,this.mySplitMovementStopWhenVerticalMovementCanceled=e.mySplitMovementStopWhenVerticalMovementCanceled,this.mySplitMovementStopCallback=e.mySplitMovementStopCallback,this.mySplitMovementStopReturnPrevious=e.mySplitMovementStopReturnPrevious,this.myRadius=e.myRadius,this.myDistanceFromFeetToIgnore=e.myDistanceFromFeetToIgnore,this.myDistanceFromHeadToIgnore=e.myDistanceFromHeadToIgnore,this.myPositionOffsetLocal.vec3_copy(e.myPositionOffsetLocal),this.myRotationOffsetLocalQuat.quat_copy(e.myRotationOffsetLocalQuat),this.myHorizontalMovementCheckEnabled=e.myHorizontalMovementCheckEnabled,this.myHorizontalMovementStepEnabled=e.myHorizontalMovementStepEnabled,this.myHorizontalMovementStepMaxLength=e.myHorizontalMovementStepMaxLength,this.myHorizontalMovementRadialStepAmount=e.myHorizontalMovementRadialStepAmount,this.myHorizontalMovementCheckDiagonalOutward=e.myHorizontalMovementCheckDiagonalOutward,this.myHorizontalMovementCheckDiagonalInward=e.myHorizontalMovementCheckDiagonalInward,this.myHorizontalMovementCheckStraight=e.myHorizontalMovementCheckStraight,this.myHorizontalMovementCheckHorizontalBorder=e.myHorizontalMovementCheckHorizontalBorder,this.myHorizontalMovementCheckVerticalStraight=e.myHorizontalMovementCheckVerticalStraight,this.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=e.myHorizontalMovementCheckVerticalDiagonalUpwardOutward,this.myHorizontalMovementCheckVerticalDiagonalUpwardInward=e.myHorizontalMovementCheckVerticalDiagonalUpwardInward,this.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=e.myHorizontalMovementCheckVerticalDiagonalDownwardOutward,this.myHorizontalMovementCheckVerticalDiagonalDownwardInward=e.myHorizontalMovementCheckVerticalDiagonalDownwardInward,this.myHorizontalMovementCheckVerticalStraightDiagonalUpward=e.myHorizontalMovementCheckVerticalStraightDiagonalUpward,this.myHorizontalMovementCheckVerticalStraightDiagonalDownward=e.myHorizontalMovementCheckVerticalStraightDiagonalDownward,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=e.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=e.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalMovementHorizontalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalMovementVerticalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,this.myHorizontalPositionCheckEnabled=e.myHorizontalPositionCheckEnabled,this.myHalfConeAngle=e.myHalfConeAngle,this.myHalfConeSliceAmount=e.myHalfConeSliceAmount,this.myCheckConeBorder=e.myCheckConeBorder,this.myCheckConeRay=e.myCheckConeRay,this.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=e.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,this.myHorizontalPositionCheckVerticalDirectionType=e.myHorizontalPositionCheckVerticalDirectionType,this.myVerticalMovementCheckEnabled=e.myVerticalMovementCheckEnabled,this.myVerticalPositionCheckEnabled=e.myVerticalPositionCheckEnabled,this.myFeetRadius=e.myFeetRadius,this.myAdjustVerticalMovementWithGroundAngleDownhill=e.myAdjustVerticalMovementWithGroundAngleDownhill,this.myAdjustVerticalMovementWithGroundAngleUphill=e.myAdjustVerticalMovementWithGroundAngleUphill,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=e.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=e.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle,this.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=e.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle,this.myAdjustHorizontalMovementWithGroundAngleDownhill=e.myAdjustHorizontalMovementWithGroundAngleDownhill,this.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=e.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle,this.myAdjustVerticalMovementWithCeilingAngleDownhill=e.myAdjustVerticalMovementWithCeilingAngleDownhill,this.myAdjustVerticalMovementWithCeilingAngleUphill=e.myAdjustVerticalMovementWithCeilingAngleUphill,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle,this.myAdjustHorizontalMovementWithCeilingAngleDownhill=e.myAdjustHorizontalMovementWithCeilingAngleDownhill,this.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=e.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle,this.myCheckVerticalFixedForwardEnabled=e.myCheckVerticalFixedForwardEnabled,this.myCheckVerticalFixedForward.vec3_copy(e.myCheckVerticalFixedForward),this.myCheckVerticalBothDirection=e.myCheckVerticalBothDirection,this.mySnapOnGroundEnabled=e.mySnapOnGroundEnabled,this.mySnapOnGroundExtraDistance=e.mySnapOnGroundExtraDistance,this.mySnapOnCeilingEnabled=e.mySnapOnCeilingEnabled,this.mySnapOnCeilingExtraDistance=e.mySnapOnCeilingExtraDistance,this.myGroundPopOutEnabled=e.myGroundPopOutEnabled,this.myGroundPopOutExtraDistance=e.myGroundPopOutExtraDistance,this.myCeilingPopOutEnabled=e.myCeilingPopOutEnabled,this.myCeilingPopOutExtraDistance=e.myCeilingPopOutExtraDistance,this.myVerticalMovementReduceEnabled=e.myVerticalMovementReduceEnabled,this.myGroundCircumferenceAddCenter=e.myGroundCircumferenceAddCenter,this.myGroundCircumferenceSliceAmount=e.myGroundCircumferenceSliceAmount,this.myGroundCircumferenceStepAmount=e.myGroundCircumferenceStepAmount,this.myGroundCircumferenceRotationPerStep=e.myGroundCircumferenceRotationPerStep,this.myVerticalAllowHitInsideCollisionIfOneOk=e.myVerticalAllowHitInsideCollisionIfOneOk,this.myCheckHeight=e.myCheckHeight,this.myCheckHeightVerticalMovement=e.myCheckHeightVerticalMovement,this.myCheckHeightVerticalPosition=e.myCheckHeightVerticalPosition,this.myCheckHeightTopMovement=e.myCheckHeightTopMovement,this.myCheckHeightTopPosition=e.myCheckHeightTopPosition,this.myCheckHeightConeOnCollision=e.myCheckHeightConeOnCollision,this.myCheckHeightConeOnCollisionKeepHit=e.myCheckHeightConeOnCollisionKeepHit,this.myHeightCheckStepAmountMovement=e.myHeightCheckStepAmountMovement,this.myHeightCheckStepAmountPosition=e.myHeightCheckStepAmountPosition,this.myCheckVerticalStraight=e.myCheckVerticalStraight,this.myCheckVerticalDiagonalRayOutward=e.myCheckVerticalDiagonalRayOutward,this.myCheckVerticalDiagonalRayInward=e.myCheckVerticalDiagonalRayInward,this.myCheckVerticalDiagonalBorderOutward=e.myCheckVerticalDiagonalBorderOutward,this.myCheckVerticalDiagonalBorderInward=e.myCheckVerticalDiagonalBorderInward,this.myCheckVerticalDiagonalBorderRayOutward=e.myCheckVerticalDiagonalBorderRayOutward,this.myCheckVerticalDiagonalBorderRayInward=e.myCheckVerticalDiagonalBorderRayInward,this.myCheckVerticalSearchFartherVerticalHit=e.myCheckVerticalSearchFartherVerticalHit,this.myGroundAngleToIgnore=e.myGroundAngleToIgnore,this.myGroundAngleToIgnoreWithPerceivedAngle=e.myGroundAngleToIgnoreWithPerceivedAngle,this.myCeilingAngleToIgnore=e.myCeilingAngleToIgnore,this.myCeilingAngleToIgnoreWithPerceivedAngle=e.myCeilingAngleToIgnoreWithPerceivedAngle,this.myHorizontalMovementGroundAngleIgnoreHeight=e.myHorizontalMovementGroundAngleIgnoreHeight,this.myHorizontalMovementCeilingAngleIgnoreHeight=e.myHorizontalMovementCeilingAngleIgnoreHeight,this.myHorizontalPositionGroundAngleIgnoreHeight=e.myHorizontalPositionGroundAngleIgnoreHeight,this.myHorizontalPositionCeilingAngleIgnoreHeight=e.myHorizontalPositionCeilingAngleIgnoreHeight,this.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=e.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft,this.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=e.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft,this.myHeight=e.myHeight,this.myComputeGroundInfoEnabled=e.myComputeGroundInfoEnabled,this.myComputeCeilingInfoEnabled=e.myComputeCeilingInfoEnabled,this.myDistanceToBeOnGround=e.myDistanceToBeOnGround,this.myDistanceToComputeGroundInfo=e.myDistanceToComputeGroundInfo,this.myDistanceToBeOnCeiling=e.myDistanceToBeOnCeiling,this.myDistanceToComputeCeilingInfo=e.myDistanceToComputeCeilingInfo,this.myVerticalFixToBeOnGround=e.myVerticalFixToBeOnGround,this.myVerticalFixToComputeGroundInfo=e.myVerticalFixToComputeGroundInfo,this.myVerticalFixToBeOnCeiling=e.myVerticalFixToBeOnCeiling,this.myVerticalFixToComputeCeilingInfo=e.myVerticalFixToComputeCeilingInfo,this.myGroundIsBaseInsideCollisionCheckEnabled=e.myGroundIsBaseInsideCollisionCheckEnabled,this.myCeilingIsBaseInsideCollisionCheckEnabled=e.myCeilingIsBaseInsideCollisionCheckEnabled,this.myIsOnGroundIfInsideHit=e.myIsOnGroundIfInsideHit,this.myIsOnCeilingIfInsideHit=e.myIsOnCeilingIfInsideHit,this.myIsOnGroundMaxSurfaceAngle=e.myIsOnGroundMaxSurfaceAngle,this.myIsOnCeilingMaxSurfaceAngle=e.myIsOnCeilingMaxSurfaceAngle,this.myFindGroundDistanceMaxOutsideDistance=e.myFindGroundDistanceMaxOutsideDistance,this.myFindGroundDistanceMaxInsideDistance=e.myFindGroundDistanceMaxInsideDistance,this.myFindCeilingDistanceMaxOutsideDistance=e.myFindCeilingDistanceMaxOutsideDistance,this.myFindCeilingDistanceMaxInsideDistance=e.myFindCeilingDistanceMaxInsideDistance,this.myAllowGroundSteepFix=e.myAllowGroundSteepFix,this.myAllowCeilingSteepFix=e.myAllowCeilingSteepFix,this.myMustStayOnGround=e.myMustStayOnGround,this.myMustStayOnCeiling=e.myMustStayOnCeiling,this.myMustStayOnValidGroundAngleDownhill=e.myMustStayOnValidGroundAngleDownhill,this.myMustStayOnValidCeilingAngleDownhill=e.myMustStayOnValidCeilingAngleDownhill,this.myRegatherGroundInfoOnSurfaceCheckFail=e.myRegatherGroundInfoOnSurfaceCheckFail,this.myRegatherCeilingInfoOnSurfaceCheckFail=e.myRegatherCeilingInfoOnSurfaceCheckFail,this.myMustStayBelowGroundAngleDownhill=e.myMustStayBelowGroundAngleDownhill,this.myMustStayBelowCeilingAngleDownhill=e.myMustStayBelowCeilingAngleDownhill,this.myMustStayBelowIgnorableGroundAngleDownhill=e.myMustStayBelowIgnorableGroundAngleDownhill,this.myMustStayBelowIgnorableCeilingAngleDownhill=e.myMustStayBelowIgnorableCeilingAngleDownhill,this.myMovementMustStayOnGroundHitAngle=e.myMovementMustStayOnGroundHitAngle,this.myMovementMustStayOnCeilingHitAngle=e.myMovementMustStayOnCeilingHitAngle,this.myTeleportMustBeOnIgnorableGroundAngle=e.myTeleportMustBeOnIgnorableGroundAngle,this.myCheckTransformMustBeOnIgnorableGroundAngle=e.myCheckTransformMustBeOnIgnorableGroundAngle,this.myTeleportMustBeOnIgnorableCeilingAngle=e.myTeleportMustBeOnIgnorableCeilingAngle,this.myCheckTransformMustBeOnIgnorableCeilingAngle=e.myCheckTransformMustBeOnIgnorableCeilingAngle,this.myTeleportMustBeOnGroundAngle=e.myTeleportMustBeOnGroundAngle,this.myCheckTransformMustBeOnGroundAngle=e.myCheckTransformMustBeOnGroundAngle,this.myTeleportMustBeOnCeilingAngle=e.myTeleportMustBeOnCeilingAngle,this.myCheckTransformMustBeOnCeilingAngle=e.myCheckTransformMustBeOnCeilingAngle,this.myTeleportMustBeOnGround=e.myTeleportMustBeOnGround,this.myCheckTransformMustBeOnGround=e.myCheckTransformMustBeOnGround,this.myTeleportMustBeOnCeiling=e.myTeleportMustBeOnCeiling,this.myCheckTransformMustBeOnCeiling=e.myCheckTransformMustBeOnCeiling,this.mySlidingEnabled=e.mySlidingEnabled,this.mySlidingHorizontalMovementCheckBetterNormal=e.mySlidingHorizontalMovementCheckBetterNormal,this.mySlidingMaxAttempts=e.mySlidingMaxAttempts,this.mySlidingCheckBothDirections=e.mySlidingCheckBothDirections,this.mySlidingFlickeringPreventionType=e.mySlidingFlickeringPreventionType,this.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=e.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding,this.mySlidingFlickerPreventionCheckAnywayCounter=e.mySlidingFlickerPreventionCheckAnywayCounter,this.mySlidingAdjustSign90Degrees=e.mySlidingAdjustSign90Degrees,this.myHorizontalBlockLayerFlags.copy(e.myHorizontalBlockLayerFlags),this.myHorizontalObjectsToIgnore.pp_copy(e.myHorizontalObjectsToIgnore),this.myVerticalBlockLayerFlags.copy(e.myVerticalBlockLayerFlags),this.myVerticalObjectsToIgnore.pp_copy(e.myVerticalObjectsToIgnore),this.myExtraMovementCheckCallback=e.myExtraMovementCheckCallback,this.myExtraTeleportCheckCallback=e.myExtraTeleportCheckCallback,this.myExtraCheckTransformCheckCallback=e.myExtraCheckTransformCheckCallback,this.myDebugActive=e.myDebugActive,this.myDebugHorizontalMovementActive=e.myDebugHorizontalMovementActive,this.myDebugHorizontalPositionActive=e.myDebugHorizontalPositionActive,this.myDebugVerticalMovementActive=e.myDebugVerticalMovementActive,this.myDebugVerticalPositionActive=e.myDebugVerticalPositionActive,this.myDebugSlidingActive=e.myDebugSlidingActive,this.myDebugGroundInfoActive=e.myDebugGroundInfoActive,this.myDebugCeilingInfoActive=e.myDebugCeilingInfoActive,this.myDebugRuntimeParamsActive=e.myDebugRuntimeParamsActive,this.myDebugMovementActive=e.myDebugMovementActive}};PP.CollisionRuntimeParams=class{constructor(){this.myOriginalPosition=PP.vec3_create(),this.myNewPosition=PP.vec3_create(),this.myOriginalHeight=0,this.myOriginalForward=PP.vec3_create(),this.myOriginalUp=PP.vec3_create(),this.myOriginalMovement=PP.vec3_create(),this.myFixedMovement=PP.vec3_create(),this.myLastValidOriginalHorizontalMovement=PP.vec3_create(),this.myLastValidOriginalVerticalMovement=PP.vec3_create(),this.myLastValidSurfaceAdjustedHorizontalMovement=PP.vec3_create(),this.myLastValidSurfaceAdjustedVerticalMovement=PP.vec3_create(),this.myLastValidEndHorizontalMovement=PP.vec3_create(),this.myLastValidEndVerticalMovement=PP.vec3_create(),this.myIsOnGround=!1,this.myGroundAngle=0,this.myGroundPerceivedAngle=0,this.myGroundNormal=PP.vec3_create(),this.myGroundHitMaxAngle=0,this.myGroundHitMaxNormal=PP.vec3_create(),this.myGroundDistance=null,this.myGroundIsBaseInsideCollision=!1,this.myIsOnCeiling=!1,this.myCeilingAngle=0,this.myCeilingPerceivedAngle=0,this.myCeilingNormal=PP.vec3_create(),this.myCeilingHitMaxAngle=0,this.myCeilingHitMaxNormal=PP.vec3_create(),this.myCeilingDistance=null,this.myCeilingIsBaseInsideCollision=!1,this.myHorizontalMovementCanceled=!1,this.myIsCollidingHorizontally=!1,this.myHorizontalCollisionHit=new PP.RaycastHit,this.myVerticalMovementCanceled=!1,this.myIsCollidingVertically=!1,this.myVerticalCollisionHit=new PP.RaycastHit,this.myHasSnappedOnGround=!1,this.myHasSnappedOnCeiling=!1,this.myHasPoppedOutGround=!1,this.myHasPoppedOutCeiling=!1,this.myHasReducedVerticalMovement=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=!1,this.myIsSliding=!1,this.myIsSlidingIntoOppositeDirection=!1,this.myIsSlidingFlickerPrevented=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingMovementAngle=0,this.mySlidingCollisionAngle=0,this.mySlidingCollisionHit=new PP.RaycastHit,this.mySlidingWallNormal=new PP.vec3_create,this.mySliding90DegreesSign=0,this.mySlidingRecompute90DegreesSign=!0,this.myLastValidIsSliding=!1,this.mySlidingPreviousHorizontalMovement=PP.vec3_create(),this.myOriginalTeleportPosition=PP.vec3_create(),this.myFixedTeleportPosition=PP.vec3_create(),this.myOriginalPositionCheckPosition=PP.vec3_create(),this.myFixedPositionCheckPosition=PP.vec3_create(),this.myTeleportCanceled=!1,this.myIsPositionOk=!1,this.myIsTeleport=!1,this.myIsMove=!1,this.myIsPositionCheck=!1,this.myIsPositionCheckAllowAdjustments=!1,this.mySplitMovementSteps=0,this.mySplitMovementStepsPerformed=0,this.mySplitMovementStop=!1,this.mySplitMovementMovementChecked=PP.vec3_create(),this.myRealIsOnGround=!1,this.myRealIsOnCeiling=!1}reset(){this.myOriginalPosition.vec3_zero(),this.myNewPosition.vec3_zero(),this.myOriginalHeight=0,this.myOriginalForward.vec3_zero(),this.myOriginalUp.vec3_zero(),this.myOriginalMovement.vec3_zero(),this.myFixedMovement.vec3_zero(),this.myLastValidOriginalHorizontalMovement.vec3_zero(),this.myLastValidOriginalVerticalMovement.vec3_zero(),this.myLastValidSurfaceAdjustedHorizontalMovement.vec3_zero(),this.myLastValidSurfaceAdjustedVerticalMovement.vec3_zero(),this.myLastValidEndHorizontalMovement.vec3_zero(),this.myLastValidEndVerticalMovement.vec3_zero(),this.myIsOnGround=!1,this.myGroundAngle=0,this.myGroundPerceivedAngle=0,this.myGroundNormal.vec3_zero(),this.myGroundHitMaxAngle=0,this.myGroundHitMaxNormal.vec3_zero(),this.myGroundDistance=null,this.myGroundIsBaseInsideCollision=!1,this.myIsOnCeiling=!1,this.myCeilingAngle=0,this.myCeilingPerceivedAngle=0,this.myCeilingNormal.vec3_zero(),this.myCeilingHitMaxAngle=0,this.myCeilingHitMaxNormal.vec3_zero(),this.myCeilingDistance=null,this.myCeilingIsBaseInsideCollision=!1,this.myHorizontalMovementCanceled=!1,this.myIsCollidingHorizontally=!1,this.myHorizontalCollisionHit.reset(),this.myVerticalMovementCanceled=!1,this.myIsCollidingVertically=!1,this.myVerticalCollisionHit.reset(),this.myHasSnappedOnGround=!1,this.myHasSnappedOnCeiling=!1,this.myHasPoppedOutGround=!1,this.myHasPoppedOutCeiling=!1,this.myHasReducedVerticalMovement=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=!1,this.myIsSliding=!1,this.myIsSlidingIntoOppositeDirection=!1,this.myIsSlidingFlickerPrevented=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingMovementAngle=0,this.mySlidingCollisionAngle=0,this.mySlidingCollisionHit.reset(),this.mySliding90DegreesSign=0,this.mySlidingRecompute90DegreesSign=!0,this.myLastValidIsSliding=!1,this.mySlidingPreviousHorizontalMovement.vec3_zero(),this.mySlidingWallNormal.vec3_zero(),this.myOriginalTeleportPosition.vec3_zero(),this.myFixedTeleportPosition.vec3_zero(),this.myOriginalPositionCheckPosition.vec3_zero(),this.myFixedPositionCheckPosition.vec3_zero(),this.myTeleportCanceled=!1,this.myIsPositionOk=!1,this.myIsTeleport=!1,this.myIsMove=!1,this.myIsPositionCheck=!1,this.myIsPositionCheckAllowAdjustments=!1,this.mySplitMovementSteps=0,this.mySplitMovementStepsPerformed=0,this.mySplitMovementStop=!1,this.mySplitMovementMovementChecked.vec3_zero(),this.myRealIsOnGround=!1,this.myRealIsOnCeiling=!1}copy(e){this.myOriginalPosition.vec3_copy(e.myOriginalPosition),this.myNewPosition.vec3_copy(e.myNewPosition),this.myOriginalHeight=e.myOriginalHeight,this.myOriginalForward.vec3_copy(e.myOriginalForward),this.myOriginalUp.vec3_copy(e.myOriginalUp),this.myOriginalMovement.vec3_copy(e.myOriginalMovement),this.myFixedMovement.vec3_copy(e.myFixedMovement),this.myLastValidOriginalHorizontalMovement.vec3_copy(e.myLastValidOriginalHorizontalMovement),this.myLastValidOriginalVerticalMovement.vec3_copy(e.myLastValidOriginalVerticalMovement),this.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(e.myLastValidSurfaceAdjustedHorizontalMovement),this.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(e.myLastValidSurfaceAdjustedVerticalMovement),this.myLastValidEndHorizontalMovement.vec3_copy(e.myLastValidEndHorizontalMovement),this.myLastValidEndVerticalMovement.vec3_copy(e.myLastValidEndVerticalMovement),this.myIsOnGround=e.myIsOnGround,this.myGroundAngle=e.myGroundAngle,this.myGroundPerceivedAngle=e.myGroundPerceivedAngle,this.myGroundNormal.vec3_copy(e.myGroundNormal),this.myGroundHitMaxAngle=e.myGroundHitMaxAngle,this.myGroundHitMaxNormal.vec3_copy(e.myGroundHitMaxNormal),this.myGroundDistance=e.myGroundDistance,this.myGroundIsBaseInsideCollision=e.myGroundIsBaseInsideCollision,this.myIsOnCeiling=e.myIsOnCeiling,this.myCeilingAngle=e.myCeilingAngle,this.myCeilingPerceivedAngle=e.myCeilingPerceivedAngle,this.myCeilingNormal.vec3_copy(e.myCeilingNormal),this.myCeilingHitMaxAngle=e.myCeilingHitMaxAngle,this.myCeilingHitMaxNormal.vec3_copy(e.myCeilingHitMaxNormal),this.myCeilingDistance=e.myCeilingDistance,this.myCeilingIsBaseInsideCollision=e.myCeilingIsBaseInsideCollision,this.myHorizontalMovementCanceled=e.myHorizontalMovementCanceled,this.myIsCollidingHorizontally=e.myIsCollidingHorizontally,this.myHorizontalCollisionHit.copy(e.myHorizontalCollisionHit),this.myVerticalMovementCanceled=e.myVerticalMovementCanceled,this.myIsCollidingVertically=e.myIsCollidingVertically,this.myVerticalCollisionHit.copy(e.myVerticalCollisionHit),this.myHasSnappedOnGround=e.myHasSnappedOnGround,this.myHasSnappedOnCeiling=e.myHasSnappedOnCeiling,this.myHasPoppedOutGround=e.myHasPoppedOutGround,this.myHasPoppedOutCeiling=e.myHasPoppedOutCeiling,this.myHasReducedVerticalMovement=e.myHasReducedVerticalMovement,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=e.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=e.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill,this.myIsSliding=e.myIsSliding,this.myIsSlidingIntoOppositeDirection=e.myIsSlidingIntoOppositeDirection,this.myIsSlidingFlickerPrevented=e.myIsSlidingFlickerPrevented,this.mySlidingFlickerPreventionCheckAnywayCounter=e.mySlidingFlickerPreventionCheckAnywayCounter,this.mySlidingMovementAngle=e.mySlidingMovementAngle,this.mySlidingCollisionAngle=e.mySlidingCollisionAngle,this.mySlidingCollisionHit.copy(e.mySlidingCollisionHit),this.mySliding90DegreesSign=e.mySliding90DegreesSign,this.mySlidingRecompute90DegreesSign=e.mySlidingRecompute90DegreesSign,this.myLastValidIsSliding=e.myLastValidIsSliding,this.mySlidingPreviousHorizontalMovement.vec3_copy(e.mySlidingPreviousHorizontalMovement),this.mySlidingWallNormal.vec3_copy(e.mySlidingWallNormal),this.myOriginalTeleportPosition.vec3_copy(e.myOriginalTeleportPosition),this.myFixedTeleportPosition.vec3_copy(e.myFixedTeleportPosition),this.myTeleportCanceled=e.myTeleportCanceled,this.myIsPositionOk=e.myIsPositionOk,this.myOriginalPositionCheckPosition.vec3_copy(e.myOriginalPositionCheckPosition),this.myFixedPositionCheckPosition.vec3_copy(e.myFixedPositionCheckPosition),this.myIsTeleport=e.myIsTeleport,this.myIsMove=e.myIsMove,this.myIsPositionCheck=e.myIsPositionCheck,this.myIsPositionCheckAllowAdjustments=e.myIsPositionCheckAllowAdjustments,this.mySplitMovementSteps=e.mySplitMovementSteps,this.mySplitMovementStepsPerformed=e.mySplitMovementStepsPerformed,this.mySplitMovementStop=e.mySplitMovementStop,this.mySplitMovementMovementChecked.vec3_copy(e.mySplitMovementMovementChecked),this.myRealIsOnGround=e.myRealIsOnGround,this.myRealIsOnCeiling=e.myRealIsOnCeiling}}});var _a=S(()=>{PP.CollisionCheckUtils={generate360TeleportParamsFromMovementParams:function(i,e=new PP.CollisionCheckParams){return e.copy(i),e.myHalfConeAngle=180,e.myHalfConeSliceAmount=Math.round(e.myHalfConeAngle/i.myHalfConeAngle*i.myHalfConeSliceAmount),e.myCheckHorizontalFixedForwardEnabled=!0,e.myCheckHorizontalFixedForward=PP.vec3_create(0,0,1),e}};PP.CollisionCheck=class{constructor(){this._myRaycastSetup=new PP.RaycastSetup,this._myRaycastResult=new PP.RaycastResults,this._myFixRaycastResult=new PP.RaycastResults,this._myBackupRaycastHit=new PP.RaycastHit,this._myPrevCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._mySlidingCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._myCheckBetterSlidingNormalCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._myInternalSlidingCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._mySlidingFlickeringFixCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._mySlidingOppositeDirectionCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._mySlidingOnVerticalCheckCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._myDebugActive=!1,this._myTotalRaycasts=0,this._myTotalRaycastsMax=0}move(e,t,n,a){this._move(e,t,n,a)}teleport(e,t,n,a){this._teleport(e,t,n,a)}positionCheck(e,t,n,a){this._positionCheck(e,t,n,a)}updateSurfaceInfo(e,t,n){this._updateSurfaceInfo(e,t,n)}_debugMovement(e,t,n,a,s){let o=e.vec3_removeComponentAlongAxis(a),l=t.vec3_removeComponentAlongAxis(a),m=t.vec3_componentAlongAxis(a),c=n.vec3_add(a.vec3_scale(s.myDistanceFromFeetToIgnore+.001));o.vec3_isZero()||(o.vec3_normalize(o),PP.myDebugVisualManager.drawArrow(0,c,o,.2,PP.vec4_create(.5,.5,1,1))),l.vec3_isZero()||(l.vec3_normalize(l),PP.myDebugVisualManager.drawArrow(0,c,l,.2,PP.vec4_create(0,0,1,1))),m.vec3_isZero()||(m.vec3_normalize(m),PP.myDebugVisualManager.drawArrow(0,n,m,.2,PP.vec4_create(0,0,1,1)))}_debugRuntimeParams(e){e.myHorizontalCollisionHit.isValid()&&PP.myDebugVisualManager.drawArrow(0,e.myHorizontalCollisionHit.myPosition,e.myHorizontalCollisionHit.myNormal,.2,PP.vec4_create(1,0,0,1)),e.mySlidingCollisionHit.isValid()&&PP.myDebugVisualManager.drawArrow(0,e.mySlidingCollisionHit.myPosition,e.mySlidingCollisionHit.myNormal,.2,PP.vec4_create(1,0,0,1)),e.myVerticalCollisionHit.isValid()&&PP.myDebugVisualManager.drawArrow(0,e.myVerticalCollisionHit.myPosition,e.myVerticalCollisionHit.myNormal,.2,PP.vec4_create(1,0,0,1))}};PP.CollisionCheck.prototype._raycastAndDebug=function(){let i=new PP.RaycastResults;return function(t,n,a,s,o,l,m){this._myRaycastSetup.myOrigin.vec3_copy(t),this._myRaycastSetup.myDirection.vec3_copy(n),this._myRaycastSetup.myDistance=a,o?(this._myRaycastSetup.myBlockLayerFlags.copy(l.myHorizontalBlockLayerFlags),this._myRaycastSetup.myObjectsToIgnore=l.myHorizontalObjectsToIgnore):(this._myRaycastSetup.myBlockLayerFlags.copy(l.myVerticalBlockLayerFlags),this._myRaycastSetup.myObjectsToIgnore=l.myVerticalObjectsToIgnore),this._myRaycastSetup.myIgnoreHitsInsideCollision=s;let c=null;return c=PP.PhysicsUtils.raycast(this._myRaycastSetup,this._myRaycastResult),this._myTotalRaycasts++,this._myDebugActive&&PP.myDebugVisualManager.drawRaycast(0,c),c}}();Object.defineProperty(PP.CollisionCheck.prototype,"_raycastAndDebug",{enumerable:!1})});var Pa=S(()=>{PP.CollisionCheck.prototype._move=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.quat2_create(),a=PP.quat2_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=PP.vec3_create(),p=new PP.CollisionRuntimeParams,d=PP.vec3_create(),_=PP.vec3_create();return function(P,T,v,f){n.quat2_setPositionRotationQuat(v.myPositionOffsetLocal,v.myRotationOffsetLocalQuat),a=n.quat2_toWorld(T,a),T.vec_equals(a,1e-5)&&a.quat2_copy(T),i=a.quat2_getUp(i),e=a.quat2_getForward(e),t=a.quat2_getPosition(t);let g=v.myHeight;g=g-1e-5,g<1e-5&&(g=0),s=P.vec3_removeComponentAlongAxis(i,s),o=P.vec3_componentAlongAxis(i,o);let C=1;if(l.vec3_copy(P),!P.vec3_isZero(1e-5)&&v.mySplitMovementEnabled){let A=P.vec3_length()/v.mySplitMovementMaxSteps;if(!v.mySplitMovementStepEqualLength||A<v.mySplitMovementStepEqualLengthMinLength){let I=v.mySplitMovementStepEqualLength?v.mySplitMovementStepEqualLengthMinLength:v.mySplitMovementMaxLength;C=Math.ceil(P.vec3_length()/I),C>1&&(l=l.vec3_normalize(l).vec3_scale(I,l),C=v.mySplitMovementMaxStepsEnabled?Math.min(C,v.mySplitMovementMaxSteps):C),C=Math.max(1,C),C==1&&l.vec3_copy(P)}else C=v.mySplitMovementMaxSteps,C>1&&(l=l.vec3_normalize(l).vec3_scale(A,l))}r.vec3_zero(),c.vec3_zero(),p.copy(f),d.vec3_copy(r),_.vec3_copy(c);let M=0,b=!1;for(let A=0;A<C;A++){if(C==1||A!=C-1?m.vec3_copy(l):m=P.vec3_sub(c,m),y=t.vec3_add(r,y),u.vec3_zero(),u=this._moveStep(m,y,i,e,g,!0,v,f,u),r.vec3_add(u,r),c=c.vec3_add(l,c),M=A+1,f.myHorizontalMovementCanceled&&f.myVerticalMovementCanceled||f.myHorizontalMovementCanceled&&v.mySplitMovementStopWhenHorizontalMovementCanceled||f.myVerticalMovementCanceled&&v.mySplitMovementStopWhenVerticalMovementCanceled||v.mySplitMovementStopCallback!=null&&v.mySplitMovementStopCallback(f)){v.mySplitMovementStopReturnPrevious&&(f.copy(p),r.vec3_copy(d),c.vec3_copy(_),M-=1),b=!0;break}p.copy(f),d.vec3_copy(r),_.vec3_copy(c)}f.mySplitMovementSteps=C,f.mySplitMovementStepsPerformed=M,f.mySplitMovementStop=b,f.mySplitMovementMovementChecked.vec3_copy(c),f.myOriginalUp=T.quat2_getUp(f.myOriginalUp),f.myOriginalForward=T.quat2_getForward(f.myOriginalForward),f.myOriginalPosition=T.quat2_getPosition(f.myOriginalPosition),f.myOriginalHeight=v.myHeight,f.myOriginalMovement.vec3_copy(P),f.myFixedMovement.vec3_copy(r),f.myNewPosition=f.myOriginalPosition.vec3_add(f.myFixedMovement,f.myNewPosition),f.myIsMove=!0}}();PP.CollisionCheck.prototype._moveStep=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=PP.vec3_create(0,0,1),p=PP.vec3_create(1,0,0);return function(_,h,P,T,v,f,g,C,M){i=_.vec3_removeComponentAlongAxis(P,i),i.vec3_isZero(1e-6)&&i.vec3_zero(),e=_.vec3_componentAlongAxis(P,e),e.vec3_isZero(1e-6)&&e.vec3_zero(),i.vec3_isZero(),this._myPrevCollisionRuntimeParams.copy(C),C.reset(),r=this._adjustHorizontalMovementWithSurface(i,e,P,g,C,this._myPrevCollisionRuntimeParams,r),r.vec3_isZero(1e-5)&&r.vec3_zero(),this._syncCollisionRuntimeParamsWithPrevious(r,e,P,g,C,this._myPrevCollisionRuntimeParams),s.vec3_copy(g.myCheckHorizontalFixedForward),g.myCheckHorizontalFixedForwardEnabled?(g.myCheckHorizontalFixedForward.vec3_isOnAxis(P)&&(u.vec3_isOnAxis(P)?s.vec3_copy(p):s.vec3_copy(u)),s=s.vec3_removeComponentAlongAxis(P,s),s=s.vec3_normalize(s),s.vec_equals(g.myCheckHorizontalFixedForward,1e-5)&&s.vec3_copy(g.myCheckHorizontalFixedForward)):r.vec3_isZero()?i.vec3_isZero()?s.vec3_copy(T):s=i.vec3_normalize(s):s=r.vec3_normalize(s),t.vec3_zero(),r.vec3_isZero()||(t=this._horizontalCheck(r,h,v,P,s,f,g,C,this._myPrevCollisionRuntimeParams,!1,t),g.mySlidingEnabled&&C.myIsCollidingHorizontally&&this._isSlidingNormalValid(r,P,C)&&(t=this._horizontalSlide(r,h,v,P,s,f,g,C,this._myPrevCollisionRuntimeParams,t))),t.vec3_isZero(1e-6)&&t.vec3_zero(),!r.vec3_isZero()&&t.vec3_isZero()&&(C.myHorizontalMovementCanceled=!0);{o.vec3_copy(g.myCheckVerticalFixedForward),g.myCheckVerticalFixedForwardEnabled?(g.myCheckVerticalFixedForward.vec3_isOnAxis(P)&&(u.vec3_isOnAxis(P)?o.vec3_copy(p):o.vec3_copy(u)),o=o.vec3_removeComponentAlongAxis(P,o),o=o.vec3_normalize(o),o.vec_equals(g.myCheckVerticalFixedForward,1e-5)&&o.vec3_copy(g.myCheckVerticalFixedForward)):t.vec3_isZero()?r.vec3_isZero()?i.vec3_isZero()?o.vec3_copy(T):o=i.vec3_normalize(o):o=r.vec3_normalize(o):o=t.vec3_normalize(o),c=this._adjustVerticalMovementWithSurface(t,e,P,g,C,this._myPrevCollisionRuntimeParams,c),m=h.vec3_add(t,m);let A=Math.pp_sign(e.vec3_lengthSigned(P),0);n.vec3_zero(),n=this._verticalCheck(c,A,m,v,P,o,g,C,n),n.vec3_isZero(1e-6)&&n.vec3_zero()}M.vec3_zero(),C.myIsCollidingVertically?(C.myHorizontalMovementCanceled=!0,C.myVerticalMovementCanceled=!0,t.vec3_zero(),n.vec3_zero(),g.myCheckVerticalFixedForwardEnabled||(r.vec3_isZero()?i.vec3_isZero()?o.vec3_copy(T):o=i.vec3_normalize(o):o=r.vec3_normalize(o))):M=t.vec3_add(n,M),m=h.vec3_add(M,m),l.vec3_copy(T),t.vec3_isZero()?r.vec3_isZero()?i.vec3_isZero()||(l=i.vec3_normalize(l)):l=r.vec3_normalize(l):l=t.vec3_normalize(l),g.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(m,v,P,l,o,!0,g,C),g.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(m,v,P,l,o,!1,g,C),!r.vec3_isZero()&&!C.myHorizontalMovementCanceled&&(this._postSurfaceCheck(t,n,P,g,C,this._myPrevCollisionRuntimeParams)||(C.myHorizontalMovementCanceled=!0,C.myVerticalMovementCanceled=!0,t.vec3_zero(),n.vec3_zero(),M.vec3_zero(),m=h.vec3_add(M,m),r.vec3_isZero()?i.vec3_isZero()?l.vec3_copy(T):l=i.vec3_normalize(l):l=r.vec3_normalize(l),g.myComputeGroundInfoEnabled&&g.myRegatherGroundInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(m,v,P,l,o,!0,g,C):(C.myIsOnGround=this._myPrevCollisionRuntimeParams.myIsOnGround,C.myGroundAngle=this._myPrevCollisionRuntimeParams.myGroundAngle,C.myGroundPerceivedAngle=this._myPrevCollisionRuntimeParams.myGroundPerceivedAngle,C.myGroundNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myGroundNormal)),g.myComputeCeilingInfoEnabled&&g.myRegatherCeilingInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(m,v,P,l,o,!1,g,C):(C.myIsOnCeiling=this._myPrevCollisionRuntimeParams.myIsOnCeiling,C.myCeilingAngle=this._myPrevCollisionRuntimeParams.myCeilingAngle,C.myCeilingPerceivedAngle=this._myPrevCollisionRuntimeParams.myCeilingPerceivedAngle,C.myCeilingNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myCeilingNormal)))),g.myExtraMovementCheckCallback!=null&&(y.vec3_copy(M),M=g.myExtraMovementCheckCallback(_,y,h,P,T,v,g,this._myPrevCollisionRuntimeParams,C,M),t=M.vec3_removeComponentAlongAxis(P,t),n=M.vec3_componentAlongAxis(P,n)),g.mySlidingAdjustSign90Degrees&&!C.myHorizontalMovementCanceled&&!C.myIsSliding&&!t.vec3_isZero()&&(C.mySlidingRecompute90DegreesSign=!0),i.vec3_isZero()||C.myLastValidOriginalHorizontalMovement.vec3_copy(i),r.vec3_isZero()||C.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(r),e.vec3_isZero()||C.myLastValidOriginalVerticalMovement.vec3_copy(e),c.vec3_isZero()||C.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(c),t.vec3_isZero(1e-6)||(C.myLastValidIsSliding=C.myIsSliding,C.myIsSlidingFlickerPrevented=!1,C.myLastValidEndHorizontalMovement.vec3_copy(t),C.myIsSliding),n.vec3_isZero(1e-6)||C.myLastValidEndVerticalMovement.vec3_copy(n);let b=!1;if(!C.myHorizontalMovementCanceled&&!t.vec3_isZero(1e-6)){a=t.vec3_normalize(a);let A=this._surfaceTooSteep(P,a,g,this._myPrevCollisionRuntimeParams);if(A[0]||A[1]){a=t.vec3_normalize(a);let I=this._surfaceTooSteep(P,a,g,C);(A[0]&&I[0]||A[1]&&I[1]||!f||A[0]&&!g.myAllowGroundSteepFix||A[1]&&!g.myAllowCeilingSteepFix)&&(M.vec3_zero(),C.copy(this._myPrevCollisionRuntimeParams),this._moveStep(_,h,P,T,v,!1,g,C,M),b=!0)}}return b||(g.myDebugActive&&g.myDebugMovementActive&&this._debugMovement(_,M,m,P,g),g.myDebugActive&&g.myDebugRuntimeParamsActive&&this._debugRuntimeParams(C)),M}}();PP.CollisionCheck.prototype._syncCollisionRuntimeParamsWithPrevious=function(){let i=PP.vec3_create();return function(t,n,a,s,o,l){if(o.myIsSlidingFlickerPrevented=l.myIsSlidingFlickerPrevented,o.myLastValidOriginalHorizontalMovement.vec3_copy(l.myLastValidOriginalHorizontalMovement),o.myLastValidOriginalVerticalMovement.vec3_copy(l.myLastValidOriginalVerticalMovement),o.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(l.myLastValidSurfaceAdjustedHorizontalMovement),o.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(l.myLastValidSurfaceAdjustedVerticalMovement),o.myLastValidIsSliding=l.myLastValidIsSliding,o.mySliding90DegreesSign=l.mySliding90DegreesSign,o.mySlidingRecompute90DegreesSign=l.mySlidingRecompute90DegreesSign,s.mySlidingAdjustSign90Degrees){let m=.5;if(!l.myLastValidSurfaceAdjustedHorizontalMovement.vec3_isZero()&&!t.vec3_isZero()&&t.vec3_angle(l.myLastValidSurfaceAdjustedHorizontalMovement)>m){if(!l.myLastValidIsSliding){let c=t.vec3_angleSigned(l.myLastValidSurfaceAdjustedHorizontalMovement,a),r=10;Math.abs(c)<180-r&&(o.mySliding90DegreesSign=Math.pp_sign(c))}o.mySlidingRecompute90DegreesSign=!0}}i=l.myFixedMovement.vec3_removeComponentAlongAxis(a,i),i.vec3_isZero(1e-6)?o.mySlidingPreviousHorizontalMovement.vec3_copy(l.mySlidingPreviousHorizontalMovement):o.mySlidingPreviousHorizontalMovement.vec3_copy(i)}}();Object.defineProperty(PP.CollisionCheck.prototype,"_move",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_moveStep",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_syncCollisionRuntimeParamsWithPrevious",{enumerable:!1})});var ga=S(()=>{PP.CollisionCheck.prototype._teleport=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.quat2_create(),s=PP.quat2_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=PP.vec3_create(),p=PP.vec3_create(),d=PP.vec3_create(),_=PP.vec3_create(),h=PP.vec3_create(0,0,1),P=PP.vec3_create(1,0,0);return function(v,f,g,C,M=!1){a.quat2_setPositionRotationQuat(g.myPositionOffsetLocal,g.myRotationOffsetLocalQuat),s=a.quat2_toWorld(f,s),f.vec_equals(s,1e-5)&&s.quat2_copy(f),i=s.quat2_getUp(i),e=s.quat2_getForward(e),t=s.quat2_getPosition(t),l.vec3_copy(v),n=f.quat2_getPosition(n),o=n.vec3_sub(t,o),o.vec3_isZero(1e-5)?o.vec3_zero():l=l.vec3_sub(o,l);let b=g.myHeight;if(b=b-1e-5,b<1e-5&&(b=0),this._myPrevCollisionRuntimeParams.copy(C),C.reset(),c.vec3_copy(g.myCheckHorizontalFixedForward),g.myCheckHorizontalFixedForwardEnabled?(g.myCheckHorizontalFixedForward.vec3_isOnAxis(i)&&(h.vec3_isOnAxis(i)?c.vec3_copy(P):c.vec3_copy(h)),c=c.vec3_removeComponentAlongAxis(i,c),c=c.vec3_normalize(c),c.vec_equals(g.myCheckHorizontalFixedForward,1e-5)&&c.vec3_copy(g.myCheckHorizontalFixedForward)):c.vec3_copy(e),u=this._horizontalCheck(m,l,b,i,c,!1,g,C,this._myPrevCollisionRuntimeParams,!1,u),C.myIsCollidingHorizontally)C.myTeleportCanceled=!0;else{d=l.vec3_add(u,d),r.vec3_copy(g.myCheckVerticalFixedForward),g.myCheckVerticalFixedForwardEnabled?(g.myCheckVerticalFixedForward.vec3_isOnAxis(i)&&(h.vec3_isOnAxis(i)?r.vec3_copy(P):r.vec3_copy(h)),r=r.vec3_removeComponentAlongAxis(i,r),r=r.vec3_normalize(r),r.vec_equals(g.myCheckVerticalFixedForward,1e-5)&&r.vec3_copy(g.myCheckVerticalFixedForward)):r.vec3_copy(e);let A=-1;if(p=this._verticalCheck(m,A,d,b,i,r,g,C,p),C.myIsCollidingVertically)C.myTeleportCanceled=!0;else{if(d=d.vec3_add(p,d),y.vec3_copy(e),g.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(d,b,i,y,r,!0,g,C),g.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(d,b,i,y,r,!1,g,C),C.myIsOnGround||(g.myTeleportMustBeOnGround&&!M||g.myCheckTransformMustBeOnGround&&M)&&(C.myTeleportCanceled=!0),C.myIsOnCeiling||(g.myTeleportMustBeOnCeiling&&!M||g.myCheckTransformMustBeOnCeiling&&M)&&(C.myTeleportCanceled=!0),C.myIsOnGround){let I=null;M?(g.myCheckTransformMustBeOnIgnorableGroundAngle&&(I=g.myGroundAngleToIgnore),g.myCheckTransformMustBeOnGroundAngle!=null&&(I=Math.min(I,g.myCheckTransformMustBeOnGroundAngle))):(g.myTeleportMustBeOnIgnorableGroundAngle&&(I=g.myGroundAngleToIgnore),g.myTeleportMustBeOnGroundAngle!=null&&(I=Math.min(I,g.myTeleportMustBeOnGroundAngle))),I!=null&&C.myGroundAngle>I+1e-4&&(C.myTeleportCanceled=!0)}if(C.myIsOnCeiling){let I=null;M?(g.myCheckTransformMustBeOnIgnorableCeilingAngle&&(I=g.myCeilingAngleToIgnore),g.myCheckTransformMustBeOnCeilingAngle!=null&&(I=Math.min(I,g.myCheckTransformMustBeOnCeilingAngle))):(g.myTeleportMustBeOnIgnorableCeilingAngle&&(I=g.myCeilingAngleToIgnore),g.myTeleportMustBeOnCeilingAngle!=null&&(I=Math.min(I,g.myTeleportMustBeOnCeilingAngle))),I!=null&&C.myCeilingAngle>I+1e-4&&(C.myTeleportCanceled=!0)}C.myTeleportCanceled&&(g.myComputeGroundInfoEnabled&&g.myRegatherGroundInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(d,b,i,y,r,!0,g,C):(C.myIsOnGround=this._myPrevCollisionRuntimeParams.myIsOnGround,C.myGroundAngle=this._myPrevCollisionRuntimeParams.myGroundAngle,C.myGroundPerceivedAngle=this._myPrevCollisionRuntimeParams.myGroundPerceivedAngle,C.myGroundNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myGroundNormal)),g.myComputeCeilingInfoEnabled&&g.myRegatherCeilingInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(d,b,i,y,r,!1,g,C):(C.myIsOnCeiling=this._myPrevCollisionRuntimeParams.myIsOnCeiling,C.myCeilingAngle=this._myPrevCollisionRuntimeParams.myCeilingAngle,C.myCeilingPerceivedAngle=this._myPrevCollisionRuntimeParams.myCeilingPerceivedAngle,C.myCeilingNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myCeilingNormal)))}}M?g.myExtraCheckTransformCheckCallback!=null&&(_.vec3_copy(d),d=g.myExtraCheckTransformCheckCallback(_,t,i,e,b,g,this._myPrevCollisionRuntimeParams,C,d)):g.myExtraTeleportCheckCallback!=null&&(_.vec3_copy(d),d=g.myExtraTeleportCheckCallback(l,_,t,i,e,b,g,this._myPrevCollisionRuntimeParams,C,d)),C.myOriginalUp=f.quat2_getUp(C.myOriginalUp),C.myOriginalForward=f.quat2_getForward(C.myOriginalForward),C.myOriginalPosition=f.quat2_getPosition(C.myOriginalPosition),C.myOriginalHeight=g.myHeight,C.myOriginalTeleportPosition.vec3_copy(v),C.myTeleportCanceled?C.myNewPosition.vec3_copy(C.myOriginalPosition):(C.myFixedTeleportPosition.vec3_copy(d),o.vec3_isZero(1e-5)||(C.myFixedTeleportPosition=C.myFixedTeleportPosition.vec3_add(o,C.myFixedTeleportPosition)),C.myNewPosition.vec3_copy(C.myFixedTeleportPosition)),C.myIsTeleport=!0,g.myDebugActive&&g.myDebugRuntimeParamsActive&&this._debugRuntimeParams(C)}}();Object.defineProperty(PP.CollisionCheck.prototype,"_teleport",{enumerable:!1})});var fa=S(()=>{PP.CollisionCheck.prototype._positionCheck=function(){let i=PP.vec3_create();return function(t,n,a,s){i=n.quat2_getPosition(i),this._teleport(i,n,a,s,!0),s.myIsPositionOk=!s.myTeleportCanceled,s.myIsPositionCheck=!0,s.myOriginalPositionCheckPosition.vec3_copy(s.myOriginalTeleportPosition),s.myFixedPositionCheckPosition.vec3_copy(s.myFixedTeleportPosition),s.myIsPositionCheckAllowAdjustments=t,t||(s.myIsPositionOk=s.myIsPositionOk&&s.myOriginalPositionCheckPosition.vec_equals(s.myFixedPositionCheckPosition,1e-5)),s.myOriginalTeleportPosition.vec3_zero(),s.myFixedTeleportPosition.vec3_zero(),s.myTeleportCanceled=!1,s.myIsTeleport=!1}}();Object.defineProperty(PP.CollisionCheck.prototype,"_positionCheck",{enumerable:!1})});var va=S(()=>{PP.CollisionCheck.prototype._horizontalCheck=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create();return function(s,o,l,m,c,r,y,u,p,d,_){u.myIsCollidingHorizontally=!1,u.myHorizontalCollisionHit.reset(),_.vec3_zero(),n=s.vec3_normalize(n);let h=this._surfaceTooSteep(m,n,y,p);if(s.vec3_isZero(1e-6)||(!h[0]||r&&y.myAllowGroundSteepFix)&&(!h[1]||r&&y.myAllowCeilingSteepFix)){i=o.vec3_add(m.vec3_scale(y.myDistanceFromFeetToIgnore+1e-4,i),i);let P=Math.max(0,l-y.myDistanceFromFeetToIgnore-y.myDistanceFromHeadToIgnore-1e-4*2),T=!0;y.myHorizontalMovementCheckEnabled&&!s.vec3_isZero(1e-6)&&(T=this._horizontalMovementCheck(s,o,l,i,P,m,y,u)),T?y.myHorizontalPositionCheckEnabled?(e=i.vec3_add(s,e),t=o.vec3_add(s,t),this._horizontalPositionCheck(t,l,e,P,m,c,y,u)&&_.vec3_copy(s),_.vec3_isZero(1e-6)&&_.vec3_zero()):_.vec3_copy(s):!d&&y.mySlidingEnabled&&y.mySlidingHorizontalMovementCheckBetterNormal&&this._horizontalCheckBetterSlideNormal(s,o,l,i,P,m,c,y,u)}return _}}();PP.CollisionCheck.prototype._horizontalCheckRaycast=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create();return function(a,s,o,l,m,c,r,y,u,p,d,_=!1,h=!1){let P=a;i=s.vec3_sub(P,i),o!=null&&!i.vec3_isConcordant(o)&&(i.vec3_negate(i),P=s);let T=i.vec3_length();i.vec3_normalize(i);let v=this._raycastAndDebug(P,i,T,m,!0,p,d),f=!0;if(v.isColliding()){let g=_?v.myHits.length:1,C=0;for(let M=0;M<g;M++){let b=v.myHits[M];if((c==null||!c(b,h))&&(r==null||!r(b,h))){f=!1,C=M;break}}if(!f&&C>0)for(let M=0;M<C;M++)v.removeHit(0)}if(!f&&u){let g=v.myHits[0].myPosition;e=y.vec3_copyComponentAlongAxis(g,l,e),t.vec3_copy(g);let C=1e-4;i=i.vec3_componentAlongAxis(l,i),i.vec3_isZero(1e-6)||(i.vec3_normalize(i),i.vec3_scale(C,i),e.vec3_add(i,e),t.vec3_add(i,t)),i=t.vec3_sub(e,i),i.vec3_normalize(i),i.vec3_scale(C,i),t=t.vec3_add(i,t);let M=this._myRaycastResult;this._myRaycastResult=this._myFixRaycastResult,f=this._horizontalCheckRaycast(e,t,null,l,!1,c,r,y,!1,p,d),this._myRaycastResult.isColliding()?this._myFixRaycastResult=M:(f=!1,this._myRaycastResult=M)}return f}}();PP.CollisionCheck.prototype._ignoreSurfaceAngle=function(){let i=(s,o)=>s.pp_equals(o),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create();return function(o,l,m,c,r,y,u,p,d,_,h){let P=!1,T=null,v=u?d.myHorizontalMovementGroundAngleIgnoreHeight:d.myHorizontalPositionGroundAngleIgnoreHeight,f=u?d.myHorizontalMovementCeilingAngleIgnoreHeight:d.myHorizontalPositionCeilingAngleIgnoreHeight;y&&v!=null?T=Math.pp_clamp(v+2e-4,0,l):!y&&f!=null&&(T=Math.pp_clamp(l-f-2e-4,0,l));let g=null;if(u&&(y&&d.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft!=null?g=d.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft:!y&&d.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft!=null&&(g=d.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft)),_.myIsInsideCollision)h&&(c==null||c.pp_hasEqual(_.myObject,i))&&(P=!0);else{e=m.vec3_normalize(e);let C=_.myNormal.vec3_angle(p);if(y||(C=180-C),y&&d.myGroundAngleToIgnore>0&&C>d.myGroundAngleToIgnore+1e-4){if(d.myGroundAngleToIgnoreWithPerceivedAngle!=null&&C<=d.myGroundAngleToIgnoreWithPerceivedAngle+1e-4){let M=this.computeSurfacePerceivedAngle(_.myNormal,e,p,!0);C=Math.abs(M)}}else if(!y&&d.myCeilingAngleToIgnore>0&&C>d.myCeilingAngleToIgnore+1e-4&&d.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&C<=d.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4){let M=this.computeSurfacePerceivedAngle(_.myNormal,e,p,!1);C=Math.abs(M)}if((y&&d.myGroundAngleToIgnore>0&&C<=d.myGroundAngleToIgnore+1e-4||!y&&d.myCeilingAngleToIgnore>0&&C<=d.myCeilingAngleToIgnore+1e-4)&&(c==null||c.pp_hasEqual(_.myObject,i))){let M=!0,b=!0;if(T!=null){M=!1;let A=o.vec3_valueAlongAxis(p),V=_.myPosition.vec3_valueAlongAxis(p)-A;(y&&V<=T||!y&&V>=T)&&(M=!0)}if(M&&u&&g!=null){let A=m.vec3_length();if(A>g){b=!1;let I=_.myPosition,V=Math.min(d.myHalfConeAngle,90);t=I.vec3_sub(o,t),t.vec3_isToTheRight(e,p)?a=e.vec3_rotateAxis(-V,p,a):a=e.vec3_rotateAxis(V,p,a),n=t.vec3_projectOnAxisAlongAxis(e,a,n);let D=n.vec3_length();A-D<=g&&(b=!0)}}M&&b&&(P=!0)}}return P&&r?.pp_pushUnique(_.myObject,i),P}}();Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalCheck",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalCheckRaycast",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_ignoreSurfaceAngle",{enumerable:!1})});var Ta=S(()=>{PP.CollisionCheck.prototype._horizontalSlide=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a,s,o,l,m,c,r,y,u){if(n.vec3_isZero(1e-5))return u.vec3_zero();if(this._mySlidingCollisionRuntimeParams.copy(r),i.vec3_copy(r.mySlidingPreviousHorizontalMovement),u=this._internalHorizontalSlide(n,a,s,o,l,i,m,c,this._mySlidingCollisionRuntimeParams,y,!1,u),c.mySlidingCheckBothDirections&&this._horizontalSlideCheckOpposite(n,a,s,o,l,i,this._myPrevCollisionRuntimeParams.myIsSliding,m,c,r,this._mySlidingCollisionRuntimeParams,y,u),this._mySlidingCollisionRuntimeParams.myIsSliding&&c.mySlidingFlickeringPreventionType>0){let p=this._horizontalSlideFlickerCheck(n,u,a,s,o,l,m,c,this._mySlidingCollisionRuntimeParams,y);this._mySlidingCollisionRuntimeParams.myIsSliding=!p}if(this._mySlidingCollisionRuntimeParams.myIsSliding){let p=r.myIsSlidingFlickerPrevented;r.copy(this._mySlidingCollisionRuntimeParams),r.myIsSlidingFlickerPrevented=p||this._mySlidingCollisionRuntimeParams.myIsSlidingFlickerPrevented}else r.myIsSlidingFlickerPrevented=r.myIsSlidingFlickerPrevented||this._mySlidingCollisionRuntimeParams.myIsSlidingFlickerPrevented,u.vec3_zero();return u}}();PP.CollisionCheck.prototype._horizontalSlideCheckOpposite=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create();return function(a,s,o,l,m,c,r,y,u,p,d,_,h){i=p.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(l,i),i.vec3_normalize(i);let P=20;if(!(i.vec3_angle(a)>180-P)&&!(r&&d.myIsSliding&&h.vec3_isConcordant(c))&&(this._mySlidingOppositeDirectionCollisionRuntimeParams.copy(p),e=this._internalHorizontalSlide(a,s,o,l,m,c,y,u,this._mySlidingOppositeDirectionCollisionRuntimeParams,_,!0,e),this._mySlidingOppositeDirectionCollisionRuntimeParams.myIsSliding)){let T=!1;if(d.myIsSliding){if(a.vec3_angle(e)<a.vec3_angle(h)-1e-4)T=!0;else if(Math.abs(a.vec3_angle(e)-a.vec3_angle(h))<=1e-4&&c.vec3_angle(e)<c.vec3_angle(h)-1e-4){let v=5;i.vec3_angle(a)<90+v&&(T=!0)}}else{let v=.001;a.vec3_isConcordant(e)&&a.vec3_angle(e)<90-v&&(T=!0)}T&&(h.vec3_copy(e),d.copy(this._mySlidingOppositeDirectionCollisionRuntimeParams))}}}();PP.CollisionCheck.prototype._horizontalSlideFlickerCheck=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create();return function(s,o,l,m,c,r,y,u,p,d){let _=!1;i.vec3_copy(p.mySlidingPreviousHorizontalMovement);let h=this._myPrevCollisionRuntimeParams.myIsSlidingFlickerPrevented||i.vec3_isZero(1e-5);if(!h&&(this._myPrevCollisionRuntimeParams.myIsSliding||!u.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding)){let P=90,T=85;switch(u.mySlidingFlickeringPreventionType){case 1:h=i.vec3_signTo(s,c,0)!=o.vec3_signTo(s,c,0);break;case 2:h=u.mySlidingCheckBothDirections&&p.myIsSlidingIntoOppositeDirection,h=h||Math.abs(p.mySlidingCollisionAngle)>P+1e-5;break;case 3:h=u.mySlidingCheckBothDirections&&p.myIsSlidingIntoOppositeDirection,h=h||Math.abs(p.mySlidingCollisionAngle)>P+1e-5,h=h||Math.abs(Math.abs(p.mySlidingCollisionAngle)-P)<1e-5&&Math.abs(p.mySlidingMovementAngle)>T+1e-5;break;case 4:h=!0;break}}if(h||this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter>0)if(h?p.mySlidingFlickerPreventionCheckAnywayCounter=u.mySlidingFlickerPreventionCheckAnywayCounter:p.mySlidingFlickerPreventionCheckAnywayCounter=Math.max(0,this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter-1),(u.mySlidingFlickeringPreventionType!=1||p.myIsSlidingFlickerPrevented||this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter>0)&&this._myPrevCollisionRuntimeParams.myIsSliding&&i.vec3_signTo(s,c,0)!=o.vec3_signTo(s,c,0))_=!0,p.myIsSlidingFlickerPrevented=!0;else{this._mySlidingFlickeringFixCollisionRuntimeParams.reset(),this._mySlidingFlickeringFixCollisionRuntimeParams.mySliding90DegreesSign=p.mySliding90DegreesSign,this._mySlidingFlickeringFixCollisionRuntimeParams.mySlidingRecompute90DegreesSign=!1,e=l.vec3_add(o,e);let P=u.myDebugActive;u.myDebugActive=u.myDebugActive&&u.myDebugSlidingActive,t.vec3_zero(),t=this._horizontalCheck(s,e,m,c,r,y,u,this._mySlidingFlickeringFixCollisionRuntimeParams,d,!1,t),u.myDebugActive=P,t.vec3_isZero(1e-5)&&(this._mySlidingFlickeringFixSlidingCollisionRuntimeParams.copy(this._mySlidingFlickeringFixCollisionRuntimeParams),n=this._internalHorizontalSlide(s,e,m,c,r,o,y,u,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams,d,!1,n),u.mySlidingCheckBothDirections&&this._horizontalSlideCheckOpposite(s,e,m,c,r,o,!0,y,u,this._mySlidingFlickeringFixCollisionRuntimeParams,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams,d,n),this._mySlidingFlickeringFixSlidingCollisionRuntimeParams.myIsSliding&&o.vec3_signTo(s,c,0)!=n.vec3_signTo(s,c,0)&&(_=!0,p.myIsSlidingFlickerPrevented=!0))}return _}}();PP.CollisionCheck.prototype._internalHorizontalSlide=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create();return function(l,m,c,r,y,u,p,d,_,h,P,T){if(l.vec3_isZero(1e-5))return T.vec3_zero();if(i=_.myHorizontalCollisionHit.myNormal.vec3_negate(i),i.vec3_removeComponentAlongAxis(r,i),i[0]=Math.abs(i[0])<.01?0:i[0],i[2]=Math.abs(i[2])<.01?0:i[2],i.vec3_normalize(i),_.mySlidingCollisionHit.copy(_.myHorizontalCollisionHit),_.mySlidingWallNormal.vec3_copy(_.myHorizontalCollisionHit.myNormal),T.vec3_zero(),e.vec3_copy(i),P&&(e.vec3_copy(l),e.vec3_normalize(e)),!e.vec3_isZero(1e-5)){e.vec3_scale(l.vec3_length(),e);let v=i.vec3_signTo(l,r);if(d.mySlidingAdjustSign90Degrees){let A=.1;i.vec3_angle(l)<A&&_.mySliding90DegreesSign!=0?v=_.mySliding90DegreesSign:(_.mySliding90DegreesSign==0||_.mySlidingRecompute90DegreesSign)&&(_.mySliding90DegreesSign=v),_.mySlidingRecompute90DegreesSign=!1}P&&(v*=-1);let f=90*v,g=Math.pp_angleClamp(e.vec3_angleSigned(l.vec3_rotateAxis(90*v,r,t),r)*v,!0)*v,C=Math.pp_angleClamp(e.vec3_angleSigned(l,r)*v,!0)*v;if(P?(g=f,C=0):(Math.abs(g)<Math.abs(C)&&(C=0),Math.abs(Math.abs(g)-Math.abs(C))<1e-4&&(C=g),(Math.abs(g)<Math.abs(f)||Math.abs(Math.abs(g)-Math.abs(f))<1e-4)&&(f=g),(Math.abs(f)<Math.abs(C)||Math.abs(Math.abs(C)-Math.abs(f))<1e-4)&&(f=C)),P&&!u.vec3_isZero(1e-6)){let A=l.vec3_angleSigned(u,r);Math.pp_sign(A)==Math.pp_sign(g)&&Math.abs(g)>Math.abs(A)&&(f=A)}n.vec3_zero();let M=d.myDebugActive;d.myDebugActive=d.myDebugActive&&d.myDebugSlidingActive;let b=f;for(let A=0;A<d.mySlidingMaxAttempts&&(this._myInternalSlidingCollisionRuntimeParams.copy(_),n=e.vec3_rotateAxis(f,r,n),a.vec3_copy(y),d.myCheckHorizontalFixedForwardEnabled||n.vec3_isZero()||(a=n.vec3_normalize(a)),s.vec3_zero(),s=this._horizontalCheck(n,m,c,r,a,p,d,this._myInternalSlidingCollisionRuntimeParams,h,!0,s),s.vec3_isZero(1e-5)?(f!=g&&(C=f),A==0&&f!=g?f=g:f=(C+g)/2):(T.vec3_copy(n),_.copy(this._myInternalSlidingCollisionRuntimeParams),_.myIsSliding=!0,_.myIsSlidingIntoOppositeDirection=P,_.mySlidingMovementAngle=l.vec3_angleSigned(n,r),_.mySlidingCollisionAngle=i.vec3_angleSigned(n,r),g=f,f=(g+C)/2),!(Math.abs(Math.abs(g)-Math.abs(C))<1e-4));A++);d.myDebugActive=M}return _.myIsSliding||_.mySlidingCollisionHit.reset(),T}}();PP.CollisionCheck.prototype._horizontalCheckBetterSlideNormal=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create();return function(l,m,c,r,y,u,p,d,_){i=l.vec3_normalize(i);let h=_.myHorizontalCollisionHit.myPosition,P=Math.min(d.myHalfConeAngle,90);e=h.vec3_sub(r,e),e.vec3_isToTheRight(i,u)?t=i.vec3_rotateAxis(-P,u,t):t=i.vec3_rotateAxis(P,u,t),n=e.vec3_projectOnAxisAlongAxis(i,t,n),n.vec3_isConcordant(i)?n=i.vec3_scale(Math.min(n.vec3_length(),l.vec3_length()),n):n.vec3_zero(),d.myDebugActive&&d.myDebugHorizontalMovementActive&&PP.myDebugVisualManager.drawArrow(0,r,i,n.vec3_length(),PP.vec4_create(1,0,1,1)),this._myCheckBetterSlidingNormalCollisionRuntimeParams.copy(_),this._myCheckBetterSlidingNormalCollisionRuntimeParams.myIsCollidingHorizontally=!1,this._myCheckBetterSlidingNormalCollisionRuntimeParams.myHorizontalCollisionHit.reset(),a=r.vec3_add(n,a),s=r.vec3_add(n,s);let T=d.myDebugActive;d.myDebugActive=d.myDebugActive&&d.myDebugSlidingActive,d.myHorizontalPositionCheckEnabled&&this._horizontalPositionCheck(m,c,a,y,u,p,d,this._myCheckBetterSlidingNormalCollisionRuntimeParams),d.myDebugActive=T,this._myCheckBetterSlidingNormalCollisionRuntimeParams.myIsCollidingHorizontally&&!this._myCheckBetterSlidingNormalCollisionRuntimeParams.myHorizontalCollisionHit.myIsInsideCollision&&_.copy(this._myCheckBetterSlidingNormalCollisionRuntimeParams)}}();PP.CollisionCheck.prototype._isSlidingNormalValid=function(){let i=PP.vec3_create();return function(t,n,a){let s=!1;return i=a.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(n,i),i.vec3_normalize(i),i.vec3_isZero(1e-6)||(s=!0),s}}();Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalSlide",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalSlideCheckOpposite",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalSlideFlickerCheck",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_internalHorizontalSlide",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalCheckBetterSlideNormal",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_isSlidingNormalValid",{enumerable:!1})});var Ca=S(()=>{PP.CollisionCheck.prototype._horizontalMovementCheck=function(){let i=[],e=[],t=0,n=function(){let d=null;for(;e.length<=t;)e.push(PP.vec3_create());return d=e[t],t++,d},a=[],s=[],o=[],l=(d,_)=>d.pp_equals(_),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=PP.vec3_create(),p=PP.vec3_create();return function(_,h,P,T,v,f,g,C){this._myDebugActive=g.myDebugActive&&g.myDebugHorizontalMovementActive;let M=Math.min(g.myHalfConeAngle,90);m=_.vec3_normalize(m),i.length=0,t=0;let b=g.myRadius/g.myHorizontalMovementRadialStepAmount;{let D=n();D.vec3_copy(T),i.push(D)}{u=m.vec3_rotateAxis(M,f,u),p=m.vec3_rotateAxis(-M,f,p);for(let D=1;D<=g.myHorizontalMovementRadialStepAmount;D++){{let B=D*b,L=n(),w=u.vec3_scale(B,L),E=w.vec3_add(T,w);i.push(E)}{let B=D*b,L=n(),w=p.vec3_scale(B,L),E=w.vec3_add(T,w);i.push(E)}}}let A=null,I=null,V=null;if(g.myGroundAngleToIgnore>0){A=a,A.length=0,V=o,V.length=0;let D=this._ignoreSurfaceAngle.bind(this,h,P,_,null,A,!0,!0,f,g),B=null;g.myCeilingAngleToIgnore>0&&(B=this._ignoreSurfaceAngle.bind(this,h,P,_,null,V,!1,!0,f,g)),c.vec3_zero(),this._horizontalMovementHorizontalCheck(_,T,i,c,f,D,B,g,C)}if(g.myCeilingAngleToIgnore>0&&!C.myIsCollidingHorizontally&&g.myCheckHeight){I=s,I.length=0;let D=null;g.myGroundAngleToIgnore>0&&(D=this._ignoreSurfaceAngle.bind(this,h,P,_,A,null,!0,!0,f,g));let B=this._ignoreSurfaceAngle.bind(this,h,P,_,null,I,!1,!0,f,g);c=f.vec3_scale(v,c),this._horizontalMovementHorizontalCheck(_,T,i,c,f,D,B,g,C)}if(!C.myIsCollidingHorizontally){let D=!0;if(V!=null){for(let E of V)if(!I.pp_hasEqual(E,l)){D=!1;break}}let B=null,L=null;g.myGroundAngleToIgnore>0&&(B=this._ignoreSurfaceAngle.bind(this,h,P,_,A,null,!0,!0,f,g)),g.myCeilingAngleToIgnore>0&&(L=this._ignoreSurfaceAngle.bind(this,h,P,_,I,null,!1,!0,f,g));let w=0;g.myCheckHeight&&g.myHeightCheckStepAmountMovement>0&&v>1e-6&&(w=g.myHeightCheckStepAmountMovement,r=f.vec3_scale(v/w,r));for(let E=0;E<=w&&(y=r.vec3_scale(E,y),!((g.myCheckHeightTopMovement||E==0)&&(E!=0&&E!=w||E==0&&!D||E==0&&g.myGroundAngleToIgnore==0||E==w&&g.myCeilingAngleToIgnore==0)&&(this._horizontalMovementHorizontalCheck(_,T,i,y,f,B,L,g,C),C.myIsCollidingHorizontally)||E>0&&(g.myCheckHeightVerticalMovement&&this._horizontalMovementVerticalCheck(_,T,i,y,r,f,B,L,g,C),C.myIsCollidingHorizontally)));E++);}return!C.myIsCollidingHorizontally}}();PP.CollisionCheck.prototype._horizontalMovementVerticalCheck=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create();return function(y,u,p,d,_,h,P,T,v,f){let g=!0,C=1;i.vec3_copy(y),v.myHorizontalMovementStepEnabled&&(C=Math.max(1,Math.ceil(y.vec3_length()/v.myHorizontalMovementStepMaxLength)),y.vec3_scale(1/C,i)),e=y.vec3_normalize(e);for(let M=0;M<C;M++)for(let b=0;b<p.length;b++){if(t=p[b].vec3_add(i.vec3_scale(M,t),t).vec3_add(d,t),b>0){let A=Math.max(0,b-2);if(n=p[A].vec3_add(i.vec3_scale(M,n),n).vec3_add(d,n),v.myHorizontalMovementCheckVerticalDiagonalUpwardOutward&&(a=t.vec3_add(i,a),l=n.vec3_sub(_,l),g=this._horizontalCheckRaycast(l,a,e,h,!0,P,T,u,!0,v,f),!g)||v.myHorizontalMovementCheckVerticalDiagonalUpwardInward&&(s=n.vec3_add(i,s),o=t.vec3_sub(_,o),g=this._horizontalCheckRaycast(o,s,e,h,!0,P,T,u,!0,v,f),!g)||v.myHorizontalMovementCheckVerticalDiagonalDownwardOutward&&(m=t.vec3_add(i,m),m=m.vec3_sub(_,m),g=this._horizontalCheckRaycast(n,m,e,h,!0,P,T,u,!0,v,f),!g)||v.myHorizontalMovementCheckVerticalDiagonalDownwardInward&&(c=n.vec3_add(i,c),c=c.vec3_sub(_,c),g=this._horizontalCheckRaycast(t,c,e,h,!0,P,T,u,!0,v,f),!g))break;if(M==0){if(v.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward&&(l=n.vec3_sub(_,l),g=this._horizontalCheckRaycast(l,t,e,h,!0,P,T,u,!0,v,f),!g))break;if(v.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward){let I=t.vec3_sub(_);if(g=this._horizontalCheckRaycast(I,n,e,h,!0,P,T,u,!0,v,f),!g)break}}if(v.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward&&(a=t.vec3_add(i,a),c=n.vec3_sub(_,c).vec3_add(i,c),g=this._horizontalCheckRaycast(c,a,e,h,!0,P,T,u,!0,v,f),!g)||v.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward&&(s=n.vec3_add(i,s),m=t.vec3_sub(_,m).vec3_add(i,m),g=this._horizontalCheckRaycast(m,s,e,h,!0,P,T,u,!0,v,f),!g))break}if((v.myHorizontalMovementCheckVerticalStraight||v.myHorizontalMovementHorizontalStraightCentralCheckEnabled&&b==0)&&(M==0&&(o=t.vec3_sub(_,o),g=this._horizontalCheckRaycast(o,t,e,h,!0,P,T,u,!0,v,f),!g)||(a=t.vec3_add(i,a),m=a.vec3_sub(_,m),g=this._horizontalCheckRaycast(m,a,e,h,!0,P,T,u,!0,v,f),!g))||(v.myHorizontalMovementCheckVerticalStraightDiagonalUpward||v.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled&&b==0)&&(a=t.vec3_add(i,a),o=t.vec3_sub(_,o),g=this._horizontalCheckRaycast(o,a,e,h,!0,P,T,u,!0,v,f),!g)||(v.myHorizontalMovementCheckVerticalStraightDiagonalDownward||v.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled&&b==0)&&(m=t.vec3_sub(_,m).vec3_add(i,m),g=this._horizontalCheckRaycast(t,m,e,h,!0,P,T,u,!0,v,f),!g))break;if(!g){f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(raycastResult.myHits[0]);break}}return g}}();PP.CollisionCheck.prototype._horizontalMovementHorizontalCheck=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create();return function(l,m,c,r,y,u,p,d,_){let h=!0,P=1;i.vec3_copy(l),d.myHorizontalMovementStepEnabled&&(P=Math.max(1,Math.ceil(l.vec3_length()/d.myHorizontalMovementStepMaxLength)),l.vec3_scale(1/P,i)),e=l.vec3_normalize(e);for(let T=0;T<P;T++){for(let v=0;v<c.length;v++){if(t=c[v].vec3_add(i.vec3_scale(T,t),t).vec3_add(r,t),v>0){let f=Math.max(0,v-2);if(n=c[f].vec3_add(i.vec3_scale(T,n),n).vec3_add(r,n),d.myHorizontalMovementCheckDiagonalOutward&&(a=t.vec3_add(i,a),h=this._horizontalCheckRaycast(n,a,e,y,!0,u,p,m,!0,d,_),!h)||d.myHorizontalMovementCheckDiagonalInward&&(s=n.vec3_add(i,s),h=this._horizontalCheckRaycast(t,s,e,y,!0,u,p,m,!0,d,_),!h)||d.myHorizontalMovementCheckHorizontalBorder&&(T==0&&(h=this._horizontalCheckRaycast(n,t,e,y,!0,u,p,m,!0,d,_),!h)||(a=t.vec3_add(i,a),s=n.vec3_add(i,s),h=this._horizontalCheckRaycast(s,a,e,y,!0,u,p,m,!0,d,_),!h)))break}if((d.myHorizontalMovementCheckStraight||d.myHorizontalMovementVerticalStraightCentralCheckEnabled&&v==0)&&(a=t.vec3_add(i,a),h=this._horizontalCheckRaycast(t,a,null,y,!0,u,p,m,!0,d,_),!h))break}if(!h){_.myIsCollidingHorizontally=!0,_.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]);break}}return h}}();Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalMovementCheck",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalMovementVerticalCheck",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalMovementHorizontalCheck",{enumerable:!1})});var Sa=S(()=>{PP.CollisionCheck.prototype._horizontalPositionCheck=function(){let i=[],e=[],t=0,n=function(){let P=null;for(;e.length<=t;)e.push(PP.vec3_create());return P=e[t],t++,P},a=[],s=[],o=[],l=(P,T)=>P.pp_equals(T),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=PP.vec3_create(),p=PP.vec3_create(),d=PP.vec3_create(),_=PP.vec3_create(),h=new PP.RaycastHit;return function(T,v,f,g,C,M,b,A){this._myDebugActive=b.myDebugActive&&b.myDebugHorizontalPositionActive,i.length=0,t=0;let V=Math.min(b.myHalfConeAngle,180)/b.myHalfConeSliceAmount,D=n();i.push(f.vec3_add(M.vec3_scale(b.myRadius,D),D));for(let E=1;E<=b.myHalfConeSliceAmount;E++){let j=E*V;D=n();let G=M.vec3_rotateAxis(-j,C,D);i.push(f.vec3_add(G.vec3_scale(b.myRadius,G),G)),D=n(),G=M.vec3_rotateAxis(j,C,D),i.push(f.vec3_add(G.vec3_scale(b.myRadius,G),G))}let B=null,L=null,w=null;if(b.myGroundAngleToIgnore>0){B=a,B.length=0,w=o,w.length=0;let E=this._ignoreSurfaceAngle.bind(this,T,v,M,null,B,!0,!1,C,b),j=null;b.myCeilingAngleToIgnore>0&&(j=this._ignoreSurfaceAngle.bind(this,T,v,M,null,w,!1,!1,C,b)),m.vec3_zero(),this._horizontalPositionHorizontalCheck(f,i,m,C,M,E,j,b,A)}if(b.myCeilingAngleToIgnore>0&&!A.myIsCollidingHorizontally&&b.myCheckHeight){L=s,L.length=0;let E=null;b.myGroundAngleToIgnore>0&&(E=this._ignoreSurfaceAngle.bind(this,T,v,M,B,null,!0,!1,C,b));let j=this._ignoreSurfaceAngle.bind(this,T,v,M,null,L,!1,!1,C,b);m=C.vec3_scale(g,m),this._horizontalPositionHorizontalCheck(f,i,m,C,M,E,j,b,A)}if(!A.myIsCollidingHorizontally){let E=!0;if(w!=null){for(let N of w)if(!L.pp_hasEqual(N,l)){E=!1;break}}let j=null,G=null;b.myGroundAngleToIgnore>0&&(j=this._ignoreSurfaceAngle.bind(this,T,v,M,B,null,!0,!1,C,b)),b.myCeilingAngleToIgnore>0&&(G=this._ignoreSurfaceAngle.bind(this,T,v,M,L,null,!1,!1,C,b));let X=0;b.myCheckHeight&&b.myHeightCheckStepAmountPosition>0&&g>0&&(X=b.myHeightCheckStepAmountPosition,C.vec3_scale(g/X,c));for(let N=0;N<=X&&(r=c.vec3_scale(N,r),!((b.myCheckHeightTopPosition||N==0)&&(N!=0&&N!=X||N==0&&!E||N==0&&b.myGroundAngleToIgnore==0||N!=0&&N==X&&b.myCeilingAngleToIgnore==0)&&(this._horizontalPositionHorizontalCheck(f,i,r,C,M,j,G,b,A),A.myIsCollidingHorizontally)));N++)if(N>0&&b.myCheckHeightVerticalPosition){let de=1e-4;if((b.myHorizontalPositionCheckVerticalDirectionType==0||b.myHorizontalPositionCheckVerticalDirectionType==2)&&(_.vec3_copy(C),this._horizontalPositionVerticalCheck(f,i,r,c,_,C,j,G,b,A),A.myIsCollidingHorizontally&&b.myCheckHeightConeOnCollision)){if(y=A.myHorizontalCollisionHit.myPosition.vec3_sub(f,y).vec3_componentAlongAxis(C,y),y.vec3_add(_.vec3_scale(de,u),y),A.myIsCollidingHorizontally=!1,b.myCheckHeightConeOnCollisionKeepHit&&h.copy(A.myHorizontalCollisionHit),A.myHorizontalCollisionHit.reset(),this._horizontalPositionHorizontalCheck(f,i,y,C,M,j,G,b,A),A.myIsCollidingHorizontally)break;if(b.myCheckHeightConeOnCollisionKeepHit){A.myIsCollidingHorizontally=!0,A.myHorizontalCollisionHit.copy(h);break}}if(!A.myIsCollidingHorizontally&&((b.myHorizontalPositionCheckVerticalDirectionType==1||b.myHorizontalPositionCheckVerticalDirectionType==2)&&(_=C.vec3_negate(_),p=r.vec3_sub(c,p),d=c.vec3_negate(d),this._horizontalPositionVerticalCheck(f,i,p,d,_,C,j,G,b,A)),A.myIsCollidingHorizontally&&b.myCheckHeightConeOnCollision)){if(y=A.myHorizontalCollisionHit.myPosition.vec3_sub(f,y).vec3_componentAlongAxis(C,y),y.vec3_add(_.vec3_scale(de,u),y),A.myIsCollidingHorizontally=!1,b.myCheckHeightConeOnCollisionKeepHit&&h.copy(A.myHorizontalCollisionHit),A.myHorizontalCollisionHit.reset(),this._horizontalPositionHorizontalCheck(f,i,y,C,M,j,G,b,A),A.myIsCollidingHorizontally)break;if(b.myCheckHeightConeOnCollisionKeepHit){A.myIsCollidingHorizontally=!0,A.myHorizontalCollisionHit.copy(h);break}}}}return!A.myIsCollidingHorizontally}}();PP.CollisionCheck.prototype._horizontalPositionHorizontalCheck=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create();return function(s,o,l,m,c,r,y,u,p){let d=!0;i=s.vec3_add(l,i);let _=Math.floor(o.length/2)+1;for(let h=0;h<_;h++){if(h>0){let P=Math.max(0,h*2),T=Math.max(0,h*2-1),v=o[P].vec_equals(o[T],1e-6);if(u.myCheckConeBorder)for(let f=0;f<2;f++){let g=f==0?P:T;t=o[g].vec3_add(l,t);let C=Math.max(0,g-2);if(n=o[C].vec3_add(l,n),d=this._horizontalCheckRaycast(n,t,c.vec3_negate(e),m,!0,r,y,s,!0,u,p),!d)break}if(u.myCheckConeRay&&d)for(let f=0;f<2&&!(f==1&&v);f++){let g=f==0?P:T;if(t=o[g].vec3_add(l,t),d=this._horizontalCheckRaycast(i,t,null,m,!1,r,y,s,!1,u,p),!d)break}}else if(u.myCheckConeRay&&(t=o[h].vec3_add(l,t),d=this._horizontalCheckRaycast(i,t,null,m,!1,r,y,s,!1,u,p),!d))break;if(!d)break}return d||(p.myIsCollidingHorizontally=!0,p.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),d}}();PP.CollisionCheck.prototype._horizontalPositionVerticalCheck=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create();return function(l,m,c,r,y,u,p,d,_,h){let P=!0;i=l.vec3_add(c,i),e=i.vec3_sub(r,e);for(let T=0;T<=m.length;T++){let v=!1;if(T==m.length?(t.vec3_copy(i),n.vec3_copy(e)):(t=m[T].vec3_add(c,t),n=t.vec3_sub(r,n),T>0&&(v=m[T].vec_equals(m[T-1],1e-6))),_.myCheckVerticalStraight&&!v&&(P=this._horizontalCheckRaycast(n,t,null,u,_.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,p,d,l,!0,_,h,!0,!0),!P&&(h.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(h.myHorizontalCollisionHit.myPosition,y)&&h.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(h.myIsCollidingHorizontally=!0,h.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!_.myCheckVerticalSearchFartherVerticalHit)))break;if(T<m.length){if((_.myCheckVerticalDiagonalRayOutward||_.myCheckVerticalDiagonalBorderRayOutward&&(T==m.length-2||T==m.length-1))&&!v&&(P=this._horizontalCheckRaycast(e,t,null,u,_.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,p,d,l,!0,_,h,!0,!0),!P&&(h.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(h.myHorizontalCollisionHit.myPosition,y)&&h.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(h.myIsCollidingHorizontally=!0,h.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!_.myCheckVerticalSearchFartherVerticalHit))||(_.myCheckVerticalDiagonalRayInward||_.myCheckVerticalDiagonalBorderRayInward&&(T==m.length-2||T==m.length-1))&&!v&&(P=this._horizontalCheckRaycast(n,i,null,u,_.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,p,d,l,!0,_,h,!0,!0),!P&&(h.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(h.myHorizontalCollisionHit.myPosition,y)&&h.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(h.myIsCollidingHorizontally=!0,h.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!_.myCheckVerticalSearchFartherVerticalHit)))break;if(T>0&&(_.myCheckVerticalDiagonalBorderOutward||_.myCheckVerticalDiagonalBorderInward)){let f=Math.max(0,T-2);if(a=m[f].vec3_add(c,a),s=a.vec3_sub(r,s),_.myCheckVerticalDiagonalBorderOutward&&(P=this._horizontalCheckRaycast(s,t,null,u,_.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,p,d,l,!0,_,h,!0,!0),!P&&(h.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(h.myHorizontalCollisionHit.myPosition,y)&&h.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(h.myIsCollidingHorizontally=!0,h.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!_.myCheckVerticalSearchFartherVerticalHit))||_.myCheckVerticalDiagonalBorderInward&&(P=this._horizontalCheckRaycast(n,a,null,u,_.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,p,d,l,!0,_,h,!0,!0),!P&&(h.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(h.myHorizontalCollisionHit.myPosition,y)&&h.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(h.myIsCollidingHorizontally=!0,h.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!_.myCheckVerticalSearchFartherVerticalHit)))break}}}return!h.myIsCollidingHorizontally}}();Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalPositionCheck",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalPositionHorizontalCheck",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_horizontalPositionVerticalCheck",{enumerable:!1})});var ba=S(()=>{PP.CollisionCheck.prototype._verticalCheck=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create();return t.vec3_zero(),function(a,s,o,l,m,c,r,y,u){y.myIsCollidingVertically=!1,y.myVerticalCollisionHit.reset();let p=Math.pp_sign(a.vec3_lengthSigned(m),-1),d=p<0;if(u.vec3_copy(a),r.myVerticalMovementCheckEnabled&&(u=this._verticalMovementAdjustment(a,d,s,o,l,m,c,r,y,u),r.myCheckVerticalBothDirection&&(u.vec_equals(a,1e-5)||s==0||p!=s))){i=o.vec3_add(u,i);let _=!d;e=this._verticalMovementAdjustment(t,_,s,i,l,m,c,r,y,e),u.vec3_add(e,u),d=!d}return r.myVerticalPositionCheckEnabled&&(i=o.vec3_add(u,i),this._verticalPositionCheck(i,d,l,m,c,r,y)||(u.vec3_zero(),y.myHasSnappedOnGround=!1,y.myHasSnappedOnCeiling=!1,y.myHasPoppedOutGround=!1,y.myHasPoppedOutCeiling=!1,y.myHasReducedVerticalMovement=!1)),u}}();PP.CollisionCheck.prototype._verticalMovementAdjustment=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create();return function(c,r,y,u,p,d,_,h,P,T){this._myDebugActive=h.myDebugActive&&h.myDebugVerticalMovementActive,i.vec3_zero(),e.vec3_zero();let v=!1,f=!1;if(r?(i.vec3_zero(),e.vec3_copy(c),h.myGroundPopOutExtraDistance>0&&h.myGroundPopOutEnabled&&(i.vec3_add(d.vec3_scale(h.myGroundPopOutExtraDistance+1e-5,t),i),v=!0)):(i=d.vec3_scale(p,i),e=d.vec3_scale(p,e).vec3_add(c,e),h.myCeilingPopOutExtraDistance>0&&h.myCeilingPopOutEnabled&&(i.vec3_add(d.vec3_scale(-h.myCeilingPopOutExtraDistance-1e-5,t),i),v=!0)),r&&y<=0&&this._myPrevCollisionRuntimeParams.myIsOnGround&&h.mySnapOnGroundEnabled&&h.mySnapOnGroundExtraDistance>0?(e.vec3_add(d.vec3_scale(-h.mySnapOnGroundExtraDistance-1e-5,t),e),f=!0):!r&&this._myPrevCollisionRuntimeParams.myIsOnCeiling&&h.mySnapOnCeilingEnabled&&h.mySnapOnCeilingExtraDistance>0&&(y>0||y==0&&(!this._myPrevCollisionRuntimeParams.myIsOnGround||!h.mySnapOnGroundEnabled))&&(e.vec3_add(d.vec3_scale(h.mySnapOnCeilingExtraDistance+1e-5,t),e),f=!0),T.vec3_zero(),i.vec3_distance(e)>1e-5){let g=this._getVerticalCheckPositions(u,d,_,h,P);n.vec3_copy(d),r||n.vec3_negate(n);let C=!1;for(let M=0;M<g.length;M++){let b=g[M];o=b.vec3_add(i,o),l=b.vec3_add(e,l).vec3_sub(o,l);let A=l.vec3_length();l.vec3_normalize(l);let I=this._raycastAndDebug(o,l,A,!0,!1,h,P);I.myHits.length>0&&(C?I.myHits[0].myPosition.vec3_isFartherAlongAxis(a,n)&&a.vec3_copy(I.myHits[0].myPosition):(C=!0,a.vec3_copy(I.myHits[0].myPosition)))}C?(s=d.vec3_negate(s),r?(T=a.vec3_sub(u,T).vec3_componentAlongAxis(d,T),f&&T.vec3_isFartherAlongAxis(c,s)?P.myHasSnappedOnGround=!0:v&&T.vec3_isFartherAlongAxis(c,d)&&!T.vec3_isZero(1e-5)&&(c.vec3_isZero(1e-5)||!T.vec3_isConcordant(c))?P.myHasPoppedOutGround=!0:P.myHasReducedVerticalMovement=!0):(T=a.vec3_sub(u.vec3_add(d.vec3_scale(p,T),T),T).vec3_componentAlongAxis(d,T),f&&T.vec3_isFartherAlongAxis(c,d)?P.myHasSnappedOnCeiling=!0:v&&T.vec3_isFartherAlongAxis(c,s)&&!T.vec3_isZero(1e-5)&&(c.vec3_isZero(1e-5)||!T.vec3_isConcordant(c))?P.myHasPoppedOutCeiling=!0:P.myHasReducedVerticalMovement=!0),!v&&!T.vec3_isConcordant(c)&&T.vec3_zero(),!h.myVerticalMovementReduceEnabled&&P.myHasReducedVerticalMovement&&(T.vec3_copy(c),P.myHasReducedVerticalMovement=!1)):T.vec3_copy(c)}else T.vec3_copy(c);return T.vec3_length()<1e-5&&T.vec3_zero(),T}}();PP.CollisionCheck.prototype._verticalPositionCheck=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create();return function(o,l,m,c,r,y,u){if(m<1e-5)return!0;this._myDebugActive=y.myDebugActive&&y.myDebugVerticalPositionActive;let p=this._getVerticalCheckPositions(o,c,r,y,u),d=!0,_=!1,h=1e-5;i=c.vec3_scale(h,i),e=c.vec3_scale(m-h,e),m-h<h*10&&(e=c.vec3_scale(h*10,e));let P=!1;for(let T=0;T<p.length;T++){let v=p[T];l?(t=v.vec3_add(i,t),n=v.vec3_add(e,n)):(t=v.vec3_add(e,t),n=v.vec3_add(i,n));let f=t;a=n.vec3_sub(f,a);let g=a.vec3_length();a.vec3_normalize(a);let C=this._raycastAndDebug(f,a,g,!1,!1,y,u);if(C.isColliding()){let M=C.getFirstHitOutsideCollision();if(M!=null){d=!1,u.myVerticalCollisionHit.copy(M);break}else if(!P&&(P=!0,u.myVerticalCollisionHit.copy(C.myHits[0]),!y.myVerticalAllowHitInsideCollisionIfOneOk)){d=!1;break}}else _=!0}return u.myIsCollidingVertically=!d||!_,!u.myIsCollidingVertically}}();PP.CollisionCheck.prototype._getVerticalCheckPositions=function(){let i=[],e=[],t=0,n=function(){let s=null;for(;e.length<=t;)e.push(PP.vec3_create());return s=e[t],t++,s},a=PP.vec3_create();return function(o,l,m,c,r){if(i.length=0,t=0,c.myGroundCircumferenceAddCenter){let d=n();d.vec3_copy(o),i.push(d)}let y=c.myFeetRadius/c.myGroundCircumferenceStepAmount,u=360/c.myGroundCircumferenceSliceAmount,p=0;for(let d=0;d<c.myGroundCircumferenceStepAmount;d++){let _=y*(d+1);a=m.vec3_rotateAxis(p,l,a);for(let h=0;h<c.myGroundCircumferenceSliceAmount;h++){let P=n(),T=a.vec3_rotateAxis(u*h,l,P);i.push(o.vec3_add(T.vec3_scale(_,T),T))}p+=c.myGroundCircumferenceRotationPerStep}return i}}();Object.defineProperty(PP.CollisionCheck.prototype,"_verticalCheck",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_verticalMovementAdjustment",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_verticalPositionCheck",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_getVerticalCheckPositions",{enumerable:!1})});var Ma=S(()=>{PP.CollisionCheck.prototype._updateSurfaceInfo=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.quat2_create(),a=PP.quat2_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(0,0,1),m=PP.vec3_create(1,0,0);return function(r,y,u){n.quat2_setPositionRotationQuat(y.myPositionOffsetLocal,y.myRotationOffsetLocalQuat),a=n.quat2_toWorld(r,a),r.vec_equals(a,1e-5)&&a.quat2_copy(r),i=a.quat2_getUp(i),e=a.quat2_getForward(e),t=a.quat2_getPosition(t);let p=y.myHeight;p=p-1e-5,p<1e-5&&(p=0),s.vec3_copy(e),o.vec3_copy(y.myCheckVerticalFixedForward),y.myCheckVerticalFixedForwardEnabled?(y.myCheckVerticalFixedForward.vec3_isOnAxis(i)&&(l.vec3_isOnAxis(i)?o.vec3_copy(m):o.vec3_copy(l)),o=o.vec3_removeComponentAlongAxis(i,o),o=o.vec3_normalize(o),o.vec_equals(y.myCheckVerticalFixedForward,1e-5)&&o.vec3_copy(y.myCheckVerticalFixedForward)):o.vec3_copy(e),y.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(t,p,i,s,o,!0,y,u),y.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(t,p,i,s,o,!1,y,u)}}();PP.CollisionCheck.prototype._postSurfaceCheck=function(){let i=PP.vec3_create();return function(t,n,a,s,o,l){let m=n.vec3_isZero(1e-5),c=Math.pp_sign(n.vec3_lengthSigned(a),-1)<0,r=t.vec3_isZero(1e-5);i=t.vec3_normalize(i);let y=this.computeSurfacePerceivedAngle(o.myGroundNormal,i,a,!0),u=this.computeSurfacePerceivedAngle(o.myCeilingNormal,i,a,!1),p=!0;s.myMustStayOnGround&&l.myIsOnGround&&!o.myIsOnGround&&(m||c)&&(p=!1);let d=!0;s.myMustStayOnCeiling&&l.myIsOnCeiling&&!o.myIsOnCeiling&&(m||c)&&(d=!1);let _=!0;if(s.myMustStayBelowGroundAngleDownhill!=null||s.myMustStayBelowIgnorableGroundAngleDownhill){let M=null;s.myMustStayBelowIgnorableGroundAngleDownhill?s.myMustStayBelowGroundAngleDownhill==null?M=s.myGroundAngleToIgnore:M=Math.min(s.myMustStayBelowGroundAngleDownhill,s.myGroundAngleToIgnore):M=s.myMustStayBelowGroundAngleDownhill,!r&&y<0&&l.myIsOnGround&&l.myGroundAngle<=M&&o.myIsOnGround&&o.myGroundAngle>M+1e-4&&(_=!1)}let h=!0;if(s.myMustStayBelowCeilingAngleDownhill!=null||s.myMustStayBelowIgnorableCeilingAngleDownhill){let M=null;s.myMustStayBelowIgnorableCeilingAngleDownhill?s.myMustStayBelowCeilingAngleDownhill==null?M=s.myCeilingAngleToIgnore:M=Math.min(s.myMustStayBelowCeilingAngleDownhill,s.myCeilingAngleToIgnore):M=s.myMustStayBelowCeilingAngleDownhill,!r&&y<0&&l.myIsOnCeiling&&l.myCeilingAngle<=M&&o.myIsOnCeiling&&o.myCeilingAngle>M+1e-4&&(h=!1)}let P=!0;s.myMovementMustStayOnGroundHitAngle!=null&&!r&&l.myIsOnGround&&l.myGroundHitMaxAngle<=s.myMovementMustStayOnGroundHitAngle&&o.myIsOnGround&&o.myGroundHitMaxAngle>s.myMovementMustStayOnGroundHitAngle+1e-4&&(P=!1);let T=!0;s.myMovementMustStayOnCeilingHitAngle!=null&&!r&&l.myIsOnCeiling&&l.myCeilingHitMaxAngle<=s.myMovementMustStayOnCeilingHitAngle&&o.myIsOnCeiling&&o.myCeilingHitMaxAngle>s.myMovementMustStayOnCeilingHitAngle+1e-4&&(T=!1);let v=!0,f=!0;o.myIsOnGround&&o.myGroundAngle>s.myGroundAngleToIgnore+1e-4&&l.myIsOnGround&&!r&&(y>0?(v=!1,s.myGroundAngleToIgnoreWithPerceivedAngle!=null&&o.myGroundAngle<=s.myGroundAngleToIgnoreWithPerceivedAngle+1e-4&&(v=Math.abs(y)<=s.myGroundAngleToIgnore+1e-4)):y<0&&l.myGroundAngle<=s.myGroundAngleToIgnore+1e-4&&s.myMustStayOnValidGroundAngleDownhill&&(f=!1));let g=!0,C=!0;return o.myIsOnCeiling&&o.myCeilingAngle>s.myCeilingAngleToIgnore+1e-4&&l.myIsOnCeiling&&!r&&(u>0?(g=!1,s.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&o.myCeilingAngle<=s.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4&&(g=Math.abs(u)<=s.myCeilingAngleToIgnore+1e-4)):u<0&&l.myCeilingAngle<=s.myCeilingAngleToIgnore+1e-4&&s.myMustStayOnValidCeilingAngleDownhill&&(C=!1)),p&&d&&_&&h&&P&&T&&v&&f&&g&&C}}();PP.CollisionCheck.prototype._surfaceTooSteep=function(){let i=[!1,!1];return function(t,n,a,s){let o=!1,l=!1;if(s.myIsOnGround&&s.myGroundAngle>a.myGroundAngleToIgnore+1e-4){let m=this.computeSurfacePerceivedAngle(s.myGroundNormal,n,t,!0);o=m>0,o&&a.myGroundAngleToIgnoreWithPerceivedAngle!=null&&s.myGroundAngle<=a.myGroundAngleToIgnoreWithPerceivedAngle+1e-4&&(o=Math.abs(m)>a.myGroundAngleToIgnore+1e-4)}if(!o&&s.myIsOnCeiling&&s.myCeilingAngle>a.myCeilingAngleToIgnore+1e-4){let m=this.computeSurfacePerceivedAngle(s.myCeilingNormal,n,t,!1);l=m>0,l&&a.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&s.myCeilingAngle<=a.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4&&(l=Math.abs(m)>a.myCeilingAngleToIgnore+1e-4)}return i[0]=o,i[1]=l,i}}();PP.CollisionCheck.prototype._adjustVerticalMovementWithSurface=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a,s,o,l,m,c){if(c.vec3_copy(a),n.vec3_isZero(1e-5))return c;let r=0;if(i=n.vec3_normalize(i),m.myIsOnGround){let y=this.computeSurfacePerceivedAngle(m.myGroundNormal,i,s,!0),u=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(y)));u*=Math.pp_sign(y),Math.abs(u)>1e-5&&(y>0?o.myAdjustVerticalMovementWithGroundAngleUphill&&(o.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle==null||Math.abs(y)<=o.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle)&&(o.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle==null||m.myGroundAngle<=o.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle)&&(r=u,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=!0):y<0&&o.myAdjustVerticalMovementWithGroundAngleDownhill&&(o.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle==null||Math.abs(y)<=o.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle)&&(o.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle==null||m.myGroundAngle<=o.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle)&&(r=u,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=!0))}if(m.myIsOnCeiling){let y=this.computeSurfacePerceivedAngle(m.myCeilingNormal,i,s,!1),u=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(y)));if(u*=Math.pp_sign(y),Math.abs(u)>1e-5){let p=Math.pp_sign(r)==Math.pp_sign(u);(r==0||p&&Math.abs(u)>Math.abs(r))&&(y>0?o.myAdjustVerticalMovementWithCeilingAngleUphill&&(o.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle==null||Math.abs(y)<=o.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle)&&(o.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle==null||m.myCeilingAngle<=o.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle)&&(r=u,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=!0,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=!1):y<0&&o.myAdjustVerticalMovementWithCeilingAngleDownhill&&(o.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle==null||Math.abs(y)<=o.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle)&&(o.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle==null||m.myCeilingAngle<=o.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle)&&(r=u,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=!0,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=!1))}}if(Math.abs(r)>1e-5){let y=a.vec3_lengthSigned(s),u=Math.pp_sign(r)==Math.pp_sign(y);e=s.vec3_scale(r,e),a.vec3_isZero(1e-5)?c.vec3_copy(e):u||!u&&(l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill||l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill)?c=a.vec3_add(e,c):(l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=!1)}return c.vec3_isZero(1e-6)&&c.vec3_zero(),c}}();PP.CollisionCheck.prototype._adjustHorizontalMovementWithSurface=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create();return function(l,m,c,r,y,u,p){if(p.vec3_copy(l),m.vec3_isZero(1e-5))return p;let d=!m.vec3_isConcordant(c);if(i.vec3_zero(),e.vec3_zero(),u.myIsOnGround&&(e=u.myGroundNormal.vec3_removeComponentAlongAxis(c,e),!e.vec3_isZero(1e-5))){e.vec3_normalize(e);let _=m.vec3_length()/Math.tan(Math.pp_toRadians(u.myGroundAngle));_*=d?1:-1,Math.abs(_)>1e-5&&d&&r.myAdjustHorizontalMovementWithGroundAngleDownhill&&(r.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle==null||u.myGroundAngle>=r.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle)&&(i=e.vec3_scale(_,i),y.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=!0)}if(u.myIsOnCeiling&&(t=u.myCeilingNormal.vec3_removeComponentAlongAxis(c,t),!t.vec3_isZero(1e-5))){t.vec3_normalize(t);let _=m.vec3_length()/Math.tan(Math.pp_toRadians(u.myCeilingAngle));if(_*=d?-1:1,Math.abs(_)>1e-5){let h=t.vec3_isConcordant(e);(i.vec3_isZero()||h)&&(d||r.myAdjustHorizontalMovementWithCeilingAngleDownhill&&(r.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle==null||u.myCeilingAngle>=r.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle)&&(n=t.vec3_scale(_,n),e.vec3_isZero()?(i.vec3_copy(n),y.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=!0):(s=n.vec3_removeComponentAlongAxis(s),a=n.vec3_componentAlongAxis(s),a.vec3_isFartherAlongAxis(i,e)?(y.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=!1,i.vec3_copy(n),y.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=!0):s.vec3_isZero(1e-5)||(i=i.vec3_add(s,i),y.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=!0))))}}return i.vec3_isZero()||(l.vec3_isZero(1e-5)?p.vec3_copy(i):(i.vec3_isConcordant(l),p=l.vec3_add(i,p))),p.vec3_isZero(1e-6)&&p.vec3_zero(),p}}();PP.CollisionCheck.prototype._computeExtraSurfaceVerticalMovement=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a,s,o,l){if(l.vec3_zero(),!n.vec3_isZero()){if(o.myIsOnGround&&o.myGroundAngle!=0){i=n.vec3_normalize(i);let m=this.computeSurfacePerceivedAngle(o.myGroundNormal,i,a,!0),c=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(m)));c*=Math.pp_sign(m),Math.abs(c)>1e-5&&(s.mySnapOnGroundEnabled||c>0)&&l.vec3_add(a.vec3_scale(c,e),l)}else if(o.myIsOnCeiling&&o.myCeilingAngle!=0){i=n.vec3_normalize(i);let m=this.computeSurfacePerceivedAngle(o.myCeilingNormal,i,a,!1),c=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(m)));c*=Math.pp_sign(m),c*=-1,Math.abs(c)>1e-5&&(s.mySnapOnCeilingEnabled||c<0)&&l.vec3_add(a.vec3_scale(c,e),l)}}return l}}();PP.CollisionCheck.prototype._gatherSurfaceInfo=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=PP.vec3_create();return function(d,_,h,P,T,v,f,g){this._myDebugActive=f.myDebugActive&&(v&&f.myDebugGroundInfoActive||!v&&f.myDebugCeilingInfoActive);let C=this._getVerticalCheckPositions(d,h,T,f,g);i.vec3_copy(h);let M=f.myDistanceToBeOnGround,b=f.myDistanceToComputeGroundInfo,A=f.myFindGroundDistanceMaxOutsideDistance,I=f.myVerticalFixToBeOnGround,V=f.myVerticalFixToComputeGroundInfo,D=f.myFindGroundDistanceMaxInsideDistance,B=f.myIsOnGroundIfInsideHit,L=f.myGroundIsBaseInsideCollisionCheckEnabled;v||(i.vec3_negate(i),M=f.myDistanceToBeOnCeiling,b=f.myDistanceToComputeCeilingInfo,A=f.myFindCeilingDistanceMaxOutsideDistance,I=f.myVerticalFixToBeOnCeiling,V=f.myVerticalFixToComputeCeilingInfo,D=f.myFindCeilingDistanceMaxInsideDistance,B=f.myIsOnCeilingIfInsideHit,L=f.myCeilingIsBaseInsideCollisionCheckEnabled),e=i.vec3_scale(Math.max(I,V,D,1e-5),e),t=i.vec3_negate(t).vec3_scale(Math.max(M,b,A,1e-5),t),n.vec3_zero(),v||(n=h.vec3_scale(_,n)),a=i.vec3_scale(1e-4,a);let w=!1,E=0,j=0;l.vec3_zero();let G=0;m.vec3_zero();let X=null,N=C.length>0;for(let de=0;de<C.length;de++){let ue=C[de];ue.vec3_add(n,ue);let Ze=!1;if(L){s=ue.vec3_add(a,s),o=ue.vec3_sub(a,o);let Ce=s;u=o.vec3_sub(Ce,u);let Ye=u.vec3_length();u.vec3_normalize(u);let _e=this._raycastAndDebug(Ce,u,Ye,!1,!1,f,g);_e.isColliding()&&(Ze=_e.myHits[0].myIsInsideCollision)}if(N&&=Ze,Ze)B&&(w=!0);else{r=ue.vec3_add(e,r),y=ue.vec3_add(t,y);let Ce=r;u=y.vec3_sub(Ce,u);let Ye=u.vec3_length();u.vec3_normalize(u);let _e=this._raycastAndDebug(Ce,u,Ye,!0,!1,f,g);if(_e.isColliding()){c=_e.myHits[0].myPosition.vec3_sub(ue,c);let K=c.vec3_lengthSigned(i);if((K>=0&&K<=I+1e-5||K<0&&Math.abs(K)<=M+1e-5)&&(w=!0),K>=0&&K<=V+1e-5||K<0&&Math.abs(K)<=b+1e-5){let $e=_e.myHits[0].myNormal;l.vec3_add($e,l);let wt=$e.vec3_angle(i);wt>G&&(G=wt,m.vec3_copy($e))}(K>=0&&K<=D+1e-5||K<0&&Math.abs(K)<=A+1e-5)&&(X==null||Math.abs(K)<Math.abs(X))&&(X=-K)}}}l.vec3_isZero()||(l.vec3_normalize(l),E=l.vec3_angle(i),E<=1e-4?(E=0,l.vec3_copy(i)):E>=180-1e-4&&(E=180,l=i.vec3_negate(l)),j=this.computeSurfacePerceivedAngle(l,P,h,v)),v?(g.myRealIsOnGround=w,g.myGroundAngle=E,g.myGroundPerceivedAngle=j,g.myGroundNormal.vec3_copy(l),g.myGroundHitMaxAngle=G,g.myGroundHitMaxNormal.vec3_copy(m),g.myGroundDistance=X,g.myGroundIsBaseInsideCollision=N,w&&(f.myIsOnGroundMaxSurfaceAngle==null||g.myGroundAngle<=f.myIsOnGroundMaxSurfaceAngle)&&(g.myIsOnGround=w)):(g.myRealIsOnCeiling=w,g.myCeilingAngle=E,g.myCeilingPerceivedAngle=j,g.myCeilingNormal.vec3_copy(l),g.myCeilingHitMaxAngle=G,g.myCeilingHitMaxNormal.vec3_copy(m),g.myCeilingDistance=X,g.myCeilingIsBaseInsideCollision=N,w&&(f.myIsOnCeilingMaxSurfaceAngle==null||g.myCeilingAngle<=f.myIsOnCeilingMaxSurfaceAngle)&&(g.myIsOnCeiling=w))}}();PP.CollisionCheck.prototype.computeSurfacePerceivedAngle=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a,s,o=!0){let l=0;e.vec3_copy(s),o||e.vec3_negate(e);let m=n.vec3_angle(e);m<=Math.PP_EPSILON_DEGREES?m=0:m>=180-Math.PP_EPSILON_DEGREES&&(m=180),i=a.vec3_projectOnPlaneAlongAxis(n,s,i),l=i.vec3_angle(a);let c=i.vec3_isFartherAlongAxis(a,s);return(!c&&o||c&&!o)&&(l*=-1),Math.abs(l)>=m&&(m!=0&&m!=180?l=m*Math.pp_sign(l):l=m),l}}();Object.defineProperty(PP.CollisionCheck.prototype,"_surfaceTooSteep",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_computeExtraSurfaceVerticalMovement",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_gatherSurfaceInfo",{enumerable:!1});Object.defineProperty(PP.CollisionCheck.prototype,"_updateSurfaceInfo",{enumerable:!1})});var Aa=S(()=>{PP.CollisionCheckBridge={_myCollisionCheck:new PP.CollisionCheck,checkMovement:function(){let i=new PP.CollisionCheckParams,e=new PP.CollisionRuntimeParams;return function(n,a,s,o,l=new PP.CharacterCollisionResults){this.convertCharacterColliderSetupToCollisionCheckParams(s,i),this.convertCharacterCollisionResultsToCollisionRuntimeParams(o,e),this._myCollisionCheck.move(n,a,i,e),this.convertCollisionRuntimeParamsToCharacterCollisionResults(e,a,l)}}(),checkTeleportToTransform:function(){let i=PP.vec3_create(),e=new PP.CollisionCheckParams,t=new PP.CollisionRuntimeParams;return function(a,s,o,l,m=new PP.CharacterCollisionResults){this.convertCharacterColliderSetupToCollisionCheckParams(o,e),this.convertCharacterCollisionResultsToCollisionRuntimeParams(l,t),i=a.quat2_getPosition(i),this._myCollisionCheck.teleport(i,a,e,t),this.convertCollisionRuntimeParamsToCharacterCollisionResults(t,s,m)}}(),checkTransform:function(){let i=new PP.CollisionCheckParams,e=new PP.CollisionRuntimeParams;return function(n,a,s,o=new PP.CharacterCollisionResults){this.convertCharacterColliderSetupToCollisionCheckParams(a,i),this.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),this._myCollisionCheck.positionCheck(!0,n,i,e),this.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,o)}}(),updateGroundInfo:function(){let i=new PP.CollisionCheckParams,e=new PP.CollisionRuntimeParams;return function(n,a,s,o=new PP.CharacterCollisionResults){this.convertCharacterColliderSetupToCollisionCheckParams(a,i),this.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),i.myComputeCeilingInfoEnabled=!1,this._myCollisionCheck.updateSurfaceInfo(n,i,e),this.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,o)}}(),updateCeilingInfo:function(){let i=new PP.CollisionCheckParams,e=new PP.CollisionRuntimeParams;return function(n,a,s,o=new PP.CharacterCollisionResults){this.convertCharacterColliderSetupToCollisionCheckParams(a,i),this.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),i.myComputeGroundInfoEnabled=!1,this._myCollisionCheck.updateSurfaceInfo(n,i,e),this.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,o)}}(),convertCharacterCollisionResultsToCollisionRuntimeParams:function(i,e){return e.reset(),i.myTransformResults.myStartTransformQuat.quat2_getPosition(e.myOriginalPosition),i.myTransformResults.myEndTransformQuat.quat2_getPosition(e.myNewPosition),i.myTransformResults.myStartTransformQuat.quat2_getForward(e.myOriginalForward),i.myTransformResults.myStartTransformQuat.quat2_getUp(e.myOriginalUp),e.myOriginalMovement.vec3_copy(i.myMovementResults.myStartMovement),e.myFixedMovement.vec3_copy(i.myMovementResults.myEndMovement),e.myLastValidOriginalHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantStartHorizontalMovement),e.myLastValidOriginalVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantStartVerticalMovement),e.myLastValidEndHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantEndHorizontalMovement),e.myLastValidEndVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantEndVerticalMovement),e.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantAdjustedStartHorizontalMovement),e.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantAdjustedStartVerticalMovement),e.myIsOnGround=i.myGroundInfo.myIsOnSurface,e.myGroundAngle=i.myGroundInfo.mySurfaceAngle,e.myGroundPerceivedAngle=i.myGroundInfo.mySurfacePerceivedAngle,e.myGroundNormal.vec3_copy(i.myGroundInfo.mySurfaceNormal),e.myGroundHitMaxAngle=i.myGroundInfo.mySurfaceHitMaxAngle,e.myGroundHitMaxNormal.vec3_copy(i.myGroundInfo.mySurfaceHitMaxNormal),e.myGroundDistance=i.myGroundInfo.mySurfaceDistance,e.myGroundIsBaseInsideCollision=i.myGroundInfo.myIsBaseInsideCollision,e.myIsOnCeiling=i.myCeilingInfo.myIsOnSurface,e.myCeilingAngle=i.myCeilingInfo.mySurfaceAngle,e.myCeilingPerceivedAngle=i.myCeilingInfo.mySurfacePerceivedAngle,e.myCeilingNormal.vec3_copy(i.myCeilingInfo.mySurfaceNormal),e.myCeilingHitMaxAngle=i.myCeilingInfo.mySurfaceHitMaxAngle,e.myCeilingHitMaxNormal.vec3_copy(i.myCeilingInfo.mySurfaceHitMaxNormal),e.myCeilingDistance=i.myCeilingInfo.mySurfaceDistance,e.myCeilingIsBaseInsideCollision=i.myCeilingInfo.myIsBaseInsideCollision,e.myHorizontalMovementCanceled=i.myHorizontalMovementResults.myMovementFailed,e.myIsCollidingHorizontally=i.myHorizontalMovementResults.myIsColliding,e.myHorizontalCollisionHit.copy(i.myHorizontalMovementResults.myReferenceCollisionHit),e.myVerticalMovementCanceled=i.myVerticalMovementResults.myMovementFailed,e.myIsCollidingVertically=i.myVerticalMovementResults.myIsColliding,e.myVerticalCollisionHit.copy(i.myVerticalMovementResults.myReferenceCollisionHit),e.myHasSnappedOnGround=i.myGroundResults.myHasSnappedOnSurface,e.myHasSnappedOnCeiling=i.myCeilingResults.myHasSnappedOnSurface,e.myHasPoppedOutGround=i.myGroundResults.myHasPoppedOutSurface,e.myHasPoppedOutCeiling=i.myCeilingResults.myHasPoppedOutSurface,e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=i.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=i.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill,e.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=i.myGroundResults.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=i.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=i.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill,e.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=i.myCeilingResults.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill,e.myIsSliding=i.myWallSlideResults.myHasSlid,e.mySlidingMovementAngle=i.myWallSlideResults.mySlideMovementAngle,e.mySlidingCollisionAngle=i.myWallSlideResults.mySlideMovementWallAngle,e.mySlidingWallNormal.vec3_copy(i.myWallSlideResults.myWallNormal),e.myIsSlidingIntoOppositeDirection=i.myInternalResults.myHasWallSlidTowardOppositeDirection,e.myIsSlidingFlickerPrevented=i.myInternalResults.myLastRelevantWallSlideFlickerPrevented,e.mySlidingFlickerPreventionCheckAnywayCounter=i.myInternalResults.myWallSlideFlickerPreventionForceCheckCounter,e.mySliding90DegreesSign=i.myInternalResults.myWallSlide90DegreesDirectionSign,e.mySlidingRecompute90DegreesSign=i.myInternalResults.myWallSlide90DegreesRecomputeDirectionSign,e.myLastValidIsSliding=i.myInternalResults.myLastRelevantHasWallSlid,e.mySlidingPreviousHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantEndHorizontalMovement),e.myOriginalTeleportPosition.vec3_copy(i.myTeleportResults.myStartTeleportTransformQuat),e.myFixedTeleportPosition.vec3_copy(i.myTeleportResults.myEndTeleportTransformQuat),e.myTeleportCanceled=i.myTeleportResults.myTeleportFailed,e.myIsPositionOk=i.myCheckTransformResults.myCheckTransformFailed,i.myCheckTransformResults.myStartCheckTransformQuat.quat2_getPosition(e.myOriginalPositionCheckPosition),i.myCheckTransformResults.myEndCheckTransformQuat.quat2_getPosition(e.myFixedPositionCheckPosition),e.myIsTeleport=i.myCheckType==PP.CharacterCollisionCheckType.CHECK_TELEPORT,e.myIsMove=i.myCheckType==PP.CharacterCollisionCheckType.CHECK_MOVEMENT,e.myIsPositionCheck=i.myCheckType==PP.CharacterCollisionCheckType.CHECK_TRANSFORM,e.mySplitMovementSteps=i.mySplitMovementResults.myStepsToPerform,e.mySplitMovementStepsPerformed=i.mySplitMovementResults.myStepsPerformed,e.mySplitMovementStop=i.mySplitMovementResults.myMovementInterrupted,e.mySplitMovementMovementChecked.vec3_copy(i.mySplitMovementResults.myMovementChecked),e},convertCollisionRuntimeParamsToCharacterCollisionResults:function(){let i=PP.quat_create();return function(t,n,a){return a.reset(),t.myIsMove?a.myCheckType=PP.CharacterCollisionCheckType.CHECK_MOVEMENT:t.myIsTeleport?a.myCheckType=PP.CharacterCollisionCheckType.CHECK_TELEPORT:t.myIsPositionCheck&&(a.myCheckType=PP.CharacterCollisionCheckType.CHECK_TRANSFORM),i.quat_setForward(t.myOriginalForward,t.myOriginalUp),a.myTransformResults.myStartTransformQuat.quat2_setPositionRotationQuat(t.myOriginalPosition,i),a.myTransformResults.myEndTransformQuat.quat2_setPositionRotationQuat(t.myNewPosition,i),a.myMovementResults.myStartMovement.vec3_copy(t.myOriginalMovement),a.myMovementResults.myEndMovement.vec3_copy(t.myFixedMovement),a.myMovementResults.myMovementFailed=t.myHorizontalMovementCanceled&&t.myVerticalMovementCanceled,a.myMovementResults.myIsColliding=t.myIsCollidingHorizontally||t.myIsCollidingVertically,t.myIsCollidingHorizontally?a.myMovementResults.myReferenceCollisionHit.copy(t.myHorizontalCollisionHit):t.myIsCollidingVertically&&a.myMovementResults.myReferenceCollisionHit.copy(t.myVerticalCollisionHit),a.myHorizontalMovementResults.myMovementFailed=t.myHorizontalMovementCanceled,a.myHorizontalMovementResults.myIsColliding=t.myIsCollidingHorizontally,a.myHorizontalMovementResults.myReferenceCollisionHit.copy(t.myHorizontalCollisionHit),a.myVerticalMovementResults.myMovementFailed=t.myVerticalMovementCanceled,a.myVerticalMovementResults.myIsColliding=t.myIsCollidingVertically,a.myVerticalMovementResults.myReferenceCollisionHit.copy(t.myVerticalCollisionHit),a.myTeleportResults.myStartTeleportTransformQuat.quat2_copy(a.myTransformResults.myStartTransformQuat),a.myTeleportResults.myStartTeleportTransformQuat.quat2_setPosition(t.myOriginalTeleportPosition),a.myTeleportResults.myEndTeleportTransformQuat.quat2_copy(a.myTransformResults.myEndTransformQuat),a.myTeleportResults.myEndTeleportTransformQuat.quat2_setPosition(t.myFixedTeleportPosition),a.myTeleportResults.myTeleportFailed=t.myTeleportCanceled,a.myCheckTransformResults.myStartCheckTransformQuat.quat2_copy(a.myTransformResults.myStartTransformQuat),a.myCheckTransformResults.myStartCheckTransformQuat.quat2_setPosition(t.myOriginalPositionCheckPosition),a.myCheckTransformResults.myEndCheckTransformQuat.quat2_copy(a.myTransformResults.myEndTransformQuat),a.myCheckTransformResults.myEndCheckTransformQuat.quat2_setPosition(t.myFixedPositionCheckPosition),a.myCheckTransformResults.myCheckTransformFailed=!t.myIsPositionOk,a.myWallSlideResults.myHasSlid=t.myIsSliding,a.myWallSlideResults.mySlideMovementAngle=t.mySlidingMovementAngle,a.myWallSlideResults.mySlideMovementWallAngle=t.mySlidingCollisionAngle,a.myWallSlideResults.myWallNormal.vec3_copy(ollisionRuntimeParams.mySlidingWallNormal),a.myGroundInfo.myIsOnSurface=t.myIsOnGround,a.myGroundInfo.mySurfaceAngle=t.myGroundAngle,a.myGroundInfo.mySurfacePerceivedAngle=t.myGroundPerceivedAngle,a.myGroundInfo.mySurfaceNormal.vec3_copy(t.myGroundNormal),a.myGroundInfo.mySurfaceHitMaxAngle=t.myGroundHitMaxAngle,a.myGroundInfo.mySurfaceHitMaxNormal.vec3_copy(t.myGroundHitMaxNormal),a.myGroundInfo.mySurfaceDistance=t.myGroundDistance,a.myGroundInfo.myIsBaseInsideCollision=t.myGroundIsBaseInsideCollision,a.myCeilingInfo.myIsOnSurface=t.myIsOnCeiling,a.myCeilingInfo.mySurfaceAngle=t.myCeilingAngle,a.myCeilingInfo.mySurfacePerceivedAngle=t.myCeilingPerceivedAngle,a.myCeilingInfo.mySurfaceNormal.vec3_copy(t.myCeilingNormal),a.myCeilingInfo.mySurfaceHitMaxAngle=t.myCeilingHitMaxAngle,a.myCeilingInfo.mySurfaceHitMaxNormal.vec3_copy(t.myCeilingHitMaxNormal),a.myCeilingInfo.mySurfaceDistance=t.myCeilingDistance,a.myCeilingInfo.myIsBaseInsideCollision=t.myCeilingIsBaseInsideCollision,a.myGroundResults.myHasSnappedOnSurface=t.myHasSnappedOnGround,a.myGroundResults.myHasPoppedOutSurface=t.myHasPoppedOutGround,a.myCeilingResults.myHasSnappedOnSurface=t.myHasSnappedOnCeiling,a.myCeilingResults.myHasPoppedOutSurface=t.myHasPoppedOutCeiling,a.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill=t.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill,a.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill=t.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill,a.myGroundResults.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill=t.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill,a.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill=t.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill,a.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill=t.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill,a.myCeilingResults.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill=t.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill,a.mySplitMovementResults.myStepsToPerform=t.mySplitMovementSteps,a.mySplitMovementResults.myStepsPerformed=t.mySplitMovementStepsPerformed,a.mySplitMovementResults.myMovementInterrupted=t.mySplitMovementStop,a.mySplitMovementResults.myMovementChecked.vec3_copy(t.mySplitMovementMovementChecked),a.myInternalResults.myLastRelevantStartHorizontalMovement.vec3_copy(t.myLastValidOriginalHorizontalMovement),a.myInternalResults.myLastRelevantEndHorizontalMovement.vec3_copy(t.myLastValidEndHorizontalMovement),a.myInternalResults.myLastRelevantStartVerticalMovement.vec3_copy(t.myLastValidOriginalVerticalMovement),a.myInternalResults.myLastRelevantEndVerticalMovement.vec3_copy(t.myLastValidEndVerticalMovement),a.myInternalResults.myLastRelevantAdjustedStartHorizontalMovement.vec3_copy(t.myLastValidSurfaceAdjustedHorizontalMovement),a.myInternalResults.myLastRelevantAdjustedStartVerticalMovement.vec3_copy(t.myLastValidSurfaceAdjustedVerticalMovement),a.myInternalResults.myLastRelevantHasWallSlid=t.myLastValidIsSliding,a.myInternalResults.myHasWallSlidTowardOppositeDirection=t.myIsSlidingIntoOppositeDirection,a.myInternalResults.myLastRelevantWallSlideFlickerPrevented=t.myIsSlidingFlickerPrevented,a.myInternalResults.myWallSlideFlickerPreventionForceCheckCounter=t.mySlidingFlickerPreventionCheckAnywayCounter,a.myInternalResults.myWallSlide90DegreesDirectionSign=t.mySliding90DegreesSign,a.myInternalResults.myWallSlide90DegreesRecomputeDirectionSign=t.mySlidingRecompute90DegreesSign,a.myTransformResults.myStartTransformQuat.quat2_copy(n),a}}(),convertCharacterColliderSetupToCollisionCheckParams:function(){return function(e,t){return t.myHeight=e.myHeight,t.myRadius=e.myHorizontalCheckSetup.myHorizontalCheckConeRadius,t.myDistanceFromFeetToIgnore=e.myHorizontalCheckSetup.myHorizontalCheckFeetDistanceToIgnore,t.myDistanceFromHeadToIgnore=e.myHorizontalCheckSetup.myHorizontalCheckHeadDistanceToIgnore,t.myHorizontalMovementCheckEnabled=e.myHorizontalCheckSetup.myHorizontalMovementCheckEnabled,t.myHorizontalMovementStepEnabled=e.myHorizontalCheckSetup.myHorizontalMovementCheckSplitMovementEnabled,t.myHorizontalMovementStepMaxLength=e.myHorizontalCheckSetup.myHorizontalMovementCheckSplitMovementMaxStepLength,t.myHorizontalMovementRadialStepAmount=e.myHorizontalCheckSetup.myHorizontalMovementCheckRadialSteps,t.myHorizontalMovementCheckDiagonalOutward=e.myHorizontalCheckSetup.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled,t.myHorizontalMovementCheckDiagonalInward=e.myHorizontalCheckSetup.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled,t.myHorizontalMovementCheckStraight=e.myHorizontalCheckSetup.myHorizontalMovementHorizontalStraightCheckEnabled,t.myHorizontalMovementCheckHorizontalBorder=e.myHorizontalCheckSetup.myHorizontalMovementHorizontalRadialCheckEnabled,t.myHorizontalMovementCheckVerticalStraight=e.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=e.myHorizontalCheckSetup.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalUpwardInward=e.myHorizontalCheckSetup.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=e.myHorizontalCheckSetup.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalDownwardInward=e.myHorizontalCheckSetup.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalStraightDiagonalUpward=e.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalStraightDiagonalDownward=e.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=e.myHorizontalCheckSetup.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled,t.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=e.myHorizontalCheckSetup.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled,t.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalCheckSetup.myHorizontalMovementHorizontalStraightCentralCheckEnabled,t.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightCentralCheckEnabled,t.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,t.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,t.myHorizontalPositionCheckEnabled=e.myHorizontalCheckSetup.myHorizontalPositionCheckEnabled,t.myHalfConeAngle=e.myHorizontalCheckSetup.myHorizontalCheckConeHalfAngle,t.myHalfConeSliceAmount=e.myHorizontalCheckSetup.myHorizontalPositionCheckConeHalfSlices,t.myCheckConeBorder=e.myHorizontalCheckSetup.myHorizontalPositionHorizontalBorderCheckEnabled,t.myCheckConeRay=e.myHorizontalCheckSetup.myHorizontalPositionHorizontalRadialCheckEnabled,t.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=e.myHorizontalCheckSetup.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision,t.myHorizontalPositionCheckVerticalDirectionType=e.myHorizontalCheckSetup.myHorizontalPositionVerticalCheckDirection,t.myCheckHeight=e.myHorizontalCheckSetup.myHorizontalHeightCheckEnabled,t.myCheckHeightVerticalMovement=e.myHorizontalCheckSetup.myHorizontalMovementHeightVerticalCheckEnabled,t.myCheckHeightVerticalPosition=e.myHorizontalCheckSetup.myHorizontalPositionHeightVerticalCheckEnabled,t.myCheckHeightTopMovement=e.myHorizontalCheckSetup.myHorizontalMovementHeightHorizontalCheckEnabled,t.myCheckHeightTopPosition=e.myHorizontalCheckSetup.myHorizontalPositionHeightHorizontalCheckEnabled,t.myCheckHeightConeOnCollision=e.myHorizontalCheckSetup.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit,t.myCheckHeightConeOnCollisionKeepHit=e.myHorizontalCheckSetup.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit,t.myHeightCheckStepAmountMovement=e.myHorizontalCheckSetup.myHorizontalMovementHeightCheckSteps,t.myHeightCheckStepAmountPosition=e.myHorizontalCheckSetup.myHorizontalPositionHeightCheckSteps,t.myCheckVerticalStraight=e.myHorizontalCheckSetup.myHorizontalPositionVerticalStraightCheckEnabled,t.myCheckVerticalDiagonalRayOutward=e.myHorizontalCheckSetup.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalRayInward=e.myHorizontalCheckSetup.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled,t.myCheckVerticalDiagonalBorderOutward=e.myHorizontalCheckSetup.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalBorderInward=e.myHorizontalCheckSetup.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled,t.myCheckVerticalDiagonalBorderRayOutward=e.myHorizontalCheckSetup.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalBorderRayInward=e.myHorizontalCheckSetup.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled,t.myCheckVerticalSearchFartherVerticalHit=e.myHorizontalCheckSetup.myHorizontalPositionVerticalCheckGetFarthestHit,t.myCheckHorizontalFixedForwardEnabled=e.myHorizontalCheckSetup.myHorizontalCheckFixedForwardEnabled,t.myCheckHorizontalFixedForward.vec3_copy(e.myHorizontalCheckSetup.myHorizontalCheckFixedForward),t.myVerticalMovementCheckEnabled=e.myVerticalCheckSetup.myVerticalMovementCheckEnabled,t.myVerticalPositionCheckEnabled=e.myVerticalCheckSetup.myVerticalPositionCheckEnabled,t.myFeetRadius=e.myVerticalCheckSetup.myVerticalCheckCircumferenceRadius,t.myAdjustVerticalMovementWithGroundAngleDownhill=e.myGroundSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhill,t.myAdjustVerticalMovementWithGroundAngleUphill=e.myGroundSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphill,t.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=e.myGroundSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfaceAngle,t.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=e.myGroundSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfaceAngle,t.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=e.myGroundSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,t.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=e.myGroundSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,t.myAdjustHorizontalMovementWithGroundAngleDownhill=e.myGroundSetup.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhill,t.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=e.myGroundSetup.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhillMinSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleDownhill=e.myCeilingSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhill,t.myAdjustVerticalMovementWithCeilingAngleUphill=e.myCeilingSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphill,t.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myCeilingSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myCeilingSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle=e.myCeilingSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,t.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle=e.myCeilingSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,t.myAdjustHorizontalMovementWithCeilingAngleDownhill=e.myCeilingSetup.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhill,t.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=e.myCeilingSetup.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhillMinSurfaceAngle,t.myCheckVerticalFixedForwardEnabled=e.myVerticalCheckSetup.myVerticalCheckFixedForwardEnabled,t.myCheckVerticalFixedForward.vec3_copy(e.myVerticalCheckSetup.myVerticalCheckFixedForward),t.myCheckVerticalBothDirection=e.myVerticalCheckSetup.myVerticalMovementCheckPerformCheckOnBothSides,t.myVerticalMovementReduceEnabled=e.myVerticalCheckSetup.myVerticalMovementCheckReductionEnabled,t.myGroundCircumferenceAddCenter=e.myVerticalCheckSetup.myVerticalCheckCircumferenceCentralCheckEnabled,t.myGroundCircumferenceSliceAmount=e.myVerticalCheckSetup.myVerticalCheckCircumferenceSlices,t.myGroundCircumferenceStepAmount=e.myVerticalCheckSetup.myVerticalCheckCircumferenceRadialSteps,t.myGroundCircumferenceRotationPerStep=e.myVerticalCheckSetup.myVerticalCheckCircumferenceRotationPerRadialStep,t.myVerticalAllowHitInsideCollisionIfOneOk=e.myVerticalCheckSetup.myVerticalCheckAllowHitsInsideCollisionIfOneValid,t.myHorizontalBlockLayerFlags.copy(e.myHorizontalCheckSetup.myHorizontalCheckBlockLayerFlags),t.myVerticalBlockLayerFlags.copy(e.myVerticalCheckSetup.myVerticalCheckBlockLayerFlags),t.myHorizontalObjectsToIgnore.pp_copy(e.myHorizontalCheckSetup.myHorizontalCheckObjectsToIgnore),t.myVerticalObjectsToIgnore.pp_copy(e.myVerticalCheckSetup.myVerticalCheckObjectsToIgnore),t.mySnapOnGroundEnabled=e.myGroundSetup.mySurfaceSnapEnabled,t.mySnapOnGroundExtraDistance=e.myGroundSetup.mySurfaceSnapMaxDistance,t.mySnapOnCeilingEnabled=e.myCeilingSetup.mySurfaceSnapEnabled,t.mySnapOnCeilingExtraDistance=e.myCeilingSetup.mySurfaceSnapMaxDistance,t.myGroundPopOutEnabled=e.myGroundSetup.mySurfacePopOutEnabled,t.myGroundPopOutExtraDistance=e.myGroundSetup.mySurfacePopOutMaxDistance,t.myCeilingPopOutEnabled=e.myCeilingSetup.mySurfacePopOutEnabled,t.myCeilingPopOutExtraDistance=e.myCeilingSetup.mySurfacePopOutMaxDistance,t.myGroundAngleToIgnore=e.myGroundSetup.mySurfaceAngleToIgnore,t.myGroundAngleToIgnoreWithPerceivedAngle=e.myGroundSetup.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,t.myCeilingAngleToIgnore=e.myCeilingSetup.mySurfaceAngleToIgnore,t.myCeilingAngleToIgnoreWithPerceivedAngle=e.myCeilingSetup.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,t.myHorizontalMovementGroundAngleIgnoreHeight=e.myGroundSetup.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalMovementCeilingAngleIgnoreHeight=e.myCeilingSetup.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalPositionGroundAngleIgnoreHeight=e.myGroundSetup.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalPositionCeilingAngleIgnoreHeight=e.myCeilingSetup.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=e.myGroundSetup.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,t.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=e.myCeilingSetup.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,t.myComputeGroundInfoEnabled=e.myGroundSetup.myCollectSurfaceInfo,t.myComputeCeilingInfoEnabled=e.myCeilingSetup.myCollectSurfaceInfo,t.myDistanceToBeOnGround=e.myGroundSetup.myIsOnSurfaceMaxOutsideDistance,t.myDistanceToComputeGroundInfo=e.myGroundSetup.myCollectSurfaceNormalMaxOutsideDistance,t.myDistanceToBeOnCeiling=e.myCeilingSetup.myIsOnSurfaceMaxOutsideDistance,t.myDistanceToComputeCeilingInfo=e.myCeilingSetup.myCollectSurfaceNormalMaxOutsideDistance,t.myVerticalFixToBeOnGround=e.myGroundSetup.myIsOnSurfaceMaxInsideDistance,t.myVerticalFixToComputeGroundInfo=e.myGroundSetup.myCollectSurfaceNormalMaxInsideDistance,t.myVerticalFixToBeOnCeiling=e.myCeilingSetup.myIsOnSurfaceMaxInsideDistance,t.myVerticalFixToComputeCeilingInfo=e.myCeilingSetup.myCollectSurfaceNormalMaxInsideDistance,t.myGroundIsBaseInsideCollisionCheckEnabled=e.myGroundSetup.myIsBaseInsideCollisionCheckEnabled,t.myCeilingIsBaseInsideCollisionCheckEnabled=e.myCeilingSetup.myIsBaseInsideCollisionCheckEnabled,t.myIsOnGroundIfInsideHit=e.myGroundSetup.myIsOnSurfaceIfBaseInsideCollision,t.myIsOnCeilingIfInsideHit=e.myCeilingSetup.myIsOnSurfaceIfBaseInsideCollision,t.myFindGroundDistanceMaxOutsideDistance=e.myGroundSetup.myFindSurfaceDistanceMaxOutsideDistance,t.myFindGroundDistanceMaxInsideDistance=e.myGroundSetup.myFindSurfaceDistanceMaxInsideDistance,t.myFindCeilingDistanceMaxOutsideDistance=e.myCeilingSetup.myFindSurfaceDistanceMaxOutsideDistance,t.myFindCeilingDistanceMaxInsideDistance=e.myCeilingSetup.myFindSurfaceDistanceMaxInsideDistance,t.myAllowGroundSteepFix=e.myGroundSetup.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle,t.myAllowCeilingSteepFix=e.myCeilingSetup.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle,t.myMustStayOnGround=e.myGroundSetup.myMovementMustStayOnSurface,t.myMustStayOnCeiling=e.myCeilingSetup.myMovementMustStayOnSurface,t.myRegatherGroundInfoOnSurfaceCheckFail=e.myGroundSetup.myRecollectSurfaceInfoOnSurfaceCheckFailed,t.myRegatherCeilingInfoOnSurfaceCheckFail=e.myCeilingSetup.myRecollectSurfaceInfoOnSurfaceCheckFailed,t.myMustStayBelowIgnorableGroundAngleDownhill=e.myGroundSetup.myMovementMustStayOnIgnorableSurfaceAngleDownhill,t.myMustStayBelowIgnorableCeilingAngleDownhill=e.myCeilingSetup.myMovementMustStayOnIgnorableSurfaceAngleDownhill,t.myMustStayBelowGroundAngleDownhill=e.myGroundSetup.myMovementMustStayOnSurfaceAngleDownhill,t.myMustStayBelowCeilingAngleDownhill=e.myCeilingSetup.myMovementMustStayOnSurfaceAngleDownhill,t.myMovementMustStayOnGroundHitAngle=e.myGroundSetup.myMovementMustStayOnSurfaceHitMaxAngle,t.myMovementMustStayOnCeilingHitAngle=e.myCeilingSetup.myMovementMustStayOnSurfaceHitMaxAngle,t.myTeleportMustBeOnIgnorableGroundAngle=e.myGroundSetup.myTeleportMustBeOnIgnorableSurfaceAngle,t.myCheckTransformMustBeOnIgnorableGroundAngle=e.myGroundSetup.myCheckTransformMustBeOnIgnorableSurfaceAngle,t.myTeleportMustBeOnIgnorableCeilingAngle=e.myCeilingSetup.myTeleportMustBeOnIgnorableSurfaceAngle,t.myCheckTransformMustBeOnIgnorableCeilingAngle=e.myCeilingSetup.myCheckTransformMustBeOnIgnorableSurfaceAngle,t.myTeleportMustBeOnGroundAngle=e.myGroundSetup.myTeleportMustBeOnSurfaceAngle,t.myCheckTransformMustBeOnGroundAngle=e.myGroundSetup.myCheckTransformMustBeOnSurfaceAngle,t.myTeleportMustBeOnCeilingAngle=e.myCeilingSetup.myTeleportMustBeOnSurfaceAngle,t.myCheckTransformMustBeOnCeilingAngle=e.myCeilingSetup.myCheckTransformMustBeOnSurfaceAngle,t.myTeleportMustBeOnGround=e.myGroundSetup.myTeleportMustBeOnSurface,t.myCheckTransformMustBeOnGround=e.myGroundSetup.myCheckTransformMustBeOnSurface,t.myTeleportMustBeOnCeiling=e.myCeilingSetup.myTeleportMustBeOnSurface,t.myCheckTransformMustBeOnCeiling=e.myCeilingSetup.myCheckTransformMustBeOnSurface,t.mySlidingEnabled=e.myWallSlideSetup.myWallSlideEnabled,t.mySlidingHorizontalMovementCheckBetterNormal=e.myHorizontalCheckSetup.myHorizontalMovementCheckGetBetterReferenceHit,t.mySlidingMaxAttempts=e.myWallSlideSetup.myWallSlideMaxAttempts,t.mySlidingCheckBothDirections=e.myWallSlideSetup.myCheckBothWallSlideDirections,t.mySlidingFlickeringPreventionType=e.myWallSlideSetup.myWallSlideFlickerPreventionMode,t.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=e.myWallSlideSetup.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding,t.mySlidingFlickerPreventionCheckAnywayCounter=e.myWallSlideSetup.myWallSlideFlickerPreventionForceCheckCounter,t.mySlidingAdjustSign90Degrees=e.myWallSlideSetup.my90DegreesWallSlideAdjustDirectionSign,t.mySplitMovementEnabled=e.mySplitMovementSetup.mySplitMovementEnabled,t.mySplitMovementMaxLength=e.mySplitMovementSetup.mySplitMovementMaxStepLength,t.mySplitMovementMaxStepsEnabled=e.mySplitMovementSetup.mySplitMovementMaxSteps!=null,t.mySplitMovementMaxSteps=e.mySplitMovementSetup.mySplitMovementMaxSteps,t.mySplitMovementStepEqualLength=e.mySplitMovementSetup.mySplitMovementMaxStepLength==null,t.mySplitMovementStepEqualLengthMinLength=e.mySplitMovementSetup.mySplitMovementMinStepLength,t.mySplitMovementStopWhenHorizontalMovementCanceled=e.mySplitMovementSetup.mySplitMovementStopOnHorizontalMovementFailed,t.mySplitMovementStopWhenVerticalMovementCanceled=e.mySplitMovementSetup.mySplitMovementStopOnVerticalMovementFailed,t.mySplitMovementStopCallback=e.mySplitMovementSetup.mySplitMovementStopOnCallback,t.mySplitMovementStopReturnPrevious=e.mySplitMovementSetup.mySplitMovementStopReturnPreviousResults,t.myPositionOffsetLocal.vec3_copy(e.myAdditionalSetup.myPositionOffsetLocal),t.myRotationOffsetLocalQuat.quat_copy(e.myAdditionalSetup.myRotationOffsetLocalQuat),t.myDebugActive=e.myDebugSetup.myVisualDebugActive,t.myDebugHorizontalMovementActive=e.myDebugSetup.myVisualDebugHorizontalMovementCheckActive,t.myDebugHorizontalPositionActive=e.myDebugSetup.myVisualDebugHorizontalPositionCheckActive,t.myDebugVerticalMovementActive=e.myDebugSetup.myVisualDebugVerticalMovementCheckActive,t.myDebugVerticalPositionActive=e.myDebugSetup.myVisualDebugVerticalPositionCheckActive,t.myDebugSlidingActive=e.myDebugSetup.myVisualDebugSlideActive,t.myDebugGroundInfoActive=e.myDebugSetup.myVisualDebugGroundInfoActive,t.myDebugCeilingInfoActive=e.myDebugSetup.myVisualDebugGroundInfoActive,t.myDebugRuntimeParamsActive=e.myDebugSetup.myVisualDebugResultsActive,t.myDebugMovementActive=e.myDebugSetup.myVisualDebugMovementActive,t}}()}});var Ia=S(()=>{PP.CharacterColliderSetup=class{constructor(){this.myHeight=0,this.myHorizontalCheckSetup=new PP.CharacterColliderHorizontalCheckSetup,this.myVerticalCheckSetup=new PP.CharacterColliderVerticalCheckSetup,this.myWallSlideSetup=new PP.CharacterColliderWallSlideSetup,this.myGroundSetup=new PP.CharacterColliderSurfaceSetup,this.myCeilingSetup=new PP.CharacterColliderSurfaceSetup,this.mySplitMovementSetup=new PP.CharacterColliderSplitMovementSetup,this.myAdditionalSetup=new PP.CharacterColliderAdditionalSetup,this.myDebugSetup=new PP.CharacterColliderDebugSetup}copy(e){}};PP.CharacterColliderHorizontalPositionVerticalCheckDirection={UPWARD:0,DOWNWARD:1,BOTH:2};PP.CharacterColliderHorizontalCheckSetup=class{constructor(){this.myHorizontalCheckConeRadius=0,this.myHorizontalCheckConeHalfAngle=0,this.myHorizontalHeightCheckEnabled=!1,this.myHorizontalCheckFeetDistanceToIgnore=0,this.myHorizontalCheckHeadDistanceToIgnore=0,this.myHorizontalCheckFixedForwardEnabled=!1,this.myHorizontalCheckFixedForward=PP.vec3_create(),this.myHorizontalMovementCheckEnabled=!1,this.myHorizontalMovementCheckRadialSteps=0,this.myHorizontalMovementCheckSplitMovementEnabled=!1,this.myHorizontalMovementCheckSplitMovementMaxSteps=null,this.myHorizontalMovementCheckSplitMovementMaxStepLength=null,this.myHorizontalMovementCheckSplitMovementMinStepLength=null,this.myHorizontalMovementCheckGetBetterReferenceHit=!1,this.myHorizontalMovementHorizontalRadialCheckEnabled=!1,this.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=!1,this.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=!1,this.myHorizontalMovementHorizontalStraightCheckEnabled=!1,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,this.myHorizontalMovementHeightCheckSteps=0,this.myHorizontalMovementHeightHorizontalCheckEnabled=!1,this.myHorizontalMovementHeightVerticalCheckEnabled=!1,this.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled=!1,this.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,this.myHorizontalPositionCheckEnabled=!1,this.myHorizontalPositionCheckConeHalfSlices=0,this.myHorizontalPositionHorizontalBorderCheckEnabled=!1,this.myHorizontalPositionHorizontalRadialCheckEnabled=!1,this.myHorizontalPositionHeightCheckSteps=0,this.myHorizontalPositionHeightHorizontalCheckEnabled=!1,this.myHorizontalPositionHeightVerticalCheckEnabled=!1,this.myHorizontalPositionVerticalStraightCheckEnabled=!1,this.myHorizontalPositionVerticalStraightCentralCheckEnabled=!1,this.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalCheckGetFarthestHit=!1,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!1,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!1,this.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision=!1,this.myHorizontalPositionVerticalCheckDirection=PP.CharacterColliderHorizontalPositionVerticalCheckDirection.UPWARD,this.myHorizontalCheckBlockLayerFlags=new PP.PhysicsLayerFlags,this.myHorizontalCheckObjectsToIgnore=[]}copy(e){}};PP.CharacterColliderVerticalCheckSetup=class{constructor(){this.myVerticalCheckCircumferenceRadius=0,this.myVerticalCheckCircumferenceSlices=0,this.myVerticalCheckCircumferenceCentralCheckEnabled=!1,this.myVerticalCheckCircumferenceRadialSteps=0,this.myVerticalCheckCircumferenceRotationPerRadialStep=0,this.myVerticalCheckFixedForwardEnabled=!1,this.myVerticalCheckFixedForward=PP.vec3_create(),this.myVerticalMovementCheckEnabled=!1,this.myVerticalMovementCheckReductionEnabled=!1,this.myVerticalMovementCheckPerformCheckOnBothSides=!1,this.myVerticalPositionCheckEnabled=!1,this.myVerticalCheckAllowHitsInsideCollisionIfOneValid=!1,this.myVerticalCheckBlockLayerFlags=new PP.PhysicsLayerFlags,this.myVerticalCheckObjectsToIgnore=[]}copy(e){}};PP.CharacterColliderSlideFlickerPreventionMode={NONE:0,USE_PREVIOUS_RESULTS:1,COLLISION_ANGLE_ABOVE_90_DEGREES:2,COLLISION_ANGLE_ABOVE_90_DEGREES_OR_MOVEMENT_ANGLE_ABOVE_85_DEGREES:3,ALWAYS:4};PP.CharacterColliderWallSlideSetup=class{constructor(){this.myWallSlideEnabled=!1,this.myWallSlideMaxAttempts=0,this.myCheckBothWallSlideDirections=!1,this.myWallSlideFlickerPreventionMode=PP.CharacterColliderSlideFlickerPreventionMode.NONE,this.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!1,this.myWallSlideFlickerPreventionForceCheckCounter=0,this.my90DegreesWallSlideAdjustDirectionSign=!1}copy(e){}};PP.CharacterColliderSurfaceSetup=class{constructor(){this.mySurfaceSnapEnabled=!1,this.mySurfaceSnapMaxDistance=0,this.mySurfacePopOutEnabled=!1,this.mySurfacePopOutMaxDistance=0,this.mySurfaceAngleToIgnore=0,this.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle=null,this.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance=null,this.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance=null,this.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=null,this.myCollectSurfaceInfo=!1,this.myIsOnSurfaceMaxOutsideDistance=0,this.myIsOnSurfaceMaxInsideDistance=0,this.myIsBaseInsideCollisionCheckEnabled=!1,this.myIsOnSurfaceIfBaseInsideCollision=!1,this.myCollectSurfaceNormalMaxOutsideDistance=0,this.myCollectSurfaceNormalMaxInsideDistance=0,this.myFindSurfaceDistanceMaxOutsideDistance=0,this.myFindSurfaceDistanceMaxInsideDistance=0,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhill=!1,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphill=!1,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfaceAngle=null,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfaceAngle=null,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle=null,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle=null,this.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhill=!1,this.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhillMinSurfaceAngle=null,this.myMovementMustStayOnSurface=!1,this.myMovementMustStayOnSurfaceHitMaxAngle=null,this.myMovementMustStayOnIgnorableSurfaceAngleDownhill=!1,this.myMovementMustStayOnSurfaceAngleDownhill=null,this.myTeleportMustBeOnSurface=!1,this.myTeleportMustBeOnIgnorableSurfaceAngle=!1,this.myTeleportMustBeOnSurfaceAngle=null,this.myCheckTransformMustBeOnSurface=!1,this.myCheckTransformMustBeOnIgnorableSurfaceAngle=!1,this.myCheckTransformMustBeOnSurfaceAngle=null,this.myRecollectSurfaceInfoOnSurfaceCheckFailed=!1,this.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle=!1}copy(e){}};PP.CharacterColliderSplitMovementSetup=class{constructor(){this.mySplitMovementEnabled=!1,this.mySplitMovementMaxSteps=null,this.mySplitMovementMaxStepLength=null,this.mySplitMovementMinStepLength=null,this.mySplitMovementStopOnHorizontalMovementFailed=!1,this.mySplitMovementStopOnVerticalMovementFailed=!1,this.mySplitMovementStopReturnPreviousResults=!1}copy(e){}};PP.CharacterColliderAdditionalSetup=class{constructor(){this.myPositionOffsetLocal=PP.vec3_create(),this.myRotationOffsetLocalQuat=PP.quat_create()}copy(e){}};PP.CharacterColliderDebugSetup=class{constructor(){this.myVisualDebugActive=!1,this.myVisualDebugMovementActive=!1,this.myVisualDebugHorizontalMovementCheckActive=!1,this.myVisualDebugHorizontalPositionCheckActive=!1,this.myVisualDebugVerticalMovementCheckActive=!1,this.myVisualDebugVerticalPositionCheckActive=!1,this.myVisualDebugSlideActive=!1,this.myVisualDebugGroundInfoActive=!1,this.myVisualDebugCeilingInfoActive=!1,this.myVisualDebugResultsActive=!1}copy(e){}};PP.CharacterColliderSetup.prototype.copy=function(e){this.myHeight=e.myHeight,this.myHorizontalCheckSetup.copy(e.myHorizontalCheckSetup),this.myVerticalCheckSetup.copy(e.myVerticalCheckSetup),this.myWallSlideSetup.copy(e.myWallSlideSetup),this.myGroundSetup.copy(e.myGroundSetup),this.myCeilingSetup.copy(e.myCeilingSetup),this.mySplitMovementSetup.copy(e.mySplitMovementSetup),this.myAdditionalSetup.copy(e.myAdditionalSetup),this.myDebugSetup.copy(e.myDebugSetup)};PP.CharacterColliderHorizontalCheckSetup.prototype.copy=function(e){this.myHorizontalCheckConeRadius=e.myHorizontalCheckConeRadius,this.myHorizontalCheckConeHalfAngle=e.myHorizontalCheckConeHalfAngle,this.myHorizontalHeightCheckEnabled=e.myHorizontalHeightCheckEnabled,this.myHorizontalCheckFeetDistanceToIgnore=e.myHorizontalCheckFeetDistanceToIgnore,this.myHorizontalCheckHeadDistanceToIgnore=e.myHorizontalCheckHeadDistanceToIgnore,this.myHorizontalCheckFixedForwardEnabled=e.myHorizontalCheckFixedForwardEnabled,this.myHorizontalCheckFixedForward.vec3_copy(e.myHorizontalCheckFixedForward),this.myHorizontalMovementCheckEnabled=e.myHorizontalMovementCheckEnabled,this.myHorizontalMovementCheckRadialSteps=e.myHorizontalMovementCheckRadialSteps,this.myHorizontalMovementCheckSplitMovementEnabled=e.myHorizontalMovementCheckSplitMovementEnabled,this.myHorizontalMovementCheckSplitMovementMaxSteps=e.myHorizontalMovementCheckSplitMovementMaxSteps,this.myHorizontalMovementCheckSplitMovementMaxStepLength=e.myHorizontalMovementCheckSplitMovementMaxStepLength,this.myHorizontalMovementCheckSplitMovementMinStepLength=e.myHorizontalMovementCheckSplitMovementMinStepLength,this.myHorizontalMovementCheckGetBetterReferenceHit=e.myHorizontalMovementCheckGetBetterReferenceHit,this.myHorizontalMovementHorizontalRadialCheckEnabled=e.myHorizontalMovementHorizontalRadialCheckEnabled,this.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=e.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled,this.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=e.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled,this.myHorizontalMovementHorizontalStraightCheckEnabled=e.myHorizontalMovementHorizontalStraightCheckEnabled,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalMovementHorizontalStraightCentralCheckEnabled,this.myHorizontalMovementHeightCheckSteps=e.myHorizontalMovementHeightCheckSteps,this.myHorizontalMovementHeightVerticalCheckEnabled=e.myHorizontalMovementHeightVerticalCheckEnabled,this.myHorizontalMovementHeightHorizontalCheckEnabled=e.myHorizontalMovementHeightHorizontalCheckEnabled,this.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled=e.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled,this.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled=e.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled,this.myHorizontalMovementVerticalStraightCheckEnabled=e.myHorizontalMovementVerticalStraightCheckEnabled,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalMovementVerticalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,this.myHorizontalPositionCheckEnabled=e.myHorizontalPositionCheckEnabled,this.myHorizontalPositionCheckConeHalfSlices=e.myHorizontalPositionCheckConeHalfSlices,this.myHorizontalPositionHorizontalBorderCheckEnabled=e.myHorizontalPositionHorizontalBorderCheckEnabled,this.myHorizontalPositionHorizontalRadialCheckEnabled=e.myHorizontalPositionHorizontalRadialCheckEnabled,this.myHorizontalPositionHeightCheckSteps=e.myHorizontalPositionHeightCheckSteps,this.myHorizontalPositionHeightHorizontalCheckEnabled=e.myHorizontalPositionHeightHorizontalCheckEnabled,this.myHorizontalPositionHeightVerticalCheckEnabled=e.myHorizontalPositionHeightVerticalCheckEnabled,this.myHorizontalPositionVerticalStraightCheckEnabled=e.myHorizontalPositionVerticalStraightCheckEnabled,this.myHorizontalPositionVerticalStraightCentralCheckEnabled=e.myHorizontalPositionVerticalStraightCentralCheckEnabled,this.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalCheckGetFarthestHit=e.myHorizontalPositionVerticalCheckGetFarthestHit,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=e.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=e.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit,this.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision=e.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision,this.myHorizontalPositionVerticalCheckDirection=e.myHorizontalPositionVerticalCheckDirection,this.myHorizontalCheckBlockLayerFlags.setMask(e.myHorizontalCheckBlockLayerFlags.getMask()),this.myHorizontalCheckObjectsToIgnore.pp_copy(e.myHorizontalCheckObjectsToIgnore)};PP.CharacterColliderVerticalCheckSetup.prototype.copy=function(e){this.myVerticalCheckCircumferenceRadius=e.myVerticalCheckCircumferenceRadius,this.myVerticalCheckCircumferenceSlices=e.myVerticalCheckCircumferenceSlices,this.myVerticalCheckCircumferenceCentralCheckEnabled=e.myVerticalCheckCircumferenceCentralCheckEnabled,this.myVerticalCheckCircumferenceRadialSteps=e.myVerticalCheckCircumferenceRadialSteps,this.myVerticalCheckCircumferenceRotationPerRadialStep=e.myVerticalCheckCircumferenceRotationPerRadialStep,this.myVerticalCheckFixedForwardEnabled=e.myVerticalCheckFixedForwardEnabled,this.myVerticalCheckFixedForward.vec3_copy(e.myVerticalCheckFixedForward),this.myVerticalMovementCheckEnabled=e.myVerticalMovementCheckEnabled,this.myVerticalMovementCheckReductionEnabled=e.myVerticalMovementCheckReductionEnabled,this.myVerticalMovementCheckPerformCheckOnBothSides=e.myVerticalMovementCheckPerformCheckOnBothSides,this.myVerticalPositionCheckEnabled=e.myVerticalPositionCheckEnabled,this.myVerticalCheckAllowHitsInsideCollisionIfOneValid=e.myVerticalCheckAllowHitsInsideCollisionIfOneValid,this.myVerticalCheckBlockLayerFlags.setMask(e.myVerticalCheckBlockLayerFlags.getMask()),this.myVerticalCheckObjectsToIgnore.pp_copy(e.myVerticalCheckObjectsToIgnore)};PP.CharacterColliderWallSlideSetup.prototype.copy=function(e){this.myWallSlideEnabled=e.myWallSlideEnabled,this.myWallSlideMaxAttempts=e.myWallSlideMaxAttempts,this.myCheckBothWallSlideDirections=e.myCheckBothWallSlideDirections,this.myWallSlideFlickerPreventionMode=e.myWallSlideFlickerPreventionMode,this.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=e.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding,this.myWallSlideFlickerPreventionForceCheckCounter=e.myWallSlideFlickerPreventionForceCheckCounter,this.my90DegreesWallSlideAdjustDirectionSign=e.my90DegreesWallSlideAdjustDirectionSign};PP.CharacterColliderSurfaceSetup.prototype.copy=function(e){this.mySurfaceSnapEnabled=e.mySurfaceSnapEnabled,this.mySurfaceSnapMaxDistance=e.mySurfaceSnapMaxDistance,this.mySurfacePopOutEnabled=e.mySurfacePopOutEnabled,this.mySurfacePopOutMaxDistance=e.mySurfacePopOutMaxDistance,this.mySurfaceAngleToIgnore=e.mySurfaceAngleToIgnore,this.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle=e.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,this.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance=e.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,this.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance=e.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,this.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=e.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,this.myCollectSurfaceInfo=e.myCollectSurfaceInfo,this.myIsOnSurfaceMaxOutsideDistance=e.myIsOnSurfaceMaxOutsideDistance,this.myIsOnSurfaceMaxInsideDistance=e.myIsOnSurfaceMaxInsideDistance,this.myIsBaseInsideCollisionCheckEnabled=e.myIsBaseInsideCollisionCheckEnabled,this.myIsOnSurfaceIfBaseInsideCollision=e.myIsOnSurfaceIfBaseInsideCollision,this.myCollectSurfaceNormalMaxOutsideDistance=e.myCollectSurfaceNormalMaxOutsideDistance,this.myCollectSurfaceNormalMaxInsideDistance=e.myCollectSurfaceNormalMaxInsideDistance,this.myFindSurfaceDistanceMaxOutsideDistance=e.myFindSurfaceDistanceMaxOutsideDistance,this.myFindSurfaceDistanceMaxInsideDistance=e.myFindSurfaceDistanceMaxInsideDistance,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhill=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhill,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphill=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphill,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfaceAngle=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfaceAngle,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfaceAngle=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfaceAngle,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,this.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhill=e.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhill,this.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhillMinSurfaceAngle=e.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhillMinSurfaceAngle,this.myMovementMustStayOnSurface=e.myMovementMustStayOnSurface,this.myMovementMustStayOnSurfaceHitMaxAngle=e.myMovementMustStayOnSurfaceHitMaxAngle,this.myMovementMustStayOnIgnorableSurfaceAngleDownhill=e.myMovementMustStayOnIgnorableSurfaceAngleDownhill,this.myMovementMustStayOnSurfaceAngleDownhill=e.myMovementMustStayOnSurfaceAngleDownhill,this.myTeleportMustBeOnSurface=e.myTeleportMustBeOnSurface,this.myTeleportMustBeOnIgnorableSurfaceAngle=e.myTeleportMustBeOnIgnorableSurfaceAngle,this.myTeleportMustBeOnSurfaceAngle=e.myTeleportMustBeOnSurfaceAngle,this.myCheckTransformMustBeOnSurface=e.myCheckTransformMustBeOnSurface,this.myCheckTransformMustBeOnIgnorableSurfaceAngle=e.myCheckTransformMustBeOnIgnorableSurfaceAngle,this.myCheckTransformMustBeOnSurfaceAngle=e.myCheckTransformMustBeOnSurfaceAngle,this.myRecollectSurfaceInfoOnSurfaceCheckFailed=e.myRecollectSurfaceInfoOnSurfaceCheckFailed,this.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle=e.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle};PP.CharacterColliderSplitMovementSetup.prototype.copy=function(e){this.mySplitMovementEnabled=e.mySplitMovementEnabled,this.mySplitMovementMaxSteps=e.mySplitMovementMaxSteps,this.mySplitMovementMaxStepLength=e.mySplitMovementMaxStepLength,this.mySplitMovementMinStepLength=e.mySplitMovementMinStepLength,this.mySplitMovementStopOnHorizontalMovementFailed=e.mySplitMovementStopOnHorizontalMovementFailed,this.mySplitMovementStopOnVerticalMovementFailed=e.mySplitMovementStopOnVerticalMovementFailed,this.mySplitMovementStopReturnPreviousResults=e.mySplitMovementStopReturnPreviousResults};PP.CharacterColliderAdditionalSetup.prototype.copy=function(e){this.myPositionOffsetLocal.vec3_copy(e.myPositionOffsetLocal),this.myRotationOffsetLocalQuat.quat_copy(e.myRotationOffsetLocalQuat)};PP.CharacterColliderDebugSetup.prototype.copy=function(e){this.myVisualDebugActive=e.myVisualDebugActive,this.myVisualDebugMovementActive=e.myVisualDebugMovementActive,this.myVisualDebugHorizontalMovementCheckActive=e.myVisualDebugHorizontalMovementCheckActive,this.myVisualDebugHorizontalPositionCheckActive=e.myVisualDebugHorizontalPositionCheckActive,this.myVisualDebugVerticalMovementCheckActive=e.myVisualDebugVerticalMovementCheckActive,this.myVisualDebugVerticalPositionCheckActive=e.myVisualDebugVerticalPositionCheckActive,this.myVisualDebugSlideActive=e.myVisualDebugSlideActive,this.myVisualDebugGroundInfoActive=e.myVisualDebugGroundInfoActive,this.myVisualDebugCeilingInfoActive=e.myVisualDebugCeilingInfoActive,this.myVisualDebugResultsActive=e.myVisualDebugResultsActive};Object.defineProperty(PP.CharacterColliderSetup.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterColliderHorizontalCheckSetup.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterColliderVerticalCheckSetup.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterColliderWallSlideSetup.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterColliderSurfaceSetup.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterColliderSplitMovementSetup.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterColliderAdditionalSetup.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterColliderDebugSetup.prototype,"copy",{enumerable:!1})});var xa=S(()=>{PP.CharacterColliderSetupSimplifiedCreationAccuracyLevel={VERY_LOW:0,LOW:1,MEDIUM:2,HIGH:3,VERY_HIGH:4};PP.CharacterColliderSetupSimplifiedCreationParams=class{constructor(){this.myHeight=0,this.myRadius=0,this.myAccuracyLevel=PP.CharacterColliderSetupSimplifiedCreationAccuracyLevel.VERY_LOW,this.myIsPlayer=!1,this.myCheckOnlyFeet=!1,this.myAverageSpeed=0,this.myCanFly=!1,this.myShouldSlideAgainstWall=!1,this.myCollectGroundInfo=!1,this.myShouldSnapOnGround=!1,this.myMaxDistanceToSnapOnGround=0,this.myMaxWalkableGroundAngle=0,this.myMaxWalkableGroundStepHeight=0,this.myShouldNotFallFromEdges=!1,this.myHorizontalCheckBlockLayerFlags=new PP.PhysicsLayerFlags,this.myHorizontalCheckObjectsToIgnore=[],this.myVerticalCheckBlockLayerFlags=new PP.PhysicsLayerFlags,this.myVerticalCheckObjectsToIgnore=[],this.myHorizontalCheckDebugActive=!1,this.myVerticalCheckDebugActive=!1}};PP.CharacterColliderUtils={createCharacterColliderSetupSimplified:function(i,e=new PP.CharacterColliderSetup){},createTeleportColliderFromMovementCollider:function(i,e=new PP.CharacterColliderSetup){return e.copy(i),e.myHorizontalCheckSetup.myHorizontalCheckConeHalfAngle=180,e.myHorizontalCheckSetup.myHorizontalPositionCheckConeHalfSlices=Math.round(e.myHorizontalCheckSetup.myHorizontalCheckConeHalfAngle/i.myHorizontalCheckSetup.myHorizontalCheckConeHalfAngle*i.myHorizontalCheckSetup.myHorizontalPositionCheckConeHalfSlices),e.myHorizontalCheckSetup.myHorizontalCheckFixedForwardEnabled=!0,e.myHorizontalCheckSetup.myHorizontalCheckFixedForward.vec3_set(0,0,1),e}};PP.CharacterColliderUtils.createCharacterColliderSetupSimplified=function(e,t=new PP.CharacterColliderSetup){if(t.myHeight=e.myHeight,t.myHorizontalCheckSetup.myHorizontalCheckConeRadius=e.myRadius,t.myVerticalCheckSetup.myVerticalCheckCircumferenceRadius=e.myRadius/2,t.myVerticalCheckSetup.myVerticalCheckFixedForwardEnabled=!0,t.myVerticalCheckSetup.myVerticalCheckFixedForward.vec3_set(0,0,1),(!e.myCheckOnlyFeet||e.myCanFly)&&(t.myHorizontalCheckSetup.myHorizontalHeightCheckEnabled=!0,t.myVerticalCheckSetup.myVerticalPositionCheckEnabled=!0),t.myWallSlideSetup.myWallSlideEnabled=e.myShouldSlideAgainstWall,t.myHorizontalCheckSetup.myHorizontalCheckFeetDistanceToIgnore=e.myMaxWalkableGroundStepHeight,t.myGroundSetup.mySurfaceSnapMaxDistance=e.myMaxDistanceToSnapOnGround,t.myGroundSetup.mySurfacePopOutMaxDistance=e.myMaxDistanceToSnapOnGround>0?e.myMaxDistanceToSnapOnGround:e.myRadius>.1?.1:.01,t.myGroundSetup.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=e.myRadius,t.myGroundSetup.myCollectSurfaceInfo=e.myCollectGroundInfo||e.myMaxWalkableGroundAngle>0,t.myGroundSetup.mySurfaceSnapEnabled=e.myShouldSnapOnGround,t.myGroundSetup.mySurfacePopOutEnabled=!0,t.myGroundSetup.mySurfaceAngleToIgnore=e.myMaxWalkableGroundAngle,t.myGroundSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngle=!0,t.myGroundSetup.myIsOnSurfaceMaxOutsideDistance=.001,t.myGroundSetup.myIsOnSurfaceMaxInsideDistance=.001,t.myGroundSetup.myCollectSurfaceNormalMaxOutsideDistance=e.myRadius>.1?.1:.01,t.myGroundSetup.myCollectSurfaceNormalMaxInsideDistance=t.myGroundSetup.myCollectSurfaceNormalMaxOutsideDistance,e.myCanFly&&(t.myHorizontalCheckSetup.myHorizontalCheckHeadDistanceToIgnore=t.myHorizontalCheckSetup.myHorizontalCheckFeetDistanceToIgnore,t.myCeilingSetup.myCollectSurfaceInfo=t.myGroundSetup.myCollectSurfaceInfo,t.myCeilingSetup.mySurfacePopOutEnabled=t.myGroundSetup.mySurfacePopOutEnabled,t.myCeilingSetup.mySurfaceAngleToIgnore=t.myGroundSetup.mySurfaceAngleToIgnore,t.myCeilingSetup.mySurfaceSnapMaxDistance=t.myGroundSetup.mySurfaceSnapMaxDistance,t.myCeilingSetup.mySurfacePopOutMaxDistance=t.myGroundSetup.mySurfacePopOutMaxDistance,t.myCeilingSetup.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=t.myGroundSetup.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,t.myCeilingSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngle=t.myGroundSetup.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngle,t.myCeilingSetup.myIsOnSurfaceMaxOutsideDistance=t.myGroundSetup.myIsOnSurfaceMaxOutsideDistance,t.myCeilingSetup.myIsOnSurfaceMaxInsideDistance=t.myGroundSetup.myIsOnSurfaceMaxInsideDistance,t.myCeilingSetup.myCollectSurfaceNormalMaxOutsideDistance=t.myGroundSetup.myCollectSurfaceNormalMaxOutsideDistance,t.myCeilingSetup.myCollectSurfaceNormalMaxInsideDistance=t.myGroundSetup.myCollectSurfaceNormalMaxInsideDistance),e.myShouldNotFallFromEdges&&(t.myGroundSetup.myMovementMustStayOnSurface=!0,t.myGroundSetup.myMovementMustStayOnSurfaceAngleDownhill=Math.max(60,t.myGroundSetup.mySurfaceAngleToIgnore)),t.myHorizontalCheckSetup.myHorizontalCheckBlockLayerFlags.copy(e.myHorizontalCheckBlockLayerFlags),t.myHorizontalCheckSetup.myHorizontalCheckObjectsToIgnore.pp_copy(e.myHorizontalCheckObjectsToIgnore),t.myVerticalCheckSetup.myVerticalCheckBlockLayerFlags.copy(e.myVerticalCheckBlockLayerFlags),t.myVerticalCheckSetup.myVerticalCheckObjectsToIgnore.pp_copy(e.myVerticalCheckObjectsToIgnore),e.myHorizontalCheckDebugActive&&(t.myDebugSetup.myVisualDebugActive=!0,t.myDebugSetup.myVisualDebugHorizontalMovementCheckActive=!0,t.myDebugSetup.myVisualDebugHorizontalPositionCheckActive=!0),e.myVerticalCheckDebugActive&&(t.myDebugSetup.myVisualDebugActive=!0,t.myDebugSetup.myVisualDebugVerticalMovementCheckActive=!0,t.myDebugSetup.myVisualDebugVerticalPositionCheckActive=!0),e.myAccuracyLevel>=PP.CharacterColliderSetupSimplifiedCreationAccuracyLevel.VERY_LOW&&(t.myHorizontalCheckSetup.myHorizontalCheckConeHalfAngle=60,t.myHorizontalCheckSetup.myHorizontalMovementHeightVerticalCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalPositionHeightVerticalCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementCheckEnabled=!1,t.myHorizontalCheckSetup.myHorizontalPositionCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalPositionCheckConeHalfSlices=1,t.myHorizontalCheckSetup.myHorizontalPositionHeightCheckSteps=1,t.myHorizontalCheckSetup.myHorizontalPositionHorizontalRadialCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalPositionVerticalStraightCheckEnabled=!0,t.myVerticalCheckSetup.myVerticalCheckCircumferenceSlices=4,t.myVerticalCheckSetup.myVerticalCheckCircumferenceCentralCheckEnabled=!0,t.myVerticalCheckSetup.myVerticalCheckCircumferenceRadialSteps=1,t.myVerticalCheckSetup.myVerticalMovementCheckEnabled=!0,t.myVerticalCheckSetup.myVerticalMovementCheckReductionEnabled=!0,t.myVerticalCheckSetup.myVerticalPositionCheckEnabled=!0,t.myVerticalCheckSetup.myVerticalCheckAllowHitsInsideCollisionIfOneValid=!0),e.myAccuracyLevel>=PP.CharacterColliderSetupSimplifiedCreationAccuracyLevel.LOW&&(t.myHorizontalCheckSetup.myHorizontalMovementCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementCheckRadialSteps=1,t.myHorizontalCheckSetup.myHorizontalMovementHeightCheckSteps=1,t.myHorizontalCheckSetup.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!0,t.myVerticalCheckSetup.myVerticalCheckCircumferenceRadialSteps=2,t.myVerticalCheckSetup.myVerticalCheckCircumferenceRotationPerRadialStep=180/t.myVerticalCheckSetup.myVerticalCheckCircumferenceSlices,t.myWallSlideSetup.myWallSlideMaxAttempts=1,t.myWallSlideSetup.myCheckBothWallSlideDirections=!1,t.myWallSlideSetup.myWallSlideFlickerPreventionMode=PP.CharacterColliderSlideFlickerPreventionMode.NONE,t.myWallSlideSetup.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!1,t.myWallSlideSetup.myWallSlideFlickerPreventionForceCheckCounter=0,t.myWallSlideSetup.my90DegreesWallSlideAdjustDirectionSign=!1,t.myWallSlideSetup.myWallSlideMaxAttempts=2),e.myAccuracyLevel>=PP.CharacterColliderSetupSimplifiedCreationAccuracyLevel.MEDIUM&&(t.myHorizontalCheckSetup.myHorizontalMovementHeightHorizontalCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalPositionCheckConeHalfSlices=2,t.myHorizontalCheckSetup.myHorizontalPositionHeightHorizontalCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalPositionHorizontalBorderCheckEnabled=!0,t.myVerticalCheckSetup.myVerticalMovementCheckPerformCheckOnBothSides=!0,t.myVerticalCheckSetup.myVerticalCheckCircumferenceSlices=6,t.myVerticalCheckSetup.myVerticalCheckCircumferenceRadialSteps=2,t.myVerticalCheckSetup.myVerticalCheckCircumferenceRotationPerRadialStep=180/t.myVerticalCheckSetup.myVerticalCheckCircumferenceSlices,t.myWallSlideSetup.myWallSlideMaxAttempts=3,t.myWallSlideSetup.my90DegreesWallSlideAdjustDirectionSign=!0,e.myIsPlayer&&(t.myWallSlideSetup.myWallSlideFlickerPreventionMode=PP.CharacterColliderSlideFlickerPreventionMode.USE_PREVIOUS_RESULTS,t.myWallSlideSetup.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!0,t.myWallSlideSetup.myWallSlideFlickerPreventionForceCheckCounter=4)),e.myAccuracyLevel>=PP.CharacterColliderSetupSimplifiedCreationAccuracyLevel.HIGH){t.myWallSlideSetup.myWallSlideEnabled&&(t.myHorizontalCheckSetup.myHorizontalMovementCheckGetBetterReferenceHit=!0,t.myHorizontalCheckSetup.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!0,t.myHorizontalCheckSetup.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!0),t.myHorizontalCheckSetup.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementHorizontalStraightCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,t.myHorizontalCheckSetup.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,t.myVerticalCheckSetup.myVerticalCheckCircumferenceSlices=8,t.myVerticalCheckSetup.myVerticalCheckCircumferenceRadialSteps=2,t.myVerticalCheckSetup.myVerticalCheckCircumferenceRotationPerRadialStep=180/t.myVerticalCheckSetup.myVerticalCheckCircumferenceSlices,t.myWallSlideSetup.myWallSlideMaxAttempts=4,e.myIsPlayer&&(t.myWallSlideSetup.myCheckBothWallSlideDirections=!0),t.myGroundSetup.myIsBaseInsideCollisionCheckEnabled=!0,t.myCeilingSetup.myIsBaseInsideCollisionCheckEnabled=!0;let n=90;e.myAverageSpeed/n>e.myRadius&&(t.mySplitMovementSetup.mySplitMovementEnabled=other.mySplitMovementEnabled,t.mySplitMovementSetup.mySplitMovementMaxSteps=Math.ceil(e.myAverageSpeed/n/e.myRadius),t.mySplitMovementSetup.mySplitMovementMinStepLength=e.myRadius)}return e.myAccuracyLevel>=PP.CharacterColliderSetupSimplifiedCreationAccuracyLevel.VERY_HIGH&&(t.myHorizontalCheckSetup.myHorizontalMovementHeightCheckSteps=2,t.myHorizontalCheckSetup.myHorizontalMovementHorizontalRadialCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,t.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,t.myHorizontalCheckSetup.myHorizontalPositionHeightCheckSteps=2,t.myHorizontalCheckSetup.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=!0,t.myHorizontalCheckSetup.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!0,t.myHorizontalCheckSetup.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!0,t.myGroundSetup.myRecollectSurfaceInfoOnSurfaceCheckFailed=!0,t.myCeilingSetup.myRecollectSurfaceInfoOnSurfaceCheckFailed=t.myGroundSetup.myRecollectSurfaceInfoOnSurfaceCheckFailed),t}});var Ra=S(()=>{PP.CharacterCollisionResults=class{constructor(){this.myCheckType=PP.CharacterCollisionCheckType.NONE,this.myTransformResults=new PP.CharacterCollisionTransformResults,this.myMovementResults=new PP.CharacterCollisionMovementResults,this.myHorizontalMovementResults=new PP.CharacterCollisionMovementResults,this.myVerticalMovementResults=new PP.CharacterCollisionMovementResults,this.myTeleportResults=new PP.CharacterCollisionTeleportResults,this.myCheckTransformResults=new PP.CharacterCollisionCheckTransformResults,this.myWallSlideResults=new PP.CharacterCollisionWallSlideResults,this.myGroundInfo=new PP.CharacterCollisionSurfaceInfo,this.myCeilingInfo=new PP.CharacterCollisionSurfaceInfo,this.myGroundResults=new PP.CharacterCollisionSurfaceResults,this.myCeilingResults=new PP.CharacterCollisionSurfaceResults,this.mySplitMovementResults=new PP.CharacterCollisionSplitMovementResults,this.myDebugResults=new PP.CharacterCollisionDebugResults,this.myInternalResults=new PP.CharacterCollisionInternalResults}reset(){}copy(e){}};PP.CharacterCollisionCheckType={NONE:0,CHECK_MOVEMENT:1,CHECK_TELEPORT:2,CHECK_TRANSFORM:3,UPDATE_SURFACE_INFO:4,UPDATE_GROUND_INFO:5,UPDATE_CEILING_INFO:6};PP.CharacterCollisionSurfaceInfo=class{constructor(){this.myIsOnSurface=!1,this.mySurfaceAngle=0,this.mySurfacePerceivedAngle=0,this.mySurfaceNormal=PP.vec3_create(),this.mySurfaceHitMaxAngle=0,this.mySurfaceHitMaxNormal=PP.vec3_create(),this.mySurfaceDistance=null,this.myIsBaseInsideCollision=!1}reset(){}copy(e){}};PP.CharacterCollisionWallSlideResults=class{constructor(){this.myHasSlid=!1,this.mySlideMovementAngle=0,this.mySlideMovementWallAngle=0,this.myWallNormal=PP.vec3_create()}reset(){}copy(e){}};PP.CharacterCollisionTransformResults=class{constructor(){this.myStartTransformQuat=PP.quat2_create(),this.myEndTransformQuat=PP.quat2_create()}reset(){}copy(e){}};PP.CharacterCollisionMovementResults=class{constructor(){this.myStartMovement=PP.vec3_create(),this.myEndMovement=PP.vec3_create(),this.myMovementFailed=!1,this.myIsColliding=!1,this.myReferenceCollisionHit=new PP.RaycastHit}reset(){}copy(e){}};PP.CharacterCollisionTeleportResults=class{constructor(){this.myStartTeleportTransformQuat=PP.quat2_create(),this.myEndTeleportTransformQuat=PP.quat2_create(),this.myTeleportFailed=!1}reset(){}copy(e){}};PP.CharacterCollisionCheckTransformResults=class{constructor(){this.myStartCheckTransformQuat=PP.quat2_create(),this.myEndCheckTransformQuat=PP.quat2_create(),this.myCheckTransformFailed=!1}reset(){}copy(e){}};PP.CharacterCollisionSurfaceResults=class{constructor(){this.myHasSnappedOnSurface=!1,this.myHasPoppedOutSurface=!1,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill=!1,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill=!1,this.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill=!1}reset(){}copy(e){}};PP.CharacterCollisionSplitMovementResults=class{constructor(){this.myStepsToPerform=0,this.myStepsPerformed=0,this.myMovementInterrupted=!1,this.myMovementChecked=PP.vec3_create()}reset(){}copy(e){}};PP.CharacterCollisionDebugResults=class{constructor(){this._myRaycastsPerformed=0}reset(){}copy(e){}};PP.CharacterCollisionInternalResults=class{constructor(){this.myLastRelevantStartHorizontalMovement=PP.vec3_create(),this.myLastRelevantAdjustedStartHorizontalMovement=PP.vec3_create(),this.myLastRelevantEndHorizontalMovement=PP.vec3_create(),this.myLastRelevantStartVerticalMovement=PP.vec3_create(),this.myLastRelevantAdjustedStartVerticalMovement=PP.vec3_create(),this.myLastRelevantEndVerticalMovement=PP.vec3_create(),this.myLastRelevantHasWallSlid=!1,this.myHasWallSlidTowardOppositeDirection=!1,this.myLastRelevantWallSlideFlickerPrevented=!1,this.myWallSlideFlickerPreventionForceCheckCounter=0,this.myWallSlide90DegreesDirectionSign=0,this.myWallSlide90DegreesRecomputeDirectionSign=!0}reset(){}copy(e){}};PP.CharacterCollisionResults.prototype.reset=function(){this.myCheckType=PP.CharacterCollisionCheckType.NONE,this.myTransformResults.reset(),this.myMovementResults.reset(),this.myHorizontalMovementResults.reset(),this.myVerticalMovementResults.reset(),this.myTeleportResults.reset(),this.myCheckTransformResults.reset(),this.myWallSlideResults.reset(),this.myGroundInfo.reset(),this.myCeilingInfo.reset(),this.myGroundResults.reset(),this.myCeilingResults.reset(),this.mySplitMovementResults.reset(),this.myInternalResults.reset()};PP.CharacterCollisionResults.prototype.copy=function(e){this.myCheckType=e.myCheckType,this.myTransformResults.copy(e.myTransformResults),this.myMovementResults.copy(e.myMovementResults),this.myHorizontalMovementResults.copy(e.myHorizontalMovementResults),this.myVerticalMovementResults.copy(e.myVerticalMovementResults),this.myTeleportResults.copy(e.myTeleportResults),this.myCheckTransformResults.copy(e.myCheckTransformResults),this.myWallSlideResults.copy(e.myWallSlideResults),this.myGroundInfo.copy(e.myGroundInfo),this.myCeilingInfo.copy(e.myCeilingInfo),this.myGroundResults.copy(e.myGroundResults),this.myCeilingResults.copy(e.myCeilingResults),this.mySplitMovementResults.copy(e.mySplitMovementResults),this.myInternalResults.copy(e.myInternalResults)};PP.CharacterCollisionSurfaceInfo.prototype.reset=function(){this.myIsOnSurface=!1,this.mySurfaceAngle=0,this.mySurfacePerceivedAngle=0,this.mySurfaceNormal.vec3_zero(),this.mySurfaceHitMaxAngle=0,this.mySurfaceHitMaxNormal.vec3_zero(),this.mySurfaceDistance=null,this.myIsBaseInsideCollision=!1};PP.CharacterCollisionSurfaceInfo.prototype.copy=function(e){this.myIsOnSurface=e.myIsOnSurface,this.mySurfaceAngle=e.mySurfaceAngle,this.mySurfacePerceivedAngle=e.mySurfacePerceivedAngle,this.mySurfaceNormal.vec3_copy(e.mySurfaceNormal),this.mySurfaceHitMaxAngle=e.mySurfaceHitMaxAngle,this.mySurfaceHitMaxNormal.vec3_copy(e.mySurfaceHitMaxNormal),this.mySurfaceDistance=e.mySurfaceDistance,this.myIsBaseInsideCollision=e.myIsBaseInsideCollision};PP.CharacterCollisionWallSlideResults.prototype.reset=function(){this.myHasSlid=!1,this.mySlideMovementAngle=0,this.mySlideMovementWallAngle=0,this.myWallNormal.vec3_zero()};PP.CharacterCollisionWallSlideResults.prototype.copy=function(e){this.myHasSlid=e.myHasSlid,this.mySlideMovementAngle=e.mySlideMovementAngle,this.mySlideMovementWallAngle=e.mySlideMovementWallAngle,this.myWallNormal.vec3_copy(e.myWallNormal)};PP.CharacterCollisionTransformResults.prototype.reset=function(){this.myStartTransformQuat.quat2_identity(),this.myEndTransformQuat.quat2_identity()};PP.CharacterCollisionTransformResults.prototype.copy=function(e){this.myStartTransformQuat.quat2_copy(e.myStartTransformQuat),this.myEndTransformQuat.quat2_copy(e.myEndTransformQuat)};PP.CharacterCollisionMovementResults.prototype.reset=function(){this.myStartMovement.vec3_zero(),this.myEndMovement.vec3_zero(),this.myMovementFailed=!1,this.myIsColliding=!1,this.myReferenceCollisionHit.reset()};PP.CharacterCollisionMovementResults.prototype.copy=function(e){this.myStartMovement.vec3_copy(e.myStartMovement),this.myEndMovement.vec3_copy(e.myEndMovement),this.myMovementFailed=e.myMovementFailed,this.myIsColliding=e.myIsColliding,this.myReferenceCollisionHit.copy(e.myReferenceCollisionHit)};PP.CharacterCollisionTeleportResults.prototype.reset=function(){this.myStartTeleportTransformQuat.quat2_identity(),this.myEndTeleportTransformQuat.quat2_identity(),this.myTeleportFailed=!1};PP.CharacterCollisionTeleportResults.prototype.copy=function(e){this.myStartTeleportTransformQuat.quat2_copy(e.myStartTeleportTransformQuat),this.myEndTeleportTransformQuat.quat2_copy(e.myEndTeleportTransformQuat),this.myTeleportFailed=e.myTeleportFailed};PP.CharacterCollisionCheckTransformResults.prototype.reset=function(){this.myStartCheckTransformQuat.quat2_identity(),this.myEndCheckTransformQuat.quat2_identity(),this.myCheckTransformFailed=!1};PP.CharacterCollisionCheckTransformResults.prototype.copy=function(e){this.myStartCheckTransformQuat.quat2_copy(e.myStartCheckTransformQuat),this.myEndCheckTransformQuat.quat2_copy(e.myEndCheckTransformQuat),this.myCheckTransformFailed=e.myCheckTransformFailed};PP.CharacterCollisionSurfaceResults.prototype.reset=function(){this.myHasSnappedOnSurface=!1,this.myHasPoppedOutSurface=!1,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill=!1,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill=!1,this.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill=!1};PP.CharacterCollisionSurfaceResults.prototype.copy=function(e){this.myHasSnappedOnSurface=e.myHasSnappedOnSurface,this.myHasPoppedOutSurface=e.myHasPoppedOutSurface,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill=e.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill=e.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill,this.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill=e.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill};PP.CharacterCollisionSplitMovementResults.prototype.reset=function(){this.myStepsToPerform=0,this.myStepsPerformed=0,this.myMovementInterrupted=!1,this.myMovementChecked.vec3_zero()};PP.CharacterCollisionSplitMovementResults.prototype.copy=function(e){this.myStepsToPerform=e.myStepsToPerform,this.myStepsPerformed=e.myStepsPerformed,this.myMovementInterrupted=e.myMovementInterrupted,this.myMovementChecked.vec3_copy(e.myMovementChecked)};PP.CharacterCollisionDebugResults.prototype.reset=function(){this._myRaycastsPerformed=0};PP.CharacterCollisionDebugResults.prototype.copy=function(e){this._myRaycastsPerformed=e._myRaycastsPerformed};PP.CharacterCollisionInternalResults.prototype.reset=function(){};PP.CharacterCollisionInternalResults.prototype.copy=function(e){this.myLastRelevantStartHorizontalMovement.vec3_copy(e.myLastRelevantStartHorizontalMovement),this.myLastRelevantAdjustedStartHorizontalMovement.vec3_copy(e.myLastRelevantAdjustedStartHorizontalMovement),this.myLastRelevantEndHorizontalMovement.vec3_copy(e.myLastRelevantEndHorizontalMovement),this.myLastRelevantStartVerticalMovement.vec3_copy(e.myLastRelevantStartVerticalMovement),this.myLastRelevantAdjustedStartVerticalMovement.vec3_copy(e.myLastRelevantAdjustedStartVerticalMovement),this.myLastRelevantEndVerticalMovement.vec3_copy(e.myLastRelevantEndVerticalMovement),this.myLastRelevantHasWallSlid=e.myLastRelevantHasWallSlid,this.myHasWallSlidTowardOppositeDirection=e.myHasWallSlidTowardOppositeDirection,this.myLastRelevantWallSlideFlickerPrevented=e.myLastRelevantWallSlideFlickerPrevented,this.myWallSlideFlickerPreventionForceCheckCounter=e.myWallSlideFlickerPreventionForceCheckCounter,this.myWallSlide90DegreesDirectionSign=e.myWallSlide90DegreesDirectionSign,this.myWallSlide90DegreesRecomputeDirectionSign=e.myWallSlide90DegreesRecomputeDirectionSign};Object.defineProperty(PP.CharacterCollisionResults.prototype,"reset",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionTransformResults.prototype,"reset",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionMovementResults.prototype,"reset",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionTeleportResults.prototype,"reset",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionCheckTransformResults.prototype,"reset",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionWallSlideResults.prototype,"reset",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionSurfaceInfo.prototype,"reset",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionSurfaceResults.prototype,"reset",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionSplitMovementResults.prototype,"reset",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionInternalResults.prototype,"reset",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionResults.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionTransformResults.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionMovementResults.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionTeleportResults.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionCheckTransformResults.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionWallSlideResults.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionSurfaceInfo.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionSurfaceResults.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionSplitMovementResults.prototype,"copy",{enumerable:!1});Object.defineProperty(PP.CharacterCollisionInternalResults.prototype,"copy",{enumerable:!1})});var Va=S(()=>{PP.CharacterCollisionSystem=class{constructor(){this._myLastCheckRaycastsPerformed=0,this._myCurrentFrameRaycastsPerformed=0,this._myMaxFrameRaycastsPerformed=0}update(e){this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),this._myCurrentFrameRaycastsPerformed=0,PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts=0}checkMovement(e,t,n,a,s=new PP.CharacterCollisionResults){PP.CollisionCheckBridge.checkMovement(e,t,n,a,s),this._myLastCheckRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),s.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}checkTeleportToPosition(e,t,n,a,s=new PP.CharacterCollisionResults){}checkTeleportToTransform(e,t,n,a,s=new PP.CharacterCollisionResults){PP.CollisionCheckBridge.checkTeleportToTransform(e,t,n,a,s),this._myLastCheckRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),s.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}checkTransform(e,t,n,a=new PP.CharacterCollisionResults){PP.CollisionCheckBridge.checkTransform(e,t,n,a),this._myLastCheckRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),a.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateSurfaceInfo(e,t,n,a=new PP.CharacterCollisionResults){let s=this._myCurrentFrameRaycastsPerformed;this.updateGroundInfo(e,t,n,a),this.updateCeilingInfo(e,t,n,a),this._myLastCheckRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts-s,this._myCurrentFrameRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),a.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateGroundInfo(e,t,n,a=new PP.CharacterCollisionResults){PP.CollisionCheckBridge.updateGroundInfo(e,t,n,a),this._myLastCheckRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),a.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateCeilingInfo(e,t,n,a=new PP.CharacterCollisionResults){PP.CollisionCheckBridge.updateCeilingInfo(e,t,n,a),this._myLastCheckRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=PP.CollisionCheckBridge._myCollisionCheck._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),a.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}};PP.CharacterCollisionSystem.prototype.checkTeleportToPosition=function(){let i=PP.quat2_create();return function(t,n,a,s,o){i.quat2_copy(n),i.quat2_setPosition(t),this.checkTeleportToTransform(i,n,a,s,o)}}();Object.defineProperty(PP.CharacterCollisionSystem.prototype,"checkTeleportToPosition",{enumerable:!1})});var Da=S(()=>{PP.CharacterController=class{constructor(){}}});var La=S(()=>{PP.SyncedCharacterController=class extends PP.CharacterController{constructor(){super()}}});var Ba=S(()=>{PP.CharacterControllerUtils={computeGroundPerceivedAngle:function(i,e,t){return this.computeSurfacePerceivedAngle(i,e,t,!0)},computeCeilingPerceivedAngle:function(i,e,t){return this.computeSurfacePerceivedAngle(i,e,t,!1)},computeSurfacePerceivedAngle:function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a,s,o){let l=0;e.vec3_copy(s),o||e.vec3_negate(e);let m=n.vec3_angle(e);m<=Math.PP_EPSILON_DEGREES?m=0:m>=180-Math.PP_EPSILON_DEGREES&&(m=180),i=a.vec3_projectOnPlaneAlongAxis(n,s,i),l=i.vec3_angle(a);let c=i.vec3_isFartherAlongAxis(a,s);return(!c&&o||c&&!o)&&(l*=-1),Math.abs(l)>=m&&(m!=0&&m!=180?l=m*Math.pp_sign(l):l=m),l}}()}});var Oa=S(()=>{PP.PlayerCharacterController=class extends PP.SyncedCharacterController{constructor(){super()}}});var Ha=S(()=>{PP.PlayerHeadCharacterController=class extends PP.SyncedCharacterController{constructor(){super()}}});var Ea=S(()=>{PP.PlayerHandCharacterController=class extends PP.SyncedCharacterController{constructor(){super()}}});var fc={};var Je,ka=U(()=>{Ft();PP.GlobalGravityComponent=(Je=class extends Y{init(){}},Pe(Je,"TypeName","pp-global-gravity"),Pe(Je,"Properties",{}),Je);WL.registerComponent(PP.GlobalGravityComponent);PP.myGravityAcceleration=0;PP.myGravityDirection=PP.vec3_create()});var Fa=S(()=>{PP.PlayerLocomotionSmooth=class{constructor(){}}});var wa=S(()=>{PP.PlayerLocomotionRotate=class{constructor(){}}});var Wa=S(()=>{PP.PlayerLocomotionGravity=class{constructor(){}}});var ja=S(()=>{PP.PlayerLocomotionTeleport=class{constructor(){}}});var za=S(()=>{PP.LocomotionUtils={EPSILON_NUMBER:Math.PP_EPSILON_NUMBER,EPSILON_DEGREES:Math.PP_EPSILON_DEGREES,computeSurfacePerceivedAngle:function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a,s,o=!0){let l=0;e.vec3_copy(s),o||e.vec3_negate(e);let m=n.vec3_angle(e);m<=Math.PP_EPSILON_DEGREES?m=0:m>=180-Math.PP_EPSILON_DEGREES&&(m=180),i=a.vec3_projectOnPlaneAlongAxis(n,s,i),l=i.vec3_angle(a);let c=i.vec3_isFartherAlongAxis(a,s);return(!c&&o||c&&!o)&&(l*=-1),Math.abs(l)>=m&&(m!=0&&m!=180?l=m*Math.pp_sign(l):l=m),l}}()}});var Ga=S(()=>{PP.PlayerHeadManagerParams=class{constructor(){this.mySessionChangeResyncEnabled=!1,this.myBlurEndResyncEnabled=!1,this.myBlurEndResyncRotation=!1,this.myResetTransformOnViewResetEnabled=!0,this.myNextEnterSessionResyncHeight=!1,this.myEnterSessionResyncHeight=!1,this.myExitSessionResyncHeight=!1,this.myExitSessionResyncVerticalAngle=!1,this.myExitSessionRemoveRightTilt=!1,this.myExitSessionAdjustMaxVerticalAngle=!1,this.myExitSessionMaxVerticalAngle=0,this.myHeightOffsetVRWithFloor=null,this.myHeightOffsetVRWithoutFloor=null,this.myHeightOffsetNonVR=null,this.myNextEnterSessionFloorHeight=null,this.myEnterSessionFloorHeight=null,this.myRotateFeetKeepUp=!1,this.myForeheadExtraHeight=0,this.myDebugActive=!1}};PP.PlayerHeadManager=class{constructor(e=new PP.PlayerHeadManagerParams){this._myParams=e,this._myCurrentHead=PP.myPlayerObjects.myNonVRHead,this._mySessionChangeResyncHeadTransform=null,this._myBlurRecoverHeadTransform=null,this._myCurrentHeadTransformQuat=PP.quat2_create(),this._myPreviousHeadTransformQuat=PP.quat2_create(),this._myDelaySessionChangeResyncCounter=0,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer=new PP.Timer(5,!1),this._myVisibilityHidden=!1,this._mySessionActive=!1,this._mySessionBlurred=!1,this._myIsSyncedDelayCounter=0,this._myActive=!0,this._myResyncCounterFrames=3,this._myIsSyncedDelayCounterFrames=1}start(){this._updateHeightOffset(),WL.xrSession&&this._onXRSessionStart(!0,WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this,!1)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}setActive(e){this._myActive=e}getParams(){return this._myParams}paramsUpdated(){this._updateHeightOffset()}getPlayer(){return PP.myPlayerObjects.myPlayer}getHead(){return this._myCurrentHead}getHeightHead(){return this.getHeightEyes()+this._myParams.myForeheadExtraHeight}getHeightEyes(){}getTransformFeetQuat(e=PP.quat2_create()){}getTransformHeadQuat(e=PP.quat2_create()){return this.getHead().pp_getTransformQuat(e)}getPositionFeet(e=PP.vec3_create()){}getPositionHead(e=PP.vec3_create()){return this._myCurrentHead.pp_getPosition(e)}getRotationFeetQuat(e=PP.quat_create()){}getRotationHeadQuat(e=PP.quat_create()){return this.getHead().pp_getRotationQuat(e)}isSynced(){return this._myIsSyncedDelayCounter==0&&this._myDelaySessionChangeResyncCounter==0&&this._myDelayBlurEndResyncCounter==0&&!this._myDelayBlurEndResyncTimer.isRunning()&&!this._mySessionBlurred}setHeight(e,t=!1){if((!t||!this._mySessionActive)&&(this._myParams.myHeightOffsetNonVR=e),!t||this._mySessionActive){this._myParams.myHeightOffsetVRWithoutFloor=e,this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0);let n=PP.XRUtils.isReferenceSpaceLocalFloor()||PP.XRUtils.isDeviceEmulated();this._mySessionActive&&n?this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(e-this.getHeight()):this._mySessionActive||(this._myParams.myNextEnterSessionFloorHeight=e)}this._updateHeightOffset()}moveFeet(e){}moveHead(e){this.moveFeet(e)}teleportPositionHead(e){}teleportPositionFeet(e){}teleportPlayerToHeadTransformQuat(e){}rotateFeetQuat(e,t=null){}rotateHeadQuat(e){}canRotateFeet(){return!0}canRotateHead(){return!this._mySessionActive}setRotationFeetQuat(e,t=null){}setRotationHeadQuat(){}lookAtFeet(e,t=null,n=null){}lookToFeet(e,t=null,n=null){}lookAtHead(e,t=null){}lookToHead(e,t=null){}update(e){this._myIsSyncedDelayCounter!=0&&(this._myIsSyncedDelayCounter--,this._myIsSyncedDelayCounter=Math.max(0,this._myIsSyncedDelayCounter)),this._myDelaySessionChangeResyncCounter>0&&(this._myDelaySessionChangeResyncCounter--,this._myDelaySessionChangeResyncCounter==0&&(this._sessionChangeResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames)),this._myDelayBlurEndResyncCounter>0&&!this._myDelayBlurEndResyncTimer.isRunning()&&(this._myDelayBlurEndResyncCounter--,this._myDelayBlurEndResyncCounter==0&&(this._blurEndResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames)),this._myDelayBlurEndResyncTimer.isRunning()&&(this._myDelayBlurEndResyncCounter>0?this._myDelayBlurEndResyncCounter--:(this._myDelayBlurEndResyncTimer.update(e),this._myDelayBlurEndResyncTimer.isDone()&&(this._blurEndResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames))),this.isSynced()&&(this._myPreviousHeadTransformQuat.quat2_copy(this._myCurrentHeadTransformQuat),this._myCurrentHead.pp_getTransformQuat(this._myCurrentHeadTransformQuat)),this._myParams.myDebugActive&&this._debugUpdate(e)}_debugUpdate(e){PP.myDebugVisualManager.drawLineEnd(0,this.getPositionFeet(),this.getPositionHead(),PP.vec4_create(1,0,0,1),.01),console.error(this.getHeightEyes())}};PP.PlayerHeadManager.prototype.getHeightEyes=function(){let i=PP.vec3_create();return function(){return i=this._myCurrentHead.pp_getPosition(i),this._getPositionHeight(i)}}();PP.PlayerHeadManager.prototype.getTransformFeetQuat=function(){let i=PP.vec3_create(),e=PP.quat_create();return function(n=PP.quat2_create()){return n.quat2_setPositionRotationQuat(this.getPositionFeet(i),this.getRotationFeetQuat(e)),n}}();PP.PlayerHeadManager.prototype.getRotationFeetQuat=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n=PP.quat_create()){i=PP.myPlayerObjects.myPlayer.pp_getUp(i),e=this._myCurrentHead.pp_getForward(e);let a=e.vec3_angle(i),s=10;return a<s?e=this._myCurrentHead.pp_getDown(e):a>180-s&&(e=this._myCurrentHead.pp_getUp(e)),e=e.vec3_removeComponentAlongAxis(i,e),e.vec3_normalize(e),n.quat_setUp(i,e),n}}();PP.PlayerHeadManager.prototype.getPositionFeet=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n=PP.vec3_create()){i=this._myCurrentHead.pp_getPosition(i);let a=this._getPositionHeight(i);return e=PP.myPlayerObjects.myPlayer.pp_getUp(e),n=i.vec3_sub(e.vec3_scale(a,n),n),n}}();PP.PlayerHeadManager.prototype.moveFeet=function(e){PP.myPlayerObjects.myPlayer.pp_translate(e)};PP.PlayerHeadManager.prototype.rotateFeetQuat=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.quat_create(),a=PP.quat_create(),s=PP.quat_create(),o=PP.vec3_create(),l=PP.quat_create(),m=PP.vec3_create(),c=PP.vec3_create();return function(y,u=null){y.quat_getAngleRadians()<=1e-5||(t=this._myCurrentHead.pp_getPosition(t),i=PP.myPlayerObjects.myPlayer.pp_getUp(i),e=y.quat_getAxis(e),!e.vec3_isOnAxis(i)&&(u==null&&this._myParams.myFeetRotationKeepUp||u)?(n=this.getRotationFeetQuat(n),a=n.quat_rotateQuat(y,a),o=a.quat_getForward(o),s.quat_copy(a),s.quat_setUp(i,o),l=n.quat_rotationToQuat(s,l)):l.quat_copy(y),PP.myPlayerObjects.myPlayer.pp_rotateAroundQuat(l,t),m=this._myCurrentHead.pp_getPosition(m),c=t.vec3_sub(m,c),c.vec3_length()>1e-5&&this.moveFeet(c))}}();PP.PlayerHeadManager.prototype.rotateHeadQuat=function(){let i=PP.quat_create(),e=PP.vec3_create();return function(n){this.canRotateHead()&&(this._myCurrentHead.pp_rotateQuat(n),i=this._myCurrentHead.pp_getRotationQuat(i),PP.myPlayerObjects.myHead.pp_setRotationQuat(i),i=i.quat_rotateAxisRadians(Math.PI,i.quat_getUp(e),i),PP.myPlayerObjects.myNonVRCamera.pp_setRotationQuat(i))}}();PP.PlayerHeadManager.prototype.setRotationFeetQuat=function(){let i=PP.quat_create(),e=PP.quat_create();return function(n,a=null){i=this.getRotationFeetQuat(i),e=i.quat_rotationToQuat(n,e),this.rotateFeetQuat(e,a)}}();PP.PlayerHeadManager.prototype.setRotationHeadQuat=function(){let i=PP.quat_create(),e=PP.quat_create();return function(n){i=this.getRotationHeadQuat(i),e=i.quat_rotationToQuat(n,e),this.rotateHeadQuat(e)}}();PP.PlayerHeadManager.prototype.teleportPositionHead=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n){i=this._myCurrentHead.pp_getPosition(i),e=n.vec3_sub(i,e),this.moveFeet(e)}}();PP.PlayerHeadManager.prototype.teleportPositionFeet=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n){i=this.getPositionFeet(i),e=n.vec3_sub(i,e),this.moveFeet(e)}}();PP.PlayerHeadManager.prototype.teleportPlayerToHeadTransformQuat=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.quat_create();return function(r){i=r.quat2_getPosition(i),e=PP.myPlayerObjects.myPlayer.pp_getUp(e),t=PP.myPlayerObjects.myPlayer.pp_getPosition(t).vec3_removeComponentAlongAxis(e,t),n=i.vec3_removeComponentAlongAxis(e,n),a=n.vec3_sub(t,a),PP.myPlayerObjects.myPlayer.pp_translate(a),s=PP.myPlayerObjects.myPlayer.pp_getForward(s),o=r.quat2_getForward(o),l=o.vec3_negate(l),m=s.vec3_rotationToPivotedQuat(l,e,m),PP.myPlayerObjects.myPlayer.pp_rotateQuat(m)}}();PP.PlayerHeadManager.prototype.lookAtFeet=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a=null,s=null){e=this.getPositionFeet(e),i=n.vec3_sub(e,i).vec3_normalize(i),this.lookToFeet(i,a,s)}}();PP.PlayerHeadManager.prototype.lookToFeet=function(){let i=PP.quat_create();return function(t,n=null,a=null){i=this.getRotationFeetQuat(i),i.quat_setForward(t,n),this.setRotationFeetQuat(i,a)}}();PP.PlayerHeadManager.prototype.lookAtHead=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a=null){e=this.getPositionHead(e),i=n.vec3_sub(e,i).vec3_normalize(i),this.lookToHead(i,a)}}();PP.PlayerHeadManager.prototype.lookToHead=function(){let i=PP.quat_create();return function(t,n=null){i=this.getRotationHeadQuat(i),i.quat_setForward(t,n),this.setRotationHeadQuat(i)}}();PP.PlayerHeadManager.prototype._getPositionHeight=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create();return function(a){i=PP.myPlayerObjects.myPlayer.pp_getPosition(i),e=PP.myPlayerObjects.myPlayer.pp_getUp(e),t=a.vec3_sub(i,t).vec3_componentAlongAxis(e,t);let s=t.vec3_length();return e.vec3_isConcordant(t)||(s=-s),s}}();PP.PlayerHeadManager.prototype._onXRSessionStart=function(){return function(e,t){if(this._myBlurRecoverHeadTransform=null,this._myVisibilityHidden=!1,this._myDelaySessionChangeResyncCounter=0,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer.reset(),t.requestReferenceSpace(WebXR.refSpace).then(function(n){n.addEventListener!=null&&n.addEventListener("reset",this._onViewReset.bind(this))}.bind(this)),t.addEventListener("visibilitychange",function(n){n.session.visibilityState!="visible"?(this._mySessionBlurred||this._onXRSessionBlurStart(n.session),this._myVisibilityHidden=t.visibilityState=="hidden"):(this._mySessionBlurred&&this._onXRSessionBlurEnd(n.session),this._myVisibilityHidden=!1)}.bind(this)),this._myParams.mySessionChangeResyncEnabled&&!e&&this._myActive){if(this._myDelaySessionChangeResyncCounter==0){let n=this._myCurrentHead;this._mySessionChangeResyncHeadTransform=n.pp_getTransformQuat()}this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames}else this._myDelaySessionChangeResyncCounter=0,this._mySessionChangeResyncHeadTransform=null;this._myCurrentHead=PP.myPlayerObjects.myVRHead,this._mySessionActive=!0,this._mySessionBlurred=!1,this._myActive&&this._updateHeightOffset()}}();PP.PlayerHeadManager.prototype._onXRSessionEnd=function(){return function(e){if(this._myParams.mySessionChangeResyncEnabled&&this._myActive){if(this._myDelaySessionChangeResyncCounter==0){let t=this._myCurrentHead.pp_getTransformQuat();this._myBlurRecoverHeadTransform!=null&&(t=this._myBlurRecoverHeadTransform),this._mySessionChangeResyncHeadTransform=t}this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames}else this._myDelaySessionChangeResyncCounter=0,this._mySessionChangeResyncHeadTransform=null;this._myBlurRecoverHeadTransform=null,this._myVisibilityHidden=!1,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer.reset(),this._myCurrentHead=PP.myPlayerObjects.myNonVRHead,this._mySessionActive=!1,this._mySessionBlurred=!1,this._myActive&&this._updateHeightOffset()}}();PP.PlayerHeadManager.prototype._onXRSessionBlurStart=function(){return function(e){this._myActive&&(this._myParams.myBlurEndResyncEnabled&&this._myBlurRecoverHeadTransform==null&&this._mySessionActive?this._myDelaySessionChangeResyncCounter>0?this._myBlurRecoverHeadTransform=this._mySessionChangeResyncHeadTransform:this._myBlurRecoverHeadTransform=this._myCurrentHead.pp_getTransformQuat():(!this._mySessionActive||!this._myParams.myBlurEndResyncEnabled)&&(this._myBlurRecoverHeadTransform=null)),this._myDelayBlurEndResyncCounter=0,this._mySessionBlurred=!0}}();PP.PlayerHeadManager.prototype._onXRSessionBlurEnd=function(){return function(e){this._myActive&&(this._myDelaySessionChangeResyncCounter==0?this._myParams.myBlurEndResyncEnabled&&this._myBlurRecoverHeadTransform!=null&&this._mySessionActive?(this._myDelayBlurEndResyncCounter=this._myResyncCounterFrames,this._myVisibilityHidden):(this._myBlurRecoverHeadTransform=null,this._myDelayBlurEndResyncCounter=0):(this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames,this._myBlurRecoverHeadTransform=null)),this._mySessionBlurred=!1}}();PP.PlayerHeadManager.prototype._onViewReset=function(){return function(){this._myActive&&this._myParams.myResetTransformOnViewResetEnabled&&this._mySessionActive&&this.isSynced()&&this.teleportPlayerToHeadTransformQuat(this._myPreviousHeadTransformQuat)}}();PP.PlayerHeadManager.prototype._blurEndResync=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.quat_create();return function(){this._myBlurRecoverHeadTransform!=null&&(this._mySessionChangeResyncHeadTransform!=null?(this._myBlurRecoverHeadTransform=null,this._sessionChangeResync()):(i=PP.myPlayerObjects.myPlayer.pp_getUp(i),e=this._myCurrentHead.pp_getPosition(e),t=this._myBlurRecoverHeadTransform.quat2_getPosition(t),n=e.vec3_removeComponentAlongAxis(i,n),a=t.vec3_removeComponentAlongAxis(i,a),s=a.vec3_sub(n,s),this.moveFeet(s),o=this._myBlurRecoverHeadTransform.quat2_getForward(o),l=this._myCurrentHead.pp_getForward(l),m=l.vec3_rotationToPivotedQuat(o,i,m),this._myParams.myBlurEndResyncRotation&&this.rotateFeetQuat(m),this._myBlurRecoverHeadTransform=null))}}();PP.PlayerHeadManager.prototype._sessionChangeResync=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.quat_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=PP.vec3_create(),p=PP.vec3_create(),d=PP.vec3_create(),_=PP.vec3_create(),h=PP.quat_create();return function(){if(this._myBlurRecoverHeadTransform==null&&this._mySessionChangeResyncHeadTransform!=null){if(this._mySessionActive){i=this._myCurrentHead.pp_getPosition(i),e=this._mySessionChangeResyncHeadTransform.quat2_getPosition(e),t=this._mySessionChangeResyncHeadTransform.quat2_getRotationQuat(t),n=PP.myPlayerObjects.myPlayer.pp_getUp(n),a=i.vec3_removeComponentAlongAxis(n,a),s=e.vec3_removeComponentAlongAxis(n,s),o=s.vec3_sub(a,o),this.moveFeet(o);let T=PP.XRUtils.isReferenceSpaceLocalFloor()||PP.XRUtils.isDeviceEmulated();if(this._myParams.myEnterSessionResyncHeight||this._myParams.myNextEnterSessionResyncHeight){this._myParams.myNextEnterSessionResyncHeight=!1;let v=this._getPositionHeight(e),f=this._getPositionHeight(i);this._myParams.myHeightOffsetVRWithoutFloor=v+this._myParams.myForeheadExtraHeight,this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0),this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(v-f),this._updateHeightOffset()}else if(T&&(this._myParams.myNextEnterSessionFloorHeight!=null||this._myParams.myEnterSessionFloorHeight!=null)){let v=this._myParams.myNextEnterSessionFloorHeight!=null?this._myParams.myNextEnterSessionFloorHeight:this._myParams.myEnterSessionFloorHeight;v-=this._myParams.myForeheadExtraHeight;let f=this._getPositionHeight(i);this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0),this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(v-f),this._updateHeightOffset()}this._resyncHeadRotationForward(t)}else{if(n=PP.myPlayerObjects.myPlayer.pp_getUp(n),e=this._mySessionChangeResyncHeadTransform.quat2_getPosition(e),s=e.vec3_removeComponentAlongAxis(n,s),r=PP.myPlayerObjects.myPlayer.pp_getPosition(r),y=s.vec3_add(r.vec3_componentAlongAxis(n,y),y),PP.myPlayerObjects.myPlayer.pp_setPosition(y),PP.myPlayerObjects.myNonVRCamera.pp_resetPositionLocal(),this._myParams.myExitSessionResyncHeight){let T=this._getPositionHeight(e);this._myParams.myHeightOffsetNonVR=T+this._myParams.myForeheadExtraHeight,this._updateHeightOffset()}if(t=this._mySessionChangeResyncHeadTransform.quat2_getRotationQuat(t),this._myParams.myExitSessionRemoveRightTilt||this._myParams.myExitSessionAdjustMaxVerticalAngle||!this._myParams.myExitSessionResyncVerticalAngle){if(l=t.quat_getForward(l),m=t.quat_getUp(m),u=l.vec3_cross(n,u),u.vec3_normalize(u),!m.vec3_isConcordant(n)){let T=l.vec3_angle(n),v=45;(T>180-v||T<v)&&u.vec3_negate(u)}u.vec3_isZero(1e-6)&&(u=t.quat_getRight(u)),d=u.vec3_cross(l,d),d.vec3_normalize(d),_=d.vec3_cross(u,_),_.vec3_normalize(_),h.quat_fromAxes(u.vec3_negate(p),d,_),t.quat_copy(h)}if(this._myParams.myExitSessionAdjustMaxVerticalAngle||!this._myParams.myExitSessionResyncVerticalAngle){m=t.quat_getUp(m),c=t.quat_getRight(c);let T=Math.max(0,this._myParams.myExitSessionMaxVerticalAngle-1e-4);this._myParams.myExitSessionResyncVerticalAngle||(T=0);let v=Math.pp_angleClamp(m.vec3_angleSigned(n,c));if(Math.abs(v)>T){let f=(Math.abs(v)-T)*Math.pp_sign(v);t=t.quat_rotateAxis(f,c,t)}}this.setRotationHeadQuat(t)}this._mySessionActive&&(this._myParams.myNextEnterSessionFloorHeight=null,this._myFirstEnterSessionResyncDone=!0),this._mySessionChangeResyncHeadTransform=null}}}();PP.PlayerHeadManager.prototype._resyncHeadRotationForward=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.quat_create();return function(s){i=PP.myPlayerObjects.myPlayer.pp_getUp(i),e=s.quat_getForward(e),t=s.quat_getUp(t),n.quat_copy(s),n.quat_setUp(i,e),t.vec3_isConcordant(i)||n.quat_rotateAxis(180,i,n),this.setRotationFeetQuat(n)}}();PP.PlayerHeadManager.prototype._updateHeightOffset=function(){return function(){this._mySessionActive?PP.XRUtils.isDeviceEmulated()?this._setPlayerPivotHeightOffset(0,0):PP.XRUtils.isReferenceSpaceLocalFloor()?this._setPlayerPivotHeightOffset(this._myParams.myHeightOffsetVRWithFloor,0):this._setPlayerPivotHeightOffset(this._myParams.myHeightOffsetVRWithoutFloor,this._myParams.myForeheadExtraHeight):this._setPlayerPivotHeightOffset(this._myParams.myHeightOffsetNonVR,this._myParams.myForeheadExtraHeight)}}();PP.PlayerHeadManager.prototype._setPlayerPivotHeightOffset=function(){let i=PP.vec3_create();return function(t,n){t!=null&&(i=PP.myPlayerObjects.myPlayerPivot.pp_getPositionLocal(i),PP.myPlayerObjects.myPlayerPivot.pp_setPositionLocal([i[0],t-n,i[2]]))}}();Object.defineProperty(PP.PlayerHeadManager.prototype,"getHeightEyes",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"getTransformFeetQuat",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"getPositionFeet",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"moveFeet",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"rotateFeetQuat",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"rotateHeadQuat",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"teleportPositionHead",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"teleportPositionFeet",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"teleportPlayerToHeadTransformQuat",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"_getPositionHeight",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"_onXRSessionStart",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"_onXRSessionEnd",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"_onXRSessionBlurStart",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"_onXRSessionBlurEnd",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"_onViewReset",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"_blurEndResync",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"_sessionChangeResync",{enumerable:!1});Object.defineProperty(PP.PlayerHeadManager.prototype,"_setPlayerPivotHeightOffset",{enumerable:!1})});var Ua=S(()=>{PP.PlayerTransformManagerSyncFlag={BODY_COLLIDING:0,HEAD_COLLIDING:1,FAR:2,FLOATING:3};PP.PlayerTransformManagerParams=class{constructor(){this.myPlayerHeadManager=null,this.myMovementCollisionCheckParams=null,this.myTeleportCollisionCheckParams=null,this.myTeleportCollisionCheckParamsCopyFromMovement=!1,this.myTeleportCollisionCheckParamsCheck360=!1,this.mySyncEnabledFlagMap=new Map,this.mySyncEnabledFlagMap.set(PP.PlayerTransformManagerSyncFlag.BODY_COLLIDING,!0),this.mySyncEnabledFlagMap.set(PP.PlayerTransformManagerSyncFlag.HEAD_COLLIDING,!0),this.mySyncEnabledFlagMap.set(PP.PlayerTransformManagerSyncFlag.FAR,!0),this.mySyncEnabledFlagMap.set(PP.PlayerTransformManagerSyncFlag.FLOATING,!0),this.mySyncPositionFlagMap=new Map,this.mySyncPositionFlagMap.set(PP.PlayerTransformManagerSyncFlag.BODY_COLLIDING,!0),this.mySyncPositionFlagMap.set(PP.PlayerTransformManagerSyncFlag.HEAD_COLLIDING,!1),this.mySyncPositionFlagMap.set(PP.PlayerTransformManagerSyncFlag.FAR,!0),this.mySyncPositionFlagMap.set(PP.PlayerTransformManagerSyncFlag.FLOATING,!0),this.mySyncPositionHeadFlagMap=new Map,this.mySyncPositionHeadFlagMap.set(PP.PlayerTransformManagerSyncFlag.BODY_COLLIDING,!1),this.mySyncPositionHeadFlagMap.set(PP.PlayerTransformManagerSyncFlag.HEAD_COLLIDING,!0),this.mySyncPositionHeadFlagMap.set(PP.PlayerTransformManagerSyncFlag.FAR,!1),this.mySyncPositionHeadFlagMap.set(PP.PlayerTransformManagerSyncFlag.FLOATING,!1),this.mySyncRotationFlagMap=new Map,this.mySyncRotationFlagMap.set(PP.PlayerTransformManagerSyncFlag.BODY_COLLIDING,!1),this.mySyncRotationFlagMap.set(PP.PlayerTransformManagerSyncFlag.HEAD_COLLIDING,!1),this.mySyncRotationFlagMap.set(PP.PlayerTransformManagerSyncFlag.FAR,!1),this.mySyncRotationFlagMap.set(PP.PlayerTransformManagerSyncFlag.FLOATING,!1),this.mySyncHeightFlagMap=new Map,this.mySyncHeightFlagMap.set(PP.PlayerTransformManagerSyncFlag.BODY_COLLIDING,!1),this.mySyncHeightFlagMap.set(PP.PlayerTransformManagerSyncFlag.HEAD_COLLIDING,!1),this.mySyncHeightFlagMap.set(PP.PlayerTransformManagerSyncFlag.FAR,!1),this.mySyncHeightFlagMap.set(PP.PlayerTransformManagerSyncFlag.FLOATING,!1),this.myIsLeaningValidAboveDistance=!1,this.myLeaningValidDistance=0,this.myIsFloatingValidIfVerticalMovement=!1,this.myIsFloatingValidIfVerticalMovementAndRealOnGround=!1,this.myIsFloatingValidIfRealOnGround=!1,this.myIsFloatingValidIfSteepGround=!1,this.myIsFloatingValidIfVerticalMovementAndSteepGround=!1,this.myFloatingSplitCheckEnabled=!1,this.myFloatingSplitCheckMaxLength=0,this.myFloatingSplitCheckMaxSteps=null,this.myFloatingSplitCheckStepEqualLength=!1,this.myFloatingSplitCheckStepEqualLengthMinLength=0,this.myIsMaxDistanceFromRealToSyncEnabled=!1,this.myMaxDistanceFromRealToSync=0,this.myHeadRadius=0,this.myHeadCollisionBlockLayerFlags=new PP.PhysicsLayerFlags,this.myHeadCollisionObjectsToIgnore=[],this.myRotateOnlyIfSynced=!1,this.myResetRealResetRotationIfUpChanged=!0,this.myRealMovementAllowVerticalAdjustments=!1,this.myUpdateRealPositionValid=!1,this.myUpdatePositionValid=!1,this.myMinHeight=null,this.myMaxHeight=null,this.myIsBodyCollidingWhenHeightBelowValue=null,this.myIsBodyCollidingWhenHeightAboveValue=null,this.myIsBodyCollidingExtraCheckCallback=null,this.myIsLeaningExtraCheckCallback=null,this.myIsHoppingExtraCheckCallback=null,this.myIsFarExtraCheckCallback=null,this.myResetToValidOnEnterSession=!1,this.myResetToValidOnExitSession=!1,this.myAlwaysResetRealPositionNonVR=!1,this.myAlwaysResetRealRotationNonVR=!1,this.myAlwaysResetRealHeightNonVR=!1,this.myAlwaysResetRealPositionVR=!1,this.myAlwaysResetRealRotationVR=!1,this.myAlwaysResetRealHeightVR=!1,this.myNeverResetRealPositionNonVR=!1,this.myNeverResetRealRotationNonVR=!1,this.myNeverResetRealHeightNonVR=!1,this.myNeverResetRealPositionVR=!1,this.myNeverResetRealRotationVR=!1,this.myNeverResetRealHeightVR=!1,this.myResetRealOnMove=!1,this.myResetRealOnTeleport=!1,this.mySyncPositionDisabled=!1,this.myDebugActive=!1}};PP.PlayerTransformManager=class{constructor(e){this._myParams=e,this._myRealMovementCollisionCheckParams=null,this._generateRealMovementParamsFromMovementParams(),this._myCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._myRealCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._myHeadCollisionCheckParams=null,this._setupHeadCollisionCheckParams(),this._myValidPosition=PP.vec3_create(),this._myValidRotationQuat=new PP.quat_create,this._myValidHeight=0,this._myValidPositionHead=PP.vec3_create(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,this._myLastValidMovementDirection=PP.vec3_create(),this._myIsRealPositionValid=!1,this._myIsPositionValid=!1,this._myResetRealOnSynced=!1}start(){this.resetToReal(!0),WL.xrSession&&this._onXRSessionStart(!0,WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this,!1)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}update(e){}move(e,t=null,n=!1){}teleportPosition(e,t=null,n=!1){}teleportTransformQuat(e,t=null,n=!1){}rotateQuat(e){}setRotationQuat(e){}setHeight(e,t=!1){}getPlayer(){return this._myParams.myPlayerHeadManager.getPlayer()}getHead(){return this._myParams.myPlayerHeadManager.getHead()}getTransformQuat(e=PP.quat2_create()){return e.quat2_setPositionRotationQuat(this.getPosition(this._myValidPosition),this.getRotationQuat(this._myValidRotationQuat))}getPosition(e=PP.vec3_create()){return e.vec3_copy(this._myValidPosition)}getRotationQuat(e=PP.quat_create()){return e.quat_copy(this._myValidRotationQuat)}getPositionHead(e=PP.vec3_create()){return e.vec3_copy(this._myValidPositionHead)}getTransformHeadQuat(e=PP.quat2_create()){return e.quat2_setPositionRotationQuat(this.getPositionHead(this._myValidPositionHead),this.getRotationQuat(this._myValidRotationQuat))}getHeight(){return this._myValidHeight}getTransformRealQuat(e=PP.quat2_create()){return this.getPlayerHeadManager().getTransformFeetQuat(e)}getTransformHeadRealQuat(e=PP.quat2_create()){return this.getPlayerHeadManager().getTransformHeadQuat(e)}getPositionReal(e=PP.vec3_create()){return this.getPlayerHeadManager().getPositionFeet(e)}getPositionHeadReal(e=PP.vec3_create()){return this.getPlayerHeadManager().getPositionHead(e)}getRotationRealQuat(e=PP.quat_create()){return this.getPlayerHeadManager().getRotationFeetQuat(e)}getHeightReal(){return this._myParams.myPlayerHeadManager.getHeightHead()}isSynced(e=null){let t=this.isBodyColliding()&&(e==null||e.get(PP.PlayerTransformManagerSyncFlag.BODY_COLLIDING)),n=this.isHeadColliding()&&(e==null||e.get(PP.PlayerTransformManagerSyncFlag.HEAD_COLLIDING)),a=this.isFar()&&(e==null||e.get(PP.PlayerTransformManagerSyncFlag.FAR)),s=this.isFloating()&&(e==null||e.get(PP.PlayerTransformManagerSyncFlag.FLOATING));return!t&&!n&&!a&&!s}resetReal(e=!0,t=!0,n=!0,a=!1){}resetHeadToReal(){this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead)}updateReal(){this._updateReal(0,!1)}resetToReal(e=!1){this._myValidPosition=this.getPositionReal(this._myValidPosition),this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead),this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat),this._myValidHeight=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight),e&&this._updateReal(0,!1)}isBodyColliding(){return this._myIsBodyColliding}isHeadColliding(){return this._myIsHeadColliding}isFloating(){return this.isLeaning()||this.isHopping()}isHopping(){return this._myIsHopping}isLeaning(){return this._myIsLeaning}isHopping(){return this._myIsHopping}isFar(){return this._myIsFar}getDistanceToReal(){}getDistanceToRealHead(){}getPlayerHeadManager(){return this._myParams.myPlayerHeadManager}getParams(){return this._myParams}getMovementCollisionCheckParams(){return this._myParams.myMovementCollisionCheckParams}getTeleportCollisionCheckParams(){return this._myParams.myTeleportCollisionCheckParams}collisionCheckParamsUpdated(){this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._generateRealMovementParamsFromMovementParams()}isPositionValid(){return this._myIsPositionValid}isRealPositionValid(){return this._myIsRealPositionValid}getCollisionRuntimeParams(){return this._myCollisionRuntimeParams}getRealCollisionRuntimeParams(){return this._myRealCollisionRuntimeParams}_updateCollisionHeight(){let e=this.getHeight(),t=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight);this._myParams.myMovementCollisionCheckParams.myHeight=e,this._myParams.myTeleportCollisionCheckParams.myHeight=e,this._myRealMovementCollisionCheckParams.myHeight=t}_setupHeadCollisionCheckParams(){this._myHeadCollisionCheckParams=new PP.CollisionCheckParams;let e=this._myHeadCollisionCheckParams;e.myRadius=this._myParams.myHeadRadius,e.myDistanceFromFeetToIgnore=0,e.myDistanceFromHeadToIgnore=0,e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.myHorizontalMovementCheckEnabled=!0,e.myHorizontalMovementRadialStepAmount=1,e.myHorizontalMovementCheckDiagonalOutward=!0,e.myHorizontalMovementCheckDiagonalInward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!0,e.myHorizontalPositionCheckEnabled=!0,e.myHalfConeAngle=180,e.myHalfConeSliceAmount=3,e.myCheckConeBorder=!0,e.myCheckConeRay=!0,e.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!1,e.myHorizontalPositionCheckVerticalDirectionType=0,e.myHeight=e.myRadius,e.myPositionOffsetLocal.vec3_set(0,-e.myRadius/2,0),e.myCheckHeight=!0,e.myCheckHeightVerticalMovement=!0,e.myCheckHeightVerticalPosition=!0,e.myHeightCheckStepAmountMovement=2,e.myHeightCheckStepAmountPosition=2,e.myCheckHeightTopMovement=!0,e.myCheckHeightTopPosition=!0,e.myCheckVerticalStraight=!0,e.myCheckVerticalFixedForwardEnabled=!0,e.myCheckVerticalFixedForward=PP.vec3_create(0,0,1),e.myCheckHorizontalFixedForwardEnabled=!0,e.myCheckHorizontalFixedForward=PP.vec3_create(0,0,1),e.myVerticalMovementCheckEnabled=!0,e.myVerticalPositionCheckEnabled=!0,e.myGroundCircumferenceAddCenter=!0,e.myGroundCircumferenceSliceAmount=6,e.myGroundCircumferenceStepAmount=2,e.myGroundCircumferenceRotationPerStep=30,e.myFeetRadius=e.myRadius,e.myHorizontalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myHorizontalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myVerticalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myVerticalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myDebugActive=!1,e.myDebugHorizontalMovementActive=!0,e.myDebugHorizontalPositionActive=!1,e.myDebugVerticalMovementActive=!1,e.myDebugVerticalPositionActive=!1,e.myDebugSlidingActive=!1,e.myDebugGroundInfoActive=!1,e.myDebugCeilingInfoActive=!1,e.myDebugRuntimeParamsActive=!1,e.myDebugMovementActive=!1}_generateTeleportParamsFromMovementParams(){this._myParams.myTeleportCollisionCheckParams==null&&(this._myParams.myTeleportCollisionCheckParams=new PP.CollisionCheckParams),this._myParams.myTeleportCollisionCheckParamsCheck360?this._myParams.myTeleportCollisionCheckParams=PP.CollisionCheckUtils.generate360TeleportParamsFromMovementParams(this._myParams.myMovementCollisionCheckParams,this._myParams.myTeleportCollisionCheckParams):this._myParams.myTeleportCollisionCheckParams.copy(this._myParams.myMovementCollisionCheckParams)}_generateRealMovementParamsFromMovementParams(){this._myRealMovementCollisionCheckParams==null&&(this._myRealMovementCollisionCheckParams=new PP.CollisionCheckParams);let e=this._myRealMovementCollisionCheckParams;e.copy(this._myParams.myMovementCollisionCheckParams),e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.mySlidingEnabled=!1,this._myParams.myRealMovementAllowVerticalAdjustments||(e.mySnapOnGroundEnabled=!1,e.mySnapOnCeilingEnabled=!1,e.myGroundPopOutEnabled=!1,e.myCeilingPopOutEnabled=!1,e.myAdjustVerticalMovementWithGroundAngleDownhill=!1,e.myAdjustVerticalMovementWithGroundAngleUphill=!1,e.myAdjustVerticalMovementWithCeilingAngleDownhill=!1,e.myAdjustVerticalMovementWithCeilingAngleUphill=!1,e.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,e.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,e.myVerticalMovementReduceEnabled=!1),e.myIsOnGroundIfInsideHit=!0,e.myDebugActive=!1,e.myDebugHorizontalMovementActive=!1,e.myDebugHorizontalPositionActive=!1,e.myDebugVerticalMovementActive=!1,e.myDebugVerticalPositionActive=!1,e.myDebugSlidingActive=!1,e.myDebugGroundInfoActive=!0,e.myDebugCeilingInfoActive=!0,e.myDebugRuntimeParamsActive=!1,e.myDebugMovementActive=!1}_onXRSessionStart(e,t){this._myParams.myResetToValidOnEnterSession&&(this._myResetRealOnSynced=!0)}_onXRSessionEnd(){this._myParams.myResetToValidOnExitSession&&(this._myResetRealOnSynced=!0)}_debugUpdate(e){PP.myDebugVisualManager.drawPoint(0,this._myValidPosition,PP.vec4_create(1,0,0,1),.05),PP.myDebugVisualManager.drawLineEnd(0,this._myValidPosition,this.getPositionReal(),PP.vec4_create(1,0,0,1),.05),PP.myDebugVisualManager.drawLine(0,this._myValidPosition,this._myValidRotationQuat.quat_getForward(),.15,PP.vec4_create(0,1,0,1),.025),PP.myDebugVisualManager.drawPoint(0,this._myValidPositionHead,PP.vec4_create(1,1,0,1),.05)}};PP.PlayerTransformManager.prototype.getDistanceToReal=function(){let i=PP.vec3_create();return function(){return i=this.getPositionReal(i),i.vec3_distance(this.getPosition())}}();PP.PlayerTransformManager.prototype.getDistanceToRealHead=function(){let i=PP.vec3_create();return function(){return i=this.getPositionHeadReal(i),i.vec3_distance(this.getPositionHead())}}();PP.PlayerTransformManager.prototype.resetReal=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.quat_create();return function(s=!0,o=!0,l=!0,m=!1){let c=this.getPlayerHeadManager();s&&c.teleportPositionFeet(this.getPosition(t)),i=this.getPlayerHeadManager().getRotationFeetQuat(n).quat_getUp(i),e=this.getRotationQuat(n).quat_getUp(e),(o||i.vec3_angle(e)>Math.PP_EPSILON_DEGREES&&this._myParams.myResetRealResetRotationIfUpChanged)&&c.setRotationFeetQuat(this.getRotationQuat(n),!1),l&&c.setHeight(this.getHeight(),!0),m&&this._updateReal(0,!1)}}();PP.PlayerTransformManager.prototype.update=function(){let i=PP.quat2_create(),e=new PP.CollisionRuntimeParams,t=PP.vec3_create(),n=PP.vec3_create(),a=PP.quat_create();return function(o){if(this._myResetRealOnSynced&&this.getPlayerHeadManager().isSynced()&&(this._myResetRealOnSynced=!1,PP.XRUtils.isSessionActive()?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)),this._updateReal(o),this._myParams.myUpdatePositionValid){i=this.getTransformQuat(i),t=i.quat2_getUp(t),a=i.quat2_getRotationQuat(a),n=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(t,n),n.vec3_isZero(1e-5)||(n.vec3_normalize(n),a.quat_setForward(n),i.quat2_setRotationQuat(a));let l=this._myParams.myMovementCollisionCheckParams.myDebugActive;this._myParams.myMovementCollisionCheckParams.myDebugActive=!1,PP.myCollisionCheck.positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,e),this._myParams.myMovementCollisionCheckParams.myDebugActive=l,this._myIsPositionValid=e.myIsPositionOk}this._myParams.myDebugActive&&this._debugUpdate(o)}}();PP.PlayerTransformManager.prototype._updateReal=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.quat2_create(),a=new PP.CollisionRuntimeParams,s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=PP.vec3_create(),p=PP.quat2_create(),d=PP.vec3_create(),_=PP.quat_create();return function(P,T=!0){if(this.getPlayerHeadManager().isSynced()){if(this._updateCollisionHeight(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,i=this.getPositionReal(t).vec3_sub(this.getPosition(e),i),i.vec3_length()>1e-4&&(this._myLastValidMovementDirection=i.vec3_normalize(this._myLastValidMovementDirection)),this._myParams.mySyncEnabledFlagMap.get(PP.PlayerTransformManagerSyncFlag.FAR)&&(this._myParams.myIsMaxDistanceFromRealToSyncEnabled&&i.vec3_length()>this._myParams.myMaxDistanceFromRealToSync?this._myIsFar=!0:this._myParams.myIsFarExtraCheckCallback!=null&&this._myParams.myIsFarExtraCheckCallback(this)&&(this._myIsFar=!0)),a.copy(this._myCollisionRuntimeParams),a.myIsOnGround=!0,n=this.getTransformQuat(n),s.vec3_copy(this._myValidPosition),this._myParams.mySyncEnabledFlagMap.get(PP.PlayerTransformManagerSyncFlag.BODY_COLLIDING)&&(PP.myCollisionCheck.move(i,n,this._myRealMovementCollisionCheckParams,a),!a.myHorizontalMovementCanceled&&!a.myVerticalMovementCanceled?Math.pp_clamp(this._myRealMovementCollisionCheckParams.myHeight,this._myParams.myIsBodyCollidingWhenHeightBelowValue,this._myParams.myIsBodyCollidingWhenHeightAboveValue)!=this._myRealMovementCollisionCheckParams.myHeight?this._myIsBodyColliding=!0:this._myParams.myIsBodyCollidingExtraCheckCallback!=null&&this._myParams.myIsBodyCollidingExtraCheckCallback(this)?this._myIsBodyColliding=!0:(this._myIsBodyColliding=!1,s.vec3_copy(a.myNewPosition)):this._myIsBodyColliding=!0),this._myParams.mySyncEnabledFlagMap.get(PP.PlayerTransformManagerSyncFlag.FLOATING)&&(this._myIsBodyColliding?i=t.vec3_sub(e,i):i=s.vec3_sub(e,i),a.copy(this._myCollisionRuntimeParams),p.quat2_setPositionRotationQuat(this._myValidPosition,this._myValidRotationQuat),PP.myCollisionCheck.updateSurfaceInfo(p,this._myRealMovementCollisionCheckParams,a),a.myIsOnGround)){c=n.quat2_getUp(c),r=i.vec3_componentAlongAxis(c,r);let v=!r.vec3_isZero(1e-5);if(!v||!this._myParams.myIsFloatingValidIfVerticalMovement){let f=1;if(l.vec3_copy(i),!i.vec3_isZero(1e-5)&&this._myParams.myFloatingSplitCheckEnabled){let V=i.vec3_length()/this._myParams.myFloatingSplitCheckMaxSteps;if(!this._myParams.myFloatingSplitCheckStepEqualLength||V<this._myParams.myFloatingSplitCheckStepEqualLengthMinLength){let D=this._myParams.myFloatingSplitCheckStepEqualLength?this._myParams.myFloatingSplitCheckStepEqualLengthMinLength:this._myParams.myFloatingSplitCheckMaxLength;f=Math.ceil(i.vec3_length()/D),f>1&&(l=l.vec3_normalize(l).vec3_scale(D,l),f=this._myParams.myFloatingSplitCheckMaxSteps!=null?Math.min(f,this._myParams.myFloatingSplitCheckMaxSteps):f),f=Math.max(1,f),f==1&&l.vec3_copy(i)}else f=this._myParams.myFloatingSplitCheckMaxSteps,f>1&&(l=l.vec3_normalize(l).vec3_scale(V,l))}let g=a.myGroundAngle<=this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4;y.vec3_zero(),u.vec3_copy(this._myValidPosition),a.copy(this._myCollisionRuntimeParams);let C=!1,M=!1,b=!1,A=!1;for(let V=0;V<f;V++)f==1||V!=f-1?m.vec3_copy(l):m=i.vec3_sub(y,m),u=u.vec3_add(m,u),p.quat2_setPositionRotationQuat(u,this._myValidRotationQuat),a.copy(this._myCollisionRuntimeParams),PP.myCollisionCheck.updateSurfaceInfo(p,this._myRealMovementCollisionCheckParams,a),y=y.vec3_add(m,y),a.myIsOnGround?(a.myGroundAngle>this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4&&(A=!0),C&&(M=!0),V==f-1&&(b=!0)):C=!0;let I=A&&g&&!this._myParams.myIsFloatingValidIfSteepGround&&(!v||!this._myParams.myIsFloatingValidIfVerticalMovementAndSteepGround);if(C||I?M?this._myIsHopping=!0:this._myIsLeaning=!0:(this._myIsLeaning=!1,this._myIsHopping=!1,this._myParams.myIsLeaningExtraCheckCallback!=null&&this._myParams.myIsLeaningExtraCheckCallback(this)?this._myIsLeaning=!0:this._myParams.myIsHoppingExtraCheckCallback!=null&&this._myParams.myIsHoppingExtraCheckCallback(this)&&(this._myIsHopping=!0)),this._myIsLeaning){let V=i.vec3_length();this._myParams.myIsLeaningValidAboveDistance&&V>this._myParams.myLeaningValidDistance&&(this._myIsLeaning=!1)}(this._myIsLeaning||this._myIsHopping)&&(b&&this._myParams.myIsFloatingValidIfRealOnGround?(this._myIsLeaning=!1,this._myIsHopping=!1):b&&v&&this._myParams.myIsFloatingValidIfVerticalMovementAndRealOnGround&&(this._myIsLeaning=!1,this._myIsHopping=!1))}}if(i=this.getPositionHeadReal(t).vec3_sub(this.getPositionHead(e),i),a.reset(),n=this.getTransformHeadQuat(n),o.vec3_copy(this._myValidPositionHead),this._myParams.mySyncEnabledFlagMap.get(PP.PlayerTransformManagerSyncFlag.HEAD_COLLIDING)&&(PP.myCollisionCheck.move(i,n,this._myHeadCollisionCheckParams,a),!a.myHorizontalMovementCanceled&&!a.myVerticalMovementCanceled?(this._myIsHeadColliding=!1,o.vec3_copy(a.myNewPosition)):this._myIsHeadColliding=!0),this.isSynced(this._myParams.mySyncPositionFlagMap)&&!this._myParams.mySyncPositionDisabled&&this._myValidPosition.vec3_copy(s),this.isSynced(this._myParams.mySyncPositionHeadFlagMap)&&(this._myValidPositionHead=this.getPositionHeadReal(o)),this.isSynced(this._myParams.mySyncRotationFlagMap)&&(this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat)),this.isSynced(this._myParams.mySyncHeightFlagMap)&&(this._myValidHeight=this._myRealMovementCollisionCheckParams.myHeight,this._updateCollisionHeight()),T)if(PP.XRUtils.isSessionActive()){let v=(this.isSynced(this._myParams.mySyncPositionFlagMap)||this._myParams.myAlwaysResetRealPositionVR)&&!this._myParams.myNeverResetRealPositionVR,f=(this.isSynced(this._myParams.mySyncRotationFlagMap)||this._myParams.myAlwaysResetRealRotationVR)&&!this._myParams.myNeverResetRealRotationVR,g=(this.isSynced(this._myParams.mySyncHeightFlagMap)||this._myParams.myAlwaysResetRealHeightVR)&&!this._myParams.myNeverResetRealHeightVR;this.resetReal(v,f,g,!1)}else{let v=(this.isSynced(this._myParams.mySyncPositionFlagMap)||this._myParams.myAlwaysResetRealPositionNonVR)&&!this._myParams.myNeverResetRealPositionNonVR,f=(this.isSynced(this._myParams.mySyncRotationFlagMap)||this._myParams.myAlwaysResetRealRotationNonVR)&&!this._myParams.myNeverResetRealRotationNonVR,g=(this.isSynced(this._myParams.mySyncHeightFlagMap)||this._myParams.myAlwaysResetRealHeightNonVR)&&!this._myParams.myNeverResetRealHeightNonVR;this.resetReal(v,f,g,!1)}if(this._myParams.myUpdateRealPositionValid){n=this.getTransformRealQuat(n),c=n.quat2_getUp(c),_=n.quat2_getRotationQuat(_),d=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(c,d),d.vec3_isZero(1e-5)||(d.vec3_normalize(d),_.quat_setForward(d),n.quat2_setRotationQuat(_));let v=this._myParams.myMovementCollisionCheckParams.myDebugActive;this._myParams.myMovementCollisionCheckParams.myDebugActive=!1,PP.myCollisionCheck.positionCheck(!0,n,this._myParams.myMovementCollisionCheckParams,this._myRealCollisionRuntimeParams),this._myIsRealPositionValid=this._myRealCollisionRuntimeParams.myIsPositionOk,this._myParams.myMovementCollisionCheckParams.myDebugActive=v}}}}();PP.PlayerTransformManager.prototype.move=function(){let i=PP.quat2_create(),e=PP.vec3_create();return function(n,a=null,s=!1){i=this.getTransformQuat(i),PP.myCollisionCheck.move(n,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),a?.copy(this._myCollisionRuntimeParams),s?e.vec3_copy(n):e.vec3_copy(this._myCollisionRuntimeParams.myFixedMovement),e.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(e,this._myValidPosition),this.getPlayerHeadManager().moveFeet(e)),this._myParams.myResetRealOnMove&&(this.isSynced()||(PP.XRUtils.isSessionActive()?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)))}}();PP.PlayerTransformManager.prototype.teleportPosition=function(){let i=PP.quat2_create();return function(e,t=null,n=!1){i=this.getTransformQuat(i),i.quat2_setPosition(e),this.teleportTransformQuat(i,t,n)}}();PP.PlayerTransformManager.prototype.teleportTransformQuat=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.quat_create(),n=PP.quat2_create(),a=PP.vec3_create();return function(s,o=null,l=!1){i=this.getPosition(i),e=s.quat2_getPosition(e),t=s.quat2_getRotationQuat(t),n.quat2_setPositionRotationQuat(i,t),PP.myCollisionCheck.teleport(e,n,this._myParams.myTeleportCollisionCheckParams,this._myCollisionRuntimeParams),o?.copy(this._myCollisionRuntimeParams),a.vec3_zero(),l?(a=e.vec3_sub(i,a),this.getPlayerHeadManager().setRotationFeetQuat(t)):this._myCollisionRuntimeParams.myTeleportCanceled||(a=this._myCollisionRuntimeParams.myFixedTeleportPosition.vec3_sub(i,a),this.getPlayerHeadManager().setRotationFeetQuat(t)),a.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(a,this._myValidPosition),this.getPlayerHeadManager().moveFeet(a)),this._myParams.myResetRealOnTeleport&&(this.isSynced()||(PP.XRUtils.isSessionActive()?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)))}}();PP.PlayerTransformManager.prototype.rotateQuat=function(){return function(e){this._myValidRotationQuat.quat_rotateQuat(e,this._myValidRotationQuat),this.getPlayerHeadManager().rotateFeetQuat(e)}}();PP.PlayerTransformManager.prototype.setRotationQuat=function(){let i=PP.quat_create();return function(t){i=this._myValidRotationQuat.quat_rotationToQuat(t,i),this.rotateQuat(i)}}();PP.PlayerTransformManager.prototype.setHeight=function(){let i=PP.quat2_create();return function(t,n=!1){let a=Math.pp_clamp(t,this._myParams.myMinHeight,this._myParams.myMaxHeight),s=this.getHeight();this._myValidHeight=a,this._updateCollisionHeight(),i=this.getTransformQuat(i),PP.myCollisionCheck.positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),this._myCollisionRuntimeParams.myIsPositionOk||n?this.getPlayerHeadManager().setHeight(this.getHeight(),!0):this._myValidHeight=s,this._updateCollisionHeight()}}()});var Na=S(()=>{PP.PlayerLocomotionRotateParams=class{constructor(){this.myPlayerHeadManager=null,this.myMaxRotationSpeed=0,this.myIsSnapTurn=!1,this.mySnapTurnOnlyVR=!1,this.mySmoothSnapActive=!0,this.mySmoothSnapSpeedDegrees=240,this.myRotationMinStickIntensityThreshold=0,this.mySnapTurnActivateThreshold=0,this.mySnapTurnResetThreshold=0,this.myClampVerticalAngle=!0,this.myMaxVerticalAngle=0,this.myHandedness=PP.Handedness.RIGHT}};PP.PlayerLocomotionRotate=class{constructor(e){this._myParams=e,this._mySnapCharge=!1,this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0,this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0}start(){}stop(){this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0,this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0}update(e){this._rotateHeadHorizontally(e),this._myParams.myPlayerHeadManager.canRotateHead()&&this._rotateHeadVertically(e)}};PP.PlayerLocomotionRotate.prototype._rotateHeadHorizontally=function(){let i=PP.vec3_create(),e=PP.quat_create();return function(n){i=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.quat_identity();let a=PP.myGamepads[this._myParams.myHandedness].getAxesInfo(PP.GamepadAxesID.THUMBSTICK).getAxes();if(!this._myParams.myIsSnapTurn||this._myParams.mySnapTurnOnlyVR&&!PP.XRUtils.isSessionActive()){if(Math.abs(a[0])>this._myParams.myRotationMinStickIntensityThreshold){let s=-a[0],o=Math.pp_lerp(0,this._myParams.myMaxRotationSpeed,Math.abs(s))*Math.pp_sign(s);e.quat_fromAxis(o*n,i)}}else if(!this._mySnapCharge)Math.abs(a.vec2_length())<this._myParams.mySnapTurnResetThreshold&&(this._mySnapCharge=!0);else if(!this._mySmoothSnapHorizontalRunning&&Math.abs(a[0])>this._myParams.mySnapTurnActivateThreshold){let s=-Math.pp_sign(a[0])*this._myParams.mySnapTurnAngle;this._myParams.mySmoothSnapActive?(this._mySmoothSnapHorizontalRunning=!0,this._mySmoothSnapHorizontalAngleToPerform=s):e.quat_fromAxis(s,i),this._mySnapCharge=!1}if(this._mySmoothSnapHorizontalRunning){let s=Math.pp_sign(this._mySmoothSnapHorizontalAngleToPerform)*(this._myParams.mySmoothSnapSpeedDegrees*n);Math.abs(s)>Math.abs(this._mySmoothSnapHorizontalAngleToPerform)-PP.LocomotionUtils.EPSILON_NUMBER&&(s=this._mySmoothSnapHorizontalAngleToPerform),e.quat_fromAxis(s,i),this._mySmoothSnapHorizontalAngleToPerform-=s,Math.abs(this._mySmoothSnapHorizontalAngleToPerform)<PP.LocomotionUtils.EPSILON_NUMBER&&(this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0)}e.quat_getAngle()>PP.LocomotionUtils.EPSILON_DEGREES&&(PP.myGamepads[PP.InputUtils.getOppositeHandedness(this._myParams.myHandedness)].getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).isPressed()?this._myParams.myPlayerHeadManager.rotateFeetQuat(e):this._myParams.myPlayerTransformManager.rotateQuat(e))}}();PP.PlayerLocomotionRotate.prototype._rotateHeadVertically=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.quat_create();return function(m){let c=this._myParams.myPlayerHeadManager.getHead();i=c.pp_getForward(i),e=c.pp_getUp(e),t=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(t),n=t.vec3_negate(n),a=i.vec3_cross(t,a);let r=1;i.vec3_angle(t)<r?a=e.vec3_negate(a).vec3_cross(t,a):i.vec3_angle(n)<r?a=e.vec3_cross(t,a):e.vec3_isConcordant(t)||a.vec3_negate(a),a.vec3_normalize(a);let y=PP.myGamepads[this._myParams.myHandedness].getAxesInfo(PP.GamepadAxesID.THUMBSTICK).getAxes(),u=0;if(!this._myParams.myIsSnapTurn||this._myParams.mySnapTurnOnlyVR&&!PP.XRUtils.isSessionActive()){if(Math.abs(y[1])>this._myParams.myRotationMinStickIntensityThreshold){let p=y[1];u=Math.pp_lerp(0,this._myParams.myMaxRotationSpeed,Math.abs(p))*Math.pp_sign(p)*m}}else if(!this._mySnapCharge)Math.abs(y.vec2_length())<this._myParams.mySnapTurnResetThreshold&&(this._mySnapCharge=!0);else if(!this._mySmoothSnapVerticalRunning&&Math.abs(y[1])>this._myParams.mySnapTurnActivateThreshold){u=Math.pp_sign(y[1])*this._myParams.mySnapTurnAngle;let p=Math.pp_angleClamp(e.vec3_angleSigned(t,a)),d=Math.round(p/this._myParams.mySnapTurnAngle),_=Math.pp_angleClamp(d*this._myParams.mySnapTurnAngle),h=-Math.pp_angleDistanceSigned(p,_);Math.abs(h)>1?Math.pp_sign(u)==Math.pp_sign(h)?u=h:u=-Math.pp_sign(h)*this._myParams.mySnapTurnAngle+h:Math.abs(h)>PP.LocomotionUtils.EPSILON_DEGREES&&(u+=h),this._myParams.mySmoothSnapActive&&(this._mySmoothSnapVerticalRunning=!0,this._mySmoothSnapVerticalAngleToPerform=u),this._mySnapCharge=!1}if(this._mySmoothSnapVerticalRunning&&(u=Math.pp_sign(this._mySmoothSnapVerticalAngleToPerform)*(this._myParams.mySmoothSnapSpeedDegrees*m),Math.abs(u)>Math.abs(this._mySmoothSnapVerticalAngleToPerform)-PP.LocomotionUtils.EPSILON_NUMBER&&(u=this._mySmoothSnapVerticalAngleToPerform),this._mySmoothSnapVerticalAngleToPerform-=u,Math.abs(this._mySmoothSnapVerticalAngleToPerform)<PP.LocomotionUtils.EPSILON_NUMBER&&(this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0)),u!=0&&(o.quat_fromAxis(u,a),this._myParams.myPlayerHeadManager.rotateHeadQuat(o),this._myParams.myClampVerticalAngle)){let p=this._myParams.myMaxVerticalAngle-1e-4;s=c.pp_getUp(s);let d=Math.pp_angleClamp(s.vec3_angleSigned(t,a));if(Math.abs(d)>p){let _=(Math.abs(d)-p)*Math.pp_sign(d);o.quat_fromAxis(_,a),this._myParams.myPlayerHeadManager.rotateHeadQuat(o)}}}}();Object.defineProperty(PP.PlayerLocomotionRotate.prototype,"_rotateHeadHorizontally",{enumerable:!1});Object.defineProperty(PP.PlayerLocomotionRotate.prototype,"_rotateHeadVertically",{enumerable:!1})});var qa=S(()=>{PP.PlayerLocomotionMovementRuntimeParams=class{constructor(){this.myIsFlying=!1,this.myCollisionRuntimeParams=null,this.myIsTeleportDetecting=!1,this.myIsTeleporting=!1,this.myTeleportJustPerformed=!1}};PP.PlayerLocomotionMovement=class{constructor(e){this._myLocomotionRuntimeParams=e}start(){}stop(){}canStop(){return!0}}});var Qa=S(()=>{PP.PlayerLocomotionSmoothParams=class{constructor(){this.myPlayerHeadManager=null,this.myPlayerTransformManager=null,this.myCollisionCheckParams=null,this.myMaxSpeed=0,this.myMovementMinStickIntensityThreshold=0,this.myFlyEnabled=!1,this.myMinAngleToFlyUpNonVR=0,this.myMinAngleToFlyDownNonVR=0,this.myMinAngleToFlyUpVR=0,this.myMinAngleToFlyDownVR=0,this.myMinAngleToFlyRight=0,this.myGravityAcceleration=0,this.myVRDirectionReferenceType=PP.PlayerLocomotionDirectionReferenceType.HEAD,this.myVRDirectionReferenceObject=null,this.myHandedness=PP.Handedness.LEFT,this.myMoveThroughCollisionShortcutEnabled=!1,this.myMoveHeadShortcutEnabled=!1}};PP.PlayerLocomotionSmooth=class extends PP.PlayerLocomotionMovement{constructor(e,t){super(t),this._myParams=e,this._myDirectionReference=PP.myPlayerObjects.myHead,this._myStickIdleTimer=new PP.Timer(.25,!1);let n=new PP.Direction2DTo3DConverterParams;n.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,n.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,n.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpNonVR,n.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownNonVR,n.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,n.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight;let a=new PP.Direction2DTo3DConverterParams;a.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,a.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,a.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpVR,a.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownVR,a.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,a.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight,this._myDirectionConverterNonVR=new PP.Direction2DTo3DConverter(n),this._myDirectionConverterVR=new PP.Direction2DTo3DConverter(a),this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myLocomotionRuntimeParams.myIsFlying=!1,WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}update(e){}};PP.PlayerLocomotionSmooth.prototype.update=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.quat2_create(),o=PP.quat2_create();return function(m){i=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.vec3_zero();let c=PP.myGamepads[this._myParams.myHandedness].getAxesInfo(PP.GamepadAxesID.THUMBSTICK).getAxes();if(c[0]=Math.abs(c[0])>this._myParams.myMovementMinStickIntensityThreshold?c[0]:0,c[1]=Math.abs(c[1])>this._myParams.myMovementMinStickIntensityThreshold?c[1]:0,c.vec2_isZero())this._myStickIdleTimer.isRunning()&&(this._myStickIdleTimer.update(m),this._myStickIdleTimer.isDone()&&this._myCurrentDirectionConverter.resetFly());else if(this._myStickIdleTimer.start(),t=this._myCurrentDirectionConverter.convertTransformQuat(c,this._myDirectionReference.pp_getTransformQuat(o),i,t),!t.vec3_isZero()){this._myLocomotionRuntimeParams.myIsFlying=this._myLocomotionRuntimeParams.myIsFlying||t.vec3_componentAlongAxis(i,n).vec3_length()>1e-6,this._myLocomotionRuntimeParams.myIsFlying||(t=t.vec3_removeComponentAlongAxis(i,t));let r=c.vec2_length();PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.SELECT).isPressed()&&(r=.1);let y=Math.pp_lerp(0,this._myParams.myMaxSpeed,r);this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsSliding&&(y=y/2),e=t.vec3_scale(y*m,e)}if(PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.SQUEEZE).isPressed()||(PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressed()?(a=i.vec3_scale(this._myParams.myMaxSpeed*m,a),e=e.vec3_add(a,e),this._myLocomotionRuntimeParams.myIsFlying=!0):PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).isPressed()&&(a=i.vec3_scale(-this._myParams.myMaxSpeed*m,a),e=e.vec3_add(a,e),this._myLocomotionRuntimeParams.myIsFlying=!0)),PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).isPressEnd(2)&&(this._myLocomotionRuntimeParams.myIsFlying=!1),PP.myGamepads[PP.InputUtils.getOppositeHandedness(this._myParams.myHandedness)].getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).isPressed())PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressed()||(this._myLocomotionRuntimeParams.myIsFlying,PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.SQUEEZE).isPressed()&&e.vec3_zero(),s=this._myParams.myPlayerHeadManager.getTransformFeetQuat(s),PP.myCollisionCheck.move(e,s,this._myParams.myCollisionCheckParams,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),e.vec3_copy(this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myFixedMovement)),e.vec3_isZero(1e-6)||this._myParams.myPlayerHeadManager.moveFeet(e);else if(PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressed())this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams,!0);else{if(!this._myLocomotionRuntimeParams.myIsFlying){let r=-2;a=i.vec3_scale(r*m,a),e=e.vec3_add(a,e)}PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.SQUEEZE).isPressed()&&e.vec3_zero(),s=this._myParams.myPlayerTransformManager.getTransformQuat(s),this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround&&(this._myLocomotionRuntimeParams.myIsFlying=!1,this._myCurrentDirectionConverter.resetFly())}}();PP.PlayerLocomotionSmooth.prototype._onXRSessionStart=function(){return function(e){switch(this._myParams.myVRDirectionReferenceType){case 0:this._myDirectionReference=PP.myPlayerHeadManager.myHead;break;case 1:this._myDirectionReference=PP.myPlayerObjects.myHands[this._myParams.myHandedness];break;case 2:this._myDirectionReference=this._myParams.myVRDirectionReferenceObject;break}this._myCurrentDirectionConverter=this._myDirectionConverterVR,this._myCurrentDirectionConverter.resetFly()}}();PP.PlayerLocomotionSmooth.prototype._onXRSessionEnd=function(){let i=PP.vec3_create();return function(t){this._myDirectionReference=PP.myPlayerObjects.myHead,this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myCurrentDirectionConverter.resetFly()}}();Object.defineProperty(PP.PlayerLocomotionSmooth.prototype,"update",{enumerable:!1});Object.defineProperty(PP.PlayerLocomotionSmooth.prototype,"_onXRSessionStart",{enumerable:!1});Object.defineProperty(PP.PlayerLocomotionSmooth.prototype,"_onXRSessionEnd",{enumerable:!1})});var Xa=S(()=>{PP.PlayerObscureManagerParams=class{constructor(){this.myPlayerTransformManager=null,this.myObscureObject=null,this.myObscureMaterial=null,this.myObscureRadius=0,this.myObscureFadeOutSeconds=.1,this.myObscureFadeInSeconds=.1,this.myObscureFadeEasingFunction=PP.EasingFunction.linear,this.myDistanceToStartObscureWhenHeadColliding=0,this.myDistanceToStartObscureWhenBodyColliding=0,this.myDistanceToStartObscureWhenFloating=0,this.myDistanceToStartObscureWhenFar=0,this.myRelativeDistanceToMaxObscureWhenHeadColliding=0,this.myRelativeDistanceToMaxObscureWhenBodyColliding=0,this.myRelativeDistanceToMaxObscureWhenFloating=0,this.myRelativeDistanceToMaxObscureWhenFar=0,this.myObscureLevelRelativeDistanceEasingFunction=PP.EasingFunction.linear}};PP.PlayerObscureManager=class{constructor(e){this._myParams=e,this._myObscureMaterial=null,this._myObscureParentObject=null,this._myCurrentObscureLevel=0,this._myTargetObscureLevel=0,this._myLastTargetObscureLevel=null,this._myLastIsFadingIn=null,this._myFadeTimer=new PP.Timer(0,!1),this._myFSM=new PP.FSM,this._myFSM.addState("init"),this._myFSM.addState("inactive"),this._myFSM.addState("idle",this._idleUpdate.bind(this)),this._myFSM.addState("fading",this._fadingUpdate.bind(this)),this._myFSM.addTransition("init","inactive","end",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("inactive","idle","start"),this._myFSM.addTransition("idle","fading","fade",this._startFading.bind(this)),this._myFSM.addTransition("fading","idle","done",this._fadingDone.bind(this)),this._myFSM.addTransition("inactive","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("idle","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("fading","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.init("init"),this._setupVisuals(),this._myFSM.perform("end")}start(){this._myFSM.perform("start")}stop(){this._myFSM.perform("stop")}update(e){this._myObscureParentObject.pp_resetTransformLocal(),this._updateObscured(),this._myFSM.update(e),this._setObscureVisible(this.isObscured())}isStarted(){return!this._myFSM.isInState("inactive")}isObscured(){return this._myCurrentObscureLevel>0}isFading(){return this._myFSM.isInState("fading")}isFadingIn(){return this.isFading()&&this._myCurrentObscureLevel>this._myTargetObscureLevel}isFadingOut(){return this.isFading()&&this._myCurrentObscureLevel<=this._myTargetObscureLevel}getObscureLevel(){return this._myCurrentObscureLevel}getTargetObscureLevel(){return this._myTargetObscureLevel}getCurrentObscureLevel(){this._myCurrentObscureLevel}obscureLevelOverride(e,t=!1){this._myObscurelevelOverride=e,t&&this.isStarted()&&this._setObscureLevel(e)}resetObscureLevelOverride(){this._myObscurelevelOverride=null}_idleUpdate(e){Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)>Math.PP_EPSILON_NUMBER&&this._myFSM.perform("fade")}_fadingUpdate(e){if(Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)<=Math.PP_EPSILON_NUMBER){this._myFSM.perform("done");return}this._myLastTargetObscureLevel!=this._myTargetObscureLevel&&(this._refreshFadeTimer(),this._myLastTargetObscureLevel=this._myTargetObscureLevel),this._myFadeTimer.update(e);let t=this._myParams.myObscureFadeEasingFunction(this._myFadeTimer.getPercentage());this._myCurrentObscureLevel>this._myTargetObscureLevel?(t=Math.pp_clamp(1-t,0,1),t=Math.max(t,this._myTargetObscureLevel)):t=Math.min(t,this._myTargetObscureLevel),this._setObscureAlpha(t),this._myCurrentObscureLevel=t,(Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)<=Math.PP_EPSILON_NUMBER||this._myFadeTimer.isDone())&&this._myFSM.perform("done")}_startFading(){this._myLastTargetObscureLevel=null,this._myLastIsFadingIn=null}_fadingDone(){this._setObscureLevel(this._myTargetObscureLevel)}_refreshFadeTimer(){let e=this._myCurrentObscureLevel>this._myTargetObscureLevel;this._myLastIsFadingIn!=e&&this._setFadeTimerToObscureLevel(e),this._myLastIsFadingIn=e}_setFadeTimerToObscureLevel(e){let t=0,n=0,s=1/1e3;for(;t<1;)Math.abs(this._myParams.myObscureFadeEasingFunction(t)-this._myCurrentObscureLevel)<Math.abs(this._myParams.myObscureFadeEasingFunction(n)-this._myCurrentObscureLevel)&&(n=t),t+=s;Math.abs(this._myParams.myObscureFadeEasingFunction(1)-this._myCurrentObscureLevel)<Math.abs(this._myParams.myObscureFadeEasingFunction(n)-this._myCurrentObscureLevel)&&(n=1),e?(this._myFadeTimer.start(this._myParams.myObscureFadeInSeconds),this._myFadeTimer.setPercentage(Math.pp_clamp(1-n,0,1))):(this._myFadeTimer.start(this._myParams.myObscureFadeOutSeconds),this._myFadeTimer.setPercentage(Math.pp_clamp(n,0,1)))}_setObscureLevel(e){this._myTargetObscureLevel=e,this._myCurrentObscureLevel=e,this._setObscureAlpha(e),this._setObscureVisible(this.isObscured())}_setObscureAlpha(e){this._myParams.myObscureObject==null?PP.MaterialUtils.setAlpha(this._myObscureMaterial,e):PP.MaterialUtils.setObjectAlpha(this._myParams.myObscureObject,e)}_updateObscured(){if(this._myTargetObscureLevel=0,this._myObscurelevelOverride!=null)this._myTargetObscureLevel=this._myObscurelevelOverride;else{if(this._myParams.myPlayerTransformManager.isHeadColliding()){let t=this._myParams.myPlayerTransformManager.getDistanceToRealHead()-this._myParams.myDistanceToStartObscureWhenHeadColliding;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenHeadColliding,0,1),a=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,a)}}if(this._myParams.myPlayerTransformManager.isBodyColliding()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenBodyColliding;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenBodyColliding,0,1),a=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,a)}}if(this._myParams.myPlayerTransformManager.isFloating()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenFloating;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenFloating,0,1),a=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,a)}}if(this._myParams.myPlayerTransformManager.isFar()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenFar;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenFar,0,1),a=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,a)}}}}_setupVisuals(){this._myObscureMaterial=null,this._myParams.myObscureMaterial!=null?this._myObscureMaterial=this._myParams.myObscureMaterial:(this._myObscureMaterial=PP.myDefaultResources.myMaterials.myFlatTransparentNoDepth.clone(),this._myObscureMaterial.color=PP.vec4_create(0,0,0,1)),this._myObscureParentObject=PP.myVisualData.myRootObject.pp_addObject();let e=new PP.VisualMeshParams;e.myMesh=PP.myDefaultResources.myMeshes.myInvertedSphere,e.myMaterial=this._myParams.myObscureMaterial!=null?this._myParams.myObscureMaterial:this._myObscureMaterial,e.myParent=this._myObscureParentObject,e.myIsLocal=!0,e.myTransform.mat4_setScale(PP.vec3_create(this._myParams.myObscureRadius,this._myParams.myObscureRadius,this._myParams.myObscureRadius)),this._myObscureVisual=new PP.VisualMesh(e),this._myParams.myObscureObject!=null&&(this._myParams.myObscureObject.pp_setParent(this._myObscureParentObject,!1),this._myParams.myObscureObject.pp_resetTransformLocal()),this._setObscureVisible(!1)}_setObscureVisible(e){this._myParams.myObscureObject==null?this._myObscureVisual.setVisible(e):(this._myObscureVisual.setVisible(!1),this._myParams.myObscureObject.pp_setActive(e)),e?this._myObscureParentObject.pp_setParent(this._myParams.myPlayerTransformManager.getHead(),!1):this._myObscureParentObject.pp_setParent(null,!1)}}});var Ka=S(()=>{PP.PlayerLocomotionDirectionReferenceType={HEAD:0,HAND:1,CUSTOM_OBJECT:2};PP.PlayerLocomotionParams=class{constructor(){this.myMaxSpeed=0,this.myMaxRotationSpeed=0,this.myCharacterRadius=0,this.myIsSnapTurn=!1,this.mySnapTurnOnlyVR=!1,this.mySnapTurnAngle=0,this.mySnapTurnSpeedDegrees=0,this.myFlyEnabled=!1,this.myMinAngleToFlyUpNonVR=0,this.myMinAngleToFlyDownNonVR=0,this.myMinAngleToFlyUpVR=0,this.myMinAngleToFlyDownVR=0,this.myMinAngleToFlyRight=0,this.myMainHand=PP.Handedness.LEFT,this.myVRDirectionReferenceType=PP.PlayerLocomotionDirectionReferenceType.HEAD,this.myVRDirectionReferenceObject=null,this.myTeleportParableStartReferenceObject=null,this.myForeheadExtraHeight=0,this.myTeleportPositionObject=null,this.myMoveThroughCollisionShortcutEnabled=!1,this.myMoveHeadShortcutEnabled=!1,this.myPhysicsBlockLayerFlags=new PP.PhysicsLayerFlags}};PP.PlayerLocomotion=class{constructor(e){this._myParams=e,this._myCollisionCheckParamsMovement=new PP.CollisionCheckParams,this._setupCollisionCheckParamsMovement(),this._myCollisionCheckParamsTeleport=null,this._setupCollisionCheckParamsTeleport(),this._myCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._myMovementRuntimeParams=new PP.PlayerLocomotionMovementRuntimeParams,this._myMovementRuntimeParams.myCollisionRuntimeParams=this._myCollisionRuntimeParams;{let t=new PP.PlayerHeadManagerParams;t.mySessionChangeResyncEnabled=!0,t.myBlurEndResyncEnabled=!0,t.myBlurEndResyncRotation=!0,t.myEnterSessionResyncHeight=!1,t.myExitSessionResyncHeight=!1,t.myExitSessionResyncVerticalAngle=!0,t.myExitSessionRemoveRightTilt=!0,t.myExitSessionAdjustMaxVerticalAngle=!0,t.myExitSessionMaxVerticalAngle=90,t.myHeightOffsetVRWithFloor=0,t.myHeightOffsetVRWithoutFloor=1.75,t.myHeightOffsetNonVR=1.75,t.myForeheadExtraHeight=this._myParams.myForeheadExtraHeight,t.myFeetRotationKeepUp=!0,t.myDebugActive=!1,this._myPlayerHeadManager=new PP.PlayerHeadManager(t)}{let t=new PP.PlayerTransformManagerParams;t.myPlayerHeadManager=this._myPlayerHeadManager,t.myMovementCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myTeleportCollisionCheckParams=null,t.myTeleportCollisionCheckParamsCopyFromMovement=!0,t.myTeleportCollisionCheckParamsCheck360=!0,t.myHeadCollisionBlockLayerFlags.copy(t.myMovementCollisionCheckParams.myHorizontalBlockLayerFlags),t.myHeadCollisionBlockLayerFlags.add(t.myMovementCollisionCheckParams.myVerticalBlockLayerFlags),t.myHeadCollisionObjectsToIgnore.pp_copy(t.myMovementCollisionCheckParams.myHorizontalObjectsToIgnore);let n=(a,s)=>a.pp_equals(s);for(let a of t.myMovementCollisionCheckParams.myVerticalObjectsToIgnore)t.myHeadCollisionObjectsToIgnore.pp_pushUnique(a,n);t.myCollisionRuntimeParams=this._myCollisionRuntimeParams,t.myHeadRadius=.15,t.myIsMaxDistanceFromRealToSyncEnabled=!0,t.myMaxDistanceFromRealToSync=100,t.myIsFloatingValidIfVerticalMovement=!1,t.myIsFloatingValidIfVerticalMovementAndRealOnGround=!1,t.myIsFloatingValidIfSteepGround=!1,t.myIsFloatingValidIfVerticalMovementAndSteepGround=!1,t.myIsFloatingValidIfRealOnGround=!1,t.myIsLeaningValidAboveDistance=!0,t.myLeaningValidDistance=2,t.myFloatingSplitCheckEnabled=!0,t.myFloatingSplitCheckMaxLength=.2,t.myFloatingSplitCheckMaxSteps=5,t.myRealMovementAllowVerticalAdjustments=!1,t.myUpdateRealPositionValid=!0,t.myUpdatePositionValid=!0,t.myIsBodyCollidingWhenHeightBelowValue=null,t.myIsBodyCollidingWhenHeightAboveValue=null,t.myResetToValidOnEnterSession=!0,t.myResetToValidOnExitSession=!0,t.myAlwaysResetRealPositionNonVR=!0,t.myAlwaysResetRealRotationNonVR=!0,t.myAlwaysResetRealHeightNonVR=!0,t.myAlwaysResetRealPositionVR=!1,t.myAlwaysResetRealRotationVR=!1,t.myAlwaysResetRealHeightVR=!1,t.myNeverResetRealPositionNonVR=!1,t.myNeverResetRealRotationNonVR=!0,t.myNeverResetRealHeightNonVR=!1,t.myNeverResetRealPositionVR=!1,t.myNeverResetRealRotationVR=!1,t.myNeverResetRealHeightVR=!0,t.myResetRealOnMove=!0,t.myDebugActive=!0,this._myPlayerTransformManager=new PP.PlayerTransformManager(t)}{let t=new PP.PlayerObscureManagerParams;t.myPlayerTransformManager=this._myPlayerTransformManager,t.myObscureObject=null,t.myObscureMaterial=null,t.myObscureRadius=.1,t.myObscureFadeOutSeconds=.25,t.myObscureFadeInSeconds=.25,t.myObscureFadeEasingFunction=PP.EasingFunction.linear,t.myObscureLevelRelativeDistanceEasingFunction=PP.EasingFunction.linear,t.myDistanceToStartObscureWhenBodyColliding=.2,t.myDistanceToStartObscureWhenHeadColliding=0,t.myDistanceToStartObscureWhenFloating=1,t.myDistanceToStartObscureWhenFar=1,t.myRelativeDistanceToMaxObscureWhenBodyColliding=.5,t.myRelativeDistanceToMaxObscureWhenHeadColliding=.1,t.myRelativeDistanceToMaxObscureWhenFloating=5,t.myRelativeDistanceToMaxObscureWhenFar=5,this._myPlayerObscureManager=new PP.PlayerObscureManager(t)}{let t=new PP.PlayerLocomotionRotateParams;t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myMaxRotationSpeed=this._myParams.myMaxRotationSpeed,t.myIsSnapTurn=this._myParams.myIsSnapTurn,t.mySnapTurnOnlyVR=this._myParams.mySnapTurnOnlyVR,t.mySnapTurnAngle=this._myParams.mySnapTurnAngle,this._myParams.mySnapTurnSpeedDegrees>PP.LocomotionUtils.EPSILON_NUMBER?(t.mySmoothSnapActive=!0,t.mySmoothSnapSpeedDegrees=this._myParams.mySnapTurnSpeedDegrees):t.mySmoothSnapActive=!1,t.myRotationMinStickIntensityThreshold=.1,t.mySnapTurnActivateThreshold=.5,t.mySnapTurnResetThreshold=.4,t.myClampVerticalAngle=!0,t.myMaxVerticalAngle=90,this._myPlayerLocomotionRotate=new PP.PlayerLocomotionRotate(t),t.myHandedness=PP.InputUtils.getOppositeHandedness(this._myParams.myMainHand)}{{let t=new PP.PlayerLocomotionSmoothParams;t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myHandedness=this._myParams.myMainHand,t.myMaxSpeed=this._myParams.myMaxSpeed,t.myMovementMinStickIntensityThreshold=.1,t.myFlyEnabled=this._myParams.myFlyEnabled,t.myMinAngleToFlyUpNonVR=this._myParams.myMinAngleToFlyUpNonVR,t.myMinAngleToFlyDownNonVR=this._myParams.myMinAngleToFlyDownNonVR,t.myMinAngleToFlyUpVR=this._myParams.myMinAngleToFlyUpVR,t.myMinAngleToFlyDownVR=this._myParams.myMinAngleToFlyDownVR,t.myMinAngleToFlyRight=this._myParams.myMinAngleToFlyRight,t.myGravityAcceleration=-20,t.myVRDirectionReferenceType=this._myParams.myVRDirectionReferenceType,t.myVRDirectionReferenceObject=this._myParams.myVRDirectionReferenceObject,t.myMoveThroughCollisionShortcutEnabled=this._myParams.myMoveThroughCollisionShortcutEnabled,t.myMoveHeadShortcutEnabled=this._myParams.myMoveHeadShortcutEnabled,this._myPlayerLocomotionSmooth=new PP.PlayerLocomotionSmooth(t,this._myMovementRuntimeParams)}{let t=new PP.PlayerLocomotionTeleportParams;t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsTeleport,t.myHandedness=this._myParams.myMainHand,t.myDetectionParams.myMaxDistance=3,t.myDetectionParams.myMaxHeightDifference=4,t.myDetectionParams.myGroundAngleToIgnoreUpward=this._myCollisionCheckParamsMovement.myGroundAngleToIgnore,t.myDetectionParams.myMustBeOnGround=!0,t.myDetectionParams.myTeleportBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFloorLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFeetPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible=!0,t.myDetectionParams.myTeleportParableStartReferenceObject=this._myParams.myTeleportParableStartReferenceObject,t.myDetectionParams.myVisibilityBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myVisualizerParams.myTeleportPositionObject=this._myParams.myTeleportPositionObject,t.myPerformTeleportAsMovement=!1,t.myTeleportAsMovementRemoveVerticalMovement=!0,t.myTeleportAsMovementExtraVerticalMovementPerMeter=-2,t.myGravityAcceleration=0,t.myDebugActive=!1,t.myDebugDetectActive=!0,t.myDebugShowActive=!0,t.myDebugVisibilityActive=!1,this._myPlayerLocomotionTeleport=new PP.PlayerLocomotionTeleport(t,this._myMovementRuntimeParams)}}this._setupLocomotionMovementFSM(),this._myIdle=!1}start(){this._fixAlmostUp(),this._myPlayerHeadManager.start(),this._myPlayerTransformManager.start(),this._myPlayerObscureManager.start(),this._myPlayerLocomotionRotate.start(),this._myLocomotionMovementFSM.perform("start")}update(e){this._myPlayerHeadManager.update(e),this._myPlayerTransformManager.update(e),PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressEnd(2)&&(this._myLocomotionMovementFSM.isInState("smooth")&&this._myPlayerLocomotionSmooth.canStop()?this._myLocomotionMovementFSM.perform("next"):this._myLocomotionMovementFSM.isInState("teleport")&&this._myPlayerLocomotionTeleport.canStop()&&this._myLocomotionMovementFSM.perform("next")),this._myPlayerHeadManager.isSynced()&&(this._updateCollisionHeight(),this._myIdle||(this._myPlayerLocomotionRotate.update(e),this._myLocomotionMovementFSM.update(e))),PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.SELECT).isPressEnd(2)&&(this._myPlayerObscureManager.isFading()?this._myPlayerObscureManager.obscureLevelOverride(this._myPlayerObscureManager.isFadingOut()?Math.pp_random(0,0):Math.pp_random(1,1)):this._myPlayerObscureManager.obscureLevelOverride(this._myPlayerObscureManager.isObscured()?Math.pp_random(0,0):Math.pp_random(1,1)))}setIdle(e){this._myIdle=e,e?this._myLocomotionMovementFSM.perform("idle"):this._myLocomotionMovementFSM.perform("start")}_updateCollisionHeight(){this._myCollisionCheckParamsMovement.myHeight=this._myPlayerHeadManager.getHeightHead(),this._myCollisionCheckParamsMovement.myHeight<=1e-6&&(this._myCollisionCheckParamsMovement.myHeight=0),this._myCollisionCheckParamsTeleport.myHeight=this._myCollisionCheckParamsMovement.myHeight}_setupCollisionCheckParamsMovement(){this._myCollisionCheckParamsMovement.mySplitMovementEnabled=!1,this._myCollisionCheckParamsMovement.mySplitMovementMaxLength=0,this._myCollisionCheckParamsMovement.myRadius=this._myParams.myCharacterRadius,this._myCollisionCheckParamsMovement.myDistanceFromFeetToIgnore=.1,this._myCollisionCheckParamsMovement.myDistanceFromHeadToIgnore=.1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckEnabled=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementStepEnabled=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementStepMaxLength=0,this._myCollisionCheckParamsMovement.myHorizontalMovementRadialStepAmount=1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckDiagonalOutward=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckDiagonalInward=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckStraight=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckHorizontalBorder=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalStraight=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalDiagonalDownwardInward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalStraightDiagonalUpward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalStraightDiagonalDownward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!0,this._myCollisionCheckParamsMovement.myHorizontalPositionCheckEnabled=!0,this._myCollisionCheckParamsMovement.myHalfConeAngle=60,this._myCollisionCheckParamsMovement.myHalfConeSliceAmount=2,this._myCollisionCheckParamsMovement.myCheckConeBorder=!0,this._myCollisionCheckParamsMovement.myCheckConeRay=!0,this._myCollisionCheckParamsMovement.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!1,this._myCollisionCheckParamsMovement.myHorizontalPositionCheckVerticalDirectionType=2,this._myCollisionCheckParamsMovement.myVerticalMovementCheckEnabled=!0,this._myCollisionCheckParamsMovement.myVerticalPositionCheckEnabled=!0,this._myCollisionCheckParamsMovement.myVerticalMovementReduceEnabled=!0,this._myCollisionCheckParamsMovement.myFeetRadius=.1,this._myCollisionCheckParamsMovement.myAdjustVerticalMovementWithGroundAngleDownhill=!0,this._myCollisionCheckParamsMovement.myAdjustVerticalMovementWithGroundAngleUphill=!0,this._myCollisionCheckParamsMovement.myAdjustVerticalMovementWithCeilingAngleUphill=!0,this._myCollisionCheckParamsMovement.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,this._myCollisionCheckParamsMovement.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,this._myCollisionCheckParamsMovement.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=30,this._myCollisionCheckParamsMovement.mySnapOnGroundEnabled=!0,this._myCollisionCheckParamsMovement.mySnapOnGroundExtraDistance=.1,this._myCollisionCheckParamsMovement.mySnapOnCeilingEnabled=!1,this._myCollisionCheckParamsMovement.mySnapOnCeilingExtraDistance=.1,this._myCollisionCheckParamsMovement.myGroundPopOutEnabled=!0,this._myCollisionCheckParamsMovement.myGroundPopOutExtraDistance=.1,this._myCollisionCheckParamsMovement.myCeilingPopOutEnabled=!0,this._myCollisionCheckParamsMovement.myCeilingPopOutExtraDistance=.1,this._myCollisionCheckParamsMovement.myGroundCircumferenceAddCenter=!0,this._myCollisionCheckParamsMovement.myGroundCircumferenceSliceAmount=8,this._myCollisionCheckParamsMovement.myGroundCircumferenceStepAmount=2,this._myCollisionCheckParamsMovement.myGroundCircumferenceRotationPerStep=22.5,this._myCollisionCheckParamsMovement.myVerticalAllowHitInsideCollisionIfOneOk=!0,this._myCollisionCheckParamsMovement.myCheckHeight=!0,this._myCollisionCheckParamsMovement.myCheckHeightVerticalMovement=!0,this._myCollisionCheckParamsMovement.myCheckHeightVerticalPosition=!0,this._myCollisionCheckParamsMovement.myCheckHeightTopMovement=!0,this._myCollisionCheckParamsMovement.myCheckHeightTopPosition=!0,this._myCollisionCheckParamsMovement.myCheckHeightConeOnCollision=!0,this._myCollisionCheckParamsMovement.myCheckHeightConeOnCollisionKeepHit=!1,this._myCollisionCheckParamsMovement.myHeightCheckStepAmountMovement=2,this._myCollisionCheckParamsMovement.myHeightCheckStepAmountPosition=2,this._myCollisionCheckParamsMovement.myCheckVerticalFixedForwardEnabled=!0,this._myCollisionCheckParamsMovement.myCheckVerticalFixedForward=PP.vec3_create(0,0,1),this._myCollisionCheckParamsMovement.myCheckVerticalBothDirection=!0,this._myCollisionCheckParamsMovement.myCheckVerticalStraight=!0,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalRayOutward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalRayInward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalBorderOutward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalBorderInward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalBorderRayOutward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalBorderRayInward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalSearchFartherVerticalHit=!1,this._myCollisionCheckParamsMovement.myGroundAngleToIgnore=30,this._myCollisionCheckParamsMovement.myCeilingAngleToIgnore=30,this._myCollisionCheckParamsMovement.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=.1,this._myCollisionCheckParamsMovement.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=.1,this._myCollisionCheckParamsMovement.myHeight=1,this._myCollisionCheckParamsMovement.myComputeGroundInfoEnabled=!0,this._myCollisionCheckParamsMovement.myComputeCeilingInfoEnabled=!0,this._myCollisionCheckParamsMovement.myDistanceToBeOnGround=.001,this._myCollisionCheckParamsMovement.myDistanceToComputeGroundInfo=.1,this._myCollisionCheckParamsMovement.myDistanceToBeOnCeiling=.001,this._myCollisionCheckParamsMovement.myDistanceToComputeCeilingInfo=.1,this._myCollisionCheckParamsMovement.myVerticalFixToBeOnGround=0,this._myCollisionCheckParamsMovement.myVerticalFixToComputeGroundInfo=0,this._myCollisionCheckParamsMovement.myVerticalFixToBeOnCeiling=0,this._myCollisionCheckParamsMovement.myVerticalFixToComputeCeilingInfo=0,this._myCollisionCheckParamsMovement.myMustStayOnGround=!1,this._myCollisionCheckParamsMovement.myMustStayOnCeiling=!1,this._myCollisionCheckParamsMovement.myRegatherGroundInfoOnSurfaceCheckFail=!0,this._myCollisionCheckParamsMovement.myRegatherCeilingInfoOnSurfaceCheckFail=!0,this._myCollisionCheckParamsMovement.mySlidingEnabled=!0,this._myCollisionCheckParamsMovement.mySlidingHorizontalMovementCheckBetterNormal=!0,this._myCollisionCheckParamsMovement.mySlidingMaxAttempts=4,this._myCollisionCheckParamsMovement.mySlidingCheckBothDirections=!0,this._myCollisionCheckParamsMovement.mySlidingFlickeringPreventionType=1,this._myCollisionCheckParamsMovement.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=!0,this._myCollisionCheckParamsMovement.mySlidingFlickerPreventionCheckAnywayCounter=4,this._myCollisionCheckParamsMovement.mySlidingAdjustSign90Degrees=!0,this._myCollisionCheckParamsMovement.myHorizontalBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags);let e=PP.myPlayerObjects.myPlayer.pp_getComponentsHierarchy("physx");for(let t of e)this._myCollisionCheckParamsMovement.myHorizontalObjectsToIgnore.pp_pushUnique(t.object,(n,a)=>n.pp_equals(a));this._myCollisionCheckParamsMovement.myVerticalBlockLayerFlags.copy(this._myCollisionCheckParamsMovement.myHorizontalBlockLayerFlags),this._myCollisionCheckParamsMovement.myVerticalObjectsToIgnore.pp_copy(this._myCollisionCheckParamsMovement.myHorizontalObjectsToIgnore),this._myCollisionCheckParamsMovement.myDebugActive=!1,this._myCollisionCheckParamsMovement.myDebugHorizontalMovementActive=!1,this._myCollisionCheckParamsMovement.myDebugHorizontalPositionActive=!0,this._myCollisionCheckParamsMovement.myDebugVerticalMovementActive=!1,this._myCollisionCheckParamsMovement.myDebugVerticalPositionActive=!1,this._myCollisionCheckParamsMovement.myDebugSlidingActive=!1,this._myCollisionCheckParamsMovement.myDebugGroundInfoActive=!1,this._myCollisionCheckParamsMovement.myDebugCeilingInfoActive=!1,this._myCollisionCheckParamsMovement.myDebugRuntimeParamsActive=!1,this._myCollisionCheckParamsMovement.myDebugMovementActive=!1}_setupCollisionCheckParamsTeleport(){this._myCollisionCheckParamsTeleport=PP.CollisionCheckUtils.generate360TeleportParamsFromMovementParams(this._myCollisionCheckParamsMovement),this._myCollisionCheckParamsTeleport.myGroundAngleToIgnore=60,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnIgnorableGroundAngle=!0,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnGround=!0}_fixAlmostUp(){let e=PP.vec3_create(0,1,0);if(PP.myPlayerObjects.myPlayer.pp_getUp().vec3_angle(e)<1){let a=PP.myPlayerObjects.myPlayer.pp_getForward().vec3_clone();a[1]=0;let o=PP.vec3_create(0,0,1).vec3_angleSigned(a,e);PP.myPlayerObjects.myPlayer.pp_resetRotation(),PP.myPlayerObjects.myPlayer.pp_rotateAxis(o,e)}}_setupLocomotionMovementFSM(){this._myLocomotionMovementFSM=new PP.FSM,this._myLocomotionMovementFSM.setDebugLogActive(!0,"Locomotion Movement"),this._myLocomotionMovementFSM.addState("init"),this._myLocomotionMovementFSM.addState("smooth",e=>this._myPlayerLocomotionSmooth.update(e)),this._myLocomotionMovementFSM.addState("teleport",e=>this._myPlayerLocomotionTeleport.update(e)),this._myLocomotionMovementFSM.addState("idleSmooth"),this._myLocomotionMovementFSM.addState("idleTeleport"),this._myLocomotionMovementFSM.addTransition("init","smooth","start",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","teleport","next",function(){this._myPlayerLocomotionSmooth.stop(),this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","smooth","next",function(){this._myPlayerLocomotionTeleport.stop(),this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","idleSmooth","idle",function(){this._myPlayerLocomotionSmooth.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","idleTeleport","idle",function(){this._myPlayerLocomotionTeleport.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleSmooth","smooth","start",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleTeleport","teleport","start",function(){this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.init("init")}}});var Ja=S(()=>{WL.registerComponent("pp-player-locomotion",{_myPhysicsBlockLayerFlags:{type:WL.Type.String,default:"1, 0, 0, 0, 0, 0, 0, 0"},_myMaxSpeed:{type:WL.Type.Float,default:2},_myMaxRotationSpeed:{type:WL.Type.Float,default:100},_myCharacterRadius:{type:WL.Type.Float,default:.3},_myIsSnapTurn:{type:WL.Type.Bool,default:!0},_mySnapTurnOnlyVR:{type:WL.Type.Bool,default:!0},_mySnapTurnAngle:{type:WL.Type.Float,default:30},_mySnapTurnSpeedDegrees:{type:WL.Type.Float,default:0},_myFlyEnabled:{type:WL.Type.Bool,default:!1},_myMinAngleToFlyUpNonVR:{type:WL.Type.Float,default:30},_myMinAngleToFlyDownNonVR:{type:WL.Type.Float,default:50},_myMinAngleToFlyUpVR:{type:WL.Type.Float,default:60},_myMinAngleToFlyDownVR:{type:WL.Type.Float,default:1},_myMinAngleToFlyRight:{type:WL.Type.Float,default:30},_myMainHand:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myVRDirectionReferenceType:{type:WL.Type.Enum,values:["head","hand","custom object"],default:"hand"},_myVRDirectionReferenceObject:{type:WL.Type.Object},_myTeleportParableStartReferenceObject:{type:WL.Type.Object},_myTeleportPositionObject:{type:WL.Type.Object},_myUseCleanedVersion:{type:WL.Type.Bool,default:!0},_myMoveThroughCollisionShortcutEnabled:{type:WL.Type.Bool,default:!1},_myMoveHeadShortcutEnabled:{type:WL.Type.Bool,default:!1}},{init(){},start(){PP.myCollisionCheck=new PP.CollisionCheck;let i=new PP.PlayerLocomotionParams;i.myMaxSpeed=this._myMaxSpeed,i.myMaxRotationSpeed=this._myMaxRotationSpeed,i.myCharacterRadius=this._myCharacterRadius,i.myIsSnapTurn=this._myIsSnapTurn,i.mySnapTurnOnlyVR=this._mySnapTurnOnlyVR,i.mySnapTurnAngle=this._mySnapTurnAngle,i.mySnapTurnSpeedDegrees=this._mySnapTurnSpeedDegrees,i.myFlyEnabled=this._myFlyEnabled,i.myMinAngleToFlyUpNonVR=this._myMinAngleToFlyUpNonVR,i.myMinAngleToFlyDownNonVR=this._myMinAngleToFlyDownNonVR,i.myMinAngleToFlyUpVR=this._myMinAngleToFlyUpVR,i.myMinAngleToFlyDownVR=this._myMinAngleToFlyDownVR,i.myMinAngleToFlyRight=this._myMinAngleToFlyRight,i.myMainHand=PP.InputUtils.getHandednessByIndex(this._myMainHand),i.myVRDirectionReferenceType=this._myVRDirectionReferenceType,i.myVRDirectionReferenceObject=this._myVRDirectionReferenceObject,i.myTeleportParableStartReferenceObject=this._myTeleportParableStartReferenceObject,i.myForeheadExtraHeight=.1,i.myTeleportPositionObject=this._myTeleportPositionObject,i.myMoveThroughCollisionShortcutEnabled=this._myMoveThroughCollisionShortcutEnabled,i.myMoveHeadShortcutEnabled=this._myMoveHeadShortcutEnabled,i.myPhysicsBlockLayerFlags.copy(this._getPhysicsBlockLayersFlags()),this._myUseCleanedVersion?this._myPlayerLocomotion=new PP.CleanedPlayerLocomotion(i):this._myPlayerLocomotion=new PP.PlayerLocomotion(i),this._myStartCounter=1},update(i){this._myStartCounter>0?(this._myStartCounter--,this._myStartCounter==0&&(this._myPlayerLocomotion.start(),this._myPlayerLocomotion._myPlayerTransformManager.resetReal(!0,!1,!1,!0),this._myPlayerLocomotion._myPlayerTransformManager.resetHeadToReal()),this._myPlayerLocomotion._myPlayerHeadManager.update(i)):(PP.myCollisionCheck._myTotalRaycasts=0,this._myPlayerLocomotion.update(i))},onActivate(){this._myStartCounter==0&&this._myPlayerLocomotion!=null&&this._myPlayerLocomotion.setActive(!0)},onDeactivate(){this._myStartCounter==0&&this._myPlayerLocomotion!=null&&this._myPlayerLocomotion.setActive(!1)},_getPhysicsBlockLayersFlags(){let i=new PP.PhysicsLayerFlags,e=[...this._myPhysicsBlockLayerFlags.split(",")];for(let t=0;t<e.length;t++)i.setFlagActive(t,e[t].trim()=="1");return i}});PP.myCollisionCheck=null});var Za=S(()=>{PP.PlayerLocomotionTeleportParable=class{constructor(){this._myStartPosition=PP.vec3_create(),this._myForward=PP.vec3_create(),this._myUp=PP.vec3_create(),this._mySpeed=0,this._myGravity=0,this._myStepLength=0}setStartPosition(e){this._myStartPosition.vec3_copy(e)}setForward(e){this._myForward.vec3_copy(e)}setUp(e){this._myUp.vec3_copy(e)}setSpeed(e){this._mySpeed=e}setGravity(e){this._myGravity=e}setStepLength(e){this._myStepLength=e}getPosition(e,t=PP.vec3_create()){}getDistance(e){}getPositionIndexByDistance(e){}getPositionByDistance(e,t=PP.vec3_create()){}getDistanceOverFlatDistance(e,t){}getFlatDistanceOverDistance(e){}};PP.PlayerLocomotionTeleportParable.prototype.getPosition=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a=PP.vec3_create()){let o=this._myStepLength/this._mySpeed*n;return i=this._myForward.vec3_scale(this._mySpeed*o,i),i=i.vec3_add(this._myStartPosition,i),e=this._myUp.vec3_scale(this._myGravity*o*o/2,e),a=i.vec3_add(e,a),a}}();PP.PlayerLocomotionTeleportParable.prototype.getDistance=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n){let a=0;e.vec3_copy(this._myStartPosition);for(let s=1;s<=n;s++)i=this.getPosition(s,i),a+=i.vec3_distance(e),e.vec3_copy(i);return a}}();PP.PlayerLocomotionTeleportParable.prototype.getPositionIndexByDistance=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n){let a=0,s=0;for(e=this.getPosition(s,e);a<n;)i=this.getPosition(s+1,i),a+=i.vec3_distance(e),s++,e.vec3_copy(i);return Math.max(0,s-1)}}();PP.PlayerLocomotionTeleportParable.prototype.getPositionByDistance=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create();return function(a,s=PP.vec3_create()){let o=0,l=0,m=!1;for(e=this.getPosition(l,e);!m;){if(i=this.getPosition(l+1,i),o+=i.vec3_distance(e),l++,o>a){let c=o-a;t=i.vec3_sub(e,t);let r=t.vec3_length()-c;t.vec3_normalize(t),s=e.vec3_add(t.vec3_scale(r,s),s),m=!0}e.vec3_copy(i)}return s}}();PP.PlayerLocomotionTeleportParable.prototype.getDistanceOverFlatDistance=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create();return function(l,m){if(l<1e-5)return 0;let c=0,r=0;t=this._myStartPosition.vec3_removeComponentAlongAxis(this._myUp,t),n=this.getPosition(r,n);let y=0;for(;c<=m;){i=this.getPosition(r+1,i),c+=i.vec3_distance(n),r++,e=i.vec3_removeComponentAlongAxis(this._myUp,e),s=e.vec3_sub(t,s);let u=s.vec3_length();if(u>=l){let p=u-l;a=i.vec3_sub(n,a);let d=a.vec3_angleRadians(s),_=Math.cos(d),h=a.vec3_length();_!=0&&(h=p/Math.cos(d)),y=c-h;break}else y=c;n.vec3_copy(i)}return Math.min(m,y)}}();PP.PlayerLocomotionTeleportParable.prototype.getFlatDistanceOverDistance=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create();return function(a){return i=this.getPositionByDistance(a,i),e=i.vec3_removeComponentAlongAxis(this._myUp,e),t=this._myStartPosition.vec3_removeComponentAlongAxis(this._myUp,t),t.vec3_distance(e)}}()});var Ya=S(()=>{PP.PlayerLocomotionTeleportState=class extends PP.State{constructor(e,t,n){super(),this._myLocomotionRuntimeParams=n,this._myTeleportParams=e,this._myTeleportRuntimeParams=t,this._myTeleportAsMovementFailed=!1}};PP.PlayerLocomotionTeleportState.prototype._checkTeleport=function(){return function(e,t,n,a=null){PP.myCollisionCheck.teleport(e,t,this._myTeleportParams.myCollisionCheckParams,n),a?.copy(n)}}();PP.PlayerLocomotionTeleportState.prototype._checkTeleportAsMovement=function(){let i=new PP.CollisionRuntimeParams,e=PP.quat_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.quat_create(),o=PP.quat2_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=PP.quat2_create();return function(d,_,h,P){if(t=_.quat2_getPosition(t),e=_.quat2_getRotationQuat(e),n=e.quat_getUp(n),a=d.vec3_sub(t,a).vec3_removeComponentAlongAxis(n,a),a.vec3_normalize(a),a.vec3_isZero(1e-5)&&(a=e.quat_getForward(a)),s.quat_setUp(n,a),o.quat2_setPositionRotationQuat(t,s),this._checkTeleport(d,o,h,P),!h.myTeleportCanceled){let T=!1;i.copy(h),m.vec3_copy(h.myNewPosition),l.vec3_copy(t);for(let v=0;v<this._myTeleportParams.myTeleportAsMovementMaxSteps;v++){if(c=m.vec3_sub(l,c),this._myTeleportParams.myTeleportAsMovementRemoveVerticalMovement&&(c=c.vec3_removeComponentAlongAxis(n,c)),this._myTeleportParams.myTeleportAsMovementExtraVerticalMovementPerMeter!=0){let g=c.vec3_length()*this._myTeleportParams.myTeleportAsMovementExtraVerticalMovementPerMeter;r=n.vec3_scale(g,r),c=c.vec3_add(r,c)}if(u.quat2_setPositionRotationQuat(l,e),PP.myCollisionCheck.move(c,u,this._myTeleportParams.myCollisionCheckParams,i),!i.myHorizontalMovementCanceled&&!i.myVerticalMovementCanceled)if(y=m.vec3_sub(i.myNewPosition,y),y.vec3_length()<this._myTeleportParams.myTeleportAsMovementMaxDistanceFromTeleportPosition+1e-5){T=!0;break}else c.vec3_copy(y),l.vec3_copy(i.myNewPosition);else break}T||(h.myTeleportCanceled=!0),this._myTeleportAsMovementFailed=!T}}}();PP.PlayerLocomotionTeleportState.prototype._teleportToPosition=function(){let i=PP.vec3_create(),e=PP.quat2_create(),t=PP.quat2_create(),n=PP.quat_create(),a=PP.quat_create();return function(o,l,m,c=!1){this._myTeleportAsMovementFailed=!1,i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),n=e.quat2_getRotationQuat(n),l!=0&&(n=n.quat_rotateAxis(l,i,n)),t.quat2_setPositionRotationQuat(o,n),PP.myGamepads[PP.InputUtils.getOppositeHandedness(this._myTeleportParams.myHandedness)].getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).isPressed()?(PP.myCollisionCheck.positionCheck(!0,t,this._myTeleportParams.myCollisionCheckParams,m),this._myTeleportParams.myPlayerHeadManager.teleportPositionFeet(o),l!=0&&(a.quat_fromAxis(l,i),this._myTeleportParams.myPlayerHeadManager.rotateFeetQuat(a))):this._myTeleportParams.myPlayerTransformManager.teleportTransformQuat(t,m,c)}}()});var $a=S(()=>{PP.PlayerLocomotionTeleportDetectionVisualizerParams=class{constructor(){this.myTeleportParableValidMaterial=null,this.myTeleportParableInvalidMaterial=null,this.myTeleportPositionObject=null,this.myTeleportParableLineEndOffset=.05,this.myTeleportParableMinVerticalDistanceToShowVerticalLine=.25,this.myTeleportParablePositionUpOffset=.05,this.myTeleportParablePositionVisualAlignOnSurface=!0,this.myVisualTeleportPositionLerpActive=!0,this.myVisualTeleportPositionLerpFactor=10,this.myVisualTeleportPositionMinDistanceToResetLerp=.005,this.myVisualTeleportPositionMinDistanceToLerp=.15,this.myVisualTeleportPositionMaxDistanceToLerp=5,this.myVisualTeleportPositionMinDistanceToCloseLerpFactor=.02,this.myVisualTeleportPositionCloseLerpFactor=30,this.myVisualTeleportPositionMinAngleDistanceToResetLerp=.1,this.myVisualTeleportPositionMinAngleDistanceToLerp=1,this.myVisualTeleportPositionMaxAngleDistanceToLerp=180}};PP.PlayerLocomotionTeleportDetectionVisualizer=class{constructor(e,t,n){this._myDetectionRuntimeParams=n,this._myTeleportParams=e,this._myTeleportRuntimeParams=t,this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformQuat=PP.quat2_create(),this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._setupVisuals()}start(){}end(){this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._hideTeleportPosition()}update(e){this._myDetectionRuntimeParams.myTeleportDetectionValid?this._showTeleportPosition(e):(this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._hideTeleportPosition())}_showTeleportPosition(e){this._hideTeleportPosition(),this._showTeleportParable(e)}_hideTeleportPosition(){for(let e of this._myValidVisualLines)e.setVisible(!1);for(let e of this._myInvalidVisualLines)e.setVisible(!1);this._myValidVisualPoint.setVisible(!1),this._myInvalidVisualPoint.setVisible(!1),this._myValidVisualVerticalLine.setVisible(!1),this._myValidVisualTeleportPositionTorus.setVisible(!1),this._myValidVisualTeleportPositionTorusInner.setVisible(!1),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject!=null&&this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!1)}_addVisualLines(e){for(let t=0;t<e;t++){{let n=new PP.VisualLineParams;this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?n.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial:n.myMaterial=this._myTeleportParableValidMaterial,this._myValidVisualLines.push(new PP.VisualLine(n))}{let n=new PP.VisualLineParams;this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?n.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableInvalidMaterial:n.myMaterial=this._myTeleportParableInvalidMaterial,this._myInvalidVisualLines.push(new PP.VisualLine(n))}}}};PP.PlayerLocomotionTeleportDetectionVisualizer.prototype._setupVisuals=function(){let i=PP.vec3_create();return function(){this._myTeleportParableValidMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),this._myTeleportParableValidMaterial.color=PP.vec4_create(0,.5,1,1),this._myTeleportParableInvalidMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),this._myTeleportParableInvalidMaterial.color=PP.vec4_create(.75,.05,0,1),this._myValidVisualLines=[],this._myInvalidVisualLines=[],this._addVisualLines(30);{let t=new PP.VisualPointParams;this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial:t.myMaterial=this._myTeleportParableValidMaterial,this._myValidVisualPoint=new PP.VisualPoint(t)}{let t=new PP.VisualPointParams;this._myTeleportParams.myVisualizerParams.myTeleportParableInvalidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableInvalidMaterial:t.myMaterial=this._myTeleportParableInvalidMaterial,this._myInvalidVisualPoint=new PP.VisualPoint(t)}{let t=new PP.VisualLineParams;this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial:t.myMaterial=this._myTeleportParableValidMaterial,this._myValidVisualVerticalLine=new PP.VisualLine(t)}this._myVisualTeleportPositionObject=PP.myVisualData.myRootObject.pp_addObject();{let t=new PP.VisualTorusParams;t.myRadius=.175,t.mySegmentsAmount=24,t.mySegmentThickness=.02,this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial:t.myMaterial=this._myTeleportParableValidMaterial,t.myParent=this._myVisualTeleportPositionObject,t.myIsLocal=!0,this._myValidVisualTeleportPositionTorus=new PP.VisualTorus(t)}{let t=new PP.VisualTorusParams;t.myRadius=.04,t.mySegmentsAmount=24,t.mySegmentThickness=.02,this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial:t.myMaterial=this._myTeleportParableValidMaterial,t.myParent=this._myVisualTeleportPositionObject,t.myIsLocal=!0;let n=this._myValidVisualTeleportPositionTorus.getParams(),a=(n.myRadius-n.mySegmentThickness/2)/2;i.vec3_set(0,0,a),t.myTransform.mat4_setPosition(i),this._myValidVisualTeleportPositionTorusInner=new PP.VisualTorus(t)}this._myTeleportParams.myVisualizerParams.myTeleportPositionObject!=null&&(this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setParent(this._myVisualTeleportPositionObject),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_resetTransformLocal(),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!1)),this._hideTeleportPosition()}}();PP.PlayerLocomotionTeleportDetectionVisualizer.prototype._showTeleportParable=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create();return function(s){let o=Math.max(this._myDetectionRuntimeParams.myParableDistance-this._myTeleportParams.myVisualizerParams.myTeleportParableLineEndOffset),l=this._myDetectionRuntimeParams.myParable.getPositionIndexByDistance(o),m=this._myDetectionRuntimeParams.myParable.getDistance(l);l+1>this._myValidVisualLines.length&&this._addVisualLines(l+1,this._myValidVisualLines.length);for(let y=0;y<=l;y++){i=this._myDetectionRuntimeParams.myParable.getPosition(y,i),e=this._myDetectionRuntimeParams.myParable.getPosition(y+1,e);let u=this._myDetectionRuntimeParams.myTeleportPositionValid?this._myValidVisualLines[y]:this._myInvalidVisualLines[y],p=u.getParams();if(y==l){let d=Math.max(0,o-m);e=e.vec3_sub(i,e).vec3_normalize(e),e=i.vec3_add(e.vec3_scale(d,e),e)}p.setStartEnd(i,e),p.myThickness=.005,u.paramsUpdated(),u.setVisible(!0),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugShowActive&&PP.myDebugVisualManager.drawPoint(0,i,PP.vec4_create(1,0,0,1),.01)}let c=this._myDetectionRuntimeParams.myTeleportPositionValid?this._myValidVisualPoint:this._myInvalidVisualPoint,r=c.getParams();if(r.myPosition.vec3_copy(e),r.myRadius=.01,c.paramsUpdated(),c.setVisible(!0),this._myDetectionRuntimeParams.myTeleportPositionValid){t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t),n=e.vec3_sub(this._myTeleportRuntimeParams.myTeleportPosition,n).vec3_componentAlongAxis(t,n);let y=n.vec3_length();if(y>=this._myTeleportParams.myVisualizerParams.myTeleportParableMinVerticalDistanceToShowVerticalLine){let u=Math.min(y-this._myTeleportParams.myVisualizerParams.myTeleportParableMinVerticalDistanceToShowVerticalLine,this._myTeleportParams.myVisualizerParams.myTeleportParableMinVerticalDistanceToShowVerticalLine),p=this._myValidVisualVerticalLine.getParams();p.myStart.vec3_copy(e),p.myDirection=t.vec3_negate(p.myDirection),p.myLength=u,p.myThickness=.005,this._myValidVisualVerticalLine.paramsUpdated(),this._myValidVisualVerticalLine.setVisible(!0)}this._showTeleportParablePosition(s)}else this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1}}();PP.PlayerLocomotionTeleportDetectionVisualizer.prototype._showTeleportParablePosition=function(){let i=PP.vec3_create(),e=PP.quat2_create(),t=PP.quat_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.quat_create(),o=PP.quat2_create(),l=PP.vec3_create(),m=PP.quat_create(),c=PP.quat_create();return function(y){if(i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),t=e.quat2_getRotationQuat(t),t=t.quat_rotateAxis(this._myTeleportRuntimeParams.myTeleportRotationOnUp,i,t),a=t.quat_getForward(a),n=this._myTeleportRuntimeParams.myTeleportPosition.vec3_add(i.vec3_scale(this._myTeleportParams.myVisualizerParams.myTeleportParablePositionUpOffset,n),n),this._myTeleportParams.myVisualizerParams.myTeleportParablePositionVisualAlignOnSurface?s.quat_setUp(this._myDetectionRuntimeParams.myTeleportSurfaceNormal,a):s.quat_setUp(i,a),this._myVisualTeleportTransformQuat.quat2_setPositionRotationQuat(n,s),this._myVisualTeleportTransformQuatReset||!this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpActive)this._myVisualTeleportPositionObject.pp_setTransformQuat(this._myVisualTeleportTransformQuat),this._myVisualTeleportTransformQuatReset=!1;else{o=this._myVisualTeleportPositionObject.pp_getTransformQuat(o),l=o.quat2_getPosition(l),m=o.quat2_getRotationQuat(m),m.quat_rotationToQuat(s,c);let u=l.vec3_distance(n),p=c.quat_getAngle();if((!this._myVisualTeleportTransformPositionLerping||u<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToResetLerp)&&(u<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToLerp||u>this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMaxDistanceToLerp))this._myVisualTeleportTransformPositionLerping=!1,l.vec3_copy(n);else{this._myVisualTeleportTransformPositionLerping=!0;let d=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpFactor*y;u<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToCloseLerpFactor&&(d=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionCloseLerpFactor*y),l.vec3_lerp(n,d,l)}if((!this._myVisualTeleportTransformRotationLerping||p<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinAngleDistanceToResetLerp)&&(p<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinAngleDistanceToLerp||u>this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMaxAngleDistanceToLerp))this._myVisualTeleportTransformRotationLerping=!1,m.quat_copy(s);else{let d=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpFactor*y;this._myVisualTeleportTransformRotationLerping=!0,m.quat_slerp(s,d,m)}o.quat2_setPositionRotationQuat(l,m),this._myVisualTeleportPositionObject.pp_setTransformQuat(o)}{let u=this._myValidVisualTeleportPositionTorus.getParams();u.myRadius=.175,u.mySegmentsAmount=24,u.mySegmentThickness=.02,this._myValidVisualTeleportPositionTorus.paramsUpdated()}{let u=this._myValidVisualTeleportPositionTorusInner.getParams();u.myRadius=.04,u.mySegmentsAmount=24,u.mySegmentThickness=.02,this._myValidVisualTeleportPositionTorusInner.paramsUpdated()}this._myTeleportParams.myVisualizerParams.myTeleportPositionObject==null?(this._myValidVisualTeleportPositionTorus.setVisible(!0),this._myValidVisualTeleportPositionTorusInner.setVisible(!0)):(this._myValidVisualTeleportPositionTorus.setVisible(!1),this._myValidVisualTeleportPositionTorusInner.setVisible(!1),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!0)),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugShowActive&&PP.myDebugVisualManager.drawPoint(0,this._myTeleportRuntimeParams.myTeleportPosition,PP.vec4_create(0,0,1,1),.02)}}()});var es=S(()=>{PP.PlayerLocomotionTeleportDetectionParams=class{constructor(){this.myMaxDistance=0,this.myMaxHeightDifference=0,this.myGroundAngleToIgnoreUpward=0,this.myMustBeOnGround=!1,this.myTeleportBlockLayerFlags=new PP.PhysicsLayerFlags,this.myTeleportFloorLayerFlags=new PP.PhysicsLayerFlags,this.myParableForwardMinAngleToBeValidUp=30,this.myParableForwardMinAngleToBeValidDown=0,this.myTeleportParableStartReferenceObject=null,this.myTeleportParableStartPositionOffset=PP.vec3_create(0,-.04,.08),this.myTeleportParableStartRotationOffset=PP.vec3_create(30,0,0),this.myTeleportParableSpeed=15,this.myTeleportParableGravity=-30,this.myTeleportParableStepLength=.25,this.myRotationOnUpMinStickIntensity=.5,this.myRotationOnUpActive=!1,this.myTeleportFeetPositionMustBeVisible=!1,this.myTeleportHeadPositionMustBeVisible=!1,this.myTeleportHeadOrFeetPositionMustBeVisible=!1,this.myVisibilityCheckRadius=.05,this.myVisibilityCheckFeetPositionVerticalOffset=.1,this.myVisibilityCheckDistanceFromHitThreshold=.1,this.myVisibilityCheckCircumferenceSliceAmount=6,this.myVisibilityCheckCircumferenceStepAmount=1,this.myVisibilityCheckCircumferenceRotationPerStep=30,this.myVisibilityBlockLayerFlags=new PP.PhysicsLayerFlags}};PP.PlayerLocomotionTeleportDetectionRuntimeParams=class{constructor(){this.myTeleportDetectionValid=!1,this.myTeleportPositionValid=!1,this.myTeleportSurfaceNormal=PP.vec3_create(),this.myParable=new PP.PlayerLocomotionTeleportParable}};PP.PlayerLocomotionTeleportDetectionState=class extends PP.PlayerLocomotionTeleportState{constructor(e,t,n){super(e,t,n),this._myDetectionRuntimeParams=new PP.PlayerLocomotionTeleportDetectionRuntimeParams,this._myVisualizer=new PP.PlayerLocomotionTeleportDetectionVisualizer(this._myTeleportParams,this._myTeleportRuntimeParams,this._myDetectionRuntimeParams),this._myTeleportRotationOnUpNext=0}start(){this._myLocomotionRuntimeParams.myIsTeleportDetecting=!0,this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0,this._myDetectionRuntimeParams.myParable.setSpeed(this._myTeleportParams.myDetectionParams.myTeleportParableSpeed),this._myDetectionRuntimeParams.myParable.setGravity(this._myTeleportParams.myDetectionParams.myTeleportParableGravity),this._myDetectionRuntimeParams.myParable.setStepLength(this._myTeleportParams.myDetectionParams.myTeleportParableStepLength),this._myTeleportParams.myPlayerTransformManager.resetReal(!0,!1,!1),this._myTeleportParams.myPlayerTransformManager.resetHeadToReal(),this._myVisualizer.start()}end(){this._myLocomotionRuntimeParams.myIsTeleportDetecting=!1,this._myVisualizer.end()}update(e,t){this._detectTeleportPosition(),this._myVisualizer.update(e),this._confirmTeleport()?this._myDetectionRuntimeParams.myTeleportPositionValid?t.perform("teleport"):t.perform("cancel"):this._cancelTeleport()&&t.perform("cancel")}_confirmTeleport(){let e=!1;return PP.XRUtils.isSessionActive()?PP.myGamepads[this._myTeleportParams.myHandedness].getAxesInfo(PP.GamepadAxesID.THUMBSTICK).getAxes().vec2_length()<=this._myTeleportParams.myStickIdleThreshold&&(e=!0):PP.myMouse.isInsideView()&&(e=PP.myMouse.isButtonPressEnd(PP.MouseButtonID.MIDDLE)),e}_cancelTeleport(){let e=!1;return PP.XRUtils.isSessionActive()?e=PP.myGamepads[this._myTeleportParams.myHandedness].getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressed():e=PP.myMouse.isButtonPressEnd(PP.MouseButtonID.RIGHT)||!PP.myMouse.isInsideView(),e}_detectTeleportPosition(){PP.XRUtils.isSessionActive()?(this._detectTeleportRotationVR(),this._detectTeleportPositionVR()):(this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0,this._detectTeleportPositionNonVR())}};PP.PlayerLocomotionTeleportDetectionState.prototype._detectTeleportPositionNonVR=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create();return function(a){this._myDetectionRuntimeParams.myTeleportPositionValid=!1,this._myDetectionRuntimeParams.myTeleportDetectionValid=!0,t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t),PP.myMouse.getOriginWorld(i),PP.myMouse.getDirectionWorld(e),this._detectTeleportPositionParable(i,e,t)}}();PP.PlayerLocomotionTeleportDetectionState.prototype._detectTeleportPositionVR=function(){let i=PP.quat2_create(),e=PP.quat2_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create();return function(l){if(this._myDetectionRuntimeParams.myTeleportPositionValid=!1,this._myDetectionRuntimeParams.myTeleportDetectionValid=!1,this._myTeleportParams.myDetectionParams.myTeleportParableStartReferenceObject==null){let m=PP.myPlayerObjects.myHands[this._myTeleportParams.myHandedness];i.quat2_setPositionRotationDegrees(this._myTeleportParams.myDetectionParams.myTeleportParableStartPositionOffset,this._myTeleportParams.myDetectionParams.myTeleportParableStartRotationOffset),e=m.pp_convertTransformObjectToWorldQuat(i,e)}else this._myTeleportParams.myDetectionParams.myTeleportParableStartReferenceObject.pp_getTransformQuat(e);t=e.quat2_getPosition(t),n=e.quat2_getForward(n),a=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(a),s=a.vec3_negate(s),n.vec3_angle(a)>=this._myTeleportParams.myDetectionParams.myParableForwardMinAngleToBeValidUp&&n.vec3_angle(s)>=this._myTeleportParams.myDetectionParams.myParableForwardMinAngleToBeValidDown&&(this._myDetectionRuntimeParams.myTeleportDetectionValid=!0),this._myDetectionRuntimeParams.myTeleportDetectionValid&&this._detectTeleportPositionParable(t,n,a)}}();PP.PlayerLocomotionTeleportDetectionState.prototype._detectTeleportPositionParable=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=new PP.RaycastSetup,a=new PP.RaycastResults,s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=new PP.CollisionRuntimeParams,p=(d,_)=>d.pp_equals(_);return function(_,h,P){this._myDetectionRuntimeParams.myParable.setStartPosition(_),this._myDetectionRuntimeParams.myParable.setForward(h),this._myDetectionRuntimeParams.myParable.setUp(P);let T=1,v=0,f=0;e=this._myDetectionRuntimeParams.myParable.getPosition(T-1,e),n.myIgnoreHitsInsideCollision=!0,n.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myTeleportBlockLayerFlags.getMask()),n.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let I of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)n.myObjectsToIgnore.pp_pushUnique(I,p);let g=this._myTeleportParams.myDetectionParams.myMaxDistance*2;do i=this._myDetectionRuntimeParams.myParable.getPosition(T,i),n.myOrigin.vec3_copy(e),n.myDirection=i.vec3_sub(e,n.myDirection),n.myDistance=n.myDirection.vec3_length(),n.myDirection.vec3_normalize(n.myDirection),a=PP.PhysicsUtils.raycast(n,a),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugDetectActive&&PP.myDebugVisualManager.drawRaycast(0,a),e.vec3_copy(i),v=i.vec3_sub(_,i).vec3_removeComponentAlongAxis(P,i).vec3_length(),f=this._myDetectionRuntimeParams.myParable.getDistance(T),T++;while(v<=this._myTeleportParams.myDetectionParams.myMaxDistance&&f<=g&&!a.isColliding());let C=this._myDetectionRuntimeParams.myParable.getDistanceOverFlatDistance(this._myTeleportParams.myDetectionParams.myMaxDistance,g),M=f;(f>C||f>g)&&(M=Math.min(C,g)),this._myDetectionRuntimeParams.myParableDistance=M;let b=!1,A=100;if(a.isColliding()){let I=a.myHits.pp_first(),V=f-(n.myDistance-I.myDistance);if(V<=M&&(b=!0,this._myDetectionRuntimeParams.myParableDistance=V,u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(I,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal),s.vec3_copy(I.myPosition),o.vec3_copy(I.myNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(l=I.myPosition.vec3_add(I.myNormal.vec3_scale(.01,l),l),m=P.vec3_negate(m),n.myOrigin.vec3_copy(l),n.myDirection.vec3_copy(m),n.myDistance=A,a=PP.PhysicsUtils.raycast(n,a),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugDetectActive&&PP.myDebugVisualManager.drawRaycast(0,a),a.isColliding()))){let D=a.myHits.pp_first();if(u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(D,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&u.myTeleportCanceled&&u.myIsCollidingHorizontally&&(c=u.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(P,c),!c.vec3_isZero(1e-5))){c.vec3_normalize(c);let B=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(c.vec3_scale(B,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(m),n.myDistance=A,a=PP.PhysicsUtils.raycast(n,a),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugDetectActive&&(PP.myDebugVisualManager.drawPoint(0,n.myOrigin,PP.vec4_create(0,0,0,1),.03),PP.myDebugVisualManager.drawRaycast(0,a)),a.isColliding()){let L=a.myHits.pp_first();u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(L,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(r=o.vec3_removeComponentAlongAxis(P,r),!r.vec3_isZero(1e-5))){r.vec3_normalize(r);let B=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(r.vec3_scale(B,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(m),n.myDistance=A,a=PP.PhysicsUtils.raycast(n,a),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugDetectActive&&(PP.myDebugVisualManager.drawPoint(0,n.myOrigin,PP.vec4_create(0,0,0,1),.03),PP.myDebugVisualManager.drawRaycast(0,a)),a.isColliding()){let L=a.myHits.pp_first();u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(L,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(y=h.vec3_negate(y).vec3_removeComponentAlongAxis(P,y).vec3_normalize(y),!y.vec3_isZero(1e-5))){y.vec3_normalize(y);let B=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(y.vec3_scale(B,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(m),n.myDistance=A,a=PP.PhysicsUtils.raycast(n,a),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugDetectActive&&(PP.myDebugVisualManager.drawPoint(0,n.myOrigin,PP.vec4_create(0,0,0,1),.03),PP.myDebugVisualManager.drawRaycast(0,a)),a.isColliding()){let L=a.myHits.pp_first();u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(L,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal)}}}}if(!b&&(t=this._myDetectionRuntimeParams.myParable.getPositionByDistance(this._myDetectionRuntimeParams.myParableDistance,t),l.vec3_copy(t),m=P.vec3_negate(m),n.myOrigin.vec3_copy(l),n.myDirection.vec3_copy(m),n.myDistance=A,a=PP.PhysicsUtils.raycast(n,a),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugDetectActive&&PP.myDebugVisualManager.drawRaycast(0,a),a.isColliding())){let I=a.myHits.pp_first();if(u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(I,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&u.myTeleportCanceled&&u.myIsCollidingHorizontally&&(c=u.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(P,c),!c.vec3_isZero(1e-5))){c.vec3_normalize(c);let V=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(c.vec3_scale(V,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(m),n.myDistance=A,a=PP.PhysicsUtils.raycast(n,a),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugDetectActive&&(PP.myDebugVisualManager.drawPoint(0,n.myOrigin,PP.vec4_create(0,0,0,1),.03),PP.myDebugVisualManager.drawRaycast(0,a)),a.isColliding()){let D=a.myHits.pp_first();u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(D,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(y=h.vec3_negate(y).vec3_removeComponentAlongAxis(P,y).vec3_normalize(y),!y.vec3_isZero(1e-5))){y.vec3_normalize(y);let V=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(y.vec3_scale(V,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(m),n.myDistance=A,a=PP.PhysicsUtils.raycast(n,a),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugDetectActive&&(PP.myDebugVisualManager.drawPoint(0,n.myOrigin,PP.vec4_create(0,0,0,1),.03),PP.myDebugVisualManager.drawRaycast(0,a)),a.isColliding()){let D=a.myHits.pp_first();u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(D,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal)}}}}}();PP.PlayerLocomotionTeleportDetectionState.prototype._detectTeleportRotationVR=function(){let i=PP.vec3_create(),e=PP.vec3_create(0,0,1),t=PP.vec3_create(0,1,0);return function(a){let s=PP.myGamepads[this._myTeleportParams.myHandedness].getAxesInfo(PP.GamepadAxesID.THUMBSTICK).getAxes();s.vec2_length()>this._myTeleportParams.myDetectionParams.myRotationOnUpMinStickIntensity&&(this._myTeleportRuntimeParams.myTeleportRotationOnUp=this._myTeleportRotationOnUpNext,i.vec3_set(s[0],0,s[1]),this._myTeleportRotationOnUpNext=i.vec3_angleSigned(e,t)),this._myTeleportParams.myDetectionParams.myRotationOnUpActive||(this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0)}}();PP.PlayerLocomotionTeleportDetectionState.prototype._isTeleportHitValid=function(){let i=new PP.RaycastSetup,e=new PP.RaycastResults,t=PP.vec3_create(),n=(a,s)=>a.pp_equals(s);return function(s,o,l){let m=!1;if(this._myTeleportAsMovementFailed=!1,s.isValid()&&!s.myIsInsideCollision){t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t);{i.myIgnoreHitsInsideCollision=!0,i.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myTeleportFloorLayerFlags.getMask()),i.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let r of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)i.myObjectsToIgnore.pp_pushUnique(r,n);let c=.01;i.myOrigin=s.myPosition.vec3_add(s.myNormal.vec3_scale(c,i.myOrigin),i.myOrigin),i.myDirection=s.myNormal.vec3_negate(i.myDirection),i.myDistance=c*1.25,i.myDirection.vec3_normalize(i.myDirection),e=PP.PhysicsUtils.raycast(i,e),e.isColliding()&&e.myHits.pp_first().myObject.pp_equals(s.myObject)&&(m=this._isTeleportPositionValid(s.myPosition,o,l))}}return m}}();PP.PlayerLocomotionTeleportDetectionState.prototype._isTeleportPositionValid=function(){let i=PP.vec3_create(),e=PP.quat2_create(),t=PP.quat_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=new PP.CollisionRuntimeParams;return function(l,m,c){let r=!1;if(this._isTeleportPositionVisible(l)&&(i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),n=e.quat2_getPosition(n),m!=0&&(t=e.quat2_getRotationQuat(t),t=t.quat_rotateAxis(m,i,t),e.quat2_setPositionRotationQuat(n,t)),l.vec3_sub(n,a).vec3_componentAlongAxis(i,a).vec3_length()<this._myTeleportParams.myDetectionParams.myMaxHeightDifference+1e-5)){let p=!1;if(s.copy(this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myTeleportParams.myPerformTeleportAsMovement?this._checkTeleportAsMovement(l,e,s,c):this._checkTeleport(l,e,s,c),s.myTeleportCanceled||(p=!0),p&&(!this._myTeleportParams.myDetectionParams.myMustBeOnGround||s.myIsOnGround)){let d=!0;s.myNewPosition.vec3_isFartherAlongAxis(n,i)&&(d=s.myGroundAngle<this._myTeleportParams.myDetectionParams.myGroundAngleToIgnoreUpward+1e-4),d&&(r=!0)}}return r}}()});var ts=S(()=>{PP.PlayerLocomotionTeleportDetectionState.prototype._isTeleportPositionVisible=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create();return function(a){let s=!0;if(this._myTeleportParams.myDetectionParams.myTeleportFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible){i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i);let o=!1,l=!1;if(this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadPositionMustBeVisible){let m=this._myTeleportParams.myPlayerHeadManager.getHeightHead();t=a.vec3_add(i.vec3_scale(m,t),t),o=this._isPositionVisible(t)}else o=!0;this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible&&o?l=!0:this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportFeetPositionMustBeVisible&&o?(e=a.vec3_add(i.vec3_scale(this._myTeleportParams.myDetectionParams.myVisibilityCheckFeetPositionVerticalOffset,e),e),l=this._isPositionVisible(e)):l=!0,s=o&&l}return s}}();PP.PlayerLocomotionTeleportDetectionState.prototype._isPositionVisible=function(){let i=PP.vec3_create(),e=PP.vec3_create(0,1,0),t=PP.vec3_create(0,0,1),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create(),r=new PP.RaycastSetup,y=new PP.RaycastResults,u=(p,d)=>p.pp_equals(d);return function(d){let _=!0;i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),a=this._myTeleportParams.myPlayerHeadManager.getHead().pp_getPosition(a),s=d.vec3_sub(a,s).vec3_normalize(s),n.vec3_copy(e),s.vec3_angle(e)<1e-4&&n.vec3_copy(t),o=s.vec3_cross(n,o),m=o.vec3_cross(s,m),l.vec3_copy(s),m.vec3_normalize(m),l.vec3_normalize(l);let P=this._getVisibilityCheckPositions(a,m,l),T=a.vec3_distance(d);for(let v of P){r.myOrigin.vec3_copy(v),r.myDirection.vec3_copy(l),r.myDistance=T,r.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myVisibilityBlockLayerFlags.getMask()),r.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let f of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)r.myObjectsToIgnore.pp_pushUnique(f,u);if(r.myIgnoreHitsInsideCollision=!0,y=PP.PhysicsUtils.raycast(r,y),this._myTeleportParams.myDebugActive&&this._myTeleportParams.myDebugVisibilityActive&&PP.myDebugVisualManager.drawRaycast(0,y),y.isColliding()){c=v.vec3_add(l.vec3_scale(T,c),c);let f=y.myHits.pp_first();if(this._myTeleportParams.myDetectionParams.myVisibilityCheckDistanceFromHitThreshold==0||f.myPosition.vec3_distance(c)>this._myTeleportParams.myDetectionParams.myVisibilityCheckDistanceFromHitThreshold+1e-5){_=!1;break}}}return _}}();PP.PlayerLocomotionTeleportDetectionState.prototype._getVisibilityCheckPositions=function(){let i=[],e=[],t=0,n=function(){let s=null;for(;e.length<=t;)e.push(PP.vec3_create());return s=e[t],t++,s},a=PP.vec3_create();return function(o,l,m){i.length=0,t=0;{let u=n();u.vec3_copy(o),i.push(u)}let c=this._myTeleportParams.myDetectionParams.myVisibilityCheckRadius/this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceStepAmount,r=360/this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceSliceAmount,y=0;for(let u=0;u<this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceStepAmount;u++){let p=c*(u+1);a=l.vec3_rotateAxis(y,m,a);for(let d=0;d<this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceSliceAmount;d++){let _=n(),h=a.vec3_rotateAxis(r*d,m,_);i.push(o.vec3_add(h.vec3_scale(p,h),h))}y+=this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceRotationPerStep}return i}}()});var is=S(()=>{PP.PlayerLocomotionTeleportTeleportType={INSTANT:0,BLINK:1,SHIFT:2};PP.PlayerLocomotionTeleportTeleportParams=class{constructor(){this.myTeleportType=PP.PlayerLocomotionTeleportTeleportType.SHIFT,this.myBlinkFadeOutSeconds=.1,this.myBlinkFadeInSeconds=.1,this.myBlinkWaitSeconds=.1,this.myBlinkSphereColor=PP.vec3_create(),this.myBlinkSphereScale=.1,this.myShiftMovementSeconds=.15,this.myShiftMovementSecondsMultiplierOverDistanceFunction=null,this.myShiftMovementEasingFunction=PP.EasingFunction.easeInOut,this.myShiftRotateSeconds=1,this.myShiftRotateSecondsMultiplierOverAngleFunction=null,this.myShiftRotateEasingFunction=PP.EasingFunction.easeOut,this.myShiftRotateStartAfterMovementPercentage=.7,this.myShiftRotateSecondsMultiplierOverAngleFunction=function(e){return PP.EasingFunction.easeOut(e/180)}}};PP.PlayerLocomotionTeleportTeleportState=class extends PP.PlayerLocomotionTeleportState{constructor(e,t,n){super(e,t,n),this._myFSM=new PP.FSM,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myBlinkState=new PP.PlayerLocomotionTeleportTeleportBlinkState(e,t,n),this._myShiftState=new PP.PlayerLocomotionTeleportTeleportShiftState(e,t,n),this._myFSM.addState("instant_teleport",this._instantUpdate.bind(this)),this._myFSM.addState("blink_teleport",this._myBlinkState),this._myFSM.addState("shift_teleport",this._myShiftState),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","instant_teleport","start_instant"),this._myFSM.addTransition("idle","blink_teleport","start_blink"),this._myFSM.addTransition("idle","shift_teleport","start_shift"),this._myFSM.addTransition("instant_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("blink_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("shift_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("instant_teleport","idle","stop",this._instantStop.bind(this)),this._myFSM.addTransition("blink_teleport","idle","stop"),this._myFSM.addTransition("shift_teleport","idle","stop"),this._myFSM.init("init"),this._myFSM.perform("start")}start(e){switch(this._myParentFSM=e,this._myTeleportParams.myTeleportParams.myTeleportType){case PP.PlayerLocomotionTeleportTeleportType.INSTANT:this._myFSM.perform("start_instant");break;case PP.PlayerLocomotionTeleportTeleportType.BLINK:this._myFSM.perform("start_blink");break;case PP.PlayerLocomotionTeleportTeleportType.SHIFT:this._myFSM.perform("start_shift");break;default:this._myFSM.perform("start_instant")}}end(){}update(e,t){this._myFSM.update(e)}completeTeleport(){this._myFSM.perform("stop"),this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}_instantUpdate(e,t){this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,t.perform("done")}_instantStop(e){this._instantUpdate(0,e)}_completeTeleport(){fsm.perform("stop")}_teleportDone(){this._myTeleportParams.myPlayerTransformManager.resetReal(!0,!1,!1),this._myTeleportParams.myPlayerTransformManager.resetHeadToReal(),this._myParentFSM.performDelayed("done")}}});var ns=S(()=>{PP.PlayerLocomotionTeleportTeleportBlinkState=class extends PP.PlayerLocomotionTeleportState{constructor(e,t,n){super(e,t,n),this._myBlinkSphere=WL.scene.addObject(null),this._myBlinkSphereMeshComponent=this._myBlinkSphere.pp_addComponent("mesh"),this._myBlinkSphereMeshComponent.mesh=PP.myDefaultResources.myMeshes.myInvertedSphere,this._myBlinkSphereMeshComponent.material=PP.myDefaultResources.myMaterials.myFlatTransparentNoDepth.clone(),this._myBlinkSphereMaterialColor=[this._myTeleportParams.myTeleportParams.myBlinkSphereColor[0]/255,this._myTeleportParams.myTeleportParams.myBlinkSphereColor[1]/255,this._myTeleportParams.myTeleportParams.myBlinkSphereColor[2]/255,0],this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myBlinkSphere.pp_resetTransformLocal(),this._myBlinkSphere.pp_setScaleLocal(this._myTeleportParams.myTeleportParams.myBlinkSphereScale),this._myBlinkSphere.pp_setActive(!1),this._myFSM=new PP.FSM,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myFSM.addState("fade_out",this._fadeOutUpdate.bind(this)),this._myFSM.addState("wait",new PP.TimerState(this._myTeleportParams.myTeleportParams.myBlinkWaitSeconds,"done")),this._myFSM.addState("fade_in",this._fadeInUpdate.bind(this)),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","fade_out","teleport",this._startFadeOut.bind(this)),this._myFSM.addTransition("fade_out","wait","done",this._teleport.bind(this)),this._myFSM.addTransition("wait","fade_in","done",this._startFadeIn.bind(this)),this._myFSM.addTransition("fade_in","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("fade_out","idle","stop",this._stop.bind(this,!0)),this._myFSM.addTransition("wait","idle","stop",this._stop.bind(this,!1)),this._myFSM.addTransition("fade_in","idle","stop",this._stop.bind(this,!1)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myFadeInTimer=new PP.Timer(this._myTeleportParams.myTeleportParams.myBlinkFadeInSeconds),this._myFadeOutTimer=new PP.Timer(this._myTeleportParams.myTeleportParams.myBlinkFadeOutSeconds),this._myFadeOutAlphaOverTime=new PP.NumberOverValue(0,1,0,1),this._myFadeInAlphaOverTime=new PP.NumberOverValue(1,0,0,1)}start(e){this._myParentFSM=e,this._myFSM.perform("teleport")}end(){this._myBlinkSphere.pp_setActive(!1),this._myBlinkSphere.pp_setParent(null,!1),this._myFSM.perform("stop")}update(e,t){this._myBlinkSphere.pp_setParent(this._myTeleportParams.myPlayerHeadManager.getHead(),!1),this._myBlinkSphere.pp_resetTransformLocal(),this._myFSM.update(e)}_startFadeOut(){this._myFadeOutTimer.start(),this._myBlinkSphereMaterialColor[3]=0,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myBlinkSphere.pp_setActive(!0)}_startFadeIn(){this._myFadeInTimer.start()}_fadeOutUpdate(e,t){this._myFadeOutTimer.update(e);let n=this._myFadeOutAlphaOverTime.get(this._myFadeOutTimer.getPercentage());this._myBlinkSphereMaterialColor[3]=n,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myFadeOutTimer.isDone()&&t.perform("done")}_fadeInUpdate(e,t){this._myFadeInTimer.update(e);let n=this._myFadeInAlphaOverTime.get(this._myFadeInTimer.getPercentage());this._myBlinkSphereMaterialColor[3]=n,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myFadeInTimer.isDone()&&t.perform("done")}_teleportDone(){this._myBlinkSphere.pp_setActive(!1),this._myParentFSM.performDelayed("done")}_stop(e){this._myBlinkSphere.pp_setActive(!1),e&&this._teleport()}_teleport(){this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}}});var as=S(()=>{PP.PlayerLocomotionTeleportTeleportShiftState=class extends PP.PlayerLocomotionTeleportState{constructor(e,t,n){super(e,t,n),this._myFSM=new PP.FSM,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myFSM.addState("shifting",this._shiftingUpdate.bind(this)),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","shifting","teleport",this._startShifting.bind(this)),this._myFSM.addTransition("shifting","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("shifting","idle","stop",this._stop.bind(this)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myShiftMovementTimer=new PP.Timer(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds),this._myShiftRotateTimer=new PP.Timer(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds,!1),this._myFeetStartPosition=new PP.vec3_create,this._myCurrentRotationOnUp=0,this._myStartRotationOnUp=0}start(e){this._myParentFSM=e,this._myFSM.perform("teleport")}end(){this._myFSM.perform("stop")}update(e,t){this._myFSM.update(e)}_startShifting(){if(this._myTeleportParams.myPlayerTransformManager.getParams().mySyncPositionDisabled=!0,this._myLocomotionRuntimeParams.myIsTeleporting=!0,this._myFeetStartPosition=this._myTeleportParams.myPlayerHeadManager.getPositionFeet(this._myFeetStartPosition),this._myShiftMovementTimer.start(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds),this._myTeleportParams.myTeleportParams.myShiftMovementSecondsMultiplierOverDistanceFunction){let e=this._myTeleportRuntimeParams.myTeleportPosition.vec3_distance(this._myFeetStartPosition),t=this._myTeleportParams.myTeleportParams.myShiftMovementSecondsMultiplierOverDistanceFunction(e);this._myShiftMovementTimer.start(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds*t)}if(this._myShiftRotateTimer.reset(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds),this._myTeleportParams.myTeleportParams.myShiftRotateSecondsMultiplierOverAngleFunction){let e=this._myTeleportParams.myTeleportParams.myShiftRotateSecondsMultiplierOverAngleFunction(Math.abs(this._myTeleportRuntimeParams.myTeleportRotationOnUp));this._myShiftRotateTimer.reset(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds*e)}this._myStartRotationOnUp=this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myCurrentRotationOnUp=0}_stop(){this._teleport()}_teleportDone(){this._teleport(),this._myParentFSM.performDelayed("done")}_teleport(){this._myTeleportParams.myPlayerTransformManager.getParams().mySyncPositionDisabled=!1,this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myStartRotationOnUp-this._myCurrentRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}};PP.PlayerLocomotionTeleportTeleportShiftState.prototype._shiftingUpdate=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n,a){if(this._myShiftMovementTimer.update(n),this._myShiftRotateTimer.update(n),this._myShiftRotateTimer.isDone()&&this._myShiftMovementTimer.isDone())a.perform("done");else{if(e.vec3_copy(this._myTeleportRuntimeParams.myTeleportPosition),this._myShiftMovementTimer.isStarted()||this._myShiftMovementTimer.isJustDone()){let o=this._myTeleportParams.myTeleportParams.myShiftMovementEasingFunction(this._myShiftMovementTimer.getPercentage());o>=this._myTeleportParams.myTeleportParams.myShiftRotateStartAfterMovementPercentage&&!this._myShiftRotateTimer.isStarted()&&(this._myShiftRotateTimer.start(),this._myShiftRotateTimer.update(n)),i=this._myTeleportRuntimeParams.myTeleportPosition.vec3_sub(this._myFeetStartPosition,i),i.vec3_scale(o,i),e=this._myFeetStartPosition.vec3_add(i,e)}let s=0;if(this._myShiftRotateTimer.isRunning()||this._myShiftRotateTimer.isJustDone()){let o=this._myTeleportParams.myTeleportParams.myShiftRotateEasingFunction(this._myShiftRotateTimer.getPercentage()),l=this._myStartRotationOnUp*o;s=l-this._myCurrentRotationOnUp,this._myCurrentRotationOnUp=l}this._teleportToPosition(e,s,this._myLocomotionRuntimeParams.myCollisionRuntimeParams,!0)}}}();Object.defineProperty(PP.PlayerLocomotionTeleportTeleportShiftState.prototype,"_shiftingUpdate",{enumerable:!1})});var ss=S(()=>{PP.PlayerLocomotionTeleportParams=class{constructor(){this.myPlayerHeadManager=null,this.myCollisionCheckParams=null,this.myDetectionParams=new PP.PlayerLocomotionTeleportDetectionParams,this.myVisualizerParams=new PP.PlayerLocomotionTeleportDetectionVisualizerParams,this.myTeleportParams=new PP.PlayerLocomotionTeleportTeleportParams,this.myHandedness=PP.Handedness.LEFT,this.myPerformTeleportAsMovement=!1,this.myTeleportAsMovementMaxDistanceFromTeleportPosition=.001,this.myTeleportAsMovementMaxSteps=2,this.myTeleportAsMovementRemoveVerticalMovement=!0,this.myTeleportAsMovementExtraVerticalMovementPerMeter=1,this.myStickIdleThreshold=.1,this.myAdjustPositionEveryFrame=!1,this.myGravityAcceleration=0,this.myDebugActive=!1,this.myDebugDetectActive=!1,this.myDebugShowActive=!1,this.myDebugVisibilityActive=!1}};PP.PlayerLocomotionTeleportRuntimeParams=class{constructor(){this.myTeleportPosition=PP.vec3_create(),this.myTeleportRotationOnUp=0}};PP.PlayerLocomotionTeleport=class extends PP.PlayerLocomotionMovement{constructor(e,t){super(t),this._myTeleportParams=e,this._myTeleportRuntimeParams=new PP.PlayerLocomotionTeleportRuntimeParams,this._myStickIdleCharge=!0,this._myGravitySpeed=0,this._myDetectionState=new PP.PlayerLocomotionTeleportDetectionState(this._myTeleportParams,this._myTeleportRuntimeParams,this._myLocomotionRuntimeParams),this._myTeleportState=new PP.PlayerLocomotionTeleportTeleportState(this._myTeleportParams,this._myTeleportRuntimeParams,this._myLocomotionRuntimeParams),this._myFSM=new PP.FSM,this._myFSM.addState("init"),this._myFSM.addState("idle",this._idleUpdate.bind(this)),this._myFSM.addState("detect",this._myDetectionState),this._myFSM.addState("teleport",this._myTeleportState),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","detect","detect"),this._myFSM.addTransition("detect","teleport","teleport"),this._myFSM.addTransition("detect","idle","cancel"),this._myFSM.addTransition("teleport","idle","done"),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("detect","idle","stop"),this._myFSM.addTransition("teleport","idle","stop",this._completeTeleport.bind(this)),this._myFSM.init("init"),this._myFSM.perform("start")}start(){this._myGravitySpeed=0}stop(){this._myFSM.perform("stop")}canStop(){return this._myFSM.isInState("idle")}update(e){this._myLocomotionRuntimeParams.myTeleportJustPerformed=!1,this._myFSM.update(e),(this._myTeleportParams.myAdjustPositionEveryFrame||this._myTeleportParams.myGravityAcceleration!=0)&&this._applyGravity(e),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround&&(this._myLocomotionRuntimeParams.myIsFlying=!1)}_idleUpdate(e){this._startDetecting()&&this._myFSM.perform("detect")}_startDetecting(){let e=!1;if(!PP.XRUtils.isSessionActive())e=PP.myMouse.isButtonPressStart(PP.MouseButtonID.MIDDLE)&&PP.myMouse.isTargetingRenderCanvas();else{let t=PP.myGamepads[this._myTeleportParams.myHandedness].getAxesInfo(PP.GamepadAxesID.THUMBSTICK).getAxes();t.vec2_length()<=this._myTeleportParams.myStickIdleThreshold&&(this._myStickIdleCharge=!0),this._myStickIdleCharge&&t[1]>=.75&&(this._myStickIdleCharge=!1,e=!0)}return e}_completeTeleport(){this._myTeleportState.completeTeleport()}};PP.PlayerLocomotionTeleport.prototype._applyGravity=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.quat2_create();return function(a){i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),this._myGravitySpeed+=this._myTeleportParams.myGravityAcceleration*a,e=i.vec3_scale(this._myGravitySpeed*a,e),this._myLocomotionRuntimeParams.myIsFlying&&e.vec3_zero(),t=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(t),PP.myCollisionCheck.move(e,t,this._myTeleportParams.myCollisionCheckParams,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myVerticalMovementCanceled||this._myTeleportParams.myPlayerHeadManager.teleportPositionFeet(this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myNewPosition),(this._myGravitySpeed>0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnCeiling||this._myGravitySpeed<0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround)&&(this._myGravitySpeed=0)}}()});var os=S(()=>{PP.CleanedPlayerLocomotion=class{constructor(e){this._myParams=e,this._myCollisionCheckParamsMovement=new PP.CollisionCheckParams,this._setupCollisionCheckParamsMovement(),this._myCollisionCheckParamsTeleport=null,this._setupCollisionCheckParamsTeleport(),this._myCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._myMovementRuntimeParams=new PP.PlayerLocomotionMovementRuntimeParams,this._myMovementRuntimeParams.myCollisionRuntimeParams=this._myCollisionRuntimeParams;{let t=new PP.PlayerHeadManagerParams;t.mySessionChangeResyncEnabled=!0,t.myBlurEndResyncEnabled=!0,t.myBlurEndResyncRotation=!0,t.myEnterSessionResyncHeight=!1,t.myExitSessionResyncHeight=!1,t.myExitSessionResyncVerticalAngle=!0,t.myExitSessionRemoveRightTilt=!0,t.myExitSessionAdjustMaxVerticalAngle=!0,t.myExitSessionMaxVerticalAngle=90,t.myHeightOffsetVRWithFloor=0,t.myHeightOffsetVRWithoutFloor=1.75,t.myHeightOffsetNonVR=1.75,t.myForeheadExtraHeight=this._myParams.myForeheadExtraHeight,t.myFeetRotationKeepUp=!0,t.myDebugActive=!1,this._myPlayerHeadManager=new PP.PlayerHeadManager(t)}{let t=new PP.PlayerTransformManagerParams;t.myPlayerHeadManager=this._myPlayerHeadManager,t.myMovementCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myTeleportCollisionCheckParams=null,t.myTeleportCollisionCheckParamsCopyFromMovement=!0,t.myTeleportCollisionCheckParamsCheck360=!0,t.myHeadCollisionBlockLayerFlags.copy(t.myMovementCollisionCheckParams.myHorizontalBlockLayerFlags),t.myHeadCollisionBlockLayerFlags.add(t.myMovementCollisionCheckParams.myVerticalBlockLayerFlags),t.myHeadCollisionObjectsToIgnore.pp_copy(t.myMovementCollisionCheckParams.myHorizontalObjectsToIgnore);let n=(a,s)=>a.pp_equals(s);for(let a of t.myMovementCollisionCheckParams.myVerticalObjectsToIgnore)t.myHeadCollisionObjectsToIgnore.pp_pushUnique(a,n);t.myCollisionRuntimeParams=this._myCollisionRuntimeParams,t.myHeadRadius=.15,t.myIsMaxDistanceFromRealToSyncEnabled=!0,t.myMaxDistanceFromRealToSync=100,t.myIsFloatingValidIfVerticalMovement=!1,t.myIsFloatingValidIfVerticalMovementAndRealOnGround=!1,t.myIsFloatingValidIfSteepGround=!1,t.myIsFloatingValidIfVerticalMovementAndSteepGround=!1,t.myIsFloatingValidIfRealOnGround=!1,t.myIsLeaningValidAboveDistance=!0,t.myLeaningValidDistance=2,t.myFloatingSplitCheckEnabled=!0,t.myFloatingSplitCheckMaxLength=.2,t.myFloatingSplitCheckMaxSteps=5,t.myRealMovementAllowVerticalAdjustments=!1,t.myUpdateRealPositionValid=!0,t.myUpdatePositionValid=!0,t.myIsBodyCollidingWhenHeightBelowValue=null,t.myIsBodyCollidingWhenHeightAboveValue=null,t.myResetToValidOnEnterSession=!0,t.myResetToValidOnExitSession=!0,t.myAlwaysResetRealPositionNonVR=!0,t.myAlwaysResetRealRotationNonVR=!0,t.myAlwaysResetRealHeightNonVR=!0,t.myAlwaysResetRealPositionVR=!1,t.myAlwaysResetRealRotationVR=!1,t.myAlwaysResetRealHeightVR=!1,t.myNeverResetRealPositionNonVR=!1,t.myNeverResetRealRotationNonVR=!0,t.myNeverResetRealHeightNonVR=!1,t.myNeverResetRealPositionVR=!1,t.myNeverResetRealRotationVR=!1,t.myNeverResetRealHeightVR=!0,t.myResetRealOnMove=!1,t.myDebugActive=!1,this._myPlayerTransformManager=new PP.CleanedPlayerTransformManager(t)}{let t=new PP.PlayerObscureManagerParams;t.myPlayerTransformManager=this._myPlayerTransformManager,t.myObscureObject=null,t.myObscureMaterial=null,t.myObscureRadius=.1,t.myObscureFadeOutSeconds=.25,t.myObscureFadeInSeconds=.25,t.myObscureFadeEasingFunction=PP.EasingFunction.linear,t.myObscureLevelRelativeDistanceEasingFunction=PP.EasingFunction.linear,t.myDistanceToStartObscureWhenBodyColliding=.35,t.myDistanceToStartObscureWhenHeadColliding=0,t.myDistanceToStartObscureWhenFloating=.35,t.myDistanceToStartObscureWhenFar=.5,t.myRelativeDistanceToMaxObscureWhenBodyColliding=.5,t.myRelativeDistanceToMaxObscureWhenHeadColliding=.1,t.myRelativeDistanceToMaxObscureWhenFloating=.5,t.myRelativeDistanceToMaxObscureWhenFar=.5,this._myPlayerObscureManager=new PP.PlayerObscureManager(t)}{let t=new PP.PlayerLocomotionRotateParams;t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myMaxRotationSpeed=this._myParams.myMaxRotationSpeed,t.myIsSnapTurn=this._myParams.myIsSnapTurn,t.mySnapTurnOnlyVR=this._myParams.mySnapTurnOnlyVR,t.mySnapTurnAngle=this._myParams.mySnapTurnAngle,this._myParams.mySnapTurnSpeedDegrees>PP.LocomotionUtils.EPSILON_NUMBER?(t.mySmoothSnapActive=!0,t.mySmoothSnapSpeedDegrees=this._myParams.mySnapTurnSpeedDegrees):t.mySmoothSnapActive=!1,t.myRotationMinStickIntensityThreshold=.1,t.mySnapTurnActivateThreshold=.5,t.mySnapTurnResetThreshold=.4,t.myClampVerticalAngle=!0,t.myMaxVerticalAngle=90,this._myPlayerLocomotionRotate=new PP.PlayerLocomotionRotate(t),t.myHandedness=PP.InputUtils.getOppositeHandedness(this._myParams.myMainHand)}{{let t=new PP.PlayerLocomotionSmoothParams;t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myHandedness=this._myParams.myMainHand,t.myMaxSpeed=this._myParams.myMaxSpeed,t.myMovementMinStickIntensityThreshold=.1,t.myFlyEnabled=this._myParams.myFlyEnabled,t.myMinAngleToFlyUpNonVR=this._myParams.myMinAngleToFlyUpNonVR,t.myMinAngleToFlyDownNonVR=this._myParams.myMinAngleToFlyDownNonVR,t.myMinAngleToFlyUpVR=this._myParams.myMinAngleToFlyUpVR,t.myMinAngleToFlyDownVR=this._myParams.myMinAngleToFlyDownVR,t.myMinAngleToFlyRight=this._myParams.myMinAngleToFlyRight,t.myGravityAcceleration=-20,t.myVRDirectionReferenceType=this._myParams.myVRDirectionReferenceType,t.myVRDirectionReferenceObject=this._myParams.myVRDirectionReferenceObject,t.myMoveThroughCollisionShortcutEnabled=this._myParams.myMoveThroughCollisionShortcutEnabled,t.myMoveHeadShortcutEnabled=this._myParams.myMoveHeadShortcutEnabled,this._myPlayerLocomotionSmooth=new PP.CleanedPlayerLocomotionSmooth(t,this._myMovementRuntimeParams)}{let t=new PP.PlayerLocomotionTeleportParams;t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsTeleport,t.myHandedness=this._myParams.myMainHand,t.myDetectionParams.myMaxDistance=3,t.myDetectionParams.myMaxHeightDifference=4,t.myDetectionParams.myGroundAngleToIgnoreUpward=this._myCollisionCheckParamsMovement.myGroundAngleToIgnore,t.myDetectionParams.myMustBeOnGround=!0,t.myDetectionParams.myTeleportBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFloorLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFeetPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible=!0,t.myDetectionParams.myTeleportParableStartReferenceObject=this._myParams.myTeleportParableStartReferenceObject,t.myDetectionParams.myVisibilityBlockLayerFlags.copy(t.myDetectionParams.myTeleportBlockLayerFlags),t.myVisualizerParams.myTeleportPositionObject=this._myParams.myTeleportPositionObject,t.myPerformTeleportAsMovement=!1,t.myTeleportAsMovementRemoveVerticalMovement=!0,t.myTeleportAsMovementExtraVerticalMovementPerMeter=-2,t.myGravityAcceleration=0,t.myDebugActive=!1,t.myDebugDetectActive=!0,t.myDebugShowActive=!0,t.myDebugVisibilityActive=!1,this._myPlayerLocomotionTeleport=new PP.PlayerLocomotionTeleport(t,this._myMovementRuntimeParams)}}this._setupLocomotionMovementFSM(),this._myIdle=!1,this._myStarted=!1,this._myActive=!0}start(){this._fixAlmostUp(),this._myPlayerHeadManager.start(),this._myPlayerTransformManager.start(),this._myPlayerObscureManager.start(),this._myPlayerLocomotionRotate.start(),this._myLocomotionMovementFSM.perform("start"),this._myStarted=!0;let e=this._myActive;this._myActive=!this._myActive,this.setActive(e)}setActive(e){this._myActive!=e&&(this._myActive=e,this._myStarted&&(this._myActive?(this._myPlayerObscureManager.start(),this._myIdle||this._myLocomotionMovementFSM.perform("start")):(this._myLocomotionMovementFSM.perform("idle"),this._myPlayerObscureManager.stop())),this._myPlayerHeadManager.setActive(this._myActive),this._myPlayerTransformManager.setActive(this._myActive))}isStarted(){return this._myStarted}canStop(){let e=!1;return(this._myLocomotionMovementFSM.isInState("smooth")&&this._myPlayerLocomotionSmooth.canStop()||this._myLocomotionMovementFSM.isInState("teleport")&&this._myPlayerLocomotionTeleport.canStop())&&(e=!0),e}update(e){this._myPlayerHeadManager.update(e),this._myPlayerTransformManager.update(e),PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressEnd(2)&&(this._myLocomotionMovementFSM.isInState("smooth")&&this._myPlayerLocomotionSmooth.canStop()?this._myLocomotionMovementFSM.perform("next"):this._myLocomotionMovementFSM.isInState("teleport")&&this._myPlayerLocomotionTeleport.canStop()&&this._myLocomotionMovementFSM.perform("next")),this._myPlayerHeadManager.isSynced()&&(this._updateCollisionHeight(),this._myIdle||(this._myPlayerLocomotionRotate.update(e),this._myLocomotionMovementFSM.update(e))),this._myPlayerObscureManager.update(e)}setIdle(e){this._myIdle=e,e?this._myLocomotionMovementFSM.perform("idle"):this._myLocomotionMovementFSM.perform("start")}_updateCollisionHeight(){this._myCollisionCheckParamsMovement.myHeight=this._myPlayerHeadManager.getHeightHead(),this._myCollisionCheckParamsMovement.myHeight<=1e-6&&(this._myCollisionCheckParamsMovement.myHeight=0),this._myCollisionCheckParamsTeleport.myHeight=this._myCollisionCheckParamsMovement.myHeight}_setupCollisionCheckParamsMovement(){let e=new PP.CharacterColliderSetupSimplifiedCreationParams;e.myHeight=1.75,e.myRadius=this._myParams.myCharacterRadius,e.myAccuracyLevel=PP.CharacterColliderSetupSimplifiedCreationAccuracyLevel.HIGH,e.myIsPlayer=!0,e.myCheckOnlyFeet=!1,e.myAverageSpeed=this._myParams.myMaxSpeed,e.myCanFly=this._myParams.myFlyEnabled,e.myShouldSlideAgainstWall=!0,e.myCollectGroundInfo=!0,e.myShouldSnapOnGround=!0,e.myMaxDistanceToSnapOnGround=.1,e.myMaxWalkableGroundAngle=30,e.myMaxWalkableGroundStepHeight=.1,e.myShouldNotFallFromEdges=!1,e.myHorizontalCheckBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags);let t=PP.myPlayerObjects.myPlayer.pp_getComponentsHierarchy("physx");for(let a of t)e.myHorizontalCheckObjectsToIgnore.pp_pushUnique(a.object,(s,o)=>s.pp_equals(o));e.myVerticalCheckBlockLayerFlags.copy(e.myHorizontalCheckBlockLayerFlags),e.myVerticalCheckObjectsToIgnore.pp_copy(e.myHorizontalCheckObjectsToIgnore),e.myHorizontalCheckDebugActive=!1,e.myVerticalCheckDebugActive=!1;let n=PP.CharacterColliderUtils.createCharacterColliderSetupSimplified(e);this._myCollisionCheckParamsMovement=PP.CollisionCheckBridge.convertCharacterColliderSetupToCollisionCheckParams(n,this._myCollisionCheckParamsMovement)}_setupCollisionCheckParamsTeleport(){this._myCollisionCheckParamsTeleport=PP.CollisionCheckUtils.generate360TeleportParamsFromMovementParams(this._myCollisionCheckParamsMovement),this._myCollisionCheckParamsTeleport.myGroundAngleToIgnore=61,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnIgnorableGroundAngle=!0,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnGround=!0}_fixAlmostUp(){let e=PP.vec3_create(0,1,0);if(PP.myPlayerObjects.myPlayer.pp_getUp().vec3_angle(e)<1){let a=PP.myPlayerObjects.myPlayer.pp_getForward().vec3_clone();a[1]=0;let o=PP.vec3_create(0,0,1).vec3_angleSigned(a,e);PP.myPlayerObjects.myPlayer.pp_resetRotation(),PP.myPlayerObjects.myPlayer.pp_rotateAxis(o,e)}}_setupLocomotionMovementFSM(){this._myLocomotionMovementFSM=new PP.FSM,this._myLocomotionMovementFSM.setDebugLogActive(!0,"Locomotion Movement"),this._myLocomotionMovementFSM.addState("init"),this._myLocomotionMovementFSM.addState("smooth",e=>this._myPlayerLocomotionSmooth.update(e)),this._myLocomotionMovementFSM.addState("teleport",e=>this._myPlayerLocomotionTeleport.update(e)),this._myLocomotionMovementFSM.addState("idleSmooth"),this._myLocomotionMovementFSM.addState("idleTeleport"),this._myLocomotionMovementFSM.addTransition("init","smooth","start",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","teleport","next",function(){this._myPlayerLocomotionSmooth.stop(),this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","smooth","next",function(){this._myPlayerLocomotionTeleport.stop(),this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","idleSmooth","idle",function(){this._myPlayerLocomotionSmooth.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","idleTeleport","idle",function(){this._myPlayerLocomotionTeleport.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleSmooth","smooth","start",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleTeleport","teleport","start",function(){this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.init("init")}}});var rs=S(()=>{PP.CleanedPlayerLocomotionSmooth=class extends PP.PlayerLocomotionMovement{constructor(e,t){super(t),this._myParams=e,this._myDirectionReference=PP.myPlayerObjects.myHead,this._myStickIdleTimer=new PP.Timer(.25,!1);let n=new PP.Direction2DTo3DConverterParams;n.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,n.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,n.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpNonVR,n.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownNonVR,n.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,n.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight;let a=new PP.Direction2DTo3DConverterParams;a.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,a.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,a.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpVR,a.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownVR,a.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,a.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight,this._myDirectionConverterNonVR=new PP.Direction2DTo3DConverter(n),this._myDirectionConverterVR=new PP.Direction2DTo3DConverter(a),this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myLocomotionRuntimeParams.myIsFlying=!1,this._myGravitySpeed=0,WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}update(e){}};PP.CleanedPlayerLocomotionSmooth.prototype.update=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create(),s=PP.quat2_create(),o=PP.quat2_create();return function(m){i=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.vec3_zero();let c=PP.myGamepads[this._myParams.myHandedness].getAxesInfo(PP.GamepadAxesID.THUMBSTICK).getAxes();c[0]=Math.abs(c[0])>this._myParams.myMovementMinStickIntensityThreshold?c[0]:0,c[1]=Math.abs(c[1])>this._myParams.myMovementMinStickIntensityThreshold?c[1]:0;let r=!1;if(c.vec2_isZero())this._myStickIdleTimer.isRunning()&&(this._myStickIdleTimer.update(m),this._myStickIdleTimer.isDone()&&this._myCurrentDirectionConverter.resetFly());else if(this._myStickIdleTimer.start(),t=this._myCurrentDirectionConverter.convertTransformQuat(c,this._myDirectionReference.pp_getTransformQuat(o),i,t),!t.vec3_isZero()){this._myLocomotionRuntimeParams.myIsFlying=this._myLocomotionRuntimeParams.myIsFlying||t.vec3_componentAlongAxis(i,n).vec3_length()>1e-6,this._myLocomotionRuntimeParams.myIsFlying||(t=t.vec3_removeComponentAlongAxis(i,t));let y=c.vec2_length(),u=Math.pp_lerp(0,this._myParams.myMaxSpeed,y);e=t.vec3_scale(u*m,e),r=!0}this._myParams.myFlyEnabled&&(PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressed()?(a=i.vec3_scale(this._myParams.myMaxSpeed*m,a),e=e.vec3_add(a,e),this._myLocomotionRuntimeParams.myIsFlying=!0):PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).isPressed()&&(a=i.vec3_scale(-this._myParams.myMaxSpeed*m,a),e=e.vec3_add(a,e),this._myLocomotionRuntimeParams.myIsFlying=!0),PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).isPressEnd(2)&&(this._myLocomotionRuntimeParams.myIsFlying=!1)),this._myParams.myMoveHeadShortcutEnabled&&PP.myGamepads[PP.InputUtils.getOppositeHandedness(this._myParams.myHandedness)].getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressed()?this._myParams.myPlayerTransformManager.getPlayerHeadManager().moveFeet(e):this._myParams.myMoveThroughCollisionShortcutEnabled&&PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressed()?(this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams,!0),r&&(this._myParams.myPlayerTransformManager.resetReal(!0,!1,!1),this._myParams.myPlayerTransformManager.resetHeadToReal())):(this._myLocomotionRuntimeParams.myIsFlying||(this._myGravitySpeed+=this._myParams.myGravityAcceleration*m,a=i.vec3_scale(this._myGravitySpeed*m,a),e=e.vec3_add(a,e)),PP.myGamepads[this._myParams.myHandedness].getButtonInfo(PP.GamepadButtonID.SQUEEZE).isPressed(),s=this._myParams.myPlayerTransformManager.getTransformQuat(s),this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),r&&(this._myParams.myPlayerTransformManager.resetReal(!0,!1,!1),this._myParams.myPlayerTransformManager.resetHeadToReal()),(this._myGravitySpeed>0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnCeiling||this._myGravitySpeed<0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround)&&(this._myGravitySpeed=0)),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround&&(this._myLocomotionRuntimeParams.myIsFlying=!1,this._myCurrentDirectionConverter.resetFly())}}();PP.CleanedPlayerLocomotionSmooth.prototype._onXRSessionStart=function(){return function(e){switch(this._myParams.myVRDirectionReferenceType){case 0:this._myDirectionReference=PP.myPlayerObjects.myHead;break;case 1:this._myDirectionReference=PP.myPlayerObjects.myHands[this._myParams.myHandedness];break;case 2:this._myDirectionReference=this._myParams.myVRDirectionReferenceObject;break}this._myCurrentDirectionConverter=this._myDirectionConverterVR,this._myCurrentDirectionConverter.resetFly()}}();PP.CleanedPlayerLocomotionSmooth.prototype._onXRSessionEnd=function(){let i=PP.vec3_create();return function(t){this._myDirectionReference=PP.myPlayerObjects.myHead,this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myCurrentDirectionConverter.resetFly()}}();Object.defineProperty(PP.CleanedPlayerLocomotionSmooth.prototype,"update",{enumerable:!1});Object.defineProperty(PP.CleanedPlayerLocomotionSmooth.prototype,"_onXRSessionStart",{enumerable:!1});Object.defineProperty(PP.CleanedPlayerLocomotionSmooth.prototype,"_onXRSessionEnd",{enumerable:!1})});var ls=S(()=>{PP.CleanedPlayerTransformManager=class{constructor(e){this._myParams=e,this._myRealMovementCollisionCheckParams=null,this._generateRealMovementParamsFromMovementParams(),this._myCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._myRealCollisionRuntimeParams=new PP.CollisionRuntimeParams,this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._myHeadCollisionCheckParams=null,this._setupHeadCollisionCheckParams(),this._myValidPosition=PP.vec3_create(),this._myValidRotationQuat=new PP.quat_create,this._myValidHeight=0,this._myValidPositionHead=PP.vec3_create(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,this._myLastValidMovementDirection=PP.vec3_create(),this._myIsRealPositionValid=!1,this._myIsPositionValid=!1,this._myResetRealOnSynced=!1,this._myActive=!0}start(){this.resetToReal(!0),WL.xrSession&&this._onXRSessionStart(!0,WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this,!1)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}setActive(e){this._myActive=e}update(e){}move(e,t=null,n=!1){}teleportPosition(e,t=null,n=!1){}teleportTransformQuat(e,t=null,n=!1){}rotateQuat(e){}setRotationQuat(e){}setHeight(e,t=!1){}getPlayer(){return this._myParams.myPlayerHeadManager.getPlayer()}getHead(){return this._myParams.myPlayerHeadManager.getHead()}getTransformQuat(e=PP.quat2_create()){return e.quat2_setPositionRotationQuat(this.getPosition(this._myValidPosition),this.getRotationQuat(this._myValidRotationQuat))}getPosition(e=PP.vec3_create()){return e.vec3_copy(this._myValidPosition)}getRotationQuat(e=PP.quat_create()){return e.quat_copy(this._myValidRotationQuat)}getPositionHead(e=PP.vec3_create()){return e.vec3_copy(this._myValidPositionHead)}getTransformHeadQuat(e=PP.quat2_create()){return e.quat2_setPositionRotationQuat(this.getPositionHead(this._myValidPositionHead),this.getRotationQuat(this._myValidRotationQuat))}getHeight(){return this._myValidHeight}getTransformRealQuat(e=PP.quat2_create()){return this.getPlayerHeadManager().getTransformFeetQuat(e)}getTransformHeadRealQuat(e=PP.quat2_create()){return this.getPlayerHeadManager().getTransformHeadQuat(e)}getPositionReal(e=PP.vec3_create()){return this.getPlayerHeadManager().getPositionFeet(e)}getPositionHeadReal(e=PP.vec3_create()){return this.getPlayerHeadManager().getPositionHead(e)}getRotationRealQuat(e=PP.quat_create()){return this.getPlayerHeadManager().getRotationFeetQuat(e)}getHeightReal(){return this._myParams.myPlayerHeadManager.getHeightHead()}isSynced(e=null){let t=this.isBodyColliding()&&(e==null||e.get(PP.PlayerTransformManagerSyncFlag.BODY_COLLIDING)),n=this.isHeadColliding()&&(e==null||e.get(PP.PlayerTransformManagerSyncFlag.HEAD_COLLIDING)),a=this.isFar()&&(e==null||e.get(PP.PlayerTransformManagerSyncFlag.FAR)),s=this.isFloating()&&(e==null||e.get(PP.PlayerTransformManagerSyncFlag.FLOATING));return!t&&!n&&!a&&!s}resetReal(e=!0,t=!0,n=!0,a=!1){}updateReal(){this._updateReal(0,!1)}resetToReal(e=!1){this._myValidPosition=this.getPositionReal(this._myValidPosition),this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead),this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat),this._myValidHeight=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight),e&&this._updateReal(0,!1)}resetHeadToReal(){this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead)}isBodyColliding(){return this._myIsBodyColliding}isHeadColliding(){return this._myIsHeadColliding}isFloating(){return this.isLeaning()||this.isHopping()}isHopping(){return this._myIsHopping}isLeaning(){return this._myIsLeaning}isHopping(){return this._myIsHopping}isFar(){return this._myIsFar}getDistanceToReal(){}getDistanceToRealHead(){}getPlayerHeadManager(){return this._myParams.myPlayerHeadManager}getParams(){return this._myParams}getMovementCollisionCheckParams(){return this._myParams.myMovementCollisionCheckParams}getTeleportCollisionCheckParams(){return this._myParams.myTeleportCollisionCheckParams}collisionCheckParamsUpdated(){this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._generateRealMovementParamsFromMovementParams()}isPositionValid(){return this._myIsPositionValid}isRealPositionValid(){return this._myIsRealPositionValid}getCollisionRuntimeParams(){return this._myCollisionRuntimeParams}getRealCollisionRuntimeParams(){return this._myRealCollisionRuntimeParams}_updateCollisionHeight(){let e=this.getHeight(),t=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight);this._myParams.myMovementCollisionCheckParams.myHeight=e,this._myParams.myTeleportCollisionCheckParams.myHeight=e,this._myRealMovementCollisionCheckParams.myHeight=t}_setupHeadCollisionCheckParams(){this._myHeadCollisionCheckParams=new PP.CollisionCheckParams;let e=this._myHeadCollisionCheckParams;e.myRadius=this._myParams.myHeadRadius,e.myDistanceFromFeetToIgnore=0,e.myDistanceFromHeadToIgnore=0,e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.myHorizontalMovementCheckEnabled=!0,e.myHorizontalMovementRadialStepAmount=1,e.myHorizontalMovementCheckDiagonalOutward=!0,e.myHorizontalMovementCheckDiagonalInward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!0,e.myHorizontalPositionCheckEnabled=!0,e.myHalfConeAngle=180,e.myHalfConeSliceAmount=3,e.myCheckConeBorder=!0,e.myCheckConeRay=!0,e.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!1,e.myHorizontalPositionCheckVerticalDirectionType=0,e.myHeight=e.myRadius,e.myPositionOffsetLocal.vec3_set(0,-e.myRadius/2,0),e.myCheckHeight=!0,e.myCheckHeightVerticalMovement=!0,e.myCheckHeightVerticalPosition=!0,e.myHeightCheckStepAmountMovement=2,e.myHeightCheckStepAmountPosition=2,e.myCheckHeightTopMovement=!0,e.myCheckHeightTopPosition=!0,e.myCheckVerticalStraight=!0,e.myCheckVerticalFixedForwardEnabled=!0,e.myCheckVerticalFixedForward=PP.vec3_create(0,0,1),e.myCheckHorizontalFixedForwardEnabled=!0,e.myCheckHorizontalFixedForward=PP.vec3_create(0,0,1),e.myVerticalMovementCheckEnabled=!0,e.myVerticalPositionCheckEnabled=!0,e.myGroundCircumferenceAddCenter=!0,e.myGroundCircumferenceSliceAmount=6,e.myGroundCircumferenceStepAmount=2,e.myGroundCircumferenceRotationPerStep=30,e.myFeetRadius=e.myRadius,e.myHorizontalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myHorizontalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myVerticalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myVerticalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myDebugActive=!1,e.myDebugHorizontalMovementActive=!0,e.myDebugHorizontalPositionActive=!1,e.myDebugVerticalMovementActive=!1,e.myDebugVerticalPositionActive=!1,e.myDebugSlidingActive=!1,e.myDebugGroundInfoActive=!1,e.myDebugCeilingInfoActive=!1,e.myDebugRuntimeParamsActive=!1,e.myDebugMovementActive=!1}_generateTeleportParamsFromMovementParams(){this._myParams.myTeleportCollisionCheckParams==null&&(this._myParams.myTeleportCollisionCheckParams=new PP.CollisionCheckParams),this._myParams.myTeleportCollisionCheckParamsCheck360?this._myParams.myTeleportCollisionCheckParams=PP.CollisionCheckUtils.generate360TeleportParamsFromMovementParams(this._myParams.myMovementCollisionCheckParams,this._myParams.myTeleportCollisionCheckParams):this._myParams.myTeleportCollisionCheckParams.copy(this._myParams.myMovementCollisionCheckParams)}_generateRealMovementParamsFromMovementParams(){this._myRealMovementCollisionCheckParams==null&&(this._myRealMovementCollisionCheckParams=new PP.CollisionCheckParams);let e=this._myRealMovementCollisionCheckParams;e.copy(this._myParams.myMovementCollisionCheckParams),e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.mySlidingEnabled=!1,this._myParams.myRealMovementAllowVerticalAdjustments||(e.mySnapOnGroundEnabled=!1,e.mySnapOnCeilingEnabled=!1,e.myGroundPopOutEnabled=!1,e.myCeilingPopOutEnabled=!1,e.myAdjustVerticalMovementWithGroundAngleDownhill=!1,e.myAdjustVerticalMovementWithGroundAngleUphill=!1,e.myAdjustVerticalMovementWithCeilingAngleDownhill=!1,e.myAdjustVerticalMovementWithCeilingAngleUphill=!1,e.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,e.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,e.myVerticalMovementReduceEnabled=!1),e.myIsOnGroundIfInsideHit=!0,e.myDebugActive=!1,e.myDebugHorizontalMovementActive=!1,e.myDebugHorizontalPositionActive=!1,e.myDebugVerticalMovementActive=!1,e.myDebugVerticalPositionActive=!1,e.myDebugSlidingActive=!1,e.myDebugGroundInfoActive=!0,e.myDebugCeilingInfoActive=!0,e.myDebugRuntimeParamsActive=!1,e.myDebugMovementActive=!1}_onXRSessionStart(e,t){this._myActive&&this._myParams.myResetToValidOnEnterSession&&!e&&(this._myResetRealOnSynced=!0)}_onXRSessionEnd(){this._myActive&&this._myParams.myResetToValidOnExitSession&&(this._myResetRealOnSynced=!0)}_debugUpdate(e){PP.myDebugVisualManager.drawPoint(0,this._myValidPosition,PP.vec4_create(1,0,0,1),.05),PP.myDebugVisualManager.drawLineEnd(0,this._myValidPosition,this.getPositionReal(),PP.vec4_create(1,0,0,1),.05),PP.myDebugVisualManager.drawLine(0,this._myValidPosition,this._myValidRotationQuat.quat_getForward(),.15,PP.vec4_create(0,1,0,1),.025),PP.myDebugVisualManager.drawPoint(0,this._myValidPositionHead,PP.vec4_create(1,1,0,1),.05)}};PP.CleanedPlayerTransformManager.prototype.getDistanceToReal=function(){let i=PP.vec3_create();return function(){return i=this.getPositionReal(i),i.vec3_distance(this.getPosition())}}();PP.CleanedPlayerTransformManager.prototype.getDistanceToRealHead=function(){let i=PP.vec3_create();return function(){return i=this.getPositionHeadReal(i),i.vec3_distance(this.getPositionHead())}}();PP.CleanedPlayerTransformManager.prototype.resetReal=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.quat_create();return function(s=!0,o=!0,l=!0,m=!1){let c=this.getPlayerHeadManager();s&&c.teleportPositionFeet(this.getPosition(t)),i=this.getPlayerHeadManager().getRotationFeetQuat(n).quat_getUp(i),e=this.getRotationQuat(n).quat_getUp(e),(o||i.vec3_angle(e)>Math.PP_EPSILON_DEGREES&&this._myParams.myResetRealResetRotationIfUpChanged)&&c.setRotationFeetQuat(this.getRotationQuat(n),!1),l&&c.setHeight(this.getHeight(),!0),m&&this._updateReal(0,!1)}}();PP.CleanedPlayerTransformManager.prototype.update=function(){let i=PP.quat2_create(),e=new PP.CollisionRuntimeParams,t=PP.vec3_create(),n=PP.vec3_create(),a=PP.quat_create();return function(o){if(this._updateReal(o),this._myResetRealOnSynced&&this.getPlayerHeadManager().isSynced()&&(this._myResetRealOnSynced=!1,PP.XRUtils.isSessionActive()?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)),this._myParams.myUpdatePositionValid){i=this.getTransformQuat(i),t=i.quat2_getUp(t),a=i.quat2_getRotationQuat(a),n=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(t,n),n.vec3_isZero(1e-5)||(n.vec3_normalize(n),a.quat_setForward(n),i.quat2_setRotationQuat(a));let l=this._myParams.myMovementCollisionCheckParams.myDebugActive;this._myParams.myMovementCollisionCheckParams.myDebugActive=!1,PP.myCollisionCheck.positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,e),this._myParams.myMovementCollisionCheckParams.myDebugActive=l,this._myIsPositionValid=e.myIsPositionOk}this._myParams.myDebugActive&&this._debugUpdate(o)}}();PP.CleanedPlayerTransformManager.prototype._updateReal=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.vec3_create(),n=PP.quat2_create(),a=new PP.CollisionRuntimeParams,s=PP.vec3_create(),o=PP.vec3_create(),l=PP.vec3_create(),m=PP.vec3_create(),c=PP.vec3_create(),r=PP.vec3_create(),y=PP.vec3_create(),u=PP.vec3_create(),p=PP.quat2_create(),d=PP.vec3_create(),_=PP.quat_create();return function(P,T=!0){if(this.getPlayerHeadManager().isSynced()){if(this._updateCollisionHeight(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,i=this.getPositionReal(t).vec3_sub(this.getPosition(e),i),i.vec3_length()>1e-4&&(this._myLastValidMovementDirection=i.vec3_normalize(this._myLastValidMovementDirection)),this._myParams.mySyncEnabledFlagMap.get(PP.PlayerTransformManagerSyncFlag.FAR)&&(this._myParams.myIsMaxDistanceFromRealToSyncEnabled&&i.vec3_length()>this._myParams.myMaxDistanceFromRealToSync?this._myIsFar=!0:this._myParams.myIsFarExtraCheckCallback!=null&&this._myParams.myIsFarExtraCheckCallback(this)&&(this._myIsFar=!0)),a.copy(this._myCollisionRuntimeParams),a.myIsOnGround=!0,n=this.getTransformQuat(n),s.vec3_copy(this._myValidPosition),this._myParams.mySyncEnabledFlagMap.get(PP.PlayerTransformManagerSyncFlag.BODY_COLLIDING)&&(PP.myCollisionCheck.move(i,n,this._myRealMovementCollisionCheckParams,a),!a.myHorizontalMovementCanceled&&!a.myVerticalMovementCanceled?Math.pp_clamp(this._myRealMovementCollisionCheckParams.myHeight,this._myParams.myIsBodyCollidingWhenHeightBelowValue,this._myParams.myIsBodyCollidingWhenHeightAboveValue)!=this._myRealMovementCollisionCheckParams.myHeight?this._myIsBodyColliding=!0:this._myParams.myIsBodyCollidingExtraCheckCallback!=null&&this._myParams.myIsBodyCollidingExtraCheckCallback(this)?this._myIsBodyColliding=!0:(this._myIsBodyColliding=!1,s.vec3_copy(a.myNewPosition)):this._myIsBodyColliding=!0),this._myParams.mySyncEnabledFlagMap.get(PP.PlayerTransformManagerSyncFlag.FLOATING)&&(this._myIsBodyColliding?i=t.vec3_sub(e,i):i=s.vec3_sub(e,i),a.copy(this._myCollisionRuntimeParams),p.quat2_setPositionRotationQuat(this._myValidPosition,this._myValidRotationQuat),PP.myCollisionCheck.updateSurfaceInfo(p,this._myRealMovementCollisionCheckParams,a),a.myIsOnGround)){c=n.quat2_getUp(c),r=i.vec3_componentAlongAxis(c,r);let v=!r.vec3_isZero(1e-5);if(!v||!this._myParams.myIsFloatingValidIfVerticalMovement){let f=1;if(l.vec3_copy(i),!i.vec3_isZero(1e-5)&&this._myParams.myFloatingSplitCheckEnabled){let V=i.vec3_length()/this._myParams.myFloatingSplitCheckMaxSteps;if(!this._myParams.myFloatingSplitCheckStepEqualLength||V<this._myParams.myFloatingSplitCheckStepEqualLengthMinLength){let D=this._myParams.myFloatingSplitCheckStepEqualLength?this._myParams.myFloatingSplitCheckStepEqualLengthMinLength:this._myParams.myFloatingSplitCheckMaxLength;f=Math.ceil(i.vec3_length()/D),f>1&&(l=l.vec3_normalize(l).vec3_scale(D,l),f=this._myParams.myFloatingSplitCheckMaxSteps!=null?Math.min(f,this._myParams.myFloatingSplitCheckMaxSteps):f),f=Math.max(1,f),f==1&&l.vec3_copy(i)}else f=this._myParams.myFloatingSplitCheckMaxSteps,f>1&&(l=l.vec3_normalize(l).vec3_scale(V,l))}let g=a.myGroundAngle<=this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4;y.vec3_zero(),u.vec3_copy(this._myValidPosition),a.copy(this._myCollisionRuntimeParams);let C=!1,M=!1,b=!1,A=!1;for(let V=0;V<f;V++)f==1||V!=f-1?m.vec3_copy(l):m=i.vec3_sub(y,m),u=u.vec3_add(m,u),p.quat2_setPositionRotationQuat(u,this._myValidRotationQuat),a.copy(this._myCollisionRuntimeParams),PP.myCollisionCheck.updateSurfaceInfo(p,this._myRealMovementCollisionCheckParams,a),y=y.vec3_add(m,y),a.myIsOnGround?(a.myGroundAngle>this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4&&(A=!0),C&&(M=!0),V==f-1&&(b=!0)):C=!0;let I=A&&g&&!this._myParams.myIsFloatingValidIfSteepGround&&(!v||!this._myParams.myIsFloatingValidIfVerticalMovementAndSteepGround);if(C||I?M?this._myIsHopping=!0:this._myIsLeaning=!0:(this._myIsLeaning=!1,this._myIsHopping=!1,this._myParams.myIsLeaningExtraCheckCallback!=null&&this._myParams.myIsLeaningExtraCheckCallback(this)?this._myIsLeaning=!0:this._myParams.myIsHoppingExtraCheckCallback!=null&&this._myParams.myIsHoppingExtraCheckCallback(this)&&(this._myIsHopping=!0)),this._myIsLeaning){let V=i.vec3_length();this._myParams.myIsLeaningValidAboveDistance&&V>this._myParams.myLeaningValidDistance&&(this._myIsLeaning=!1)}(this._myIsLeaning||this._myIsHopping)&&(b&&this._myParams.myIsFloatingValidIfRealOnGround?(this._myIsLeaning=!1,this._myIsHopping=!1):b&&v&&this._myParams.myIsFloatingValidIfVerticalMovementAndRealOnGround&&(this._myIsLeaning=!1,this._myIsHopping=!1))}}if(i=this.getPositionHeadReal(t).vec3_sub(this.getPositionHead(e),i),a.reset(),n=this.getTransformHeadQuat(n),o.vec3_copy(this._myValidPositionHead),this._myParams.mySyncEnabledFlagMap.get(PP.PlayerTransformManagerSyncFlag.HEAD_COLLIDING)&&(PP.myCollisionCheck.move(i,n,this._myHeadCollisionCheckParams,a),!a.myHorizontalMovementCanceled&&!a.myVerticalMovementCanceled?(this._myIsHeadColliding=!1,o.vec3_copy(a.myNewPosition)):this._myIsHeadColliding=!0),this.isSynced(this._myParams.mySyncPositionFlagMap)&&!this._myParams.mySyncPositionDisabled&&this._myValidPosition.vec3_copy(s),this.isSynced(this._myParams.mySyncPositionHeadFlagMap)&&(this._myValidPositionHead=this.getPositionHeadReal(o)),this.isSynced(this._myParams.mySyncRotationFlagMap)&&(this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat)),this.isSynced(this._myParams.mySyncHeightFlagMap)&&(this._myValidHeight=this._myRealMovementCollisionCheckParams.myHeight,this._updateCollisionHeight()),this._myParams.myUpdateRealPositionValid){n=this.getTransformRealQuat(n),c=n.quat2_getUp(c),_=n.quat2_getRotationQuat(_),d=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(c,d),d.vec3_isZero(1e-5)||(d.vec3_normalize(d),_.quat_setForward(d),n.quat2_setRotationQuat(_));let v=this._myParams.myMovementCollisionCheckParams.myDebugActive;this._myParams.myMovementCollisionCheckParams.myDebugActive=!1,PP.myCollisionCheck.positionCheck(!0,n,this._myParams.myMovementCollisionCheckParams,this._myRealCollisionRuntimeParams),this._myIsRealPositionValid=this._myRealCollisionRuntimeParams.myIsPositionOk,this._myParams.myMovementCollisionCheckParams.myDebugActive=v}}}}();PP.CleanedPlayerTransformManager.prototype.move=function(){let i=PP.quat2_create(),e=PP.vec3_create();return function(n,a=null,s=!1){i=this.getTransformQuat(i),PP.myCollisionCheck.move(n,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),a?.copy(this._myCollisionRuntimeParams),s?e.vec3_copy(n):e.vec3_copy(this._myCollisionRuntimeParams.myFixedMovement),e.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(e,this._myValidPosition),this.getPlayerHeadManager().moveFeet(e)),this._myParams.myResetRealOnMove&&(this.isSynced()||(PP.XRUtils.isSessionActive()?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)))}}();PP.CleanedPlayerTransformManager.prototype.teleportPosition=function(){let i=PP.quat2_create();return function(e,t=null,n=!1){i=this.getTransformQuat(i),i.quat2_setPosition(e),this.teleportTransformQuat(i,t,n)}}();PP.CleanedPlayerTransformManager.prototype.teleportTransformQuat=function(){let i=PP.vec3_create(),e=PP.vec3_create(),t=PP.quat_create(),n=PP.quat2_create(),a=PP.vec3_create();return function(s,o=null,l=!1){i=this.getPosition(i),e=s.quat2_getPosition(e),t=s.quat2_getRotationQuat(t),n.quat2_setPositionRotationQuat(i,t),PP.myCollisionCheck.teleport(e,n,this._myParams.myTeleportCollisionCheckParams,this._myCollisionRuntimeParams),o?.copy(this._myCollisionRuntimeParams),a.vec3_zero(),l?(a=e.vec3_sub(i,a),this.getPlayerHeadManager().setRotationFeetQuat(t)):this._myCollisionRuntimeParams.myTeleportCanceled||(a=this._myCollisionRuntimeParams.myFixedTeleportPosition.vec3_sub(i,a),this.getPlayerHeadManager().setRotationFeetQuat(t)),a.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(a,this._myValidPosition),this.getPlayerHeadManager().moveFeet(a)),this._myParams.myResetRealOnTeleport&&(this.isSynced()||(PP.XRUtils.isSessionActive()?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)))}}();PP.CleanedPlayerTransformManager.prototype.rotateQuat=function(){return function(e){this._myValidRotationQuat.quat_rotateQuat(e,this._myValidRotationQuat),this.getPlayerHeadManager().rotateFeetQuat(e)}}();PP.CleanedPlayerTransformManager.prototype.setRotationQuat=function(){let i=PP.quat_create();return function(t){i=this._myValidRotationQuat.quat_rotationToQuat(t,i),this.rotateQuat(i)}}();PP.CleanedPlayerTransformManager.prototype.setHeight=function(){let i=PP.quat2_create();return function(t,n=!1){let a=Math.pp_clamp(t,this._myParams.myMinHeight,this._myParams.myMaxHeight),s=this.getHeight();this._myValidHeight=a,this._updateCollisionHeight(),i=this.getTransformQuat(i),PP.myCollisionCheck.positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),this._myCollisionRuntimeParams.myIsPositionOk||n?this.getPlayerHeadManager().setHeight(this.getHeight(),!0):this._myValidHeight=s,this._updateCollisionHeight()}}()});var ms=S(()=>{WL.registerComponent("pp-finger-cursor",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myEnableMultipleClicks:{type:WL.Type.Bool,default:!0},_myCollisionGroup:{type:WL.Type.Int,default:1},_myCollisionSize:{type:WL.Type.Float,default:.0125},_myCursorObject:{type:WL.Type.Object,default:null}},{init:function(){this._myLastTarget=null,this._myReferenceSpace=null,this._myHandInputSource=null,this._myHandednessString=["left","right"][this._myHandedness],this._myDoubleClickTimer=0,this._myTripleClickTimer=0,this._myMultipleClickObject=null,this._myMultipleClickDelay=.3},start:function(){this._myCursorObjectRoot=WL.scene.addObject(this.object),this._myCursorObject==null?this._myCursorObject=this._myCursorObjectRoot.pp_addObject():this._myCursorObject.pp_setParent(this._myCursorObjectRoot),this._myCollisionComponent=this._myCursorObject.addComponent("collision"),this._myCollisionComponent.collider=WL.Collider.Sphere,this._myCollisionComponent.group=1<<this._myCollisionGroup,this._myCollisionComponent.extents=PP.vec3_create(this._myCollisionSize,this._myCollisionSize,this._myCollisionSize),WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))},update:function(i){if(this._myDoubleClickTimer>0&&(this._myDoubleClickTimer-=i),this._myTripleClickTimer>0&&(this._myTripleClickTimer-=i),this._myCursorObjectRoot.pp_setTransformQuat(PP.myPlayerObjects.myPlayerPivot.pp_getTransformQuat()),this._updateHand(),this._myHandInputSource){let e=this._myCollisionComponent.queryOverlaps(),t=null;for(let n=0;n<e.length;++n){let s=e[n].object.getComponent("cursor-target");if(s&&(t==null||!s.isSurface)&&(t=s,!s.isSurface))break}t?t.equals(this._myLastTarget)||(this._targetTouchEnd(),this._myLastTarget=t,this._targetTouchStart()):this._targetTouchEnd()}else this._targetTouchEnd()},_targetTouchStart:function(){this._myLastTarget.onHover(this._myLastTarget.object,this),this._myLastTarget.onDown(this._myLastTarget.object,this)},_targetTouchEnd:function(){this._myLastTarget&&(this._myEnableMultipleClicks&&this._myTripleClickTimer>0&&this._myMultipleClickObject&&this._myMultipleClickObject.equals(this._myLastTarget.object)?(this._myLastTarget.onTripleClick(this._myLastTarget.object,this),this._myTripleClickTimer=0):this._myEnableMultipleClicks&&this._myDoubleClickTimer>0&&this._myMultipleClickObject&&this._myMultipleClickObject.equals(this._myLastTarget.object)?(this._myLastTarget.onDoubleClick(this._myLastTarget.object,this),this._myTripleClickTimer=this._myMultipleClickDelay,this._myDoubleClickTimer=0):(this._myLastTarget.onClick(this._myLastTarget.object,this),this._myTripleClickTimer=0,this._myDoubleClickTimer=this._myMultipleClickDelay,this._myMultipleClickObject=this._myLastTarget.object),this._myLastTarget.onUp(this._myLastTarget.object,this),this._myLastTarget.onUnhover(this._myLastTarget.object,this),this._myLastTarget=null)},onActivate:function(){this._myCursorObjectRoot.pp_setActive(!0)},onDeactivate:function(){this._myCursorObjectRoot.pp_setActive(!1)},_updateHand(){if(this._myHandInputSource=PP.InputUtils.getInputSource(this._myHandednessString,PP.InputSourceType.TRACKED_HAND),this._myHandInputSource){let i=Module.webxr_frame.getJointPose(this._myHandInputSource.hand.get("index-finger-tip"),this._myReferenceSpace);i&&(this._myCursorObject.pp_setRotationLocalQuat([i.transform.orientation.x,i.transform.orientation.y,i.transform.orientation.z,i.transform.orientation.w]),this._myCursorObject.pp_setPositionLocal([i.transform.position.x,i.transform.position.y,i.transform.position.z]))}},_onXRSessionStart:function(i){i.requestReferenceSpace(WebXR.refSpace).then(function(e){this._myReferenceSpace=e}.bind(this))},_onXRSessionEnd:function(i){this._myReferenceSpace=null}})});var ys=S(()=>{PP.Handedness={LEFT:"left",RIGHT:"right"};PP.HandednessIndex={LEFT:0,RIGHT:1};PP.InputSourceType={GAMEPAD:0,TRACKED_HAND:1};PP.TrackedHandJointID={WRIST:"wrist",THUMB_METACARPAL:"thumb-metacarpal",THUMB_PHALANX_PROXIMAL:"thumb-phalanx-proximal",THUMB_PHALANX_DISTAL:"thumb-phalanx-distal",THUMB_TIP:"thumb-tip",INDEX_FINGER_METACARPAL:"index-finger-metacarpal",INDEX_FINGER_PHALANX_PROXIMAL:"index-finger-phalanx-proximal",INDEX_FINGER_PHALANX_INTERMEDIATE:"index-finger-phalanx-intermediate",INDEX_FINGER_PHALANX_DISTAL:"index-finger-phalanx-distal",INDEX_FINGER_TIP:"index-finger-tip",MIDDLE_FINGER_METACARPAL:"middle-finger-metacarpal",MIDDLE_FINGER_PHALANX_PROXIMAL:"middle-finger-phalanx-proximal",MIDDLE_FINGER_PHALANX_INTERMEDIATE:"middle-finger-phalanx-intermediate",MIDDLE_FINGER_PHALANX_DISTAL:"middle-finger-phalanx-distal",MIDDLE_FINGER_TIP:"middle-finger-tip",RING_FINGER_METACARPAL:"ring-finger-metacarpal",RING_FINGER_PHALANX_PROXIMAL:"ring-finger-phalanx-proximal",RING_FINGER_PHALANX_INTERMEDIATE:"ring-finger-phalanx-intermediate",RING_FINGER_PHALANX_DISTAL:"ring-finger-phalanx-distal",RING_FINGER_TIP:"ring-finger-tip",PINKY_FINGER_METACARPAL:"pinky-finger-metacarpal",PINKY_FINGER_PHALANX_PROXIMAL:"pinky-finger-phalanx-proximal",PINKY_FINGER_PHALANX_INTERMEDIATE:"pinky-finger-phalanx-intermediate",PINKY_FINGER_PHALANX_DISTAL:"pinky-finger-phalanx-distal",PINKY_FINGER_TIP:"pinky-finger-tip"};PP.TrackedHandJointIDIndex={WRIST:0,THUMB_METACARPAL:1,THUMB_PHALANX_PROXIMAL:2,THUMB_PHALANX_DISTAL:3,THUMB_TIP:4,INDEX_FINGER_METACARPAL:5,INDEX_FINGER_PHALANX_PROXIMAL:6,INDEX_FINGER_PHALANX_INTERMEDIATE:7,INDEX_FINGER_PHALANX_DISTAL:8,INDEX_FINGER_TIP:9,MIDDLE_FINGER_METACARPAL:10,MIDDLE_FINGER_PHALANX_PROXIMAL:11,MIDDLE_FINGER_PHALANX_INTERMEDIATE:12,MIDDLE_FINGER_PHALANX_DISTAL:13,MIDDLE_FINGER_TIP:14,RING_FINGER_METACARPAL:15,RING_FINGER_PHALANX_PROXIMAL:16,RING_FINGER_PHALANX_INTERMEDIATE:17,RING_FINGER_PHALANX_DISTAL:18,RING_FINGER_TIP:19,PINKY_FINGER_METACARPAL:20,PINKY_FINGER_PHALANX_PROXIMAL:21,PINKY_FINGER_PHALANX_INTERMEDIATE:22,PINKY_FINGER_PHALANX_DISTAL:23,PINKY_FINGER_TIP:24}});var cs=S(()=>{PP.InputUtils={getHandednessByIndex:function(i){let e=null;switch(i){case PP.HandednessIndex.LEFT:e=PP.Handedness.LEFT;break;case PP.HandednessIndex.RIGHT:e=PP.Handedness.RIGHT;break}return e},getInputSource:function(i,e){let t=null;if(WL.xrSession&&WL.xrSession.inputSources)for(let n=0;n<WL.xrSession.inputSources.length;n++){let a=WL.xrSession.inputSources[n];if((!e||e==PP.InputSourceType.GAMEPAD&&!a.hand||e==PP.InputSourceType.TRACKED_HAND&&a.hand)&&a.handedness==i){t=a;break}}return t},getInputSourceTypeByHandedness:function(i){let e=PP.InputUtils.getInputSource(i);return PP.InputUtils.getInputSourceType(e)},getInputSourceType:function(i){let e=null;return i&&(i.hand?e=PP.InputSourceType.TRACKED_HAND:e=PP.InputSourceType.GAMEPAD),e},getOppositeHandedness:function(i){let e=null;switch(i){case PP.Handedness.LEFT:e=PP.Handedness.RIGHT;break;case PP.Handedness.RIGHT:e=PP.Handedness.LEFT;break}return e},getJointIDByIndex:function(i){let e=null,t=null;for(let n in PP.TrackedHandJointIDIndex)if(PP.TrackedHandJointIDIndex[n]==i){t=n;break}return t!=null&&(e=PP.TrackedHandJointID[t]),e}}});var us=S(()=>{PP.KeyID={_0:"0",_1:"1",_2:"2",_3:"3",_4:"4",_5:"5",_6:"6",_7:"7",_8:"8",_9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z",UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight",SPACE:" ",ENTER:"Enter",BACKSPACE:"Backspace",ESC:"Escape",SHIFT_LEFT:"ShiftLeft",SHIFT_RIGHT:"ShiftRight",CONTROL_LEFT:"ControlLeft",CONTROL_RIGHT:"ControlRight",ALT_LEFT:"AltLeft",ALT_RIGHT:"AltRight"};PP.Keyboard=class{constructor(){this._myKeyInfos=new Map;for(let e in PP.KeyID)this.addKey(PP.KeyID[e])}isKeyPressed(e){let t=!1;return this._myKeyInfos.has(e)&&(t=this._myKeyInfos.get(e).myIsPressed),t}isKeyPressStart(e){let t=!1;return this._myKeyInfos.has(e)&&(t=this._myKeyInfos.get(e).myIsPressStart),t}isKeyPressEnd(e){let t=!1;return this._myKeyInfos.has(e)&&(t=this._myKeyInfos.get(e).myIsPressEnd),t}addKey(e){this._myKeyInfos.set(e,this._createKeyInfo())}start(){window.addEventListener("keydown",this._keyDown.bind(this)),window.addEventListener("keyup",this._keyUp.bind(this))}update(e){if(!document.hasFocus())for(let t of this._myKeyInfos.values())t.myIsPressed&&(t.myIsPressed=!1,t.myIsPressEndToProcess=!0);for(let t of this._myKeyInfos.values())t.myIsPressStart=t.myIsPressStartToProcess,t.myIsPressEnd=t.myIsPressEndToProcess,t.myIsPressStartToProcess=!1,t.myIsPressEndToProcess=!1}_keyDown(e){this._keyPressedChanged(e.key,!0),e.key!=e.code&&this._keyPressedChanged(e.code,!0)}_keyUp(e){this._keyPressedChanged(e.key,!1),e.key!=e.code&&this._keyPressedChanged(e.code,!1)}_keyPressedChanged(e,t){if(this._myKeyInfos.has(e)){let n=this._myKeyInfos.get(e);t?(n.myIsPressed=!0,n.myIsPressStartToProcess=!0):(n.myIsPressed=!1,n.myIsPressEndToProcess=!0)}}_createKeyInfo(){return{myIsPressed:!1,myIsPressStart:!1,myIsPressStartToProcess:!1,myIsPressEnd:!1,myIsPressEndToProcess:!1}}}});var hs=S(()=>{PP.MouseButtonID={LEFT:0,MIDDLE:1,RIGHT:2};PP.Mouse=class{constructor(){this._myButtonInfos=new Map;for(let e in PP.MouseButtonID)this._myButtonInfos.set(PP.MouseButtonID[e],this._createButtonInfo());this._myPreventContextMenuCallback=this._preventContextMenu.bind(this),this._myPreventMiddleButtonScrollCallback=this._preventMiddleButtonScroll.bind(this),this._myInternalMousePosition=PP.vec2_create(),this._myScreenSize=PP.vec2_create(),this._updateScreenSize(),this._myResetMovingDelay=.15,this._myResetMovingTimer=new PP.Timer(this._myResetMovingDelay,!1),this._myIsMoving=!1,this._myIsInsideView=!1,this._myIsValid=!1,this._myPointerUpOnPointerLeave=!0,this._myContextMenuActive=!0,this._myMiddleButtonScrollActive=!0,this._myPointerID=null,this._myLastValidPointerEvent=null,this._myPointerEventValidCallbacks=new Map,this._myProjectionMatrixInverse=PP.mat4_create(),this._myRotationQuat=PP.quat_create(),this._myOriginWorld=PP.vec3_create(),this._myDirectionWorld=PP.vec3_create()}start(){this._myOnPointerMoveCallback=this._onPointerAction.bind(this,this._onPointerMove.bind(this)),document.body.addEventListener("pointermove",this._myOnPointerMoveCallback),this._myOnPointerDownCallback=this._onPointerAction.bind(this,this._onPointerDown.bind(this)),document.body.addEventListener("pointerdown",this._myOnPointerDownCallback),this._myOnPointerUpCallback=this._onPointerAction.bind(this,this._onPointerUp.bind(this)),document.body.addEventListener("pointerup",this._myOnPointerUpCallback),this._myOnPointerLeaveCallback=this._onPointerLeave.bind(this),document.body.addEventListener("pointerleave",this._myOnPointerLeaveCallback),this._myOnPointerEnterCallback=this._onPointerEnter.bind(this),document.body.addEventListener("pointerenter",this._myOnPointerEnterCallback),this._myOnMouseDownCallback=this._onMouseAction.bind(this,this._onPointerDown.bind(this)),document.body.addEventListener("mousedown",this._myOnMouseDownCallback),this._myOnMouseUpCallback=this._onMouseAction.bind(this,this._onPointerUp.bind(this)),document.body.addEventListener("mouseup",this._myOnMouseUpCallback)}update(e){this._myResetMovingTimer.isRunning()&&(this._myResetMovingTimer.update(e),this._myResetMovingTimer.isDone()&&(this._myResetMovingTimer.reset(),this._myIsMoving=!1));for(let t of this._myButtonInfos.values())t.myIsPressStart=t.myIsPressStartToProcess,t.myIsPressEnd=t.myIsPressEndToProcess,t.myIsPressStartToProcess=!1,t.myIsPressEndToProcess=!1;this._updateScreenSize(),!this.isAnyButtonPressed()&&!this._myIsMoving&&(this._myPointerID=null),this._myLastValidPointerEvent!=null&&(this._isPointerEventValid(this._myLastValidPointerEvent)||(this._myIsInsideView&&this._onPointerLeave(this._myLastValidPointerEvent),this._myLastValidPointerEvent=null))}destroy(){document.body.removeEventListener("pointermove",this._myOnPointerMoveCallback),document.body.removeEventListener("pointerdown",this._myOnPointerDownCallback),document.body.removeEventListener("pointerup",this._myOnPointerUpCallback),document.body.removeEventListener("pointerleave",this._myOnPointerLeaveCallback),document.body.removeEventListener("pointerenter",this._myOnPointerEnterCallback),document.body.removeEventListener("mousedown",this._myOnMouseDownCallback),document.body.removeEventListener("mouseup",this._myOnMouseUpCallback),document.body.removeEventListener("contextmenu",this._myPreventContextMenuCallback),document.body.removeEventListener("mousedown",this._myPreventMiddleButtonScrollCallback)}isValid(){return this._myIsValid}isButtonPressed(e){let t=!1;return this._myButtonInfos.has(e)&&(t=this._myButtonInfos.get(e).myIsPressed),t}isAnyButtonPressed(){let e=!1;for(let t of this._myButtonInfos.values())if(t.myIsPressed){e=!0;break}return e}isButtonPressStart(e){let t=!1;return this._myButtonInfos.has(e)&&(t=this._myButtonInfos.get(e).myIsPressStart),t}isButtonPressEnd(e=null){let t=!1;return this._myButtonInfos.has(e)&&(t=this._myButtonInfos.get(e).myIsPressEnd),t}isMoving(){return this._myIsMoving}isInsideView(){return this._myIsInsideView}isTargetingRenderCanvas(){return this.isInsideView()&&this._myLastValidPointerEvent!=null&&this._myLastValidPointerEvent.target==WL.canvas}raycastWorld(e,t=new PP.RaycastResults){return this.getOriginWorld(e.myOrigin),this.getDirectionWorld(e.myDirection),t=PP.PhysicsUtils.raycast(e,t),t}getPositionScreen(e=PP.vec2_create()){let t=e;return t[0]=this._myInternalMousePosition[0],t[1]=this._myScreenSize[1]-1-this._myInternalMousePosition[1],t}getPositionScreenNormalized(e=PP.vec2_create()){let t=e;return t[0]=this._myScreenSize[0]==0?0:this._myInternalMousePosition[0]/this._myScreenSize[0]*2-1,t[1]=this._myScreenSize[1]==0?0:(this._myScreenSize[1]-1-this._myInternalMousePosition[1])/this._myScreenSize[1]*2-1,t}getScreenSize(){return this._myScreenSize}getPositionWorld(e,t=PP.vec3_create()){let n=this.getOriginWorld(this._myOriginWorld),a=this.getDirectionWorld(this._myDirectionWorld);return t=n.vec3_add(a.vec3_scale(e,t),t),t}getOriginWorld(e=PP.vec3_create()){return PP.XRUtils.isSessionActive()?PP.myPlayerObjects.myEyeLeft.pp_getPosition(e):PP.myPlayerObjects.myNonVRCamera.pp_getPosition(e),e}getDirectionWorld(e=PP.vec3_create()){let t=this._myInternalMousePosition[0]/this._myScreenSize[0],n=this._myInternalMousePosition[1]/this._myScreenSize[1],a=e;a.vec3_set(t*2-1,-n*2+1,-1);let s=this._myProjectionMatrixInverse;PP.XRUtils.isSessionActive()?s=PP.myPlayerObjects.myEyeLeft.pp_getComponentHierarchy("view").projectionMatrix.mat4_invert(s):s=PP.myPlayerObjects.myNonVRCamera.pp_getComponentHierarchy("view").projectionMatrix.mat4_invert(s),a.vec3_transformMat4(s,a),a.vec3_normalize(a);let o=a;return PP.XRUtils.isSessionActive()?o=a.vec3_transformQuat(PP.myPlayerObjects.myEyeLeft.pp_getRotationQuat(this._myRotationQuat),a):o=a.vec3_transformQuat(PP.myPlayerObjects.myNonVRCamera.pp_getRotationQuat(this._myRotationQuat),a),o.vec3_normalize(o),e}setTouchValid(e){let t="internal_touch_valid_callback";e?this.removePointerEventValidCallback(t):this.addPointerEventValidCallback(t,function(n){return n.pointerType=="mouse"})}setTargetOnlyRenderCanvas(e){let t="internal_target_only_render_canvas_callback";e?this.addPointerEventValidCallback(t,function(n){return n.target==WL.canvas}):this.removePointerEventValidCallback(t)}getLastValidPointerEvent(){return this._myLastValidPointerEvent}addPointerEventValidCallback(e,t){this._myPointerEventValidCallbacks.set(e,t)}removePointerEventValidCallback(e){this._myPointerEventValidCallbacks.delete(e)}isPointerUpOnPointerLeave(){return this._myPointerUpOnPointerLeave}setPointerUpOnPointerLeave(e){this._myPointerUpOnPointerLeave=e}isContextMenuActive(){return this._myContextMenuActive}setContextMenuActive(e){this._myContextMenuActive!=e&&(e?document.body.removeEventListener("contextmenu",this._myPreventContextMenuCallback):document.body.addEventListener("contextmenu",this._myPreventContextMenuCallback,!1),this._myContextMenuActive=e)}isMiddleButtonScrollActive(){return this._myMiddleButtonScrollActive}setMiddleButtonScrollActive(e){this._myMiddleButtonScrollActive!=e&&(e?document.body.removeEventListener("mousedown",this._myPreventMiddleButtonScrollCallback):document.body.addEventListener("mousedown",this._myPreventMiddleButtonScrollCallback,!1),this._myMiddleButtonScrollActive=e)}setResetMovingDelay(e){this._myResetMovingDelay=e}getResetMovingDelay(){return this._myResetMovingDelay}_onPointerAction(e,t){if(!!this._isPointerEventIDValid(t)){if(!this._isPointerEventValid(t)){this._myIsInsideView&&this._onPointerLeave(t);return}this._myIsInsideView||this._onPointerEnter(t),e(t),this._updatePositionAndScreen(t),this._updatePointerData(t)}}_onMouseAction(e,t){!this._myIsInsideView||!this._isMouseAllowed()||!this._isPointerEventIDValid(this._myLastValidPointerEvent)||!this._isPointerEventValid(this._myLastValidPointerEvent)||e(t)}_onPointerMove(e){this._myResetMovingTimer.start(this._myResetMovingDelay),this._myIsMoving=!0}_onPointerDown(e){let t=this._myButtonInfos.get(e.button);t.myIsPressed||(t.myIsPressed=!0,t.myIsPressStartToProcess=!0)}_onPointerUp(e){let t=this._myButtonInfos.get(e.button);t.myIsPressed&&(t.myIsPressed=!1,t.myIsPressEndToProcess=!0)}_onPointerLeave(e){if(!(!this._myIsInsideView||this._myLastValidPointerEvent==null||e.pointerId!=this._myLastValidPointerEvent.pointerId)){if(this._myIsInsideView=!1,this._myIsMoving=!1,this._myPointerUpOnPointerLeave)for(let t of this._myButtonInfos.values())t.myIsPressed&&(t.myIsPressed=!1,t.myIsPressEndToProcess=!0);this._myPointerID=null}}_onPointerEnter(e){this._myIsInsideView&&this._myPointerID!=null||!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e)||(this._myIsInsideView=!0,this._updatePositionAndScreen(e),this._updatePointerData(e))}_preventContextMenu(e){!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e)||e.preventDefault()}_preventMiddleButtonScroll(e){if(!(!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e))&&e.button==1)return e.preventDefault(),!1}_updatePositionAndScreen(e){this._updateScreenSize(),this._myInternalMousePosition[0]=e.clientX,this._myInternalMousePosition[1]=e.clientY,this._myIsValid=!0}_updateScreenSize(){let e=document.body.getBoundingClientRect();this._myScreenSize[0]=e.width,this._myScreenSize[1]=e.height}_updatePointerData(e){this._myPointerID=e.pointerId,this._myLastValidPointerEvent=e}_isPointerEventIDValid(e){return e==null?!1:this._myPointerID==null||this._myPointerID==e.pointerId}_isPointerEventValid(e){if(e==null)return!1;let t=!0;for(let n of this._myPointerEventValidCallbacks.values())if(!n(e)){t=!1;break}return t}_isMouseAllowed(){return this._myLastValidPointerEvent!=null&&this._myLastValidPointerEvent.pointerId==1}_createButtonInfo(){return{myIsPressed:!1,myIsPressStart:!1,myIsPressStartToProcess:!1,myIsPressEnd:!1,myIsPressEndToProcess:!1}}}});var ps=S(()=>{PP.InputManager=class{constructor(){this._myMouse=new PP.Mouse,this._myKeyboard=new PP.Keyboard,this._myGamepadManager=new PP.GamepadManager}start(){this._myMouse.start(),this._myKeyboard.start(),this._myGamepadManager.start()}update(e){this._myMouse.update(e),this._myKeyboard.update(e),this._myGamepadManager.update(e)}getMouse(){return this._myMouse}getKeyboard(){return this._myKeyboard}getGamepadManager(){return this._myGamepadManager}}});var ds=S(()=>{WL.registerComponent("pp-input-manager",{_myGamepadFixForward:{type:WL.Type.Bool,default:!0},_myMousePreventContextMenu:{type:WL.Type.Bool,default:!0},_myMousePreventMiddleButtonScroll:{type:WL.Type.Bool,default:!0}},{init(){this._myInputManager=new PP.InputManager,PP.myInputManager=this._myInputManager,PP.myMouse=this._myInputManager.getMouse(),PP.myKeyboard=this._myInputManager.getKeyboard(),PP.myGamepadManager=this._myInputManager.getGamepadManager(),PP.myGamepads=PP.myGamepadManager.getGamepads(),PP.myLeftGamepad=PP.myGamepadManager.getLeftGamepad(),PP.myRightGamepad=PP.myGamepadManager.getRightGamepad()},start(){this._myInputManager.start(),this._setupMousePrevent(),this._addGamepadCores()},update(i){this._myInputManager.update(i)},_setupMousePrevent(){this._myMousePreventContextMenu&&PP.myMouse.setContextMenuActive(!1),this._myMousePreventMiddleButtonScroll&&PP.myMouse.setMiddleButtonScrollActive(!1)},_addGamepadCores(){let i=new PP.HandPoseParams;i.myReferenceObject=PP.myPlayerObjects.myPlayerPivot,i.myFixForward=this._myFixForward,i.myForceEmulatedVelocities=!1;let e=new PP.XRGamepadCore(PP.Handedness.LEFT,i),t=new PP.XRGamepadCore(PP.Handedness.RIGHT,i);PP.myLeftGamepad.addGamepadCore("left_xr_gamepad",e),PP.myRightGamepad.addGamepadCore("right_xr_gamepad",t);let n=new PP.KeyboardGamepadCore(PP.Handedness.LEFT,e.getHandPose()),a=new PP.KeyboardGamepadCore(PP.Handedness.RIGHT,t.getHandPose());PP.myLeftGamepad.addGamepadCore("left_keyboard_gamepad",n),PP.myRightGamepad.addGamepadCore("right_keyboard_gamepad",a);let s=new PP.ClassicGamepadCore(null,PP.Handedness.LEFT,e.getHandPose()),o=new PP.ClassicGamepadCore(null,PP.Handedness.RIGHT,t.getHandPose());PP.myLeftGamepad.addGamepadCore("left_classic_gamepad",s),PP.myRightGamepad.addGamepadCore("right_classic_gamepad",o)}});PP.myInputManager=null;PP.myMouse=null;PP.myKeyboard=null;PP.myGamepadManager=null;PP.myGamepads=null;PP.myLeftGamepad=null;PP.myRightGamepad=null});var _s=S(()=>{WL.registerComponent("pp-switch-hand-object",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myGamepad:{type:WL.Type.Object},_myTrackedHand:{type:WL.Type.Object}},{init:function(){},start:function(){this._myHandednessType=PP.InputUtils.getHandednessByIndex(this._myHandedness),this._myFirstUpdate=!0,this._myCurrentInputSourceType=null},onActivate(){this._myFirstUpdate=!0},update:function(i){this._myFirstUpdate&&(this._myFirstUpdate=!1,this._start());let e=PP.InputUtils.getInputSourceTypeByHandedness(this._myHandednessType);e!=null&&this._myCurrentInputSourceType!=e&&(this._myCurrentInputSourceType=e,e==PP.InputSourceType.TRACKED_HAND?(this._myGamepad!=null&&this._myGamepad.pp_setActive(!1),this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!0)):e==PP.InputSourceType.GAMEPAD&&(this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!1),this._myGamepad!=null&&this._myGamepad.pp_setActive(!0)))},_start(){this._myGamepad!=null&&this._myGamepad.pp_setActive(!1),this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!1),this._myCurrentInputSourceType=null}})});var Ps=S(()=>{WL.registerComponent("pp-tracked-hand-draw-joint",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_myJointID:{type:WL.Type.Enum,values:["Wrist","Thumb Metacarpal","Thumb Phalanx Proximal","Thumb Phalanx Distal","Thumb Tip","Index Metacarpal","Index Phalanx Proximal","Index Phalanx Intermediate","Index Phalanx Distal","Index Tip","Middle Metacarpal","Middle Phalanx Proximal","Middle Phalanx Intermediate","Middle Phalanx Distal","Middle Tip","Ring Metacarpal","Ring Phalanx Proximal","Ring Phalanx Intermediate","Ring Phalanx Distal","Ring Tip","Pinky Metacarpal","Pinky Phalanx Proximal","Pinky Phalanx Intermediate","Pinky Phalanx Distal","Pinky Tip"],default:"Wrist"},_myJointMesh:{type:WL.Type.Mesh},_myJointMaterial:{type:WL.Type.Material}},{init:function(){this._myHandednessInternal=PP.InputUtils.getHandednessByIndex(this._myHandedness),this._myJointIDInternal=PP.InputUtils.getJointIDByIndex(this._myJointID),this._myTrackedHandJointPose=new PP.TrackedHandJointPose(this._myHandednessInternal,this._myJointIDInternal),this._myTrackedHandJointPose.setFixForward(this._myFixForward)},start:function(){this._myTrackedHandJointPose.start(),this._buildTrackedHandHierarchy()},update:function(i){this._myTrackedHandJointPose.update(i),this._myJointMeshObject.pp_setTransformLocalQuat(this._myTrackedHandJointPose.getTransformQuat()),this._myJointMeshObject.pp_setScaleLocal(this._myTrackedHandJointPose.getJointRadius())},_buildTrackedHandHierarchy(){this._myJointMeshObject=this.object.pp_addObject();let i=this._myJointMeshObject.pp_addComponent("mesh");i.mesh=this._myJointMesh,i.material=this._myJointMaterial,this._myJointMeshObject.pp_setScaleLocal(0)}})});var gs=S(()=>{WL.registerComponent("pp-tracked-hand-draw-all-joints",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_myHideMetacarpals:{type:WL.Type.Bool,default:!0},_myJointMesh:{type:WL.Type.Mesh},_myJointMaterial:{type:WL.Type.Material}},{init:function(){},start:function(){this._buildTrackedHandHierarchy()},update:function(i){},_buildTrackedHandHierarchy(){this._myTrackedHandMeshObject=this.object.pp_addObject(),this._myJointMeshObjectList=[];for(let i in PP.TrackedHandJointID){let e=PP.TrackedHandJointID[i];if(!this._myHideMetacarpals||e!=PP.TrackedHandJointID.THUMB_METACARPAL&&e!=PP.TrackedHandJointID.INDEX_FINGER_METACARPAL&&e!=PP.TrackedHandJointID.MIDDLE_FINGER_METACARPAL&&e!=PP.TrackedHandJointID.RING_FINGER_METACARPAL&&e!=PP.TrackedHandJointID.PINKY_FINGER_METACARPAL){let t=this._myTrackedHandMeshObject.pp_addObject();this._myJointMeshObjectList[e]=t,t.pp_addComponent("pp-tracked-hand-draw-joint",{_myHandedness:this._myHandedness,_myFixForward:this._myFixForward,_myJointID:PP.TrackedHandJointIDIndex[i],_myJointMesh:this._myJointMesh,_myJointMaterial:this._myJointMaterial})}}}})});var fs=S(()=>{WL.registerComponent("pp-tracked-hand-draw-skin",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_myHandSkin:{type:WL.Type.Skin,default:null}},{init:function(){this._myHandednessInternal=PP.InputUtils.getHandednessByIndex(this._myHandedness),this._myTrackedHandPose=new PP.TrackedHandPose(this._myHandednessInternal),this._myTrackedHandPose.setFixForward(this._myFixForward)},start:function(){this._myTrackedHandPose.start(),this._prepareJoints()},update:function(e){this._myTrackedHandPose.update(e);for(let t=0;t<this._myJoints.length;t++){let n=this._myJoints[t],a=n.name,s=this._myTrackedHandPose.getJointPose(a);n.pp_setTransformLocalQuat(s.getTransformQuat())}},_prepareJoints(){this._myJoints=[];let i=this._myHandSkin.jointIds;for(let e=0;e<i.length;e++)this._myJoints[e]=new WL.Object(i[e])}})});var vs=S(()=>{PP.GamepadButtonID={SELECT:0,SQUEEZE:1,TOUCHPAD:2,THUMBSTICK:3,BOTTOM_BUTTON:4,TOP_BUTTON:5,THUMB_REST:6};PP.GamepadButtonEvent={PRESS_START:0,PRESS_END:1,PRESSED:2,NOT_PRESSED:3,TOUCH_START:4,TOUCH_END:5,TOUCHED:6,NOT_TOUCHED:7,VALUE_CHANGED:8,ALWAYS:9};PP.GamepadAxesID={THUMBSTICK:0};PP.GamepadAxesEvent={X_CHANGED:0,Y_CHANGED:1,AXES_CHANGED:2,ALWAYS:3};PP.GamepadButtonInfo=class{constructor(e,t){this.myID=e,this.myHandedness=t,this.myIsPressed=!1,this.myPrevIsPressed=!1,this.myIsTouched=!1,this.myPrevIsTouched=!1,this.myValue=0,this.myPrevValue=0,this.myTimePressed=0,this.myPrevTimePressed=0,this.myTimeNotPressed=0,this.myPrevTimeNotPressed=0,this.myTimeTouched=0,this.myPrevTimeTouched=0,this.myTimeNotTouched=0,this.myPrevTimeNotTouched=0,this.myMultiplePressStartCount=0,this.myPrevMultiplePressStartCount=0,this.myMultiplePressEndCount=0,this.myPrevMultiplePressEndCount=0,this.myMultipleTouchStartCount=0,this.myPrevMultipleTouchStartCount=0,this.myMultipleTouchEndCount=0,this.myPrevMultipleTouchEndCount=0}getID(){return this.myID}getHandedness(){return this.myHandedness}getValue(){return this.myValue}isPressed(){return this.myIsPressed}isTouched(){return this.myIsTouched}isPressStart(e=null){return this.myIsPressed&&!this.myPrevIsPressed&&(e==null||this.myMultiplePressStartCount==e)}isPressEnd(e=null){return!this.myIsPressed&&this.myPrevIsPressed&&(e==null||this.myMultiplePressEndCount==e)}isTouchStart(e=null){return this.myIsTouched&&!this.myPrevIsTouched&&(e==null||this.myMultipleTouchStartCount==e)}isTouchEnd(e=null){return!this.myIsTouched&&this.myPrevIsTouched&&(e==null||this.myMultipleTouchEndCount==e)}clone(){let e=new PP.GamepadButtonInfo(this.myID,this.myHandedness);return e.myIsPressed=this.myIsPressed,e.myPrevIsPressed=this.myPrevIsPressed,e.myIsTouched=this.myIsTouched,e.myPrevIsTouched=this.myPrevIsTouched,e.myValue=this.myValue,e.myPrevValue=this.myPrevValue,e.myTimePressed=this.myTimePressed,e.myPrevTimePressed=this.myPrevTimePressed,e.myTimeNotPressed=this.myTimeNotPressed,e.myPrevTimeNotPressed=this.myPrevTimeNotPressed,e.myTimeTouched=this.myTimeTouched,e.myPrevTimeTouched=this.myPrevTimeTouched,e.myTimeNotTouched=this.myTimeNotTouched,e.myPrevTimeNotTouched=this.myPrevTimeNotTouched,e.myMultiplePressStartCount=this.myMultiplePressStartCount,e.myPrevMultiplePressStartCount=this.myPrevMultiplePressStartCount,e.myMultiplePressEndCount=this.myMultiplePressEndCount,e.myPrevMultiplePressEndCount=this.myPrevMultiplePressEndCount,e.myMultipleTouchStartCount=this.myMultipleTouchStartCount,e.myPrevMultipleTouchStartCount=this.myPrevMultipleTouchStartCount,e.myMultipleTouchEndCount=this.myMultipleTouchEndCount,e.myPrevMultipleTouchEndCount=this.myPrevMultipleTouchEndCount,e}};PP.GamepadAxesInfo=class{constructor(e,t){this.myID=e,this.myHandedness=t,this.myAxes=PP.vec2_create(0,0),this.myPrevAxes=PP.vec2_create(0,0)}getID(){return this.myID}getAxes(){return this.myAxes}getHandedness(){return this.myHandedness}clone(){let e=new PP.GamepadAxesInfo(this.myID,this.myHandedness);return e.myAxes.vec2_copy(this.myAxes),e.myPrevAxes.vec2_copy(this.myPrevAxes),e}};PP.GamepadPulseInfo=class{constructor(){this.myIntensity=0,this.myDuration=0,this.myIsDevicePulsing=!1}clone(){let e=new PP.GamepadPulseInfo;return e.myIntensity=this.myIntensity,e.myDuration=this.myDuration,e.myIsDevicePulsing=this.myIsDevicePulsing,e}}});var Ts=S(()=>{PP.BaseGamepad=class{constructor(e){this._myHandedness=e,this._myButtonInfos=[];for(let t in PP.GamepadButtonID)this._myButtonInfos[PP.GamepadButtonID[t]]=new PP.GamepadButtonInfo(PP.GamepadButtonID[t],this._myHandedness);this._myAxesInfos=[];for(let t in PP.GamepadAxesID)this._myAxesInfos[PP.GamepadAxesID[t]]=new PP.GamepadAxesInfo(PP.GamepadAxesID[t],this._myHandedness);this._myButtonCallbacks=[];for(let t in PP.GamepadButtonID){this._myButtonCallbacks[PP.GamepadButtonID[t]]=[];for(let n in PP.GamepadButtonEvent)this._myButtonCallbacks[PP.GamepadButtonID[t]][PP.GamepadButtonEvent[n]]=new Map}this._myAxesCallbacks=[];for(let t in PP.GamepadAxesID){this._myAxesCallbacks[PP.GamepadAxesID[t]]=[];for(let n in PP.GamepadAxesEvent)this._myAxesCallbacks[PP.GamepadAxesID[t]][PP.GamepadAxesEvent[n]]=new Map}this._myPulseInfo=new PP.GamepadPulseInfo,this._myMultiplePressMaxDelay=.4,this._myMultipleTouchMaxDelay=.4}getHandedness(){return this._myHandedness}getButtonInfo(e){return this._myButtonInfos[e]}registerButtonEventListener(e,t,n,a){this._myButtonCallbacks[e][t].set(n,a)}unregisterButtonEventListener(e,t,n){this._myButtonCallbacks[e][t].delete(n)}getAxesInfo(e){return this._myAxesInfos[e]}registerAxesEventListener(e,t,n,a){this._myAxesCallbacks[e][t].set(n,a)}unregisterAxesEventListener(e,t,n){this._myAxesCallbacks[e][t].delete(n)}pulse(e,t=0){this._myPulseInfo.myIntensity=Math.min(Math.max(e,0),1),this._myPulseInfo.myDuration=Math.max(t,0)}stopPulse(){this._myPulseInfo.myIntensity=0,this._myPulseInfo.myDuration=0}isPulsing(){return this._myPulseInfo.myIntensity>0||this._myPulseInfo.myDuration>0}getPulseInfo(){return this._myPulseInfo}getMultiplePressMaxDelay(){return this._myMultiplePressMaxDelay}setMultiplePressMaxDelay(e){this._myMultiplePressMaxDelay=e}getMultipleTouchMaxDelay(){return this._myMultipleTouchMaxDelay}setMultipleTouchMaxDelay(e){this._myMultipleTouchMaxDelay=e}getHandPose(){return null}_start(){}_preUpdate(e){}_postUpdate(e){}_getButtonData(e){return this._createButtonData()}_getAxesData(e){return this._createAxesData()}_getHapticActuators(){return[]}start(){this._start()}update(e){this._preUpdate(e),this._preUpdateButtonInfos(),this._updateButtonInfos(),this._postUpdateButtonInfos(e),this._preUpdateAxesInfos(),this._updateAxesInfos(),this._postUpdateAxesInfos(),this._updatePulse(e),this._postUpdate(e)}_preUpdateButtonInfos(){this._myButtonInfos.forEach(function(e){e.myPrevIsPressed=e.myIsPressed,e.myPrevIsTouched=e.myIsTouched,e.myPrevValue=e.myValue})}_updateButtonInfos(){this._updateSingleButtonInfo(PP.GamepadButtonID.SELECT),this._updateSingleButtonInfo(PP.GamepadButtonID.SQUEEZE),this._updateSingleButtonInfo(PP.GamepadButtonID.TOUCHPAD),this._updateSingleButtonInfo(PP.GamepadButtonID.THUMBSTICK),this._updateSingleButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON),this._updateSingleButtonInfo(PP.GamepadButtonID.TOP_BUTTON),this._updateSingleButtonInfo(PP.GamepadButtonID.THUMB_REST)}_updateSingleButtonInfo(e){let t=this._myButtonInfos[e],n=this._getButtonData(e);t.myIsPressed=n.myIsPressed,t.myIsTouched=n.myIsTouched,t.myValue=n.myValue}_postUpdateButtonInfos(e){this._myButtonInfos.forEach(function(t){t.myIsPressed?(t.myTimePressed+=e,t.myPrevIsPressed||(t.myMultiplePressStartCount+=1,t.myPrevTimeNotPressed=t.myTimeNotPressed,t.myTimeNotPressed=0),t.myPrevTimeNotPressed+t.myTimePressed>this._myMultiplePressMaxDelay&&t.myMultiplePressEndCount>0&&(t.myPrevMultiplePressEndCount=t.myMultiplePressEndCount,t.myMultiplePressEndCount=0),t.myTimePressed>this._myMultiplePressMaxDelay&&t.myMultiplePressStartCount>0&&(t.myPrevMultiplePressStartCount=t.myMultiplePressStartCount,t.myMultiplePressStartCount=0)):(t.myTimeNotPressed+=e,t.myPrevIsPressed&&(t.myMultiplePressEndCount+=1,t.myPrevTimePressed=t.myTimePressed,t.myTimePressed=0),t.myPrevTimePressed+t.myTimeNotPressed>this._myMultiplePressMaxDelay&&t.myMultiplePressStartCount>0&&(t.myPrevMultiplePressStartCount=t.myMultiplePressStartCount,t.myMultiplePressStartCount=0),t.myTimeNotPressed>this._myMultiplePressMaxDelay&&t.myMultiplePressEndCount>0&&(t.myPrevMultiplePressEndCount=t.myMultiplePressEndCount,t.myMultiplePressEndCount=0)),t.myIsTouched?(t.myTimeTouched+=e,t.myPrevIsTouched||(t.myMultipleTouchStartCount+=1,t.myPrevTimeNotTouched=t.myTimeNotTouched,t.myTimeNotTouched=0),t.myPrevTimeNotTouched+t.myTimeTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchEndCount>0&&(t.myPrevMultipleTouchEndCount=t.myMultipleTouchEndCount,t.myMultipleTouchEndCount=0),t.myTimeTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchStartCount>0&&(t.myPrevMultipleTouchStartCount=t.myMultipleTouchStartCount,t.myMultipleTouchStartCount=0)):(t.myTimeNotTouched+=e,t.myPrevIsTouched&&(t.myMultipleTouchEndCount+=1,t.myPrevTimeTouched=t.myTimeTouched,t.myTimeTouched=0),t.myPrevTimeTouched+t.myTimeNotTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchStartCount>0&&(t.myPrevMultipleTouchStartCount=t.myMultipleTouchStartCount,t.myMultipleTouchStartCount=0),t.myTimeNotTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchEndCount>0&&(t.myPrevMultipleTouchEndCount=t.myMultipleTouchEndCount,t.myMultipleTouchEndCount=0))}.bind(this));for(let t in PP.GamepadButtonID){let n=this._myButtonInfos[PP.GamepadButtonID[t]],a=this._myButtonCallbacks[PP.GamepadButtonID[t]];if(n.myIsPressed&&!n.myPrevIsPressed){let o=a[PP.GamepadButtonEvent.PRESS_START];this._triggerCallbacks(o,n)}if(!n.myIsPressed&&n.myPrevIsPressed){let o=a[PP.GamepadButtonEvent.PRESS_END];this._triggerCallbacks(o,n)}if(n.myIsPressed){let o=a[PP.GamepadButtonEvent.PRESSED];this._triggerCallbacks(o,n)}else{let o=a[PP.GamepadButtonEvent.NOT_PRESSED];this._triggerCallbacks(o,n)}if(n.myIsTouched&&!n.myPrevIsTouched){let o=a[PP.GamepadButtonEvent.TOUCH_START];this._triggerCallbacks(o,n)}if(!n.myIsTouched&&n.myPrevIsTouched){let o=a[PP.GamepadButtonEvent.TOUCH_END];this._triggerCallbacks(o,n)}if(n.myIsTouched){let o=a[PP.GamepadButtonEvent.TOUCHED];this._triggerCallbacks(o,n)}else{let o=a[PP.GamepadButtonEvent.NOT_TOUCHED];this._triggerCallbacks(o,n)}if(n.myValue!=n.myPrevValue){let o=a[PP.GamepadButtonEvent.VALUE_CHANGED];this._triggerCallbacks(o,n)}let s=a[PP.GamepadButtonEvent.ALWAYS];this._triggerCallbacks(s,n)}this._mySelectStart=!1,this._mySelectEnd=!1,this._mySqueezeStart=!1,this._mySqueezeEnd=!1}_preUpdateAxesInfos(){this._myAxesInfos.forEach(function(e){e.myPrevAxes[0]=e.myAxes[0],e.myPrevAxes[1]=e.myAxes[1]})}_updateAxesInfos(){this._updateSingleAxesInfo(PP.GamepadAxesID.THUMBSTICK)}_updateSingleAxesInfo(e){let t=this._myAxesInfos[e],n=this._getAxesData(e);t.myAxes[0]=n[0],t.myAxes[1]=n[1]}_postUpdateAxesInfos(){for(let e in PP.GamepadAxesID){let t=this._myAxesInfos[PP.GamepadAxesID[e]],n=this._myAxesCallbacks[PP.GamepadAxesID[e]];if(t.myAxes[0]!=t.myPrevAxes[0]){let s=n[PP.GamepadAxesEvent.X_CHANGED];this._triggerCallbacks(s,t)}if(t.myAxes[1]!=t.myPrevAxes[1]){let s=n[PP.GamepadAxesEvent.Y_CHANGED];this._triggerCallbacks(s,t)}if(t.myAxes[0]!=t.myPrevAxes[0]||t.myAxes[1]!=t.myPrevAxes[1]){let s=n[PP.GamepadAxesEvent.AXES_CHANGED];this._triggerCallbacks(s,t)}let a=n[PP.GamepadAxesEvent.ALWAYS];this._triggerCallbacks(a,t)}}_updatePulse(e){if(this._myPulseInfo.myIsDevicePulsing||this._myPulseInfo.myIntensity>0){let t=this._getHapticActuators();if(t.length>0){if(this._myPulseInfo.myIntensity>0){for(let n of t)n.pulse(this._myPulseInfo.myIntensity,1e3);this._myPulseInfo.myIsDevicePulsing=!0}else if(this._myPulseInfo.myIsDevicePulsing){for(let n of t)n.reset();this._myPulseInfo.myIsDevicePulsing=!1}}else this._myPulseInfo.myIsDevicePulsing=!1}this._myPulseInfo.myDuration-=e,this._myPulseInfo.myDuration<=0&&(this._myPulseInfo.myIntensity=0,this._myPulseInfo.myDuration=0)}_triggerCallbacks(e,t){for(let n of e.values())n(t,this)}_createButtonData(){return{myIsPressed:!1,myIsTouched:!1,myValue:0}}_createAxesData(){return PP.vec2_create(0,0)}}});var Cs=S(()=>{PP.UniversalGamepad=class extends PP.BaseGamepad{constructor(e){super(e),this._myGamepadCores=new Map,this._myStarted=!1,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}addGamepadCore(e,t){t.getHandedness()==this.getHandedness()&&(this._myGamepadCores.set(e,t),this._myStarted&&t.start())}getGamepadCore(e){return this._myGamepadCores.get(e)}removeGamepadCore(e){this._myGamepadCores.get(e)&&this._myGamepadCores.delete(e)}removeAllGamepadCores(){for(let e of this._myGamepadCores.keys())this.removeGamepadCore(e)}getHandPose(){let e=null;for(let t of this._myGamepadCores.values()){if(t.isGamepadCoreActive()){let n=t.getHandPose();(e==null||n!=null&&n.isValid())&&(e=n)}if(e!=null&&e.isValid())break}return e}_start(){for(let e of this._myGamepadCores.values())e.start();this._myStarted=!0}_preUpdate(e){for(let t of this._myGamepadCores.values())t.preUpdate(e)}_postUpdate(e){for(let t of this._myGamepadCores.values())t.postUpdate(e)}_getButtonData(e){this._myButtonData.myIsPressed=!1,this._myButtonData.myIsTouched=!1,this._myButtonData.myValue=0;for(let t of this._myGamepadCores.values())if(t.isGamepadCoreActive()){let n=t.getButtonData(e);this._myButtonData.myIsPressed=this._myButtonData.myIsPressed||n.myIsPressed,this._myButtonData.myIsTouched=this._myButtonData.myIsTouched||n.myIsTouched,Math.abs(n.myValue)>Math.abs(this._myButtonData.myValue)&&(this._myButtonData.myValue=n.myValue)}return this._myButtonData}_getAxesData(e){this._myAxesData.vec2_zero();for(let t of this._myGamepadCores.values())if(t.isGamepadCoreActive()){let n=t.getAxesData(e);Math.abs(n[0])>Math.abs(this._myAxesData[0])&&(this._myAxesData[0]=n[0]),Math.abs(n[1])>Math.abs(this._myAxesData[1])&&(this._myAxesData[1]=n[1])}return this._myAxesData}_getHapticActuators(){this._myHapticActuators.pp_clear();for(let e of this._myGamepadCores.values())e.isGamepadCoreActive()&&this._myHapticActuators.push(...e.getHapticActuators());return this._myHapticActuators}}});var Ss=S(()=>{PP.GamepadCore=class{constructor(e,t){this._myHandedness=e,this._myHandPose=t}getHandedness(){return this._myHandedness}getHandPose(){return this._myHandPose}isGamepadCoreActive(){return!0}start(){}preUpdate(e){}postUpdate(e){}getButtonData(e){return this._createButtonData()}getAxesData(e){return this._createAxesData()}getHapticActuators(){return[]}_createButtonData(){return{myIsPressed:!1,myIsTouched:!1,myValue:0}}_createAxesData(){return PP.vec2_create(0,0)}}});var bs=S(()=>{PP.XRGamepadCore=class extends PP.GamepadCore{constructor(e,t=new PP.HandPoseParams){super(e,new PP.HandPose(e,t)),this._mySelectPressed=!1,this._mySqueezePressed=!1,this._myIsXRSessionActive=!1,this._myInputSource=null,this._myGamepad=null,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return this._myIsXRSessionActive&&this._myGamepad!=null&&(this._myGamepad.connected==null||this._myGamepad.connected)}start(){this._myHandPose.start(),WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}preUpdate(e){this._updateHandPose(e)}getButtonData(e){if(this._myButtonData.myIsPressed=!1,this._myButtonData.myIsTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive()){if(e<this._myGamepad.buttons.length){let t=this._myGamepad.buttons[e];e!=PP.GamepadButtonID.SELECT&&e!=PP.GamepadButtonID.SQUEEZE?this._myButtonData.myIsPressed=t.pressed:this._myButtonData.myIsPressed=this._getSpecialButtonPressed(e),this._myButtonData.myIsTouched=t.touched,this._myButtonData.myValue=t.value}else if(e==PP.GamepadButtonID.TOP_BUTTON&&this._myGamepad.buttons.length>=3){let t=this._myGamepad.buttons[2];this._myButtonData.myIsPressed=t.pressed,this._myButtonData.myIsTouched=t.touched,this._myButtonData.myValue=t.value}}return this._myButtonData}getAxesData(e){if(this._myAxesData.vec2_zero(),this.isGamepadCoreActive()){let t=this._myGamepad.axes;t.length==4?(Math.abs(t[0])>Math.abs(t[2])?this._myAxesData[0]=t[0]:this._myAxesData[0]=t[2],Math.abs(t[1])>Math.abs(t[3])?this._myAxesData[1]=t[1]:this._myAxesData[1]=t[3]):t.length==2&&(this._myAxesData[0]=t[0],this._myAxesData[1]=t[1]),this._myAxesData[1]=-this._myAxesData[1]}return this._myAxesData}getHapticActuators(){return this._myHapticActuators.pp_clear(),this.isGamepadCoreActive()&&(this._myGamepad.hapticActuators!=null&&this._myGamepad.hapticActuators.length>0&&this._myHapticActuators.push(...this._myGamepad.hapticActuators),this._myGamepad.vibrationActuator!=null&&this._myHapticActuators.push(this._myGamepad.vibrationActuator)),this._myHapticActuators}_updateHandPose(e){this._myHandPose.update(e),this._myInputSource=this._myHandPose.getInputSource(),this._myInputSource!=null?this._myGamepad=this._myInputSource.gamepad:this._myGamepad=null}_getSpecialButtonPressed(e){let t=!1;return this.isGamepadCoreActive()&&(e==PP.GamepadButtonID.SELECT?t=this._mySelectPressed:e==PP.GamepadButtonID.SQUEEZE&&(t=this._mySqueezePressed)),t}_onXRSessionStart(e){e.addEventListener("selectstart",this._selectStart.bind(this)),e.addEventListener("selectend",this._selectEnd.bind(this)),e.addEventListener("squeezestart",this._squeezeStart.bind(this)),e.addEventListener("squeezeend",this._squeezeEnd.bind(this)),this._myIsXRSessionActive=!0}_onXRSessionEnd(e){this._myIsXRSessionActive=!1}_selectStart(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySelectPressed=!0)}_selectEnd(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySelectPressed=!1)}_squeezeStart(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySqueezePressed=!0)}_squeezeEnd(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySqueezePressed=!1)}}});var Ms=S(()=>{PP.KeyboardGamepadCore=class extends PP.GamepadCore{constructor(e,t=null){super(e,t),this._myHandPoseUpdateActive=!1,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}setHandPoseUpdateActive(e){this._myHandPoseUpdateActive=e}isHandPoseUpdateActive(){return this._myHandPoseUpdateActive}isGamepadCoreActive(){return!0}start(){this._myHandPose&&this._myHandPoseUpdateActive&&this._myHandPose.start()}preUpdate(e){this._myHandPose&&this._myHandPoseUpdateActive&&this._myHandPose.update(e)}getButtonData(e){if(this._myButtonData.myIsPressed=!1,this._myButtonData.myIsTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive())if(this.getHandedness()==PP.Handedness.LEFT)switch(e){case PP.GamepadButtonID.SELECT:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.E)||PP.myKeyboard.isKeyPressed(PP.KeyID.e);break;case PP.GamepadButtonID.SQUEEZE:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.Q)||PP.myKeyboard.isKeyPressed(PP.KeyID.q);break;case PP.GamepadButtonID.TOUCHPAD:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.X)||PP.myKeyboard.isKeyPressed(PP.KeyID.x);break;case PP.GamepadButtonID.THUMBSTICK:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.R)||PP.myKeyboard.isKeyPressed(PP.KeyID.r);break;case PP.GamepadButtonID.BOTTOM_BUTTON:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.C)||PP.myKeyboard.isKeyPressed(PP.KeyID.c);break;case PP.GamepadButtonID.TOP_BUTTON:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.F)||PP.myKeyboard.isKeyPressed(PP.KeyID.f);break;case PP.GamepadButtonID.THUMB_REST:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.V)||PP.myKeyboard.isKeyPressed(PP.KeyID.v);break}else switch(e){case PP.GamepadButtonID.SELECT:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.U)||PP.myKeyboard.isKeyPressed(PP.KeyID.u);break;case PP.GamepadButtonID.SQUEEZE:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.O)||PP.myKeyboard.isKeyPressed(PP.KeyID.o);break;case PP.GamepadButtonID.TOUCHPAD:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.M)||PP.myKeyboard.isKeyPressed(PP.KeyID.m);break;case PP.GamepadButtonID.THUMBSTICK:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.Y)||PP.myKeyboard.isKeyPressed(PP.KeyID.y);break;case PP.GamepadButtonID.BOTTOM_BUTTON:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.N)||PP.myKeyboard.isKeyPressed(PP.KeyID.n);break;case PP.GamepadButtonID.TOP_BUTTON:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.H)||PP.myKeyboard.isKeyPressed(PP.KeyID.h);break;case PP.GamepadButtonID.THUMB_REST:this._myButtonData.myIsPressed=PP.myKeyboard.isKeyPressed(PP.KeyID.B)||PP.myKeyboard.isKeyPressed(PP.KeyID.b);break}return this._myButtonData.myIsPressed&&(this._myButtonData.myIsTouched=!0,this._myButtonData.myValue=1),this._myButtonData}getAxesData(e){return this._myAxesData.vec2_zero(),this.isGamepadCoreActive()&&(this.getHandedness()==PP.Handedness.LEFT?((PP.myKeyboard.isKeyPressed(PP.KeyID.W)||PP.myKeyboard.isKeyPressed(PP.KeyID.w))&&(this._myAxesData[1]+=1),(PP.myKeyboard.isKeyPressed(PP.KeyID.S)||PP.myKeyboard.isKeyPressed(PP.KeyID.s))&&(this._myAxesData[1]+=-1),(PP.myKeyboard.isKeyPressed(PP.KeyID.D)||PP.myKeyboard.isKeyPressed(PP.KeyID.d))&&(this._myAxesData[0]+=1),(PP.myKeyboard.isKeyPressed(PP.KeyID.A)||PP.myKeyboard.isKeyPressed(PP.KeyID.a))&&(this._myAxesData[0]+=-1)):((PP.myKeyboard.isKeyPressed(PP.KeyID.I)||PP.myKeyboard.isKeyPressed(PP.KeyID.i)||PP.myKeyboard.isKeyPressed(PP.KeyID.UP))&&(this._myAxesData[1]+=1),(PP.myKeyboard.isKeyPressed(PP.KeyID.K)||PP.myKeyboard.isKeyPressed(PP.KeyID.k)||PP.myKeyboard.isKeyPressed(PP.KeyID.DOWN))&&(this._myAxesData[1]+=-1),(PP.myKeyboard.isKeyPressed(PP.KeyID.L)||PP.myKeyboard.isKeyPressed(PP.KeyID.l)||PP.myKeyboard.isKeyPressed(PP.KeyID.RIGHT))&&(this._myAxesData[0]+=1),(PP.myKeyboard.isKeyPressed(PP.KeyID.J)||PP.myKeyboard.isKeyPressed(PP.KeyID.j)||PP.myKeyboard.isKeyPressed(PP.KeyID.LEFT))&&(this._myAxesData[0]+=-1))),this._myAxesData}getHapticActuators(){return this._myHapticActuators}}});var As=S(()=>{PP.VirtualGamepadGamepadCore=class extends PP.GamepadCore{constructor(e,t,n=null){super(t,n),this._myHandPoseUpdateActive=!1,this._myVirtualGamepad=e,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}setHandPoseUpdateActive(e){this._myHandPoseUpdateActive=e}isHandPoseUpdateActive(){return this._myHandPoseUpdateActive}isGamepadCoreActive(){return this._myVirtualGamepad.isVisible()}start(){this._myHandPose&&this._myHandPoseUpdateActive&&this._myHandPose.start()}preUpdate(e){this._myHandPose&&this._myHandPoseUpdateActive&&this._myHandPose.update(e)}getButtonData(e){return this._myButtonData.myIsPressed=!1,this._myButtonData.myIsTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive()&&this._myVirtualGamepad.isButtonPressed(this._myHandedness,e)&&(this._myButtonData.myIsPressed=!0,this._myButtonData.myIsTouched=!0,this._myButtonData.myValue=1),this._myButtonData}getAxesData(e){return this._myAxesData.vec2_zero(),this.isGamepadCoreActive()&&this._myVirtualGamepad.getAxes(this._myHandedness,this._myAxesData),this._myAxesData}getHapticActuators(){return this._myHapticActuators}}});var Is=S(()=>{PP.ClassicGamepadCore=class extends PP.GamepadCore{constructor(e,t,n=null){super(t,n),this._myGamepadIndex=e,this._myHandPoseUpdateActive=!1,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}setHandPoseUpdateActive(e){this._myHandPoseUpdateActive=e}isHandPoseUpdateActive(){return this._myHandPoseUpdateActive}isGamepadCoreActive(){let e=this._getClassicGamepad();return e!=null&&(e.connected==null||e.connected)}start(){this._myHandPose&&this._myHandPoseUpdateActive&&this._myHandPose.start()}preUpdate(e){this._myHandPose&&this._myHandPoseUpdateActive&&this._myHandPose.update(e)}getButtonData(e){this._myButtonData.myIsPressed=!1,this._myButtonData.myIsTouched=!1,this._myButtonData.myValue=0;let t=this._getClassicGamepad();if(t!=null&&this.isGamepadCoreActive()){let n=null;if(this.getHandedness()==PP.Handedness.LEFT)switch(e){case PP.GamepadButtonID.SELECT:n=t.buttons[4];break;case PP.GamepadButtonID.SQUEEZE:n=t.buttons[6];break;case PP.GamepadButtonID.TOUCHPAD:n=null;break;case PP.GamepadButtonID.THUMBSTICK:n=t.buttons[10];break;case PP.GamepadButtonID.BOTTOM_BUTTON:n=t.buttons[13];break;case PP.GamepadButtonID.TOP_BUTTON:n=t.buttons[12];break;case PP.GamepadButtonID.THUMB_REST:n=null;break}else switch(e){case PP.GamepadButtonID.SELECT:n=t.buttons[5];break;case PP.GamepadButtonID.SQUEEZE:n=t.buttons[7];break;case PP.GamepadButtonID.TOUCHPAD:n=null;break;case PP.GamepadButtonID.THUMBSTICK:n=t.buttons[11];break;case PP.GamepadButtonID.BOTTOM_BUTTON:n=t.buttons[0];break;case PP.GamepadButtonID.TOP_BUTTON:n=t.buttons[3];break;case PP.GamepadButtonID.THUMB_REST:n=null;break}n!=null&&(this._myButtonData.myIsPressed=n.pressed,this._myButtonData.myIsTouched=n.touched,this._myButtonData.myValue=n.value)}return this._myButtonData}getAxesData(e){this._myAxesData.vec2_zero();let t=this._getClassicGamepad();return t!=null&&this.isGamepadCoreActive()&&(this.getHandedness()==PP.Handedness.LEFT?(this._myAxesData[0]=t.axes[0],this._myAxesData[1]=t.axes[1]):(this._myAxesData[0]=t.axes[2],this._myAxesData[1]=t.axes[3])),this._myAxesData}getHapticActuators(){this._myHapticActuators.pp_clear();let e=this._getClassicGamepad();return e!=null&&this.isGamepadCoreActive()&&(e.hapticActuators!=null&&e.hapticActuators.length>0&&this._myHapticActuators.push(...e.hapticActuators),e.vibrationActuator!=null&&this._myHapticActuators.push(e.vibrationActuator)),this._myHapticActuators}_getClassicGamepad(){let e=null,t=navigator.getGamepads();if(this._myGamepadIndex!=null)this._myGamepadIndex<t.length&&(e=t[this._myGamepadIndex]);else for(let n of t)if(n!=null&&(n.connected==null||n.connected)){e=n;break}return e}}});var xs=S(()=>{WL.registerComponent("pp-gamepad-mesh-animator",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_mySelect:{type:WL.Type.Object,default:null},_mySqueeze:{type:WL.Type.Object,default:null},_myThumbstick:{type:WL.Type.Object,default:null},_myTopButton:{type:WL.Type.Object,default:null},_myBottomButton:{type:WL.Type.Object,default:null},_mySelectRotateAngle:{type:WL.Type.Float,default:15},_mySqueezeRotateAngle:{type:WL.Type.Float,default:11},_myThumbstickRotateAngle:{type:WL.Type.Float,default:15},_myThumbstickPressOffset:{type:WL.Type.Float,default:625e-6},_myTopButtonPressOffset:{type:WL.Type.Float,default:.0015},_myBottomButtonPressOffset:{type:WL.Type.Float,default:.0015},_myUsePressForSqueeze:{type:WL.Type.Bool,default:!1},_mySqueezePressOffset:{type:WL.Type.Float,default:.0015}},{start:function(){let i=null;this._myHandedness==0?i=PP.myLeftGamepad:i=PP.myRightGamepad,this._mySelect!=null&&(this._mySelectOriginalRotation=this._mySelect.pp_getRotationLocalQuat(),this._mySelectOriginalLeft=this._mySelect.pp_getLeftLocal()),this._mySqueeze!=null&&(this._mySqueezeOriginalPosition=this._mySqueeze.pp_getPositionLocal(),this._mySqueezeOriginalRotation=this._mySqueeze.pp_getRotationLocalQuat(),this._mySqueezeOriginalLeft=this._mySqueeze.pp_getLeftLocal(),this._mySqueezeOriginalForward=this._mySqueeze.pp_getForwardLocal()),this._myThumbstick!=null&&(this._myThumbstickOriginalPosition=this._myThumbstick.pp_getPositionLocal(),this._myThumbstickOriginalRotation=this._myThumbstick.pp_getRotationLocalQuat(),this._myThumbstickOriginalLeft=this._myThumbstick.pp_getLeftLocal(),this._myThumbstickOriginalUp=this._myThumbstick.pp_getUpLocal(),this._myThumbstickOriginalForward=this._myThumbstick.pp_getForwardLocal()),this._myTopButton!=null&&(this._myTopButtonOriginalPosition=this._myTopButton.pp_getPositionLocal(),this._myTopButtonOriginalUp=this._myTopButton.pp_getUpLocal()),this._myBottomButton!=null&&(this._myBottomButtonOriginalPosition=this._myBottomButton.pp_getPositionLocal(),this._myBottomButtonOriginalUp=this._myBottomButton.pp_getUpLocal()),this._myThumbstick!=null&&(i.registerButtonEventListener(PP.GamepadButtonID.THUMBSTICK,PP.GamepadButtonEvent.PRESS_START,this,this._thumbstickPressedStart.bind(this)),i.registerButtonEventListener(PP.GamepadButtonID.THUMBSTICK,PP.GamepadButtonEvent.PRESS_END,this,this._thumbstickPressedEnd.bind(this))),this._myTopButton!=null&&(i.registerButtonEventListener(PP.GamepadButtonID.TOP_BUTTON,PP.GamepadButtonEvent.PRESS_START,this,this._topButtonPressedStart.bind(this)),i.registerButtonEventListener(PP.GamepadButtonID.TOP_BUTTON,PP.GamepadButtonEvent.PRESS_END,this,this._topButtonPressedEnd.bind(this))),this._myBottomButton!=null&&(i.registerButtonEventListener(PP.GamepadButtonID.BOTTOM_BUTTON,PP.GamepadButtonEvent.PRESS_START,this,this._bottomButtonPressedStart.bind(this)),i.registerButtonEventListener(PP.GamepadButtonID.BOTTOM_BUTTON,PP.GamepadButtonEvent.PRESS_END,this,this._bottomButtonPressedEnd.bind(this))),this._mySelect!=null&&i.registerButtonEventListener(PP.GamepadButtonID.SELECT,PP.GamepadButtonEvent.VALUE_CHANGED,this,this._selectValueChanged.bind(this)),this._mySqueeze!=null&&i.registerButtonEventListener(PP.GamepadButtonID.SQUEEZE,PP.GamepadButtonEvent.VALUE_CHANGED,this,this._squeezeValueChanged.bind(this)),this._myThumbstick!=null&&i.registerAxesEventListener(PP.GamepadAxesID.THUMBSTICK,PP.GamepadAxesEvent.AXES_CHANGED,this,this._thumbstickValueChanged.bind(this))},_thumbstickPressedStart:function(){let i=PP.vec3_create();return function(t,n){this._myThumbstickOriginalUp.vec3_scale(-this._myThumbstickPressOffset,i),this._myThumbstick.pp_translateLocal(i)}}(),_thumbstickPressedEnd:function(e,t){this._myThumbstick.pp_setPositionLocal(this._myThumbstickOriginalPosition)},_topButtonPressedStart:function(i,e){this._myTopButton.pp_translateAxisLocal(-this._myTopButtonPressOffset,this._myTopButtonOriginalUp)},_topButtonPressedEnd:function(i,e){this._myTopButton.pp_setPositionLocal(this._myTopButtonOriginalPosition)},_bottomButtonPressedStart:function(i,e){this._myBottomButton.pp_translateAxisLocal(-this._myBottomButtonPressOffset,this._myBottomButtonOriginalUp)},_bottomButtonPressedEnd:function(i,e){this._myBottomButton.pp_setPositionLocal(this._myBottomButtonOriginalPosition)},_selectValueChanged:function(i,e){this._mySelect.pp_setRotationLocalQuat(this._mySelectOriginalRotation),i.myValue>1e-5&&this._mySelect.pp_rotateAxisLocal(this._mySelectRotateAngle*i.myValue,this._mySelectOriginalLeft)},_squeezeValueChanged:function(i,e){if(this._mySqueeze.pp_setPositionLocal(this._mySqueezeOriginalPosition),this._mySqueeze.pp_setRotationLocalQuat(this._mySqueezeOriginalRotation),i.myValue>1e-5)if(this._myUsePressForSqueeze){let t=this._mySqueezePressOffset;this._myHandedness==1&&(t*=-1),this._mySqueeze.pp_translateAxisLocal(t*i.myValue,this._mySqueezeOriginalLeft)}else{let t=-this._mySqueezeRotateAngle;this._myHandedness==1&&(t*=-1),this._mySqueeze.pp_rotateAxisLocal(t*i.myValue,this._mySqueezeOriginalForward)}},_thumbstickValueChanged:function(i,e){this._myThumbstick.pp_setRotationLocalQuat(this._myThumbstickOriginalRotation);let t=this._myThumbstickRotateAngle*i.myAxes[1],n=this._myThumbstickRotateAngle*i.myAxes[0];Math.abs(t)>1e-4&&this._myThumbstick.pp_rotateAxisLocal(t,this._myThumbstickOriginalLeft),Math.abs(n)>1e-4&&this._myThumbstick.pp_rotateAxisLocal(n,this._myThumbstickOriginalForward)}})});var Rs=S(()=>{PP.GamepadManager=class{constructor(){this._myLeftGamepad=new PP.UniversalGamepad(PP.Handedness.LEFT),this._myRightGamepad=new PP.UniversalGamepad(PP.Handedness.RIGHT)}start(){this._myLeftGamepad.start(),this._myRightGamepad.start()}update(e){this._myLeftGamepad.update(e),this._myRightGamepad.update(e)}getLeftGamepad(){return this._myLeftGamepad}getRightGamepad(){return this._myRightGamepad}getGamepad(e){let t=null;switch(e){case PP.Handedness.LEFT:t=this._myLeftGamepad;break;case PP.Handedness.RIGHT:t=this._myRightGamepad;break;default:t=null}return t}getGamepads(){let e=[];return e[PP.Handedness.LEFT]=this._myLeftGamepad,e[PP.Handedness.RIGHT]=this._myRightGamepad,e}}});var Vs=S(()=>{PP.GamepadUtils={_mySimultaneousPressMaxDelay:.15,_mySimultaneousTouchMaxDelay:.15,setSimultaneousPressMaxDelay:function(i){PP.GamepadUtils._mySimultaneousPressMaxDelay=i},setSimultaneousTouchMaxDelay:function(i){PP.GamepadUtils._mySimultaneousTouchMaxDelay=i},getSimultaneousPressMaxDelay:function(){return PP.GamepadUtils._mySimultaneousPressMaxDelay},getSimultaneousTouchMaxDelay:function(){return PP.GamepadUtils._mySimultaneousTouchMaxDelay},isAnyButtonPressStart:function(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let a of t)if(a.length==1)for(let s in PP.GamepadButtonID)a.push(PP.GamepadButtonID[s]);let n=!1;for(let a of t){let s=a[0];for(let o=1;o<a.length;o++){let l=a[o];if(s.getButtonInfo(l).isPressStart(e)){n=!0;break}}if(n)break}return n},areButtonsPressStart:function(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let o in PP.GamepadButtonID)s.push(PP.GamepadButtonID[o]);let n=!0,a=!1;for(let s of t){let o=s[0];for(let l=1;l<s.length;l++){let m=s[l],c=o.getButtonInfo(m);if(!(c.myIsPressed&&(e==null||c.myMultiplePressStartCount==e)&&c.myTimePressed<PP.GamepadUtils._mySimultaneousPressMaxDelay)){n=!1;break}c.isPressStart(e)&&(a=!0)}if(!n)break}return n&&a},isAnyButtonPressEnd:function(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let a of t)if(a.length==1)for(let s in PP.GamepadButtonID)a.push(PP.GamepadButtonID[s]);let n=!1;for(let a of t){let s=a[0];for(let o=1;o<a.length;o++){let l=a[o];if(s.getButtonInfo(l).isPressEnd(e)){n=!0;break}}if(n)break}return n},areButtonsPressEnd:function(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let o in PP.GamepadButtonID)s.push(PP.GamepadButtonID[o]);let n=!0,a=!1;for(let s of t){let o=s[0];for(let l=1;l<s.length;l++){let m=s[l],c=o.getButtonInfo(m);if(!(!c.myIsPressed&&(e==null||c.myMultiplePressEndCount==e)&&c.myTimeNotPressed<PP.GamepadUtils._mySimultaneousPressMaxDelay)){n=!1;break}c.isPressEnd(e)&&(a=!0)}if(!n)break}return n&&a},isAnyButtonTouchStart:function(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let a of t)if(a.length==1)for(let s in PP.GamepadButtonID)a.push(PP.GamepadButtonID[s]);let n=!1;for(let a of t){let s=a[0];for(let o=1;o<a.length;o++){let l=a[o];if(s.getButtonInfo(l).isTouchStart(e)){n=!0;break}}if(n)break}return n},areButtonsTouchStart:function(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let o in PP.GamepadButtonID)s.push(PP.GamepadButtonID[o]);let n=!0,a=!1;for(let s of t){let o=s[0];for(let l=1;l<s.length;l++){let m=s[l],c=o.getButtonInfo(m);if(!(c.myIsTouched&&(e==null||c.myMultipleTouchStartCount==e)&&c.myTimeTouched<PP.GamepadUtils._mySimultaneousTouchMaxDelay)){n=!1;break}c.isTouchStart(e)&&(a=!0)}if(!n)break}return n&&a},isAnyButtonTouchEnd:function(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let a of t)if(a.length==1)for(let s in PP.GamepadButtonID)a.push(PP.GamepadButtonID[s]);let n=!1;for(let a of t){let s=a[0];for(let o=1;o<a.length;o++){let l=a[o];if(s.getButtonInfo(l).isTouchEnd(e)){n=!0;break}}if(n)break}return n},areButtonsTouchEnd:function(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let o in PP.GamepadButtonID)s.push(PP.GamepadButtonID[o]);let n=!0,a=!1;for(let s of t){let o=s[0];for(let l=1;l<s.length;l++){let m=s[l],c=o.getButtonInfo(m);if(!(!c.myIsTouched&&(e==null||c.myMultipleTouchEndCount==e)&&c.myTimeNotTouched<PP.GamepadUtils._mySimultaneousTouchMaxDelay)){n=!1;break}c.isTouchEnd(e)&&(a=!0)}if(!n)break}return n&&a}}});var Ds=S(()=>{WL.registerComponent("pp-gamepad-control-scheme",{_myShowOnStart:{type:WL.Type.Bool,default:!0},_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_mySelectText:{type:WL.Type.String,default:""},_mySqueezeText:{type:WL.Type.String,default:""},_myThumbstickText:{type:WL.Type.String,default:""},_myBottomButtonText:{type:WL.Type.String,default:""},_myTopButtonText:{type:WL.Type.String,default:""},_mySelect:{type:WL.Type.Object,default:null},_mySqueeze:{type:WL.Type.Object,default:null},_myThumbstick:{type:WL.Type.Object,default:null},_myBottomButton:{type:WL.Type.Object,default:null},_myTopButton:{type:WL.Type.Object,default:null},_myTextScaleMultiplier:{type:WL.Type.Float,default:1},_myTextOffsetMultiplier:{type:WL.Type.Float,default:1},_myLineLengthMultiplier:{type:WL.Type.Float,default:1},_myLineThicknessMultiplier:{type:WL.Type.Float,default:1},_myDistanceFromButtonsMultiplier:{type:WL.Type.Float,default:1},_myTextMaterial:{type:WL.Type.Material},_myLineMaterial:{type:WL.Type.Material}},{init:function(){},start:function(){this._myTextMaterialFinal=this._myTextMaterial!=null?this._myTextMaterial:PP.myDefaultResources.myMaterials.myText.clone(),this._myLineMaterialFinal=this._myLineMaterial!=null?this._myLineMaterial:PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),this._myHandednessType=PP.InputUtils.getHandednessByIndex(this._myHandedness),this._myControlSchemeDirection=this._myHandednessType==PP.Handedness.LEFT?1:-1,this._myVisible=!1,this._mySetVisibleNextUpdate=!1,this._createControlScheme(),this.setVisible(this._myShowOnStart),this._myVisibleBackup=this._myVisible},update:function(i){this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this.setVisible(!1),this.setVisible(this._myVisibleBackup))},onActivate(){this._mySetVisibleNextUpdate=!0},onDeactivate(){this._myVisibleBackup=this._myVisible,this.setVisible(!1)},isVisible(){return this._myVisible},setVisible(i){this._myVisible=i,this._myRootObject!=null&&(this._myRootObject.pp_setActive(this._myVisible),this._myVisible&&this._hideEmptySchemes())},setSelectText(i){this._mySelectText=i,this._mySelectTextComponent.text=this._mySelectText,this.setVisible(this._myVisible)},setSqueezeText(i){this._mySqueezeText=i,this._mySqueezeTextComponent.text=this._mySqueezeText,this.setVisible(this._myVisible)},setThumbstickText(i){this._myThumbstickText=i,this._myThumbstickTextComponent.text=this._myThumbstickText,this.setVisible(this._myVisible)},setBottomButtonText(i){this._myBottomButtonText=i,this._myBottomButtonTextComponent.text=this._myBottomButtonText,this.setVisible(this._myVisible)},setTopButtonText(i){this._myTopButtonText=i,this._myTopButtonTextComponent.text=this._myTopButtonText,this.setVisible(this._myVisible)},_createControlScheme(){this._myRootObject=this.object.pp_addObject();let i=.02*this._myDistanceFromButtonsMultiplier,e=.0935*this._myLineLengthMultiplier,t=this._myThumbstick;this._mySelectObject=this._myRootObject.pp_addObject(),this._mySelectTextComponent=this._addScheme(this._mySelect,t,PP.vec3_create(0,0,i),PP.vec3_create(e*this._myControlSchemeDirection,0,0),this._mySelectObject),this._mySelectTextComponent.text=this._mySelectText,this._mySqueezeObject=this._myRootObject.pp_addObject(),this._mySqueezeTextComponent=this._addScheme(this._mySqueeze,t,PP.vec3_create(i*this._myControlSchemeDirection,0,0),PP.vec3_create(e*this._myControlSchemeDirection,0,0),this._mySqueezeObject),this._mySqueezeTextComponent.text=this._mySqueezeText,this._myThumbstickObject=this._myRootObject.pp_addObject(),this._myThumbstickTextComponent=this._addScheme(this._myThumbstick,t,PP.vec3_create(0,i,0),PP.vec3_create(-e*this._myControlSchemeDirection,0,0),this._myThumbstickObject),this._myThumbstickTextComponent.text=this._myThumbstickText;let n=this._myThumbstick.pp_getPositionLocal(),a=this._myThumbstick.pp_getUpLocal();{let l=this._myBottomButton.pp_getPositionLocal().vec3_sub(n).vec3_valueAlongAxis(a);this._myBottomButtonObject=this._myRootObject.pp_addObject(),this._myBottomButtonTextComponent=this._addScheme(this._myBottomButton,t,PP.vec3_create(0,i-l,0),PP.vec3_create(0,0,-e),this._myBottomButtonObject),this._myBottomButtonTextComponent.text=this._myBottomButtonText}{let l=this._myTopButton.pp_getPositionLocal().vec3_sub(n).vec3_valueAlongAxis(a);this._myTopButtonObject=this._myRootObject.pp_addObject(),this._myTopButtonTextComponent=this._addScheme(this._myTopButton,t,PP.vec3_create(0,i-l,0),PP.vec3_create(-e*this._myControlSchemeDirection,0,0).vec3_rotateAxis(-45*this._myControlSchemeDirection,PP.vec3_create(0,1,0)),this._myTopButtonObject),this._myTopButtonTextComponent.text=this._myTopButtonText}},_addScheme(i,e,t,n,a){let s=i.pp_getPositionLocal(),o=e.pp_getForwardLocal(),l=e.pp_getRightLocal(),m=e.pp_getUpLocal(),c=s.vec3_add(l.vec3_scale(t[0]));c.vec3_add(m.vec3_scale(t[1]),c),c.vec3_add(o.vec3_scale(t[2]),c);let r=c.vec3_add(l.vec3_scale(n[0]));r.vec3_add(m.vec3_scale(n[1]),r),r.vec3_add(o.vec3_scale(n[2]),r);let y=.01*this._myTextOffsetMultiplier,u=r.vec3_add(o.vec3_scale(-y));return this._addLine(c,r,a),this._addText(u,o,m,a)},_addLine(i,e,t){let n=e.vec3_sub(i),a=n.vec3_length();n.vec3_normalize(n),lineRootObject=t.pp_addObject(),lineObject=lineRootObject.pp_addObject();let s=lineObject.addComponent("mesh");s.mesh=PP.myDefaultResources.myMeshes.myCylinder,s.material=this._myLineMaterialFinal,lineRootObject.pp_setPositionLocal(i);let o=.001*this._myLineThicknessMultiplier;lineObject.pp_scaleObject(PP.vec3_create(o/2,a/2,o/2)),lineObject.pp_setUpLocal(n),lineObject.pp_translateObject(PP.vec3_create(0,a/2,0))},_addText(i,e,t,n){let a=n.pp_addObject();a.pp_setPositionLocal(i),a.pp_lookToLocal(t,e),a.pp_scaleObject(.0935*this._myTextScaleMultiplier);let s=a.pp_addComponent("text");return s.alignment=WL.Alignment.Center,s.justification=WL.Justification.Top,s.material=this._myTextMaterialFinal,s},_hideEmptySchemes(){this._mySelectText.length==0&&this._mySelectObject.pp_setActive(!1),this._mySqueezeText.length==0&&this._mySqueezeObject.pp_setActive(!1),this._myThumbstickText.length==0&&this._myThumbstickObject.pp_setActive(!1),this._myBottomButtonText.length==0&&this._myBottomButtonObject.pp_setActive(!1),this._myTopButtonText.length==0&&this._myTopButtonObject.pp_setActive(!1)}})});var Ls=S(()=>{PP.VirtualGamepad=class{constructor(e=new PP.VirtualGamepadParams){this._myParams=e,this._myVisible=!0,this._myVirtualGamepadContainer=null,this._myVirtualGamepadVirtualButtons=[],this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT]=[],this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT]=[],this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT][PP.GamepadButtonID.SELECT]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT][PP.GamepadButtonID.SQUEEZE]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT][PP.GamepadButtonID.THUMBSTICK]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT][PP.GamepadButtonID.TOP_BUTTON]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT][PP.GamepadButtonID.BOTTOM_BUTTON]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT][PP.GamepadButtonID.SELECT]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT][PP.GamepadButtonID.SQUEEZE]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT][PP.GamepadButtonID.THUMBSTICK]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT][PP.GamepadButtonID.TOP_BUTTON]=null,this._myVirtualGamepadVirtualButtons[PP.Handedness.RIGHT][PP.GamepadButtonID.BOTTOM_BUTTON]=null,this._myButtonsAmount=this._myVirtualGamepadVirtualButtons[PP.Handedness.LEFT].length,this._myVirtualGamepadVirtualThumbsticks=[],this._myVirtualGamepadVirtualThumbsticks[PP.Handedness.LEFT]=null,this._myVirtualGamepadVirtualThumbsticks[PP.Handedness.RIGHT]=null}isVisible(){return this._myVisible}setVisible(e){if(this._myVisible!=e&&(this._myVisible=e,this._myVirtualGamepadContainer!=null)){this._myVisible?this._myVirtualGamepadContainer.style.display="block":this._myVirtualGamepadContainer.style.display="none";for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let a=this._myVirtualGamepadVirtualButtons[t][n];a?.setActive(this._myVisible)}for(let t in this._myVirtualGamepadVirtualThumbsticks){let n=this._myVirtualGamepadVirtualThumbsticks[t];n?.setActive(this._myVisible)}}}isButtonPressed(e,t){if(!this._myVisible)return!1;let n=this._myVirtualGamepadVirtualButtons[e][t];return n!=null?n.isPressed():!1}getAxes(e,t=PP.vec2_create(0,0)){if(!this._myVisible)return t;let n=this._myVirtualGamepadVirtualThumbsticks[e];return n!=null&&t.vec2_copy(n.getAxes()),t}start(){this._buildVirtualGamepad();let e=this._myVisible;this._myVisible=!this._myVisible,this.setVisible(e)}update(e){if(this._myParams.myAutoUpdateVisibility&&(PP.XRUtils.isSessionActive()&&WL.vrSupported==1?this.setVisible(!1):this._myParams.myShowOnDesktop&&PP.BrowserUtils.isDesktop()&&WL.vrSupported==0?this.setVisible(!0):this._myParams.myShowOnHeadset&&PP.BrowserUtils.isDesktop()&&WL.vrSupported==1?this.setVisible(!0):this._myParams.myShowOnMobile&&PP.BrowserUtils.isMobile()?this.setVisible(!0):this.setVisible(!1)),this._myVisible){for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let a=this._myVirtualGamepadVirtualButtons[t][n];a?.update(e)}for(let t in this._myVirtualGamepadVirtualThumbsticks){let n=this._myVirtualGamepadVirtualThumbsticks[t];n?.update(e)}this._setMouseHoverActive(!(this._myParams.myDisableMouseHoverWhenPressed&&this._isAnyElementPressed()))}}_buildVirtualGamepad(){this._documentBodySetup(),this._myVirtualGamepadContainer=document.createElement("div"),this._myVirtualGamepadContainer.style.display="block",this._myVirtualGamepadContainer.style.opacity=this._myParams.myOpacity.toString(),document.body.appendChild(this._myVirtualGamepadContainer);let e=document.createElement("div");this._myVirtualGamepadContainer.appendChild(e);let t=document.createElement("div");this._myVirtualGamepadContainer.appendChild(t);let n=this._myParams.myButtonsOrder[PP.Handedness.LEFT].length;for(let a=0;a<n;a++){if(this._myParams.myButtonsOrder[PP.Handedness.LEFT][a]!=null){let s=this._myParams.myButtonsOrder[PP.Handedness.LEFT][a][0],o=this._myParams.myButtonsOrder[PP.Handedness.LEFT][a][1];this._buildButton(e,PP.Handedness.LEFT,a,s,o)}if(this._myParams.myButtonsOrder[PP.Handedness.RIGHT][a]!=null){let s=this._myParams.myButtonsOrder[PP.Handedness.RIGHT][a][0],o=this._myParams.myButtonsOrder[PP.Handedness.RIGHT][a][1];this._buildButton(t,PP.Handedness.RIGHT,a,s,o)}}if(this._myParams.myThumbsticksOrder[PP.Handedness.LEFT]!=null){let a=this._myParams.myThumbsticksOrder[PP.Handedness.LEFT];this._buildThumbstick(e,PP.Handedness.LEFT,a)}if(this._myParams.myThumbsticksOrder[PP.Handedness.RIGHT]!=null){let a=this._myParams.myThumbsticksOrder[PP.Handedness.RIGHT];this._buildThumbstick(t,PP.Handedness.RIGHT,a)}}_documentBodySetup(){document.body.style.overflow="hidden",document.body.style.userSelect="none",document.body.style.webkitUserSelect="none",document.body.style.webkitTapHighlightColor="transparent",document.body.style.touchAction="none",document.addEventListener("gesturestart",function(e){e.preventDefault()})}_buildButton(e,t,n,a,s){let o=new PP.VirtualGamepadVirtualButton(e,this._myParams,t,n,a,s);this._myVirtualGamepadVirtualButtons[a][s]=o}_buildThumbstick(e,t,n){let a=new PP.VirtualGamepadVirtualThumbstick(e,this._myParams,t,n);this._myVirtualGamepadVirtualThumbsticks[n]=a}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}_isAnyElementPressed(){let e=!1;for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let a=this._myVirtualGamepadVirtualButtons[t][n];if(a!=null&&a.isPressed()){e=!0;break}}if(!e)for(let t in this._myVirtualGamepadVirtualThumbsticks){let n=this._myVirtualGamepadVirtualThumbsticks[t];if(n!=null&&n.isPressed()){e=!0;break}}return e}_setMouseHoverActive(e){for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let a=this._myVirtualGamepadVirtualButtons[t][n];a?.setMouseHoverActive(e)}for(let t in this._myVirtualGamepadVirtualThumbsticks){let n=this._myVirtualGamepadVirtualThumbsticks[t];n?.setMouseHoverActive(e)}}}});var Bs=S(()=>{WL.registerComponent("pp-virtual-gamepad",{_myShowOnDesktop:{type:WL.Type.Bool,default:!1},_myShowOnMobile:{type:WL.Type.Bool,default:!0},_myShowOnHeadset:{type:WL.Type.Bool,default:!1},_myAddToUniversalGamepad:{type:WL.Type.Bool,default:!0},_myOpacity:{type:WL.Type.Float,default:.5},_myIconColor:{type:WL.Type.String,default:"#e0e0e0"},_myBackgroundColor:{type:WL.Type.String,default:"#616161"},_myInterfaceScale:{type:WL.Type.Float,default:1},_myMarginScale:{type:WL.Type.Float,default:1},ADVANCED_PARAMS_BELOW:{type:WL.Type.String,default:""},_myLabelFontSize:{type:WL.Type.Float,default:2},_myLabelFontFamily:{type:WL.Type.String,default:"sans-serif"},_myLabelFontWeight:{type:WL.Type.String,default:"bold"},_myImagePressedBrightness:{type:WL.Type.Float,default:.5},_myLeftSelectButtonVisible:{type:WL.Type.Bool,default:!0},_myLeftSelectButtonOrderIndex:{type:WL.Type.Int,default:1},_myLeftSelectButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"frame"},_myLeftSelectButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myLeftSqueezeButtonVisible:{type:WL.Type.Bool,default:!0},_myLeftSqueezeButtonOrderIndex:{type:WL.Type.Int,default:0},_myLeftSqueezeButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"square"},_myLeftSqueezeButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myLeftThumbstickButtonVisible:{type:WL.Type.Bool,default:!0},_myLeftThumbstickButtonOrderIndex:{type:WL.Type.Int,default:4},_myLeftThumbstickButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"dot"},_myLeftThumbstickButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myLeftTopButtonVisible:{type:WL.Type.Bool,default:!0},_myLeftTopButtonOrderIndex:{type:WL.Type.Int,default:2},_myLeftTopButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"circle"},_myLeftTopButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myLeftBottomButtonVisible:{type:WL.Type.Bool,default:!0},_myLeftBottomButtonOrderIndex:{type:WL.Type.Int,default:3},_myLeftBottomButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"ring"},_myLeftBottomButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myRightSelectButtonVisible:{type:WL.Type.Bool,default:!0},_myRightSelectButtonOrderIndex:{type:WL.Type.Int,default:1},_myRightSelectButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"frame"},_myRightSelectButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myRightSqueezeButtonVisible:{type:WL.Type.Bool,default:!0},_myRightSqueezeButtonOrderIndex:{type:WL.Type.Int,default:0},_myRightSqueezeButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"square"},_myRightSqueezeButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myRightThumbstickButtonVisible:{type:WL.Type.Bool,default:!0},_myRightThumbstickButtonOrderIndex:{type:WL.Type.Int,default:4},_myRightThumbstickButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"dot"},_myRightThumbstickButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myRightTopButtonVisible:{type:WL.Type.Bool,default:!0},_myRightTopButtonOrderIndex:{type:WL.Type.Int,default:2},_myRightTopButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"circle"},_myRightTopButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""},_myRightBottomButtonVisible:{type:WL.Type.Bool,default:!0},_myRightBottomButtonOrderIndex:{type:WL.Type.Int,default:3},_myRightBottomButtonIconType:{type:WL.Type.Enum,values:["none","label","image","dot","circle","square","ring","frame"],default:"ring"},_myRightBottomButtonIconLabelOrImageUrl:{type:WL.Type.String,default:""}},{start(){let i=new PP.VirtualGamepadParams;i.defaultSetup();for(let e in i.myButtonParams)for(let t in i.myButtonParams[e]){let n=i.myButtonParams[e][t];n.myIconParams.myBackgroundColor=this._myBackgroundColor,n.myIconParams.myBackgroundPressedColor=this._myIconColor,n.myIconParams.myIconColor=this._myIconColor,n.myIconParams.myIconPressedColor=this._myBackgroundColor}for(let e in i.myThumbstickParams){let t=i.myThumbstickParams[e];t.myBackgroundColor=this._myBackgroundColor,t.myIconParams.myBackgroundColor=this._myIconColor,t.myIconParams.myBackgroundPressedColor=this._myIconColor,t.myIconParams.myIconColor=this._myBackgroundColor,t.myIconParams.myIconPressedColor=this._myBackgroundColor}i.myOpacity=this._myOpacity,i.myInterfaceScale=this._myInterfaceScale,i.myMarginScale=this._myMarginScale,i.myShowOnDesktop=this._myShowOnDesktop,i.myShowOnMobile=this._myShowOnMobile,i.myShowOnHeadset=this._myShowOnHeadset,i.myShowOnDesktop||i.myShowOnMobile||i.myShowOnHeadset?i.myAutoUpdateVisibility=!0:i.myAutoUpdateVisibility=!1,this._advancedSetup(i),this._myVirtualGamepad=new PP.VirtualGamepad(i),i.myAutoUpdateVisibility||this._myVirtualGamepad.setVisible(!1),this._myVirtualGamepad.start(),this._myFirstUpdate=!0},update(i){if(this._myFirstUpdate&&(this._myFirstUpdate=!1,this._myAddToUniversalGamepad)){let e=new PP.VirtualGamepadGamepadCore(this._myVirtualGamepad,PP.Handedness.LEFT,PP.myLeftGamepad.getGamepadCore("left_xr_gamepad").getHandPose()),t=new PP.VirtualGamepadGamepadCore(this._myVirtualGamepad,PP.Handedness.RIGHT,PP.myRightGamepad.getGamepadCore("right_xr_gamepad").getHandPose());PP.myLeftGamepad.addGamepadCore("left_virtual_gamepad",e),PP.myRightGamepad.addGamepadCore("right_virtual_gamepad",t)}this._myVirtualGamepad.update(i)},_advancedSetup(i){i.myButtonsOrder[PP.Handedness.LEFT]=[null,null,null,null,null],i.myButtonsOrder[PP.Handedness.RIGHT]=[null,null,null,null,null];{let e=i.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SELECT];e.myIconParams.myIconType=this._myLeftSelectButtonIconType,e.myIconParams.myLabel=this._myLeftSelectIconLabelOrImageUrl,e.myIconParams.myImageURL=this._myLeftSelectIconLabelOrImageUrl,e.myIconParams.myLabelFontSize=this._myLabelFontSize,e.myIconParams.myLabelFontFamily=this._myLabelFontFamily,e.myIconParams.myLabelFontWeight=this._myLabelFontWeight,e.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftSelectButtonVisible&&(i.myButtonsOrder[PP.Handedness.LEFT][this._myLeftSelectButtonOrderIndex]=[PP.Handedness.LEFT,PP.GamepadButtonID.SELECT])}{let e=i.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SQUEEZE];e.myIconParams.myIconType=this._myLeftSqueezeButtonIconType,e.myIconParams.myLabel=this._myLeftSqueezeIconLabelOrImageUrl,e.myIconParams.myImageURL=this._myLeftSqueezeIconLabelOrImageUrl,e.myIconParams.myLabelFontSize=this._myLabelFontSize,e.myIconParams.myLabelFontFamily=this._myLabelFontFamily,e.myIconParams.myLabelFontWeight=this._myLabelFontWeight,e.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftSqueezeButtonVisible&&(i.myButtonsOrder[PP.Handedness.LEFT][this._myLeftSqueezeButtonOrderIndex]=[PP.Handedness.LEFT,PP.GamepadButtonID.SQUEEZE])}{let e=i.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.THUMBSTICK];e.myIconParams.myIconType=this._myLeftThumbstickButtonIconType,e.myIconParams.myLabel=this._myLeftThumbstickButtonIconLabelOrImageUrl,e.myIconParams.myImageURL=this._myLeftThumbstickButtonIconLabelOrImageUrl,e.myIconParams.myLabelFontSize=this._myLabelFontSize,e.myIconParams.myLabelFontFamily=this._myLabelFontFamily,e.myIconParams.myLabelFontWeight=this._myLabelFontWeight,e.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftThumbstickButtonVisible&&(i.myButtonsOrder[PP.Handedness.LEFT][this._myLeftThumbstickButtonOrderIndex]=[PP.Handedness.LEFT,PP.GamepadButtonID.THUMBSTICK])}{let e=i.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.TOP_BUTTON];e.myIconParams.myIconType=this._myLeftTopButtonIconType,e.myIconParams.myLabel=this._myLeftTopButtonIconLabelOrImageUrl,e.myIconParams.myImageURL=this._myLeftTopButtonIconLabelOrImageUrl,e.myIconParams.myLabelFontSize=this._myLabelFontSize,e.myIconParams.myLabelFontFamily=this._myLabelFontFamily,e.myIconParams.myLabelFontWeight=this._myLabelFontWeight,e.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftTopButtonVisible&&(i.myButtonsOrder[PP.Handedness.LEFT][this._myLeftTopButtonOrderIndex]=[PP.Handedness.LEFT,PP.GamepadButtonID.TOP_BUTTON])}{let e=i.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.BOTTOM_BUTTON];e.myIconParams.myIconType=this._myLeftBottomButtonIconType,e.myIconParams.myLabel=this._myLeftBottomButtonIconLabelOrImageUrl,e.myIconParams.myImageURL=this._myLeftBottomButtonIconLabelOrImageUrl,e.myIconParams.myLabelFontSize=this._myLabelFontSize,e.myIconParams.myLabelFontFamily=this._myLabelFontFamily,e.myIconParams.myLabelFontWeight=this._myLabelFontWeight,e.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftBottomButtonVisible&&(i.myButtonsOrder[PP.Handedness.LEFT][this._myLeftBottomButtonOrderIndex]=[PP.Handedness.LEFT,PP.GamepadButtonID.BOTTOM_BUTTON])}{let e=i.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SELECT];e.myIconParams.myIconType=this._myRightSelectButtonIconType,e.myIconParams.myLabel=this._myRightSelectIconLabelOrImageUrl,e.myIconParams.myImageURL=this._myRightSelectIconLabelOrImageUrl,e.myIconParams.myLabelFontSize=this._myLabelFontSize,e.myIconParams.myLabelFontFamily=this._myLabelFontFamily,e.myIconParams.myLabelFontWeight=this._myLabelFontWeight,e.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightSelectButtonVisible&&(i.myButtonsOrder[PP.Handedness.RIGHT][this._myRightSelectButtonOrderIndex]=[PP.Handedness.RIGHT,PP.GamepadButtonID.SELECT])}{let e=i.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SQUEEZE];e.myIconParams.myIconType=this._myRightSqueezeButtonIconType,e.myIconParams.myLabel=this._myRightSqueezeIconLabelOrImageUrl,e.myIconParams.myImageURL=this._myRightSqueezeIconLabelOrImageUrl,e.myIconParams.myLabelFontSize=this._myLabelFontSize,e.myIconParams.myLabelFontFamily=this._myLabelFontFamily,e.myIconParams.myLabelFontWeight=this._myLabelFontWeight,e.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightSqueezeButtonVisible&&(i.myButtonsOrder[PP.Handedness.RIGHT][this._myRightSqueezeButtonOrderIndex]=[PP.Handedness.RIGHT,PP.GamepadButtonID.SQUEEZE])}{let e=i.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.THUMBSTICK];e.myIconParams.myIconType=this._myRightThumbstickButtonIconType,e.myIconParams.myLabel=this._myRightThumbstickButtonIconLabelOrImageUrl,e.myIconParams.myImageURL=this._myRightThumbstickButtonIconLabelOrImageUrl,e.myIconParams.myLabelFontSize=this._myLabelFontSize,e.myIconParams.myLabelFontFamily=this._myLabelFontFamily,e.myIconParams.myLabelFontWeight=this._myLabelFontWeight,e.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightThumbstickButtonVisible&&(i.myButtonsOrder[PP.Handedness.RIGHT][this._myRightThumbstickButtonOrderIndex]=[PP.Handedness.RIGHT,PP.GamepadButtonID.THUMBSTICK])}{let e=i.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.TOP_BUTTON];e.myIconParams.myIconType=this._myRightTopButtonIconType,e.myIconParams.myLabel=this._myRightTopButtonIconLabelOrImageUrl,e.myIconParams.myImageURL=this._myRightTopButtonIconLabelOrImageUrl,e.myIconParams.myLabelFontSize=this._myLabelFontSize,e.myIconParams.myLabelFontFamily=this._myLabelFontFamily,e.myIconParams.myLabelFontWeight=this._myLabelFontWeight,e.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightTopButtonVisible&&(i.myButtonsOrder[PP.Handedness.RIGHT][this._myRightTopButtonOrderIndex]=[PP.Handedness.RIGHT,PP.GamepadButtonID.TOP_BUTTON])}{let e=i.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.BOTTOM_BUTTON];e.myIconParams.myIconType=this._myRightBottomButtonIconType,e.myIconParams.myLabel=this._myRightBottomButtonIconLabelOrImageUrl,e.myIconParams.myImageURL=this._myRightBottomButtonIconLabelOrImageUrl,e.myIconParams.myLabelFontSize=this._myLabelFontSize,e.myIconParams.myLabelFontFamily=this._myLabelFontFamily,e.myIconParams.myLabelFontWeight=this._myLabelFontWeight,e.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightBottomButtonVisible&&(i.myButtonsOrder[PP.Handedness.RIGHT][this._myRightBottomButtonOrderIndex]=[PP.Handedness.RIGHT,PP.GamepadButtonID.BOTTOM_BUTTON])}}})});var Os=S(()=>{PP.VirtualGamepadButtonParams=class{constructor(){this.myIconParams=new PP.VirtualGamepadIconParams}};PP.VirtualGamepadThumbstickParams=class{constructor(){this.myBackgroundColor="",this.myMaxDistanceFromCenterMultiplier=1,this.myReleaseTransitionSeconds=.2,this.myMoveTransitionSeconds=0,this.myIncludeBackgroundToDetection=!1,this.myIconParams=new PP.VirtualGamepadIconParams}};PP.VirtualGamepadParams=class{constructor(){this.myShowOnDesktop=!1,this.myShowOnMobile=!1,this.myShowOnHeadset=!1,this.myAutoUpdateVisibility=!1,this.myOpacity=1,this.myInterfaceScale=1,this.myMarginScale=1,this.myReleaseOnPointerLeave=!0,this.myStopPropagatingMouseDownEvents=!0,this.myButtonParams=[],this.myButtonParams[PP.Handedness.LEFT]=[],this.myButtonParams[PP.Handedness.RIGHT]=[],this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SELECT]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SQUEEZE]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.THUMBSTICK]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.TOP_BUTTON]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.BOTTOM_BUTTON]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SELECT]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SQUEEZE]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.THUMBSTICK]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.TOP_BUTTON]=new PP.VirtualGamepadButtonParams,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.BOTTOM_BUTTON]=new PP.VirtualGamepadButtonParams,this.myThumbstickParams=[],this.myThumbstickParams[PP.Handedness.LEFT]=new PP.VirtualGamepadThumbstickParams,this.myThumbstickParams[PP.Handedness.RIGHT]=new PP.VirtualGamepadThumbstickParams,this.myButtonsOrder=[],this.myButtonsOrder[PP.Handedness.LEFT]=[null,null,null,null,null],this.myButtonsOrder[PP.Handedness.RIGHT]=[null,null,null,null,null],this.myThumbsticksOrder=[],this.myThumbsticksOrder[PP.Handedness.LEFT]=null,this.myThumbsticksOrder[PP.Handedness.RIGHT]=null,this.myValidPointerButtons=[],this.myMarginLeft=0,this.myMarginRight=0,this.myMarginBottom=0,this.myThumbstickSize=0,this.myButtonSize=0,this.myButtonsRingRadius=0,this.myButtonsRingStartAngle=0,this.myButtonsRingEndAngle=0,this.myFontSize=0,this.myMinSizeMultiplier=0,this.myDisableMouseHoverWhenPressed=!1}defaultSetup(){this.myShowOnMobile=!0,this.myAutoUpdateVisibility=!0,this.myOpacity=.5;let e="#616161",t="#e0e0e0",n=.75,a=.75,s=!0;for(let o in this.myButtonParams)for(let l in this.myButtonParams[o]){let m=this.myButtonParams[o][l];m.myIconParams.myBackgroundColor=e,m.myIconParams.myBackgroundPressedColor=t,m.myIconParams.myIconColor=t,m.myIconParams.myIconPressedColor=e,m.myIconParams.myOverallHoveredBrightness=n}this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SQUEEZE].myIconParams.myIconType=PP.VirtualGamepadIconType.SQUARE,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SQUEEZE].myIconParams.myIconType=PP.VirtualGamepadIconType.SQUARE,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.SELECT].myIconParams.myIconType=PP.VirtualGamepadIconType.FRAME,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.SELECT].myIconParams.myIconType=PP.VirtualGamepadIconType.FRAME,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.TOP_BUTTON].myIconParams.myIconType=PP.VirtualGamepadIconType.CIRCLE,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.TOP_BUTTON].myIconParams.myIconType=PP.VirtualGamepadIconType.CIRCLE,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.BOTTOM_BUTTON].myIconParams.myIconType=PP.VirtualGamepadIconType.RING,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.BOTTOM_BUTTON].myIconParams.myIconType=PP.VirtualGamepadIconType.RING,this.myButtonParams[PP.Handedness.LEFT][PP.GamepadButtonID.THUMBSTICK].myIconParams.myIconType=PP.VirtualGamepadIconType.DOT,this.myButtonParams[PP.Handedness.RIGHT][PP.GamepadButtonID.THUMBSTICK].myIconParams.myIconType=PP.VirtualGamepadIconType.DOT;for(let o in this.myThumbstickParams){let l=this.myThumbstickParams[o];l.myBackgroundColor=e,l.myIconParams.myBackgroundColor=t,l.myIconParams.myBackgroundPressedColor=t,l.myIconParams.myIconColor=e,l.myIconParams.myIconPressedColor=e,l.myIconParams.myOverallHoveredBrightness=a,l.myIncludeBackgroundToDetection=s}this.myButtonsOrder[PP.Handedness.LEFT][0]=[PP.Handedness.LEFT,PP.GamepadButtonID.SQUEEZE],this.myButtonsOrder[PP.Handedness.LEFT][1]=[PP.Handedness.LEFT,PP.GamepadButtonID.SELECT],this.myButtonsOrder[PP.Handedness.LEFT][2]=[PP.Handedness.LEFT,PP.GamepadButtonID.TOP_BUTTON],this.myButtonsOrder[PP.Handedness.LEFT][3]=[PP.Handedness.LEFT,PP.GamepadButtonID.BOTTOM_BUTTON],this.myButtonsOrder[PP.Handedness.LEFT][4]=[PP.Handedness.LEFT,PP.GamepadButtonID.THUMBSTICK],this.myButtonsOrder[PP.Handedness.RIGHT][0]=[PP.Handedness.RIGHT,PP.GamepadButtonID.SQUEEZE],this.myButtonsOrder[PP.Handedness.RIGHT][1]=[PP.Handedness.RIGHT,PP.GamepadButtonID.SELECT],this.myButtonsOrder[PP.Handedness.RIGHT][2]=[PP.Handedness.RIGHT,PP.GamepadButtonID.TOP_BUTTON],this.myButtonsOrder[PP.Handedness.RIGHT][3]=[PP.Handedness.RIGHT,PP.GamepadButtonID.BOTTOM_BUTTON],this.myButtonsOrder[PP.Handedness.RIGHT][4]=[PP.Handedness.RIGHT,PP.GamepadButtonID.THUMBSTICK],this.myThumbsticksOrder[PP.Handedness.LEFT]=PP.Handedness.LEFT,this.myThumbsticksOrder[PP.Handedness.RIGHT]=PP.Handedness.RIGHT,this.myMarginLeft=3,this.myMarginRight=3,this.myMarginBottom=3,this.myThumbstickSize=15,this.myButtonSize=5,this.myButtonsRingRadius=12,this.myButtonsRingStartAngle=385,this.myButtonsRingEndAngle=245,this.myMinSizeMultiplier=5/3,this.myDisableMouseHoverWhenPressed=!0,this.myValidPointerButtons=[0]}}});var Hs=S(()=>{PP.VirtualGamepadVirtualButton=class{constructor(e,t,n,a,s,o){this._myButtonElement=null,this._myButtonIcon=null,this._myButtonDetectionElement=null,this._myIsActive=!0,this._myPointerID=null,this._myPointerButton=null,this._myIsPressed=!1,this._myVirtualGamepadParams=t,this._myParams=this._myVirtualGamepadParams.myButtonParams[s][o],this._build(e,n,a),this._myButtonDetectionElement.addEventListener("pointerdown",this._onPointerDown.bind(this,this._myVirtualGamepadParams.myStopPropagatingPointerDownEvents)),document.body.addEventListener("pointerup",this._onPointerUp.bind(this)),this._myVirtualGamepadParams.myReleaseOnPointerLeave&&document.body.addEventListener("pointerleave",this._onPointerLeave.bind(this)),this._myButtonDetectionElement.addEventListener("mouseenter",this._onButtonEnter.bind(this)),this._myButtonDetectionElement.addEventListener("mouseleave",this._onButtonLeave.bind(this))}isPressed(){return this._myIsActive&&this._myIsPressed}setActive(e){this._myIsActive!=e&&(this.reset(),this._myButtonIcon.reset()),this._myIsActive=e}setMouseHoverActive(e){this._myButtonIcon.setMouseHoverActive(e)}reset(){this._myButtonIcon.setPressed(!1),this._myIsPressed=!1,this._myPointerID=null,this._myPointerButton=null}update(e){this._myButtonIcon.update(e)}_onPointerDown(e,t){!this._myIsActive||this._myIsPressed||!this._myVirtualGamepadParams.myValidPointerButtons.pp_hasEqual(t.button)||(e&&t.stopPropagation(),t.preventDefault(),this._myButtonIcon.setPressed(!0),this._myPointerID=t.pointerId,this._myPointerButton=t.button,this._myIsPressed=!0)}_onPointerUp(e){!this._myIsActive||!this._myIsPressed||this._myPointerID==e.pointerId&&(this._myPointerButton!=null&&this._myPointerButton!=e.button||this.reset())}_onPointerLeave(e){!this._myIsActive||this._myPointerID==e.pointerId&&this.reset()}_onButtonEnter(e){!this._myIsActive||this._myButtonIcon.onMouseEnter(e)}_onButtonLeave(e){!this._myIsActive||this._myButtonIcon.onMouseLeave(e)}_build(e,t,n){let a=this._myVirtualGamepadParams.myButtonSize*this._myVirtualGamepadParams.myInterfaceScale,s=this._myVirtualGamepadParams.myButtonsRingRadius*this._myVirtualGamepadParams.myInterfaceScale,o=this._myVirtualGamepadParams.myThumbstickSize*this._myVirtualGamepadParams.myInterfaceScale,l=this._myVirtualGamepadParams.myMarginBottom*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,m=this._myVirtualGamepadParams.myMarginLeft*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,c=this._myVirtualGamepadParams.myMarginRight*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,r=this._myVirtualGamepadParams.myButtonsRingStartAngle,y=this._myVirtualGamepadParams.myButtonsRingEndAngle,u=Math.max(1,this._myVirtualGamepadParams.myMinSizeMultiplier/this._myVirtualGamepadParams.myInterfaceScale),p=this._myVirtualGamepadParams.myButtonsOrder[PP.Handedness.LEFT].length,d=(y-r)/(p-1),_=Math.pp_angleClamp(r+d*n);t==PP.Handedness.RIGHT&&(_=270+(270-_),_=Math.pp_angleClamp(_,!0));let h=360-_,P=document.createElement("div");P.style.position="absolute",P.style.width=this._createSizeValue(a,u),P.style.height=this._createSizeValue(a,u);let T=l+o/2-a/2;if(P.style.bottom=this._createSizeValue(T,u),t==PP.Handedness.LEFT){let C=m+o/2-a/2;P.style.left=this._createSizeValue(C,u)}else{let C=c+o/2-a/2;P.style.right=this._createSizeValue(C,u)}P.style.transform="rotate("+_+"deg) translateX("+this._createSizeValue(s,u)+")",e.appendChild(P),this._myButtonElement=document.createElement("div"),this._myButtonElement.style.position="absolute",this._myButtonElement.style.width="100%",this._myButtonElement.style.height="100%",this._myButtonElement.style.transform="rotate("+h+"deg)",P.appendChild(this._myButtonElement),this._myButtonIcon=new PP.VirtualGamepadIcon(this._myButtonElement,this._myParams.myIconParams,u,this._myVirtualGamepadParams.myInterfaceScale);let v=document.createElement("div");v.style.position="absolute",v.style.width="100%",v.style.height="100%",v.style.transform="rotate("+h+"deg)",P.appendChild(v);let f=document.createElementNS("http://www.w3.org/2000/svg","svg");f.style.position="absolute",f.style.width="100%",f.style.height="100%",v.appendChild(f);let g=document.createElementNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"cx","50%"),g.setAttributeNS(null,"cy","50%"),g.setAttributeNS(null,"r","50%"),g.style.fill="#00000000",f.appendChild(g),this._myButtonDetectionElement=g}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}}});var Es=S(()=>{PP.VirtualGamepadVirtualThumbstick=class{constructor(e,t,n,a){this._myThumbstickElement=null,this._myThumbstickIcon=null,this._myThumbstickBackground=null,this._myThumbstickDetectionElement=null,this._myIsActive=!0,this._myPointerID=null,this._myPointerButton=null,this._myThumbstickDragStartPosition=PP.vec2_create(),this._myAxes=PP.vec2_create(),this._myIsPressed=!1,this._myVirtualGamepadParams=t,this._myParams=this._myVirtualGamepadParams.myThumbstickParams[a],this._build(e,n),this._myThumbstickDetectionElement.addEventListener("pointerdown",this._onPointerDown.bind(this,this._myVirtualGamepadParams.myStopPropagatingPointerDownEvents)),document.body.addEventListener("pointerup",this._onPointerUp.bind(this)),document.body.addEventListener("pointermove",this._onPointerMove.bind(this)),this._myVirtualGamepadParams.myReleaseOnPointerLeave&&document.body.addEventListener("pointerleave",this._onPointerLeave.bind(this)),this._myThumbstickDetectionElement.addEventListener("mouseenter",this._onThumbstickEnter.bind(this)),this._myThumbstickDetectionElement.addEventListener("mouseleave",this._onThumbstickLeave.bind(this))}isPressed(){return this._myIsActive&&this._myIsPressed}getAxes(){return this._myAxes}setActive(e){this._myIsActive!=e&&(this.reset(),this._myThumbstickIcon.reset()),this._myIsActive=e}setMouseHoverActive(e){this._myThumbstickIcon.setMouseHoverActive(e)}reset(){this._myThumbstickIcon.setPressed(!1),this._myAxes[0]=0,this._myAxes[1]=0,this._myIsPressed=!1,this._myPointerID=null,this._myPointerButton=null,this._myThumbstickElement.style.transition="all "+this._myParams.myReleaseTransitionSeconds+"s ease 0s",this._myThumbstickElement.style.transform="translate(0px, 0px)"}update(e){this._myThumbstickIcon.update(e)}_onPointerDown(e,t){!this._myIsActive||this._myIsPressed||!this._myVirtualGamepadParams.myValidPointerButtons.pp_hasEqual(t.button)||(e&&t.stopPropagation(),t.preventDefault(),this._myThumbstickIcon.setPressed(!0),this._myPointerID=t.pointerId,this._myPointerButton=t.button,this._myThumbstickDragStartPosition[0]=t.clientX,this._myThumbstickDragStartPosition[1]=t.clientY,this._myIsPressed=!0)}_onPointerUp(e){!this._myIsActive||!this._myIsPressed||this._myPointerID==e.pointerId&&(this._myPointerButton!=null&&this._myPointerButton!=e.button||this.reset())}_onPointerLeave(e){!this._myIsActive||this._myPointerID==e.pointerId&&this.reset()}_onThumbstickEnter(e){this._myThumbstickIcon.onMouseEnter(e)}_onThumbstickLeave(e){this._myThumbstickIcon.onMouseLeave(e)}_onPointerMove(e){if(!this._myIsActive||!this._myIsPressed||e.pointerId!=this._myPointerID)return;let t=e.clientX,n=e.clientY,s=this._myThumbstickBackground.getBoundingClientRect().width/2*this._myParams.myMaxDistanceFromCenterMultiplier,o=t-this._myThumbstickDragStartPosition[0],l=n-this._myThumbstickDragStartPosition[1],m=Math.atan2(l,o),c=Math.min(s,Math.hypot(o,l)),r=c*Math.cos(m),y=c*Math.sin(m);this._myThumbstickElement.style.transition="all "+this._myParams.myMoveTransitionSeconds+"s ease-out 0s",this._myThumbstickElement.style.transform="translate("+r+"px, "+y+"px)",this._myAxes[0]=r/s,this._myAxes[1]=-(y/s)}_build(e,t){let n=this._myVirtualGamepadParams.myThumbstickSize*this._myVirtualGamepadParams.myInterfaceScale,a=this._myVirtualGamepadParams.myMarginBottom*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,s=this._myVirtualGamepadParams.myMarginLeft*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,o=this._myVirtualGamepadParams.myMarginRight*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,l=Math.max(1,this._myVirtualGamepadParams.myMinSizeMultiplier/this._myVirtualGamepadParams.myInterfaceScale),m=document.createElement("div");m.style.position="absolute",m.style.width=this._createSizeValue(n,l),m.style.height=this._createSizeValue(n,l),m.style.bottom=this._createSizeValue(a,l),t==PP.Handedness.LEFT?m.style.left=this._createSizeValue(s,l):m.style.right=this._createSizeValue(o,l),e.appendChild(m);let c=document.createElementNS("http://www.w3.org/2000/svg","svg");if(c.style.position="absolute",c.style.width="100%",c.style.height="100%",m.appendChild(c),this._myThumbstickBackground=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._myThumbstickBackground.setAttributeNS(null,"cx","50%"),this._myThumbstickBackground.setAttributeNS(null,"cy","50%"),this._myThumbstickBackground.setAttributeNS(null,"r","48%"),this._myThumbstickBackground.style.fill=this._myParams.myBackgroundColor,c.appendChild(this._myThumbstickBackground),this._myThumbstickElement=document.createElement("div"),this._myThumbstickElement.style.position="absolute",this._myThumbstickElement.style.width="34%",this._myThumbstickElement.style.height="34%",this._myThumbstickElement.style.top="33%",this._myThumbstickElement.style.left="33%",m.appendChild(this._myThumbstickElement),this._myThumbstickIcon=new PP.VirtualGamepadIcon(this._myThumbstickElement,this._myParams.myIconParams,l,this._myVirtualGamepadParams.myScale),this._myParams.myIncludeBackgroundToDetection){let r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.style.position="absolute",r.style.width="100%",r.style.height="100%",m.appendChild(r);let y=document.createElementNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"cx","50%"),y.setAttributeNS(null,"cy","50%"),y.setAttributeNS(null,"r","48%"),y.style.fill="#00000000",r.appendChild(y),this._myThumbstickDetectionElement=y}else{let r=document.createElement("div");r.style.position="absolute",r.style.width="34%",r.style.height="34%",r.style.top="33%",r.style.left="33%",m.appendChild(r);let y=document.createElementNS("http://www.w3.org/2000/svg","svg");y.style.position="absolute",y.style.width="100%",y.style.height="100%",r.appendChild(y);let u=document.createElementNS("http://www.w3.org/2000/svg","circle");u.setAttributeNS(null,"cx","50%"),u.setAttributeNS(null,"cy","50%"),u.setAttributeNS(null,"r","50%"),u.style.fill="#00000000",y.appendChild(u),this._myThumbstickDetectionElement=u}}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}}});var ks=S(()=>{PP.VirtualGamepadIconType={NONE:0,LABEL:1,IMAGE:2,DOT:3,CIRCLE:4,SQUARE:5,RING:6,FRAME:7};PP.VirtualGamepadIconParams=class{constructor(){this.myBackgroundColor="",this.myBackgroundPressedColor="",this.myIconColor="",this.myIconPressedColor="",this.myIconType=PP.VirtualGamepadIconType.NONE,this.myOverallHoveredBrightness=1,this.myLabel="",this.myLabelFontSize=0,this.myLabelFontFamily="",this.myLabelFontWeight="",this.myImageURL="",this.myImagePressedBrightness=1}};PP.VirtualGamepadIcon=class{constructor(e,t,n,a){this._myParams=t,this._myIconContainerElement=null,this._myBackgroundElement=null,this._myIconElement=null,this._myPressed=!1,this._myIsMouseHover=!1,this._myIsMouseHoverActive=!0,this._build(e,n,a)}update(e){this._myPressed||!this._myIsMouseHover||!this._myIsMouseHoverActive?this._myIconContainerElement.style.filter="none":this._myIconContainerElement.style.filter="brightness("+this._myParams.myOverallHoveredBrightness+")"}reset(){this.setPressed(!1),this._myIsMouseHover=!1,this._myIconContainerElement.style.filter="none"}setPressed(e){this._myPressed!=e&&(this._myPressed=e,this._myPressed?(this._myBackgroundElement.style.fill=this._myParams.myBackgroundPressedColor,this._myIconElement!=null&&(this._myIconElement.style.strokeWidth.length>0?this._myIconElement.style.stroke=this._myParams.myIconPressedColor:this._myIconElement.style.fill=this._myParams.myIconPressedColor,this._myParams.myIconType==PP.VirtualGamepadIconType.IMAGE&&(this._myIconElement.style.filter="brightness("+this._myParams.myImagePressedBrightness+")"))):(this._myBackgroundElement.style.fill=this._myParams.myBackgroundColor,this._myIconElement!=null&&(this._myIconElement.style.strokeWidth.length>0?this._myIconElement.style.stroke=this._myParams.myIconColor:this._myIconElement.style.fill=this._myParams.myIconColor,this._myParams.myIconType==PP.VirtualGamepadIconType.IMAGE&&(this._myIconElement.style.filter="none"))))}onMouseEnter(){this._myIsMouseHover=!0}onMouseLeave(){this._myIsMouseHover=!1}setMouseHoverActive(e){this._myIsMouseHoverActive=e}_build(e,t,n){switch(this._myIconContainerElement=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._myIconContainerElement.style.position="absolute",this._myIconContainerElement.style.width="100%",this._myIconContainerElement.style.height="100%",e.appendChild(this._myIconContainerElement),this._myBackgroundElement=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._myBackgroundElement.setAttributeNS(null,"cx","50%"),this._myBackgroundElement.setAttributeNS(null,"cy","50%"),this._myBackgroundElement.setAttributeNS(null,"r","50%"),this._myBackgroundElement.style.fill=this._myParams.myBackgroundColor,this._myIconContainerElement.appendChild(this._myBackgroundElement),this._myParams.myIconType){case PP.VirtualGamepadIconType.NONE:break;case PP.VirtualGamepadIconType.LABEL:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","text"),this._myIconElement.setAttributeNS(null,"x","50%"),this._myIconElement.setAttributeNS(null,"y","50%"),this._myIconElement.style.textAlign="center",this._myIconElement.style.textAnchor="middle",this._myIconElement.style.dominantBaseline="central",this._myIconElement.style.alignmentBaseline="central",this._myIconElement.style.fontFamily=this._myParams.myLabelFontFamily,this._myIconElement.style.fontWeight=this._myParams.myLabelFontWeight,this._myIconElement.style.fontSize=this._createSizeValue(this._myParams.myLabelFontSize*n,t),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.textContent=this._myParams.myLabel,this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.IMAGE:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","image"),this._myIconElement.setAttributeNS(null,"x","0%"),this._myIconElement.setAttributeNS(null,"y","0%"),this._myIconElement.setAttribute("href",this._myParams.myImageURL),this._myIconElement.style.width="100%",this._myIconElement.style.height="100%",this._myIconElement.style.filter="none",this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.DOT:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","17.5%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.CIRCLE:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","24%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.SQUARE:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._myIconElement.setAttributeNS(null,"x","28%"),this._myIconElement.setAttributeNS(null,"y","28%"),this._myIconElement.setAttributeNS(null,"rx","10%"),this._myIconElement.setAttributeNS(null,"ry","10%"),this._myIconElement.setAttributeNS(null,"width","44%"),this._myIconElement.setAttributeNS(null,"height","44%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.transformOrigin="center",this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.RING:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","20%"),this._myIconElement.style.fill="#00000000",this._myIconElement.style.stroke=this._myParams.myIconColor,this._myIconElement.style.strokeWidth="10%",this._myIconContainerElement.appendChild(this._myIconElement);break;case PP.VirtualGamepadIconType.FRAME:this._myIconElement=document.createElementNS("http://www.w3.org/2000/svg","rect"),this._myIconElement.setAttributeNS(null,"x","31.5%"),this._myIconElement.setAttributeNS(null,"y","31.5%"),this._myIconElement.setAttributeNS(null,"rx","10%"),this._myIconElement.setAttributeNS(null,"ry","10%"),this._myIconElement.setAttributeNS(null,"width","37%"),this._myIconElement.setAttributeNS(null,"height","37%"),this._myIconElement.style.fill="#00000000",this._myIconElement.style.stroke=this._myParams.myIconColor,this._myIconElement.style.strokeWidth="10%",this._myIconElement.style.transformOrigin="center",this._myIconContainerElement.appendChild(this._myIconElement);break}}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}_invertColors(){this._myIconElement.style.strokeWidth.length>0?(this._myBackgroundElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.stroke=this._myParams.myBackgroundColor):(this._myBackgroundElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.fill=this._myParams.myBackgroundColor)}}});var Fs=S(()=>{PP.BasePoseParams=class{constructor(){this.myReferenceObject=null,this.myFixForward=!0,this.myForceEmulatedVelocities=!1,this.myUpdateOnViewReset=!1}};PP.BasePose=class{constructor(e=new PP.BasePoseParams){this._myFixForward=e.myFixForward,this._myForceEmulatedVelocities=e.myForceEmulatedVelocities,this._myUpdateOnViewReset=e.myUpdateOnViewReset,this._myReferenceSpace=null,this._myReferenceObject=e.myReferenceObject,this._myPosition=PP.vec3_create(),this._myRotationQuat=PP.quat_create(),this._myPrevPosition=PP.vec3_create(),this._myPrevRotationQuat=PP.quat_create(),this._myLinearVelocity=PP.vec3_create(),this._myAngularVelocityRadians=PP.vec3_create(),this._myIsValid=!1,this._myIsLinearVelocityEmulated=!0,this._myIsAngularVelocityEmulated=!0,this._myPoseUpdatedCallbacks=new Map}setReferenceObject(e){this._myReferenceObject=e}getReferenceObject(){return this._myReferenceObject}setFixForward(e){this._myFixForward=e}isFixForward(){return this._myFixForward}setForceEmulatedVelocities(e){this._myForceEmulatedVelocities=e}isForceEmulatedVelocities(){return this._myForceEmulatedVelocities}setUpdateOnViewReset(e){this._myUpdateOnViewReset=e}isUpdateOnViewReset(){return this._myUpdateOnViewReset}getReferenceSpace(){return this._myReferenceSpace}getInputSource(){return this._myInputSource}getPosition(){}getRotation(){return this.getRotationDegrees()}getRotationDegrees(){return this.getRotationQuat().quat_toDegrees()}getRotationRadians(){return this.getRotationQuat().quat_toRadians()}getRotationQuat(){}getTransform(){return this.getTransformMatrix()}getTransformMatrix(){}getTransformQuat(){}getLinearVelocity(){}getAngularVelocity(){return this.getAngularVelocityDegrees()}getAngularVelocityDegrees(){}getAngularVelocityRadians(){}isValid(){return this._myIsValid}isLinearVelocityEmulated(){return this._myIsLinearVelocityEmulated}isAngularVelocityEmulated(){return this._myIsAngularVelocityEmulated}registerPoseUpdatedEventListener(e,t){this._myPoseUpdatedCallbacks.set(e,t)}unregisterPoseUpdatedEventListener(e){this._myPoseUpdatedCallbacks.delete(e)}start(){WL.xrSession&&this._onXRSessionStart(!0,WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this,!1)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}update(e){this._update(e,!0)}_isReadyToGetPose(){return!0}_getPose(e){return null}_updateHook(e,t,n){}_onXRSessionStartHook(e,t){}_onXRSessionEndHook(){}_onViewResetHook(){}_update(e,t){this._myPrevPosition.vec3_copy(this._myPosition),this._myPrevRotationQuat.quat_copy(this._myRotationQuat);let n=Module.webxr_frame;if(n&&this._isReadyToGetPose()){let a=null;try{a=this._getPose(n)}catch{}a?(this._myPosition[0]=a.transform.position.x,this._myPosition[1]=a.transform.position.y,this._myPosition[2]=a.transform.position.z,this._myRotationQuat[0]=a.transform.orientation.x,this._myRotationQuat[1]=a.transform.orientation.y,this._myRotationQuat[2]=a.transform.orientation.z,this._myRotationQuat[3]=a.transform.orientation.w,this._myRotationQuat.quat_normalize(this._myRotationQuat),t&&(a.linearVelocity&&!this._myForceEmulatedVelocities?(this._myLinearVelocity[0]=a.linearVelocity.x,this._myLinearVelocity[1]=a.linearVelocity.y,this._myLinearVelocity[2]=a.linearVelocity.z,this._myIsLinearVelocityEmulated=!1):(this._computeEmulatedLinearVelocity(e),this._myIsLinearVelocityEmulated=!0),a.angularVelocity&&!this._myForceEmulatedVelocities?(this._myAngularVelocityRadians[0]=a.angularVelocity.x,this._myAngularVelocityRadians[1]=a.angularVelocity.y,this._myAngularVelocityRadians[2]=a.angularVelocity.z,this._myIsAngularVelocityEmulated=!1):(this._computeEmulatedAngularVelocity(e),this._myIsAngularVelocityEmulated=!0)),this._myIsValid=!0):(t&&(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0,this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0),this._myIsValid=!1,this._myIsLinearVelocityEmulated=!0,this._myIsAngularVelocityEmulated=!0),this._updateHook(e,t,a)}else t&&(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0,this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0),this._myIsValid=!1,this._myIsLinearVelocityEmulated=!0,this._myIsAngularVelocityEmulated=!0,this._updateHook(e,t,null);this._myPoseUpdatedCallbacks.forEach(function(a){a(this)}.bind(this))}_computeEmulatedLinearVelocity(e){e>0?(this._myPosition.vec3_sub(this._myPrevPosition,this._myLinearVelocity),this._myLinearVelocity.vec3_scale(1/e,this._myLinearVelocity)):(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0)}_onXRSessionStart(e,t){t.requestReferenceSpace(WebXR.refSpace).then(function(n){this._myReferenceSpace=n,n.addEventListener!=null&&n.addEventListener("reset",this._onViewReset.bind(this))}.bind(this)),this._onXRSessionStartHook(e,t)}_onXRSessionEnd(){this._onXRSessionEndHook(),this._myReferenceSpace=null}_onViewReset(){this._myUpdateOnViewReset&&this._update(0,!1),this._onViewResetHook()}};PP.BasePose.prototype.getPosition=function(){let i=PP.vec3_create(),e=PP.mat4_create();return function(){return this._myReferenceObject==null?this._myPosition:this._myPosition.vec3_convertPositionToWorld(this._myReferenceObject.pp_getTransform(e),i)}}();PP.BasePose.prototype.getRotationQuat=function(){let i=PP.quat_create(),e=PP.quat_create(),t=PP.vec3_create();return function(){return i.quat_copy(this._myRotationQuat),this._myFixForward&&i.quat_rotateAxisRadians(Math.PI,i.quat_getUp(t),i),this._myReferenceObject==null?i:i.quat_toWorld(this._myReferenceObject.pp_getRotationQuat(e),i)}}();PP.BasePose.prototype.getTransformMatrix=function(){let i=PP.mat4_create();return function(){return this.getTransformQuat().quat2_toMatrix(i)}}();PP.BasePose.prototype.getTransformQuat=function(){let i=PP.quat2_create(),e=PP.quat2_create();return function(){return i.quat2_setPositionRotationQuat(this._myPosition,this.getRotationQuat()),this._myReferenceObject==null?i:i.quat_toWorld(this._myReferenceObject.pp_getTransformQuat(e),i)}}();PP.BasePose.prototype.getLinearVelocity=function(){let i=PP.vec3_create(),e=PP.mat4_create();return function(){return this._myReferenceObject==null?this._myLinearVelocity:this._myLinearVelocity.vec3_convertDirectionToWorld(this._myReferenceObject.pp_getTransform(e),i)}}();PP.BasePose.prototype.getAngularVelocityDegrees=function(){let i=PP.vec3_create();return function(){this.getAngularVelocityRadians().vec3_toDegrees(i)}}();PP.BasePose.prototype.getAngularVelocityRadians=function(){let i=PP.vec3_create(),e=PP.mat4_create();return function(){return this._myReferenceObject==null?this._myAngularVelocityRadians:this._myAngularVelocityRadians.vec3_convertDirectionToWorld(this._myReferenceObject.pp_getTransform(e),i)}}();PP.BasePose.prototype._computeEmulatedAngularVelocity=function(){let i=PP.vec3_create(),e=PP.vec3_create();return function(n){n>0?(i=this._myRotationQuat.quat_toRadians(i),e=this._myPrevRotationQuat.quat_toRadians(e),i.vec3_sub(e,this._myAngularVelocityRadians),this._myAngularVelocityRadians.vec3_scale(1/n,this._myAngularVelocityRadians)):(this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0)}}();Object.defineProperty(PP.BasePose.prototype,"getPosition",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getRotationQuat",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getTransformMatrix",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getTransformQuat",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getLinearVelocity",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getAngularVelocityDegrees",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"getAngularVelocityRadians",{enumerable:!1});Object.defineProperty(PP.BasePose.prototype,"_computeEmulatedAngularVelocity",{enumerable:!1})});var ws=S(()=>{PP.HandPoseParams=class extends PP.BasePoseParams{constructor(){super(),this.myFixTrackedHandRotation=!0}};PP.HandPose=class extends PP.BasePose{constructor(e,t=new PP.HandPoseParams){super(t),this._myInputSource=null,this._myHandedness=e,this._myFixTrackedHandRotation=t.myFixTrackedHandRotation,this._myIsTrackedHand=!1}getInputSourceType(){return this._myInputSource==null?null:PP.InputUtils.getInputSourceType(this._myInputSource)}isFixTrackedHandRotation(){return this._myFixTrackedHandRotation}setFixTrackedHandRotation(e){this.myFixTrackedHandRotation=e}_isReadyToGetPose(){return this._myInputSource!=null}_getPose(e){return e.getPose(this._myInputSource.gripSpace,this._myReferenceSpace)}_onXRSessionStartHook(e,t){if(t.addEventListener("inputsourceschange",function(n){if(n.removed)for(let a of n.removed)a==this._myInputSource&&(this._myInputSource=null);if(n.added)for(let a of n.added)a.handedness==this._myHandedness&&(this._myInputSource=a,this._myIsTrackedHand=PP.InputUtils.getInputSourceType(this._myInputSource)==PP.InputSourceType.TRACKED_HAND)}.bind(this)),e&&this._myInputSource==null&&t.inputSources)for(let n of t.inputSources)n.handedness==this._myHandedness&&(this._myInputSource=n,this._myIsTrackedHand=PP.InputUtils.getInputSourceType(this._myInputSource)==PP.InputSourceType.TRACKED_HAND)}_onXRSessionEndHook(){this._myInputSource=null}};PP.HandPose.prototype.getRotationQuat=function(){let i=PP.quat_create(),e=PP.quat_create(),t=PP.vec3_create(),n=PP.vec3_create(),a=PP.vec3_create();return function(){if(i.quat_copy(this._myRotationQuat),this._myFixForward&&i.quat_rotateAxisRadians(Math.PI,i.quat_getUp(t),i),this._myFixTrackedHandRotation&&this._myIsTrackedHand){i.quat_rotateAxis(-60,i.quat_getRight(n),i);let o=20;o=this._myHandedness==PP.Handedness.LEFT?o:-o,i.quat_rotateAxis(o,i.quat_getForward(a),i)}return this._myReferenceObject==null?i:i.quat_toWorld(this._myReferenceObject.pp_getRotationQuat(e),i)}}();Object.defineProperty(PP.HandPose.prototype,"getRotationQuat",{enumerable:!1})});var Ws=S(()=>{PP.HeadPose=class extends PP.BasePose{_getPose(e){return e.getViewerPose(this._myReferenceSpace)}}});var js=S(()=>{PP.TrackedHandJointPose=class extends PP.BasePose{constructor(e,t,n=new PP.BasePoseParams){super(n),this._myInputSource=null,this._myHandedness=e,this._myTrackedHandJointID=t,this._myJointRadius=0}getTrackedHandJointID(){return this._myTrackedHandJointID}setTrackedHandJointID(e){this._myTrackedHandJointID=e}getJointRadius(){return this._myJointRadius}_isReadyToGetPose(){return this._myInputSource!=null}_getPose(e){return e.getJointPose(this._myInputSource.hand.get(this._myTrackedHandJointID),this._myReferenceSpace)}_updateHook(e,t,n){n!=null&&(this._myJointRadius=n.radius)}_onXRSessionStartHook(e,t){if(t.addEventListener("inputsourceschange",function(n){if(n.removed)for(let a of n.removed)a==this._myInputSource&&(this._myInputSource=null);if(n.added)for(let a of n.added)a.handedness==this._myHandedness&&PP.InputUtils.getInputSourceType(a)==PP.InputSourceType.TRACKED_HAND&&(this._myInputSource=a)}.bind(this)),e&&this._myInputSource==null&&t.inputSources)for(let n of t.inputSources)n.handedness==this._myHandedness&&PP.InputUtils.getInputSourceType(n)==PP.InputSourceType.TRACKED_HAND&&(this._myInputSource=n)}_onXRSessionEndHook(){this._myInputSource=null}}});var zs=S(()=>{PP.TrackedHandPoseParams=class extends PP.BasePoseParams{constructor(e=!0){if(super(),this.myTrackedHandJointIDList=[],e)for(let t in PP.TrackedHandJointID)this.myTrackedHandJointIDList.push([PP.TrackedHandJointID[t]])}};PP.TrackedHandPose=class{constructor(e,t=new PP.TrackedHandPoseParams){this._myHandedness=e,this._myFixForward=t.myFixForward,this._myForceEmulatedVelocities=t.myForceEmulatedVelocities,this._myReferenceObject=t.myReferenceObject,this._myTrackedHandJointPoseParams=new PP.BasePoseParams,this._myTrackedHandJointPoseParams.myFixForward=this._myFixForward,this._myTrackedHandJointPoseParams.myForceEmulatedVelocities=this._myForceEmulatedVelocities,this._myTrackedHandJointPoseParams.myReferenceObject=this._myReferenceObject,this._myTrackedHandJointPoseList=[];for(let n of t.myTrackedHandJointIDList){let a=new PP.TrackedHandJointPose(this._myHandedness,n,this._myTrackedHandJointPoseParams);this._myTrackedHandJointPoseList[n]=a}}start(){for(let e in this._myTrackedHandJointPoseList)this._myTrackedHandJointPoseList[e].start()}update(e){for(let t in this._myTrackedHandJointPoseList)this._myTrackedHandJointPoseList[t].update(e)}getJointPoseList(){return this._myTrackedHandJointPoseList}getJointPose(e){return this._myTrackedHandJointPoseList[e]}getJointPoseByIndex(e){return this._myTrackedHandJointPoseList[PP.InputUtils.getJointIDByIndex(e)]}addTrackedHandJointID(e){if(!this._myTrackedHandJointPoseList.pp_has(t=>t.getTrackedHandJointID()==e)){let t=new PP.TrackedHandJointPose(this._myHandedness,e,this._myTrackedHandJointPoseParams);this._myTrackedHandJointPoseList.push(t)}}removeTrackedHandJointID(e){this._myTrackedHandJointPoseList.pp_remove(t=>t.getTrackedHandJointID()==e)}setReferenceObject(e){this._myReferenceObject=e,this._myTrackedHandJointPoseParams.myReferenceObject=this._myReferenceObject;for(let t in this._myTrackedHandJointPoseList)this._myTrackedHandJointPoseList[t].setReferenceObject(e)}getReferenceObject(){return this._myReferenceObject}setFixForward(e){this._myFixForward=e,this._myTrackedHandJointPoseParams.myFixForward=this._myFixForward;for(let t in this._myTrackedHandJointPoseList)this._myTrackedHandJointPoseList[t].setFixForward(e)}isFixForward(){return this._myFixForward}setForceEmulatedVelocities(e){this._myForceEmulatedVelocities=e,this._myTrackedHandJointPoseParams.myForceEmulatedVelocities=this._myForceEmulatedVelocities;for(let t in this._myTrackedHandJointPoseList)this._myTrackedHandJointPoseList[t].setForceEmulatedVelocities(e)}isForceEmulatedVelocities(){return this._myForceEmulatedVelocities}}});var Gs=S(()=>{WL.registerComponent("pp-set-player-height",{_myEyesHeight:{type:WL.Type.Float,default:1.65},_mySetOnlyOnStart:{type:WL.Type.Bool,default:!1}},{start(){let i=this.object.pp_getPositionLocal();this.object.pp_setPositionLocal(PP.vec3_create(i[0],this._myEyesHeight,i[2])),this._myHeightSetOnce=!1,WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))},_onXRSessionStart(){if(this.active&&(!this._mySetOnlyOnStart||!this._myHeightSetOnce)){let i=this.object.pp_getPositionLocal();PP.XRUtils.isReferenceSpaceLocalFloor()?this.object.pp_setPositionLocal(PP.vec3_create(i[0],0,i[2])):PP.XRUtils.isDeviceEmulated()?this.object.pp_setPositionLocal(PP.vec3_create(i[0],0,i[2])):this.object.pp_setPositionLocal(PP.vec3_create(i[0],this._myEyesHeight,i[2])),this._myHeightSetOnce=!0}},_onXRSessionEnd(){if(this.active&&!this._mySetOnlyOnStart){let i=this.object.pp_getPositionLocal();this.object.pp_setPositionLocal(PP.vec3_create(i[0],this._myEyesHeight,i[2]))}}})});var Us=S(()=>{WL.registerComponent("pp-set-hand-local-transform",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_myUpdateOnViewReset:{type:WL.Type.Bool,default:!0}},{init:function(){this._myHandPose=new PP.HandPose(PP.InputUtils.getHandednessByIndex(this._myHandedness)),this._myHandPose.setFixForward(this._myFixForward),this._myHandPose.setUpdateOnViewReset(this._myUpdateOnViewReset),this._myHandPose.registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))},start:function(){this._myHandPose.start(),this.update(0)},update:function(e){this._myHandPose.update(e)},onPoseUpdated:function(){let i=PP.quat2_create();return function(){this.object.pp_setTransformLocalQuat(this._myHandPose.getTransformQuat(i))}}()})});var Ns=S(()=>{WL.registerComponent("pp-set-head-local-transform",{_myNonVRCamera:{type:WL.Type.Object},_myFixForward:{type:WL.Type.Bool,default:!0},_myUpdateOnViewReset:{type:WL.Type.Bool,default:!0}},{init:function(){this._myHeadPose=new PP.HeadPose,this._myHeadPose.setFixForward(this._myFixForward),this._myHeadPose.setUpdateOnViewReset(this._myUpdateOnViewReset),this._myHeadPose.registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))},start:function(){this._myHeadPose.start(),this.update(0)},update:function(){let i=PP.quat_create(),e=PP.vec3_create(),t=PP.vec3_create();return function(a){PP.XRUtils.isSessionActive()?this._myHeadPose.update(a):(i=this._myNonVRCamera.pp_getRotationLocalQuat(i),this._myFixForward&&i.quat_rotateAxisRadians(Math.PI,i.quat_getUp(e),i),this.object.pp_setPositionLocal(this._myNonVRCamera.pp_getPositionLocal(t)),this.object.pp_setRotationLocalQuat(i))}}(),onPoseUpdated:function(){let i=PP.quat2_create();return function(){PP.XRUtils.isSessionActive()&&this.object.pp_setTransformLocalQuat(this._myHeadPose.getTransformQuat(i))}}()})});var qs=S(()=>{WL.registerComponent("pp-set-vr-head-local-transform",{_myFixForward:{type:WL.Type.Bool,default:!0},_myUpdateOnViewReset:{type:WL.Type.Bool,default:!0}},{init:function(){this._myHeadPose=new PP.HeadPose,this._myHeadPose.setFixForward(this._myFixForward),this._myHeadPose.setUpdateOnViewReset(this._myUpdateOnViewReset),this._myHeadPose.registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))},start:function(){this._myHeadPose.start(),this.update(0)},update:function(e){this._myHeadPose.update(e)},onPoseUpdated:function(){let i=PP.quat2_create();return function(){this.object.pp_setTransformLocalQuat(this._myHeadPose.getTransformQuat(i))}}()})});var Qs=S(()=>{WL.registerComponent("pp-set-non-vr-head-local-transform",{_myNonVRCamera:{type:WL.Type.Object},_myFixForward:{type:WL.Type.Bool,default:!0}},{init:function(){},start:function(){this.update(0)},update:function(i){let e=PP.quat_create(),t=PP.vec3_create(),n=PP.vec3_create();return function(s){e=this._myNonVRCamera.pp_getRotationLocalQuat(e),this._myFixForward&&e.quat_rotateAxisRadians(Math.PI,e.quat_getUp(t),e),this.object.pp_setPositionLocal(this._myNonVRCamera.pp_getPositionLocal(n)),this.object.pp_setRotationLocalQuat(e)}}()})});var Xs=S(()=>{WL.registerComponent("pp-set-tracked-hand-joint-local-transform",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_myUpdateOnViewReset:{type:WL.Type.Bool,default:!0},_mySetLocalScaleAsJointRadius:{type:WL.Type.Bool,default:!1},_myJointID:{type:WL.Type.Enum,values:["Wrist","Thumb Metacarpal","Thumb Phalanx Proximal","Thumb Phalanx Distal","Thumb Tip","Index Metacarpal","Index Phalanx Proximal","Index Phalanx Intermediate","Index Phalanx Distal","Index Tip","Middle Metacarpal","Middle Phalanx Proximal","Middle Phalanx Intermediate","Middle Phalanx Distal","Middle Tip","Ring Metacarpal","Ring Phalanx Proximal","Ring Phalanx Intermediate","Ring Phalanx Distal","Ring Tip","Pinky Metacarpal","Pinky Phalanx Proximal","Pinky Phalanx Intermediate","Pinky Phalanx Distal","Pinky Tip"],default:"Wrist"}},{init:function(){this._myHandednessInternal=PP.InputUtils.getHandednessByIndex(this._myHandedness),this._myJointIDInternal=PP.InputUtils.getJointIDByIndex(this._myJointID),this._myTrackedHandJointPose=new PP.TrackedHandJointPose(this._myHandednessInternal,this._myJointIDInternal),this._myTrackedHandJointPose.setFixForward(this._myFixForward),this._myTrackedHandJointPose.setUpdateOnViewReset(this._myUpdateOnViewReset),this._myTrackedHandJointPose.registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))},start:function(){this._myTrackedHandJointPose.start(),this.update(0)},update:function(i){this._myTrackedHandJointPose.update(i)},onPoseUpdated:function(){let i=PP.quat2_create();return function(){this.object.pp_setTransformLocalQuat(this._myTrackedHandJointPose.getTransformQuat(i)),this._mySetLocalScaleAsJointRadius&&this.object.pp_setScaleLocal(this._myTrackedHandJointPose.getJointRadius())}}()})});var Ks=S(()=>{WL.registerComponent("pp-copy-hand-transform",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"}},{init:function(){this._myHandednessType=this._myHandedness==0?PP.Handedness.LEFT:PP.Handedness.RIGHT},update:function(i){let e=PP.myPlayerObjects.myHands[this._myHandednessType];this.object.pp_setTransformQuat(e.pp_getTransformQuat()),this.object.pp_setScale(e.pp_getScale())}})});var Js=S(()=>{WL.registerComponent("pp-copy-head-transform",{},{update:function(i){let e=PP.myPlayerObjects.myHead;this.object.pp_setTransformQuat(e.pp_getTransformQuat()),this.object.pp_setScale(e.pp_getScale())}})});var Zs=S(()=>{WL.registerComponent("pp-copy-player-transform",{},{update:function(i){let e=PP.myPlayerObjects.myPlayer;this.object.pp_setTransformQuat(e.pp_getTransformQuat()),this.object.pp_setScale(e.pp_getScale())}})});var Ys=S(()=>{WL.registerComponent("pp-copy-player-pivot-transform",{},{update:function(i){let e=PP.myPlayerObjects.myPlayerPivot;this.object.pp_setTransformQuat(e.pp_getTransformQuat()),this.object.pp_setScale(e.pp_getScale())}})});var $s=S(()=>{PP.ToolHandedness={NONE:null,LEFT:"left",RIGHT:"right"};PP.ToolInputSourceType={NONE:null,GAMEPAD:0,TRACKED_HAND:1}});var eo=S(()=>{WL.registerComponent("pp-tool-cursor",{_myHandedness:{type:WL.Type.Enum,values:["left","right"],default:"left"},_myFixForward:{type:WL.Type.Bool,default:!0},_myApplyDefaultCursorOffset:{type:WL.Type.Bool,default:!0},_myPulseOnHover:{type:WL.Type.Bool,default:!1},_myShowFingerCursor:{type:WL.Type.Bool,default:!1}},{init:function(){this._myHandednessString=["left","right"][this._myHandedness],this._myCursorPositionDefaultOffset=PP.vec3_create(0,-.035,-.05),this._myCursorRotationDefaultOffset=PP.vec3_create(-30,0,0),this._myCursorMeshScale=PP.vec3_create(.0025,.0025,.0025),this._myCursorColor=[255/255,255/255,255/255,1],this._myCursorTargetCollisionGroup=7},start:function(){this._myToolCursorObject=WL.scene.addObject(this.object),this._myFixForwardObject=WL.scene.addObject(this._myToolCursorObject),this._myFixForward&&this._myFixForwardObject.pp_rotateObject(PP.vec3_create(0,180,0)),this._myCursorObjectVR=WL.scene.addObject(this._myFixForwardObject),this._myApplyDefaultCursorOffset&&(this._myCursorObjectVR.pp_setPositionLocal(this._myCursorPositionDefaultOffset),this._myCursorObjectVR.pp_rotateObject(this._myCursorRotationDefaultOffset));{this._myCursorMeshobject=WL.scene.addObject(this._myCursorObjectVR),this._myCursorMeshobject.pp_setScale(this._myCursorMeshScale);let t=this._myCursorMeshobject.addComponent("mesh");t.mesh=PP.myDefaultResources.myMeshes.mySphere,t.material=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),t.material.color=this._myCursorColor;let n=this._myCursorObjectVR.addComponent("cursor",{collisionGroup:this._myCursorTargetCollisionGroup,handedness:this._myHandedness+1,cursorObject:this._myCursorMeshobject});n.rayCastMode=0,this._myPulseOnHover&&n.globalTarget.addHoverFunction(this._pulseOnHover.bind(this))}this._myCursorObjectNonVR=WL.scene.addObject(this._myToolCursorObject);{let t=this._myCursorObjectNonVR.addComponent("cursor",{collisionGroup:this._myCursorTargetCollisionGroup,handedness:this._myHandedness+1});t.rayCastMode=0,this._myPulseOnHover&&t.globalTarget.addHoverFunction(this._pulseOnHover.bind(this)),t.setViewComponent(PP.myPlayerObjects.myNonVRCamera.getComponent("view"))}let i=null,e=.0125;if(this._myShowFingerCursor){i=this._myToolCursorObject.pp_addObject();let t=i.addComponent("mesh");t.mesh=PP.myDefaultResources.myMeshes.mySphere,t.material=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),t.material.color=this._myCursorColor,i.pp_setScale(e)}this._myFingerCursorObject=WL.scene.addObject(this._myToolCursorObject),this._myFingerCursorComponent=this._myFingerCursorObject.addComponent("pp-finger-cursor",{_myHandedness:this._myHandedness,_myEnableMultipleClicks:!0,_myCollisionGroup:this._myCursorTargetCollisionGroup,_myCollisionSize:e,_myCursorObject:i}),this._myCursorObjectVR.pp_setActive(!1),this._myCursorObjectNonVR.pp_setActive(!1),this._myFingerCursorObject.pp_setActive(!1)},update:function(){let i=PP.quat2_create(),e=PP.mat4_create();return function(n){let a=this._isUsingHand();this._myFingerCursorObject.pp_setActive(a),a?(this._myCursorObjectNonVR.pp_setActive(!1),this._myCursorObjectVR.pp_setActive(!1)):PP.XRUtils.isSessionActive()?(this._myCursorObjectVR.pp_setActive(!a),this._myCursorObjectNonVR.pp_setActive(!1)):(this._myCursorObjectNonVR.pp_setActive(!a),this._myCursorObjectVR.pp_setActive(!1),this._myCursorObjectNonVR.pp_setTransformQuat(PP.myPlayerObjects.myNonVRCamera.pp_getTransformQuat(i)))}}(),_isUsingHand:function(){let i=!1;if(WL.xrSession&&WL.xrSession.inputSources)for(let e=0;e<WL.xrSession.inputSources.length;e++){let t=WL.xrSession.inputSources[e];if(t.hand&&t.handedness==this._myHandednessString){i=!0;break}}return i},_pulseOnHover:function(i){let e=i.getComponent("cursor-target");e&&!e.isSurface&&(this._myHandedness==0?PP.myLeftGamepad&&PP.myLeftGamepad.pulse(.4,0):PP.myRightGamepad&&PP.myRightGamepad.pulse(.4,0))}})});var to=S(()=>{PP.ConsoleVRWidgetSetup=class{constructor(){this._initializeBuildSetup(),this._initializeRuntimeSetup()}_initializeBuildSetup(){this.myBackgroundColor=[46/255,46/255,46/255,1],this.myCursorTargetCollisionCollider=2,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=[255/255,255/255,255/255,1],this.myTextAlignment=2,this.myTextJustification=2,this.myTextColor=this.myDefaultTextColor,this.myMessageTypeColors=[],this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.LOG]=this.myDefaultTextColor,this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.ERROR]=[255/255,40/255,40/255,1],this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.WARN]=[250/255,220/255,40/255,1],this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.DEBUG]=[60/255,200/255,255/255,1],this.myMessagesPanelPosition=PP.vec3_create(0,.075,0),this.myMessagesBackgroundScale=PP.vec3_create(.34,.15,1);{let e=.03,t=e*this.myMessagesBackgroundScale[0]/this.myMessagesBackgroundScale[1]*.8,n=-this.myMessagesBackgroundScale[0]+this.myMessagesBackgroundScale[0]*e,a=this.myMessagesBackgroundScale[1]-this.myMessagesBackgroundScale[1]*t;this.myMessagesTextsPanelPosition=PP.vec3_create(n,a,.007)}this.myMessagesTextsPanelScale=PP.vec3_create(.1,.1,.1),this.myMessagesTextStartString=`.
`,this.myMessagesTextAlignment=1,this.myMessagesTextJustification=3,this.myMessagesTextPositions=[],this.myMessagesTextPositions[PP.ConsoleVRWidget.MessageType.LOG]=PP.vec3_create(0,0,1e-5),this.myMessagesTextPositions[PP.ConsoleVRWidget.MessageType.ERROR]=PP.vec3_create(0,0,0),this.myMessagesTextPositions[PP.ConsoleVRWidget.MessageType.WARN]=PP.vec3_create(0,0,0),this.myMessagesTextPositions[PP.ConsoleVRWidget.MessageType.DEBUG]=PP.vec3_create(0,0,0),this.myMessagesTextColors=[],this.myMessagesTextColors[PP.ConsoleVRWidget.MessageType.LOG]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.LOG],this.myMessagesTextColors[PP.ConsoleVRWidget.MessageType.ERROR]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.ERROR],this.myMessagesTextColors[PP.ConsoleVRWidget.MessageType.WARN]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.WARN],this.myMessagesTextColors[PP.ConsoleVRWidget.MessageType.DEBUG]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.DEBUG],this.myButtonsPanelPosition=PP.vec3_create(0,-.11,.015),this.myButtonBackgroundScale=PP.vec3_create(.04,.02,1),this.myButtonTextPosition=PP.vec3_create(0,0,.007),this.myButtonTextScale=PP.vec3_create(.18,.18,.18),this.myButtonCursorTargetPosition=PP.vec3_create(0,0,0),this.myButtonCursorTargetPosition[2]=this.myButtonTextPosition[2],this.myButtonsCollisionCollider=this.myCursorTargetCollisionCollider,this.myButtonsCollisionGroup=this.myCursorTargetCollisionGroup,this.myButtonsCollisionExtents=this.myButtonBackgroundScale.slice(0),this.myButtonsCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myClearButtonTextLabel="clear",this.myUpButtonTextLabel="up",this.myDownButtonTextLabel="down",this.myFilterButtonsTextColors=[],this.myFilterButtonsTextColors[PP.ConsoleVRWidget.MessageType.LOG]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.LOG],this.myFilterButtonsTextColors[PP.ConsoleVRWidget.MessageType.ERROR]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.ERROR],this.myFilterButtonsTextColors[PP.ConsoleVRWidget.MessageType.WARN]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.WARN],this.myFilterButtonsTextColors[PP.ConsoleVRWidget.MessageType.DEBUG]=this.myMessageTypeColors[PP.ConsoleVRWidget.MessageType.DEBUG],this.myFilterButtonsTextLabel=[],this.myFilterButtonsTextLabel[PP.ConsoleVRWidget.MessageType.LOG]="log",this.myFilterButtonsTextLabel[PP.ConsoleVRWidget.MessageType.ERROR]="error",this.myFilterButtonsTextLabel[PP.ConsoleVRWidget.MessageType.WARN]="warn",this.myFilterButtonsTextLabel[PP.ConsoleVRWidget.MessageType.DEBUG]="debug";{let e=7,t=Math.max(.68,this.myButtonBackgroundScale[0]*e),n=2+3+4+4+1+2,a=Math.max((t-e*this.myButtonBackgroundScale[0]*2)/n,0),s=this.myButtonBackgroundScale[0],o=-t/2;this.myFilterButtonsPositions=[],this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.LOG]=[o+a*2+s,0,0],this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.ERROR]=[this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.LOG][0]+s+a+s,0,0],this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.WARN]=[this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.ERROR][0]+s+a+s,0,0],this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.DEBUG]=[this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.WARN][0]+s+a+s,0,0],this.myClearButtonPosition=[this.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType.DEBUG][0]+s+a*4+s,0,0],this.myUpButtonPosition=[this.myClearButtonPosition[0]+s+a*4+s,0,0],this.myDownButtonPosition=[this.myUpButtonPosition[0]+s+a+s,0,0]}this.myNotifyIconBackgroundScale=PP.vec3_create(.01,.01,1),this.myNotifyIconPanelPositions=[],this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE]=PP.vec3_create(0,0,0),this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE][0]=-this.myMessagesBackgroundScale[0]+this.myNotifyIconBackgroundScale[0]+.01,this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE][1]=-this.myMessagesBackgroundScale[1]+this.myNotifyIconBackgroundScale[1]+.01,this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE][2]=this.myMessagesTextsPanelPosition[2]-1e-5,this.myNotifyIconPanelPositions[PP.ToolHandedness.LEFT]=this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE],this.myNotifyIconPanelPositions[PP.ToolHandedness.RIGHT]=this.myNotifyIconPanelPositions[PP.ToolHandedness.NONE],this.myNotifyIconCursorTargetPosition=PP.vec3_create(0,0,0),this.myNotifyIconCursorTargetPosition[2]=this.myButtonsPanelPosition[2]+this.myButtonTextPosition[2]-this.myMessagesTextsPanelPosition[2],this.myNotifyIconCollisionExtents=this.myNotifyIconBackgroundScale.slice(0),this.myNotifyIconCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myNotifyIconColor=[210/255,210/255,210/255,1],this.myPointerCollisionCollider=this.myCursorTargetCollisionCollider,this.myPointerCollisionGroup=this.myCursorTargetCollisionGroup;{let e=Math.abs(this.myMessagesPanelPosition[1]-this.myMessagesBackgroundScale[1]-(this.myButtonsPanelPosition[1]+this.myButtonBackgroundScale[1])),t=this.myMessagesBackgroundScale[1]+this.myButtonBackgroundScale[1]+e/2;this.myPointerCollisionExtents=PP.vec3_create(this.myMessagesBackgroundScale[0],t,this.myCursorTargetCollisionThickness)}this.myPointerCursorTargetPosition=PP.vec3_create(0,0,0),this.myPointerCursorTargetPosition[1]=this.myMessagesPanelPosition[1]+this.myMessagesBackgroundScale[1]-this.myPointerCollisionExtents[1],this.myPointerCursorTargetPosition[2]=this.myButtonsPanelPosition[2]+this.myButtonTextPosition[2]-1e-4}_initializeRuntimeSetup(){this.myTabString="     ",this.myAssertStartString="Assertion failed:",this.myMaxCharactersPerLine=100,this.myMaxLineSplits=50,this.myMaxLines=22,this.myMaxMessages=2e3,this.myMaxMessagesDeletePad=2e3,this.myLinesBetweenMessages=1,this.myButtonHoverColor=[150/255,150/255,150/255,1],this.myButtonDisabledTextColor=this.myBackgroundColor,this.myButtonDisabledBackgroundColor=[110/255,110/255,110/255,1],this.myFilterButtonDisabledTextColor=this.myButtonDisabledTextColor,this.myFilterButtonDisabledBackgroundColor=this.myButtonDisabledBackgroundColor,this.myScrollDelay=.1,this.myScrollAmount=1,this.myScrollThumbstickHandedness=PP.ToolHandedness.RIGHT,this.myScrollThumbstickDelay=.1,this.myScrollThumbstickMinThreshold=.2,this.myScrollThumbstickAmount=3,this.myPulseDelay=5,this.myPulseIntensity=.3,this.myPulseDuration=.085,this.myClearBrowserConsoleWhenClearPressed=!0,this.myGamepadScrollOnlyOnHover=!0}}});var io=S(()=>{PP.ConsoleVRWidgetUI=class{build(e,t,n){this._myParentObject=e,this._mySetup=t,this._myAdditionalSetup=n,this._myPlaneMesh=PP.MeshUtils.createPlaneMesh(),this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonVR(),WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}setVisible(e){this.myPivotObject.pp_setActiveHierarchy(e)}_createSkeleton(){this.myPivotObject=WL.scene.addObject(this._myParentObject),this._createMessagesSkeleton(),this._createButtonsSkeleton(),this._createPointerSkeleton()}_createMessagesSkeleton(){this.myMessagesPanel=WL.scene.addObject(this.myPivotObject),this.myMessagesBackground=WL.scene.addObject(this.myMessagesPanel),this.myMessagesTextsPanel=WL.scene.addObject(this.myMessagesPanel),this.myMessagesTexts=[];for(let e in PP.ConsoleVRWidget.MessageType)this.myMessagesTexts[PP.ConsoleVRWidget.MessageType[e]]=WL.scene.addObject(this.myMessagesTextsPanel);this.myNotifyIconPanel=WL.scene.addObject(this.myMessagesPanel),this.myNotifyIconBackground=WL.scene.addObject(this.myNotifyIconPanel),this.myNotifyIconCursorTarget=WL.scene.addObject(this.myNotifyIconPanel)}_createButtonsSkeleton(){this.myButtonsPanel=WL.scene.addObject(this.myPivotObject),this.myFilterButtonsPanels=[],this.myFilterButtonsBackgrounds=[],this.myFilterButtonsTexts=[],this.myFilterButtonsCursorTargets=[];for(let e in PP.ConsoleVRWidget.MessageType)this.myFilterButtonsPanels[PP.ConsoleVRWidget.MessageType[e]]=WL.scene.addObject(this.myButtonsPanel),this.myFilterButtonsBackgrounds[PP.ConsoleVRWidget.MessageType[e]]=WL.scene.addObject(this.myFilterButtonsPanels[PP.ConsoleVRWidget.MessageType[e]]),this.myFilterButtonsTexts[PP.ConsoleVRWidget.MessageType[e]]=WL.scene.addObject(this.myFilterButtonsPanels[PP.ConsoleVRWidget.MessageType[e]]),this.myFilterButtonsCursorTargets[PP.ConsoleVRWidget.MessageType[e]]=WL.scene.addObject(this.myFilterButtonsPanels[PP.ConsoleVRWidget.MessageType[e]]);this.myClearButtonPanel=WL.scene.addObject(this.myButtonsPanel),this.myClearButtonBackground=WL.scene.addObject(this.myClearButtonPanel),this.myClearButtonText=WL.scene.addObject(this.myClearButtonPanel),this.myClearButtonCursorTarget=WL.scene.addObject(this.myClearButtonPanel),this.myUpButtonPanel=WL.scene.addObject(this.myButtonsPanel),this.myUpButtonBackground=WL.scene.addObject(this.myUpButtonPanel),this.myUpButtonText=WL.scene.addObject(this.myUpButtonPanel),this.myUpButtonCursorTarget=WL.scene.addObject(this.myUpButtonPanel),this.myDownButtonPanel=WL.scene.addObject(this.myButtonsPanel),this.myDownButtonBackground=WL.scene.addObject(this.myDownButtonPanel),this.myDownButtonText=WL.scene.addObject(this.myDownButtonPanel),this.myDownButtonCursorTarget=WL.scene.addObject(this.myDownButtonPanel)}_createPointerSkeleton(){this.myPointerCursorTarget=WL.scene.addObject(this.myPivotObject)}_setTransforms(){this.myPivotObject.setDirty(),this._setMessagesTransforms(),this._setButtonsTransforms(),this._setPointerTransform()}_setMessagesTransforms(){this.myMessagesPanel.setTranslationLocal(this._mySetup.myMessagesPanelPosition),this.myMessagesBackground.scale(this._mySetup.myMessagesBackgroundScale),this.myMessagesTextsPanel.setTranslationLocal(this._mySetup.myMessagesTextsPanelPosition),this.myMessagesTextsPanel.scale(this._mySetup.myMessagesTextsPanelScale);for(let e in PP.ConsoleVRWidget.MessageType)this.myMessagesTexts[PP.ConsoleVRWidget.MessageType[e]].setTranslationLocal(this._mySetup.myMessagesTextPositions[PP.ConsoleVRWidget.MessageType[e]]);this.myNotifyIconPanel.setTranslationLocal(this._mySetup.myNotifyIconPanelPositions[this._myAdditionalSetup.myHandedness]),this.myNotifyIconBackground.scale(this._mySetup.myNotifyIconBackgroundScale),this.myNotifyIconCursorTarget.setTranslationLocal(this._mySetup.myNotifyIconCursorTargetPosition)}_setButtonsTransforms(){this.myButtonsPanel.setTranslationLocal(this._mySetup.myButtonsPanelPosition);for(let e in PP.ConsoleVRWidget.MessageType)this.myFilterButtonsPanels[PP.ConsoleVRWidget.MessageType[e]].setTranslationLocal(this._mySetup.myFilterButtonsPositions[PP.ConsoleVRWidget.MessageType[e]]),this.myFilterButtonsBackgrounds[PP.ConsoleVRWidget.MessageType[e]].scale(this._mySetup.myButtonBackgroundScale),this.myFilterButtonsTexts[PP.ConsoleVRWidget.MessageType[e]].setTranslationLocal(this._mySetup.myButtonTextPosition),this.myFilterButtonsTexts[PP.ConsoleVRWidget.MessageType[e]].scale(this._mySetup.myButtonTextScale),this.myFilterButtonsCursorTargets[PP.ConsoleVRWidget.MessageType[e]].setTranslationLocal(this._mySetup.myButtonCursorTargetPosition);this.myClearButtonPanel.setTranslationLocal(this._mySetup.myClearButtonPosition),this.myClearButtonBackground.scale(this._mySetup.myButtonBackgroundScale),this.myClearButtonText.setTranslationLocal(this._mySetup.myButtonTextPosition),this.myClearButtonText.scale(this._mySetup.myButtonTextScale),this.myClearButtonCursorTarget.setTranslationLocal(this._mySetup.myButtonCursorTargetPosition),this.myUpButtonPanel.setTranslationLocal(this._mySetup.myUpButtonPosition),this.myUpButtonBackground.scale(this._mySetup.myButtonBackgroundScale),this.myUpButtonText.setTranslationLocal(this._mySetup.myButtonTextPosition),this.myUpButtonText.scale(this._mySetup.myButtonTextScale),this.myUpButtonCursorTarget.setTranslationLocal(this._mySetup.myButtonCursorTargetPosition),this.myDownButtonPanel.setTranslationLocal(this._mySetup.myDownButtonPosition),this.myDownButtonBackground.scale(this._mySetup.myButtonBackgroundScale),this.myDownButtonText.setTranslationLocal(this._mySetup.myButtonTextPosition),this.myDownButtonText.scale(this._mySetup.myButtonTextScale),this.myDownButtonCursorTarget.setTranslationLocal(this._mySetup.myButtonCursorTargetPosition)}_setPointerTransform(){this.myPointerCursorTarget.setTranslationLocal(this._mySetup.myPointerCursorTargetPosition)}_addComponents(){this._addMessagesComponents(),this._addButtonsComponents(),this._addPointerComponents()}_addMessagesComponents(){let e=this.myMessagesBackground.addComponent("mesh");e.mesh=this._myPlaneMesh,e.material=this._myAdditionalSetup.myPlaneMaterial.clone(),e.material.color=this._mySetup.myBackgroundColor,this.myMessagesTextComponents=[];for(let t in PP.ConsoleVRWidget.MessageType){let n=this.myMessagesTexts[PP.ConsoleVRWidget.MessageType[t]].addComponent("text");n.alignment=this._mySetup.myMessagesTextAlignment,n.justification=this._mySetup.myMessagesTextJustification,n.material=this._myAdditionalSetup.myTextMaterial.clone(),n.material.color=this._mySetup.myMessagesTextColors[PP.ConsoleVRWidget.MessageType[t]],n.lineSpacing=1.2,n.text=this._mySetup.myMessagesTextStartString,this.myMessagesTextComponents[PP.ConsoleVRWidget.MessageType[t]]=n}this.myNotifyIconBackgroundComponent=this.myNotifyIconBackground.addComponent("mesh"),this.myNotifyIconBackgroundComponent.mesh=this._myPlaneMesh,this.myNotifyIconBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myNotifyIconBackgroundComponent.material.color=this._mySetup.myNotifyIconColor,this.myNotifyIconCursorTargetComponent=this.myNotifyIconCursorTarget.addComponent("cursor-target"),this.myNotifyIconCollisionComponent=this.myNotifyIconCursorTarget.addComponent("collision"),this.myNotifyIconCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myNotifyIconCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myNotifyIconCollisionComponent.extents=this._mySetup.myNotifyIconCollisionExtents}_addButtonsComponents(){this.myFilterButtonsBackgroundComponents=[],this.myFilterButtonsTextComponents=[],this.myFilterButtonsCursorTargetComponents=[],this.myFilterButtonsCollisionComponents=[];for(let e in PP.ConsoleVRWidget.MessageType){let t=this.myFilterButtonsBackgrounds[PP.ConsoleVRWidget.MessageType[e]].addComponent("mesh");t.mesh=this._myPlaneMesh,t.material=this._myAdditionalSetup.myPlaneMaterial.clone(),t.material.color=this._mySetup.myBackgroundColor;let n=this.myFilterButtonsTexts[PP.ConsoleVRWidget.MessageType[e]].addComponent("text");this._setupButtonTextComponent(n),n.material.color=this._mySetup.myFilterButtonsTextColors[PP.ConsoleVRWidget.MessageType[e]],n.text=this._mySetup.myFilterButtonsTextLabel[PP.ConsoleVRWidget.MessageType[e]];let a=this.myFilterButtonsCursorTargets[PP.ConsoleVRWidget.MessageType[e]].addComponent("cursor-target"),s=this.myFilterButtonsCursorTargets[PP.ConsoleVRWidget.MessageType[e]].addComponent("collision");s.collider=this._mySetup.myButtonsCollisionCollider,s.group=1<<this._mySetup.myButtonsCollisionGroup,s.extents=this._mySetup.myButtonsCollisionExtents,this.myFilterButtonsBackgroundComponents[PP.ConsoleVRWidget.MessageType[e]]=t,this.myFilterButtonsTextComponents[PP.ConsoleVRWidget.MessageType[e]]=n,this.myFilterButtonsCursorTargetComponents[PP.ConsoleVRWidget.MessageType[e]]=a,this.myFilterButtonsCollisionComponents[PP.ConsoleVRWidget.MessageType[e]]=s}{let e=this.myClearButtonBackground.addComponent("mesh");e.mesh=this._myPlaneMesh,e.material=this._myAdditionalSetup.myPlaneMaterial.clone(),e.material.color=this._mySetup.myBackgroundColor;let t=this.myClearButtonText.addComponent("text");this._setupButtonTextComponent(t),t.text=this._mySetup.myClearButtonTextLabel;let n=this.myClearButtonCursorTarget.addComponent("cursor-target"),a=this.myClearButtonCursorTarget.addComponent("collision");a.collider=this._mySetup.myButtonsCollisionCollider,a.group=1<<this._mySetup.myButtonsCollisionGroup,a.extents=this._mySetup.myButtonsCollisionExtents,this.myClearButtonBackgroundComponent=e,this.myClearButtonTextComponent=t,this.myClearButtonCursorTargetComponent=n,this.myClearButtonCollisionComponent=a}{let e=this.myUpButtonBackground.addComponent("mesh");e.mesh=this._myPlaneMesh,e.material=this._myAdditionalSetup.myPlaneMaterial.clone(),e.material.color=this._mySetup.myBackgroundColor;let t=this.myUpButtonText.addComponent("text");this._setupButtonTextComponent(t),t.text=this._mySetup.myUpButtonTextLabel;let n=this.myUpButtonCursorTarget.addComponent("cursor-target"),a=this.myUpButtonCursorTarget.addComponent("collision");a.collider=this._mySetup.myButtonsCollisionCollider,a.group=1<<this._mySetup.myButtonsCollisionGroup,a.extents=this._mySetup.myButtonsCollisionExtents,this.myUpButtonBackgroundComponent=e,this.myUpButtonTextComponent=t,this.myUpButtonCursorTargetComponent=n,this.myUpButtonCollisionComponent=a}{let e=this.myDownButtonBackground.addComponent("mesh");e.mesh=this._myPlaneMesh,e.material=this._myAdditionalSetup.myPlaneMaterial.clone(),e.material.color=this._mySetup.myBackgroundColor;let t=this.myDownButtonText.addComponent("text");this._setupButtonTextComponent(t),t.text=this._mySetup.myDownButtonTextLabel;let n=this.myDownButtonCursorTarget.addComponent("cursor-target"),a=this.myDownButtonCursorTarget.addComponent("collision");a.collider=this._mySetup.myButtonsCollisionCollider,a.group=1<<this._mySetup.myButtonsCollisionGroup,a.extents=this._mySetup.myButtonsCollisionExtents,this.myDownButtonBackgroundComponent=e,this.myDownButtonTextComponent=t,this.myDownButtonCursorTargetComponent=n,this.myDownButtonCollisionComponent=a}}_addPointerComponents(){this.myPointerCursorTargetComponent=this.myPointerCursorTarget.addComponent("cursor-target"),this.myPointerCursorTargetComponent.isSurface=!0;let e=this.myPointerCursorTarget.addComponent("collision");e.collider=this._mySetup.myPointerCollisionCollider,e.group=1<<this._mySetup.myPointerCollisionGroup,e.extents=this._mySetup.myPointerCollisionExtents,this.myPointerCollisionComponent=e}_setupButtonTextComponent(e){e.alignment=this._mySetup.myTextAlignment,e.justification=this._mySetup.myTextJustification,e.material=this._myAdditionalSetup.myTextMaterial.clone(),e.material.color=this._mySetup.myTextColor,e.text=""}_onXRSessionStart(){this._setTransformForVR()}_onXRSessionEnd(){this._setTransformForNonVR()}_setTransformForVR(){this.myNotifyIconPanel.setTranslationLocal(this._mySetup.myNotifyIconPanelPositions[this._myAdditionalSetup.myHandedness])}_setTransformForNonVR(){this.myNotifyIconPanel.setTranslationLocal(this._mySetup.myNotifyIconPanelPositions[PP.ToolHandedness.NONE])}}});var no=S(()=>{PP.ConsoleVRWidget=class{constructor(){this._myWidgetFrame=new PP.WidgetFrame("C",0),this._myWidgetFrame.registerWidgetVisibleChangedEventListener(this,this._widgetVisibleChanged.bind(this)),this._mySetup=new PP.ConsoleVRWidgetSetup,this._myAdditionalSetup=null,this._myUI=new PP.ConsoleVRWidgetUI,this._myMessages=[],this._myOldBrowserConsole=[],this._myOldConsoleVR=[],this._myTypeFilters=[];for(let e in PP.ConsoleVRWidget.MessageType)this._myTypeFilters[PP.ConsoleVRWidget.MessageType[e]]=!1;this._myScrollUp=!1,this._myScrollDown=!1,this._myScrollOffset=0,this._myScrollTimer=0,this._myScrollThumbstickTimer=0,this._myPulseTimer=0,this._myGamepadScrollActive=!0,this._mySetup.myGamepadScrollOnlyOnHover&&(this._myGamepadScrollActive=!1)}setVisible(e){this._myWidgetFrame.setVisible(e)}isVisible(){return this._myWidgetFrame.isVisible()}start(e,t){this._myLeftGamepad=PP.myLeftGamepad,this._myRightGamepad=PP.myRightGamepad,this._myAdditionalSetup=t,this._myWidgetFrame.start(e,t),this._myUI.build(this._myWidgetFrame.getWidgetObject(),this._mySetup,t),this._myUI.setVisible(this._myWidgetFrame.myIsWidgetVisible),this._setNotifyIconActive(!1),this._addListeners(),this._overrideConsolesFunctions()}_overrideConsolesFunctions(){this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.LOG]=console.log,this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.ERROR]=console.error,this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.WARN]=console.warn,this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.INFO]=console.info,this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.DEBUG]=console.debug,this._myOldBrowserConsole[PP.ConsoleVRWidget.ConsoleFunction.ASSERT]=console.assert,this._myOldBrowserConsoleClear=console.clear,this._myAdditionalSetup.myOverrideBrowserConsole&&(console.log=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.LOG,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.error=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.ERROR,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.warn=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.WARN,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.info=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.INFO,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.debug=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.DEBUG,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.assert=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.ASSERT,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),console.clear=this._clearConsole.bind(this,!0,PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE),window.addEventListener("error",function(e){e.error!=null?this._consolePrint(PP.ConsoleVRWidget.ConsoleFunction.ERROR,PP.ConsoleVRWidget.Sender.WINDOW,"Uncaught",e.error.stack):this._consolePrint(PP.ConsoleVRWidget.ConsoleFunction.ERROR,PP.ConsoleVRWidget.Sender.WINDOW,"Uncaught",e.message)}.bind(this)),window.addEventListener("unhandledrejection",function(e){this._consolePrint(PP.ConsoleVRWidget.ConsoleFunction.ERROR,PP.ConsoleVRWidget.Sender.WINDOW,"Uncaught (in promise)",e.reason)}.bind(this))),this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.LOG]=PP.ConsoleVR.log,this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.ERROR]=PP.ConsoleVR.error,this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.WARN]=PP.ConsoleVR.warn,this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.INFO]=PP.ConsoleVR.info,this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.DEBUG]=PP.ConsoleVR.debug,this._myOldConsoleVR[PP.ConsoleVRWidget.ConsoleFunction.ASSERT]=PP.ConsoleVR.assert,this._myOldConsoleVRClear=PP.ConsoleVR.clear,PP.ConsoleVR.log=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.LOG,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.error=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.ERROR,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.warn=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.WARN,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.info=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.INFO,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.debug=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.DEBUG,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.assert=this._consolePrint.bind(this,PP.ConsoleVRWidget.ConsoleFunction.ASSERT,PP.ConsoleVRWidget.Sender.CONSOLE_VR),PP.ConsoleVR.clear=this._clearConsole.bind(this,!0,PP.ConsoleVRWidget.Sender.CONSOLE_VR)}update(e){this._myWidgetFrame.update(e),this._myWidgetFrame.myIsWidgetVisible&&this._updateScroll(e),this._updateGamepadsExtraActions(e)}_updateText(e){let t="";if(!this._myTypeFilters[e]){let n=0,a=this._myMessages.length-1,s=Math.round(this._myScrollOffset);for(;a>=0&&n<this._mySetup.myMaxLines;){let o=this._myMessages[a];if(this._myTypeFilters[o.myType]){a-=1;continue}let l=o.myLines.length,m=0;if(s>0){let r=0;a!=this._myMessages.length-1&&(r=this._mySetup.myLinesBetweenMessages),s>=l+r?(s-=l+r,m=l+r):(m=s,s=0)}if(a!=this._myMessages.length-1){let r=this._mySetup.myLinesBetweenMessages-Math.max(this._mySetup.myLinesBetweenMessages-m,0),y=this._mySetup.myLinesBetweenMessages-r;n+y>this._mySetup.myMaxLines&&(y=this._myMaxLines-n);for(let u=0;u<y;u++)t=`
`.concat(t);n+=y,m-=r}let c=l-m;if(n+c>this._mySetup.myMaxLines&&(c=this._mySetup.myMaxLines-n),c>0)if(o.myType==e)t=o.myLines.slice(l-c-m,l-m).join(`
`).concat(`
`).concat(t),n+=c;else{for(let r=0;r<c;r++)t=`
`.concat(t);n+=c}a-=1}}t=this._mySetup.myMessagesTextStartString.concat(t),this._myUI.myMessagesTextComponents[e].text=t}_consolePrint(e,t,...n){if(e!=PP.ConsoleVRWidget.ConsoleFunction.ASSERT||n.length>0&&!n[0]){let a=this._argsToMessage(e,...n);this._addMessage(a),this._myMessages.length>=this._mySetup.myMaxMessages+this._mySetup.myMaxMessagesDeletePad&&(this._myMessages=this._myMessages.slice(this._myMessages.length-this._mySetup.myMaxMessages),this._clampScrollOffset()),this._updateAllTexts(),this._pulseGamepad()}switch(t){case PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE:this._myOldBrowserConsole[e].apply(console,n);break;case PP.ConsoleVRWidget.Sender.CONSOLE_VR:this._myOldConsoleVR[e].apply(PP.ConsoleVR,n);break;default:this._myOldBrowserConsole[e].apply(console,n);break}}_argsToMessage(e,...t){e==PP.ConsoleVRWidget.ConsoleFunction.ASSERT&&(t=t.slice(1),t.splice(0,0,this._mySetup.myAssertStartString));let n=this._consoleFunctionToMessageType(e),a=this._formatArgs(...t),s=this._splitLongLines(a);return n==PP.ConsoleVRWidget.MessageType.INFO?n=PP.ConsoleVRWidget.MessageType.LOG:(n==PP.ConsoleVRWidget.MessageType.EXCEPTION||n==PP.ConsoleVRWidget.MessageType.ASSERT)&&(n=PP.ConsoleVRWidget.MessageType.ERROR),new PP.ConsoleVRWidget.Message(n,s)}_consoleFunctionToMessageType(e){let t=PP.ConsoleVRWidget.MessageType.LOG;return e<PP.ConsoleVRWidget.ConsoleFunction.INFO?t=e:e==PP.ConsoleVRWidget.ConsoleFunction.INFO?t=PP.ConsoleVRWidget.MessageType.LOG:t=PP.ConsoleVRWidget.MessageType.ERROR,t}_formatArgs(...e){let t=[];for(let a=0;a<e.length;a++)e[a]===void 0?t.push("undefined"):t.push(this._stringifyItem(e[a]));return t.join(" ")}_stringifyItem(e){if(typeof e=="object"){let t=null,n=2;try{t=JSON.stringify(e,this._jsonReplacer.bind(this),n)}catch{let s=new WeakSet;t=JSON.stringify(e,function(o,l){if(typeof l=="object"&&l!==null){if(s.has(l))return"<stringify error: object already stringified>";s.add(l)}return this._jsonReplacer(o,l)}.bind(this),n)}return t=t.replaceAll('"[',"["),t=t.replaceAll("'[","["),t=t.replaceAll(']"',"]"),t=t.replaceAll("]'","]"),t}return e}_splitLongLines(e){let t=e.split(`
`),n=[];for(let a=0;a<t.length;a++){let s=t[a];if(s.length>this._mySetup.myMaxCharactersPerLine){let o=this._getSpacesAtStart(s),l=this._mySetup.myTabString.concat(o),m=0;for(;s.length>this._mySetup.myMaxCharactersPerLine&&m<this._mySetup.myMaxLineSplits;){let c=s.substr(0,this._mySetup.myMaxCharactersPerLine-1),r=s.substr(this._mySetup.myMaxCharactersPerLine-1);r=l.concat(r),n.push(c),s=r,m++}n.push(s)}else n.push(s)}return n}_getSpacesAtStart(e){let t="",n=0;for(;n<e.length&&e[n]==" ";)t=t.concat(" "),n++;return t}_addMessage(e){let t=!1;if(this._myMessages.length>0){let n=this._myMessages[this._myMessages.length-1];n.hasSameInfo(e)&&(n.increaseCount(),t=!0)}t||this._myMessages.push(e),this._adjustScrollOffsetAfterMessageAdded(e,t),this._updateNotifyIcon(e)}_adjustScrollOffsetAfterMessageAdded(e,t){!t&&!this._myTypeFilters[e.myType]&&this._myScrollOffset>0&&(this._myScrollOffset+=e.myLines.length+this._mySetup.myLinesBetweenMessages)}_updateAllTexts(){if(this._myWidgetFrame.myIsWidgetVisible)for(let e in PP.ConsoleVRWidget.MessageType)this._updateText(PP.ConsoleVRWidget.MessageType[e])}_updateNotifyIcon(e){!this._myTypeFilters[e.myType]&&this._myScrollOffset>0&&this._setNotifyIconActive(!0)}_updateScroll(e){if(this._myScrollUp)for(this._myScrollTimer+=e;this._myScrollTimer>this._mySetup.myScrollDelay;)this._myScrollTimer-=this._mySetup.myScrollDelay,this._myScrollOffset+=this._mySetup.myScrollAmount;else if(this._myScrollDown)for(this._myScrollTimer+=e;this._myScrollTimer>this._mySetup.myScrollDelay;)this._myScrollTimer-=this._mySetup.myScrollDelay,this._myScrollOffset-=this._mySetup.myScrollAmount;this._clampScrollOffset(),(this._myScrollUp||this._myScrollDown)&&this._updateAllTexts(),this._myScrollOffset==0&&this._setNotifyIconActive(!1)}_clampScrollOffset(){let e=this._getMaxScrollOffset();this._myScrollOffset=Math.min(Math.max(this._myScrollOffset,0),e)}_getMaxScrollOffset(){return Math.max(this._getLinesCount()-this._mySetup.myMaxLines,0)}_getLinesCount(){let e=0;for(let t of this._myMessages)this._myTypeFilters[t.myType]||(e+=t.myLines.length+this._mySetup.myLinesBetweenMessages);return e-=this._mySetup.myLinesBetweenMessages,e=Math.max(e,0),e}_addListeners(){let e=this._myUI;for(let t in PP.ConsoleVRWidget.MessageType){let n=e.myFilterButtonsCursorTargetComponents[PP.ConsoleVRWidget.MessageType[t]],a=e.myFilterButtonsBackgroundComponents[PP.ConsoleVRWidget.MessageType[t]].material,s=e.myFilterButtonsTextComponents[PP.ConsoleVRWidget.MessageType[t]].material;n.addTripleClickFunction(this._resetFilters.bind(this,PP.ConsoleVRWidget.MessageType[t])),n.addDoubleClickFunction(this._filterAllButOne.bind(this,PP.ConsoleVRWidget.MessageType[t],s)),n.addClickFunction(this._toggleFilter.bind(this,PP.ConsoleVRWidget.MessageType[t],s)),n.addHoverFunction(this._filterHover.bind(this,PP.ConsoleVRWidget.MessageType[t],a)),n.addUnHoverFunction(this._filterUnHover.bind(this,PP.ConsoleVRWidget.MessageType[t],a))}{let t=e.myClearButtonCursorTargetComponent,n=e.myClearButtonBackgroundComponent.material;t.addClickFunction(this._clearConsole.bind(this,!1,null)),t.addHoverFunction(this._genericHover.bind(this,n)),t.addUnHoverFunction(this._genericUnHover.bind(this,n))}{let t=e.myUpButtonCursorTargetComponent,n=e.myUpButtonBackgroundComponent.material;t.addDoubleClickFunction(this._instantScrollUp.bind(this,!0)),t.addDownFunction(this._setScrollUp.bind(this,!0)),t.addUpFunction(this._setScrollUp.bind(this,!1)),t.addUnHoverFunction(this._setScrollUp.bind(this,!1)),t.addHoverFunction(this._genericHover.bind(this,n)),t.addUnHoverFunction(this._genericUnHover.bind(this,n))}{let t=e.myDownButtonCursorTargetComponent,n=e.myDownButtonBackgroundComponent.material;t.addDoubleClickFunction(this._instantScrollDown.bind(this)),t.addDownFunction(this._setScrollDown.bind(this,!0)),t.addUpFunction(this._setScrollDown.bind(this,!1)),t.addUnHoverFunction(this._setScrollDown.bind(this,!1)),t.addHoverFunction(this._genericHover.bind(this,n)),t.addUnHoverFunction(this._genericUnHover.bind(this,n))}{let t=e.myNotifyIconCursorTargetComponent,n=e.myNotifyIconBackgroundComponent.material;t.addClickFunction(this._instantScrollDown.bind(this)),t.addHoverFunction(this._genericHover.bind(this,n)),t.addUnHoverFunction(this._notifyIconUnHover.bind(this))}e.myPointerCursorTargetComponent.addHoverFunction(this._setGamepadScrollActive.bind(this,!0)),e.myPointerCursorTargetComponent.addUnHoverFunction(this._setGamepadScrollActive.bind(this,!1))}_resetFilters(e){if(this._myWidgetFrame.myIsWidgetVisible){for(let t in PP.ConsoleVRWidget.MessageType){let n=this._myUI.myFilterButtonsBackgroundComponents[PP.ConsoleVRWidget.MessageType[t]].material,a=this._myUI.myFilterButtonsTextComponents[PP.ConsoleVRWidget.MessageType[t]].material;this._myTypeFilters[PP.ConsoleVRWidget.MessageType[t]]=!1,a.color=this._mySetup.myMessageTypeColors[PP.ConsoleVRWidget.MessageType[t]],PP.ConsoleVRWidget.MessageType[t]!=e&&(n.color=this._mySetup.myBackgroundColor)}this._clampScrollOffset(),this._updateAllTexts()}}_filterAllButOne(e){if(this._myWidgetFrame.myIsWidgetVisible){for(let t in PP.ConsoleVRWidget.MessageType){let n=this._myUI.myFilterButtonsBackgroundComponents[PP.ConsoleVRWidget.MessageType[t]].material,a=this._myUI.myFilterButtonsTextComponents[PP.ConsoleVRWidget.MessageType[t]].material;PP.ConsoleVRWidget.MessageType[t]!=e?(this._myTypeFilters[PP.ConsoleVRWidget.MessageType[t]]=!0,n.color=this._mySetup.myFilterButtonDisabledBackgroundColor,a.color=this._mySetup.myFilterButtonDisabledTextColor):(this._myTypeFilters[PP.ConsoleVRWidget.MessageType[t]]=!1,a.color=this._mySetup.myMessageTypeColors[e])}this._clampScrollOffset(),this._updateAllTexts()}}_toggleFilter(e,t){this._myWidgetFrame.myIsWidgetVisible&&(this._myTypeFilters[e]=!this._myTypeFilters[e],this._myTypeFilters[e]?t.color=this._mySetup.myFilterButtonDisabledTextColor:t.color=this._mySetup.myMessageTypeColors[e],this._clampScrollOffset(),this._updateAllTexts())}_clearConsole(e=!1,t=null){if(this._myWidgetFrame.myIsWidgetVisible||e)if(this._myMessages=[],this._clampScrollOffset(),this._updateAllTexts(),e)switch(t){case PP.ConsoleVRWidget.Sender.BROWSER_CONSOLE:this._myOldBrowserConsoleClear.apply(console);break;case PP.ConsoleVRWidget.Sender.CONSOLE_VR:this._myOldConsoleVRClear.apply(PP.ConsoleVR);break;default:break}else this._mySetup.myClearBrowserConsoleWhenClearPressed&&PP.ConsoleVR._myRealClear()}_setScrollUp(e){(this._myWidgetFrame.myIsWidgetVisible||!e)&&(e&&(this._myScrollTimer=0),this._myScrollUp=e)}_setScrollDown(e){(this._myWidgetFrame.myIsWidgetVisible||!e)&&(e&&(this._myScrollTimer=0),this._myScrollDown=e)}_instantScrollUp(){this._myWidgetFrame.myIsWidgetVisible&&(this._myScrollOffset=this._getMaxScrollOffset(),this._updateAllTexts())}_instantScrollDown(){this._myWidgetFrame.myIsWidgetVisible&&(this._myScrollOffset=0,this._setNotifyIconActive(!1),this._updateAllTexts())}_setNotifyIconActive(e){this._myUI.myNotifyIconPanel.pp_setActiveHierarchy(e&&this._myWidgetFrame.myIsWidgetVisible)}_notifyIconUnHover(){let e=this._myUI.myNotifyIconBackgroundComponent.material;e.color=this._mySetup.myNotifyIconColor}_filterHover(e,t){this._genericHover(t)}_filterUnHover(e,t){this._myTypeFilters[e]?t.color=this._mySetup.myFilterButtonDisabledBackgroundColor:t.color=this._mySetup.myBackgroundColor}_genericHover(e){e.color=this._mySetup.myButtonHoverColor}_genericUnHover(e){e.color=this._mySetup.myBackgroundColor}_updateGamepadsExtraActions(e){this._myLeftGamepad&&this._myRightGamepad&&((this._myLeftGamepad.getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressStart()&&this._myRightGamepad.getButtonInfo(PP.GamepadButtonID.THUMBSTICK).myIsPressed||this._myRightGamepad.getButtonInfo(PP.GamepadButtonID.THUMBSTICK).isPressStart()&&this._myLeftGamepad.getButtonInfo(PP.GamepadButtonID.THUMBSTICK).myIsPressed)&&this._toggleVisibility(),this._myPulseTimer=Math.max(this._myPulseTimer-e,0),this._updateScrollWithThumbstick(e))}_toggleVisibility(){this._myWidgetFrame.toggleVisibility()}_widgetVisibleChanged(e){this._myUI.setVisible(e),e&&this._updateAllTexts()}_updateScrollWithThumbstick(e){if(this._myWidgetFrame.myIsWidgetVisible&&this._myGamepadScrollActive){let t=[0,0];if(this._mySetup.myScrollThumbstickHandedness==PP.ToolHandedness.LEFT?t=this._myLeftGamepad.getAxesInfo(PP.GamepadAxesID.THUMBSTICK).myAxes:this._mySetup.myScrollThumbstickHandedness==PP.ToolHandedness.RIGHT&&(t=this._myRightGamepad.getAxesInfo(PP.GamepadAxesID.THUMBSTICK).myAxes),Math.abs(t[1])>this._mySetup.myScrollThumbstickMinThreshold){for(this._myScrollThumbstickTimer+=e;this._myScrollThumbstickTimer>this._mySetup.myScrollThumbstickDelay;){this._myScrollThumbstickTimer-=this._mySetup.myScrollThumbstickDelay;let n=(Math.abs(t[1])-this._mySetup.myScrollThumbstickMinThreshold)/(1-this._mySetup.myScrollThumbstickMinThreshold);this._myScrollOffset+=Math.sign(t[1])*n*this._mySetup.myScrollThumbstickAmount}this._clampScrollOffset(),this._updateAllTexts()}else this._myScrollThumbstickTimer=0}}_pulseGamepad(){if(this._myLeftGamepad&&this._myRightGamepad){let e=this._myAdditionalSetup.myPulseOnNewMessage;(e==PP.ConsoleVRWidget.PulseOnNewMessage.ALWAYS||!this._myWidgetFrame.myIsWidgetVisible&&e==PP.ConsoleVRWidget.PulseOnNewMessage.WHEN_HIDDEN)&&this._myPulseTimer==0&&(this._myAdditionalSetup.myHandedness==PP.ToolHandedness.RIGHT?this._myRightGamepad.pulse(this._mySetup.myPulseIntensity,this._mySetup.myPulseDuration):this._myLeftGamepad.pulse(this._mySetup.myPulseIntensity,this._mySetup.myPulseDuration),this._myPulseTimer=this._mySetup.myPulseDelay)}}_isSimpleArray(e){if(this._isSpecialSimpleArray(e))return!0;if(Array.isArray(e)){let t=!0;for(let n of e)if(n instanceof Object){t=!1;break}return t}return!1}_isSpecialSimpleArray(e){return e&&e.constructor&&(e.constructor.name=="Uint32Array"||e.constructor.name=="Int32Array"||e.constructor.name=="Float32Array"||e.constructor.name=="Float64Array")}_setGamepadScrollActive(e){this._myGamepadScrollActive=e,this._mySetup.myGamepadScrollOnlyOnHover||(this._myGamepadScrollActive=!0)}_jsonReplacer(e,t){if(t instanceof Map)return Array.from(t.entries());if(this._isSimpleArray(t)){let n=t;if(this._isSpecialSimpleArray(n)){let s=[];for(let o=0;o<n.length;o++)s[o]=n[o];n=s}let a=JSON.stringify(n);return a=a.split(",").join(", "),a}else return t}};PP.ConsoleVRWidget.AdditionalSetup=class{constructor(){this.myHandedness=PP.ToolHandedness.NONE,this.myOverrideBrowserConsole=!1,this.myShowOnStart=!1,this.myShowVisibilityButton=!1,this.myPulseOnNewMessage=PP.ConsoleVRWidget.PulseOnNewMessage.NEVER,this.myPlaneMaterial=null,this.myTextMaterial=null}};PP.ConsoleVRWidget.ConsoleFunction={DEBUG:0,WARN:1,ERROR:2,LOG:3,INFO:4,ASSERT:5};PP.ConsoleVRWidget.Sender={BROWSER_CONSOLE:0,CONSOLE_VR:1,WINDOW:2};PP.ConsoleVRWidget.PulseOnNewMessage={NEVER:0,ALWAYS:1,WHEN_HIDDEN:2};PP.ConsoleVRWidget.MessageType={DEBUG:0,WARN:1,ERROR:2,LOG:3};PP.ConsoleVRWidget.Message=class{constructor(e,t){this.myType=e,this.myLines=t,this._myOriginalText=t.join(`
`),this._myMessagesCount=1}hasSameInfo(e){return this._myOriginalText==e._myOriginalText&&this.myType==e.myType}increaseCount(){this._myMessagesCount+=1;let e="(x".concat(this._myMessagesCount).concat(") "),t=this._myOriginalText.slice(0);t=e.concat(t),this.myLines=t.split(`
`)}}});var ao=S(()=>{PP.ConsoleVR={_myRealLog:console.log,_myRealError:console.error,_myRealWarn:console.warn,_myRealInfo:console.info,_myRealDebug:console.debug,_myRealAssert:console.assert,_myRealClear:console.clear,_myForwardToBrowserConsole:!0,log:function(...i){this._myForwardToBrowserConsole&&this._myRealLog.apply(console,i)},error:function(...i){this._myForwardToBrowserConsole&&this._myRealError.apply(console,i)},warn:function(...i){this._myForwardToBrowserConsole&&this._myRealWarn.apply(console,i)},info:function(...i){this._myForwardToBrowserConsole&&this._myRealInfo.apply(console,i)},debug:function(...i){this._myForwardToBrowserConsole&&this._myRealDebug.apply(console,i)},assert:function(...i){this._myForwardToBrowserConsole&&this._myRealAssert.apply(console,i)},clear:function(){this._myForwardToBrowserConsole&&this._myRealClear.apply(console)},setForwardToBrowserConsole:function(i){this._myForwardToBrowserConsole=i},isForwardToBrowserConsole:function(){return this._myForwardToBrowserConsole}}});var so=S(()=>{WL.registerComponent("pp-console-vr",{_myHandedness:{type:WL.Type.Enum,values:["none","left","right"],default:"none"},_myOverrideBrowserConsole:{type:WL.Type.Bool,default:!0},_myShowOnStart:{type:WL.Type.Bool,default:!1},_myShowVisibilityButton:{type:WL.Type.Bool,default:!1},_myPulseOnNewMessage:{type:WL.Type.Enum,values:["never","always","when hidden"],default:"never"}},{init:function(){this._myWidget=new PP.ConsoleVRWidget,this._myStarted=!1},start:function(){let i=new PP.ConsoleVRWidget.AdditionalSetup;i.myHandedness=[null,"left","right"][this._myHandedness],i.myOverrideBrowserConsole=this._myOverrideBrowserConsole,i.myShowOnStart=this._myShowOnStart,i.myShowVisibilityButton=this._myShowVisibilityButton,i.myPulseOnNewMessage=this._myPulseOnNewMessage,i.myPlaneMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),i.myTextMaterial=PP.myDefaultResources.myMaterials.myText.clone(),this._myWidget.start(this.object,i),this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._mySetVisibleNextUpdate=!1,this._myStarted=!0},update:function(i){this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this._myWidget.setVisible(!1),this._myWidget.setVisible(this._myWidgetVisibleBackup)),this._myWidget.update(i)},onActivate(){this._mySetVisibleNextUpdate=!0},onDeactivate(){this._myStarted&&(this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._myWidget.setVisible(!1))}})});var oo=S(()=>{PP.EasyObjectTuner=class{constructor(e,t,n,a){this._myObject=e,this._myUseTuneTarget=a,this._mySetAsDefault=n,this._myEasyObject=this._myObject,this._myUseTuneTarget&&(this._myEasyObject=PP.myEasyTuneTarget),this._myPrevEasyObject=null;let s=this._getVariableNamePrefix();t==""?this._myEasyTuneVariableName=s.concat(this._myObject.objectId):this._myEasyTuneVariableName=s.concat(t)}start(){let e=this._createEasyTuneVariable(this._myEasyTuneVariableName);PP.myEasyTuneVariables.add(e),this._mySetAsDefault&&PP.setEasyTuneWidgetActiveVariable(this._myEasyTuneVariableName)}update(e){if(PP.myEasyTuneVariables.isActive(this._myEasyTuneVariableName)){if(this._myUseTuneTarget&&(this._myEasyObject=PP.myEasyTuneTarget),this._myPrevEasyObject!=this._myEasyObject)if(this._myPrevEasyObject=this._myEasyObject,this._myEasyObject){let t=this._getObjectValue(this._myEasyObject);PP.myEasyTuneVariables.set(this._myEasyTuneVariableName,t,!0)}else{let t=this._getDefaultValue();PP.myEasyTuneVariables.set(this._myEasyTuneVariableName,t,!0)}this._myEasyObject&&this._updateObjectValue(this._myEasyObject,PP.myEasyTuneVariables.get(this._myEasyTuneVariableName))}}updateVariableValue(e){PP.myEasyTuneVariables.set(this._myEasyTuneVariableName,e)}}});var ro=S(()=>{WL.registerComponent("pp-easy-light-attenuation",{_myVariableName:{type:WL.Type.String,default:""},_mySetAsDefault:{type:WL.Type.Bool,default:!1},_myUseTuneTarget:{type:WL.Type.Bool,default:!1}},{init:function(){this._myEasyObjectTuner=new PP.EasyLightAttenuation(this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(i){this._myEasyObjectTuner.update(i)}});PP.EasyLightAttenuation=class extends PP.EasyObjectTuner{constructor(e,t,n,a){super(e,t,n,a)}_getVariableNamePrefix(){return"Light Attenuation "}_createEasyTuneVariable(e){return new PP.EasyTuneNumber(e,this._getDefaultValue(),.01,3,0,1)}_getObjectValue(e){return this._getLightAttenuation(e)}_getDefaultValue(){return 0}_updateObjectValue(e,t){let n=t,a=e.pp_getComponent("light");a&&(a.color[3]=n)}_getLightAttenuation(e){let t=this._getDefaultValue(),n=e.pp_getComponent("light");return n&&(t=n.color[3]),t}}});var lo=S(()=>{WL.registerComponent("pp-easy-light-color",{_myVariableName:{type:WL.Type.String,default:""},_mySetAsDefault:{type:WL.Type.Bool,default:!1},_myUseTuneTarget:{type:WL.Type.Bool,default:!1},_myColorModel:{type:WL.Type.Enum,values:["rgb","hsv"]}},{init:function(){this._myEasyObjectTuner=new PP.EasyLightColor(this._myColorModel,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(i){this._myEasyObjectTuner.update(i)}});PP.EasyLightColor=class extends PP.EasyObjectTuner{constructor(e,t,n,a,s){super(t,n,a,s),this._myColorModel=e}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Light RGB ":e="Light HSV ",e}_createEasyTuneVariable(e){return new PP.EasyTuneIntArray(e,this._getDefaultValue(),100,0,255)}_getObjectValue(e){let t=null,n=this._getLightColor(e);return n?this._myColorModel==0?t=PP.ColorUtils.rgbCodeToHuman(n):t=PP.ColorUtils.hsvCodeToHuman(PP.ColorUtils.rgbToHsv(n)):t=this._getDefaultValue(),t}_getDefaultValue(){return PP.vec3_create()}_updateObjectValue(e,t){let n=t;this._myColorModel==0?n=PP.ColorUtils.rgbHumanToCode(n):n=PP.ColorUtils.hsvToRgb(PP.ColorUtils.hsvHumanToCode(n));let a=e.pp_getComponent("light");if(a&&(a.color[0]=n[0],a.color[1]=n[1],a.color[2]=n[2],a.color[3]=a.color[3]),PP.myRightGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressStart()&&PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).myIsPressed||PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressStart()&&PP.myRightGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).myIsPressed){let s=PP.ColorUtils.color1To255(PP.ColorUtils.rgbToHsv(n)),o=PP.ColorUtils.color1To255(n);console.log("RGB:",o.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getLightColor(e){let t=null,n=e.pp_getComponent("light");return n&&(t=n.color.slice(0,3)),t}}});var mo=S(()=>{WL.registerComponent("pp-easy-mesh-color",{_myVariableName:{type:WL.Type.String,default:""},_myUseTuneTarget:{type:WL.Type.Bool,default:!1},_mySetAsDefault:{type:WL.Type.Bool,default:!1},_myColorModel:{type:WL.Type.Enum,values:["rgb","hsv"],default:"hsv"},_myColorType:{type:WL.Type.Enum,values:["color","diffuse color","ambient color","specular color","emissive color","fog color","ambient factor"],default:"color"}},{init:function(){this._myEasyObjectTuner=new PP.EasyMeshColor(this._myColorModel,this._myColorType,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(i){this._myEasyObjectTuner.update(i)},pp_clone(i){return i.pp_addComponent(this.type,{_myVariableName:this._myVariableName,_mySetAsDefault:this._mySetAsDefault,_myUseTuneTarget:this._myUseTuneTarget,_myColorModel:this._myColorModel,_myColorType:this._myColorType})}});PP.EasyMeshColor=class extends PP.EasyObjectTuner{constructor(e,t,n,a,s,o){super(n,a,s,o),this._myColorModel=e,this._myColorType=t,this._myColorVariableNames=["color","diffuseColor","ambientColor","specularColor","emissiveColor","fogColor","ambientFactor"]}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Mesh RGB ":e="Mesh HSV ",e}_createEasyTuneVariable(e){return this._myColorType==6?new PP.EasyTuneNumberArray(e,this._getDefaultValue(),.1,3,0,1):new PP.EasyTuneIntArray(e,this._getDefaultValue(),100,0,255)}_getObjectValue(e){let t=null,n=this._getMeshMaterial(e);return n?this._myColorType!=6?(t=n[this._myColorVariableNames[this._myColorType]].pp_clone(),this._myColorModel==0?t=PP.ColorUtils.rgbCodeToHuman(t):t=PP.ColorUtils.hsvCodeToHuman(PP.ColorUtils.rgbToHsv(t))):t=[n[this._myColorVariableNames[this._myColorType]]]:t=this._getDefaultValue(),t}_getDefaultValue(){return this._myColorType==6?[0]:PP.vec4_create()}_updateObjectValue(e,t){let n=t;this._myColorType!=6&&(this._myColorModel==0?n=PP.ColorUtils.rgbHumanToCode(n):n=PP.ColorUtils.hsvToRgb(PP.ColorUtils.hsvHumanToCode(n)));let a=this._getMeshMaterial(e);if(a&&(a[this._myColorVariableNames[this._myColorType]]=n),this._myColorType!=6&&(PP.myRightGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressStart()&&PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).myIsPressed||PP.myLeftGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressStart()&&PP.myRightGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).myIsPressed)){let s=PP.ColorUtils.color1To255(PP.ColorUtils.rgbToHsv(n)),o=PP.ColorUtils.color1To255(n);console.log("RGB:",o.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getMeshMaterial(e){let t=null,n=e.pp_getComponentHierarchy("mesh");return n&&(t=n.material),t}}});var yo=S(()=>{WL.registerComponent("pp-easy-scale",{_myVariableName:{type:WL.Type.String,default:""},_mySetAsDefault:{type:WL.Type.Bool,default:!1},_myUseTuneTarget:{type:WL.Type.Bool,default:!1},_myIsLocal:{type:WL.Type.Bool,default:!1},_myScaleAsOne:{type:WL.Type.Bool,default:!0}},{init:function(){this._myEasyObjectTuner=new PP.EasyScale(this._myIsLocal,this._myScaleAsOne,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(i){this._myEasyObjectTuner.update(i)}});PP.EasyScale=class extends PP.EasyObjectTuner{constructor(e,t,n,a,s,o){super(n,a,s,o),this._myIsLocal=e,this._myScaleAsOne=t}_getVariableNamePrefix(){return"Scale "}_createEasyTuneVariable(e){return new PP.EasyTuneNumberArray(e,this._getDefaultValue(),1,3,.001,null,this._myScaleAsOne)}_getObjectValue(e){return this._myIsLocal?e.pp_getScaleLocal():e.pp_getScaleWorld()}_getDefaultValue(){return PP.vec3_create(1,1,1)}_updateObjectValue(e,t){this._myIsLocal?e.pp_setScaleLocal(t):e.pp_setScaleWorld(t)}}});var co=S(()=>{WL.registerComponent("pp-easy-set-tune-target-child-number",{_myVariableName:{type:WL.Type.String,default:""},_mySetAsDefault:{type:WL.Type.Bool,default:!1}},{init:function(){},start:function(){this._myEasyTuneVariableName="Target Child ",this._myVariableName==""?this._myEasyTuneVariableName=this._myEasyTuneVariableName.concat(this.object.objectId):this._myEasyTuneVariableName=this._myEasyTuneVariableName.concat(this._myVariableName);let i=this.object.pp_getChildren().length,e=1,t=i;i==0&&(e=0,t=0),PP.myEasyTuneVariables.add(new PP.EasyTuneInt(this._myEasyTuneVariableName,0,10,e,t)),this._mySetAsDefault&&PP.setEasyTuneWidgetActiveVariable(this._myEasyTuneVariableName),this._myCurrentChildIndex=-1,this._myCurrentChildrenCount=i},update:function(){if(PP.myEasyTuneVariables.isActive(this._myEasyTuneVariableName)){let i=this.object.pp_getChildren().length;if(i!=this._myCurrentChildrenCount){this._myCurrentChildrenCount=i;let t=1,n=i;i==0&&(t=0,n=0);let a=PP.myEasyTuneVariables.getEasyTuneVariable(this._myEasyTuneVariableName);a.setMin(t),a.setMax(n)}let e=PP.myEasyTuneVariables.get(this._myEasyTuneVariableName);e!=this._myCurrentChildIndex&&(e==0&&this._myCurrentChildIndex!=-1?PP.myEasyTuneTarget=null:e>0&&(PP.myEasyTuneTarget=this.object.pp_getChildren()[e-1]),this._myCurrentChildIndex=e)}}})});var uo=S(()=>{WL.registerComponent("pp-easy-set-tune-target-grab",{},{init:function(){},start:function(){this._myGrabber=this.object.pp_getComponent("pp-grabber-hand")},update:function(){},_onRelease:function(i,e){PP.myEasyTuneTarget=e.object},_onGrab:function(i,e){},onActivate(){this._myGrabber.registerGrabEventListener(this,this._onGrab.bind(this)),this._myGrabber.registerThrowEventListener(this,this._onRelease.bind(this))},onDeactivate(){this._myGrabber.unregisterGrabEventListener(this),this._myGrabber.unregisterThrowEventListener(this)}})});var ho=S(()=>{WL.registerComponent("pp-easy-transform",{_myVariableName:{type:WL.Type.String,default:""},_mySetAsDefault:{type:WL.Type.Bool,default:!1},_myUseTuneTarget:{type:WL.Type.Bool,default:!1},_myIsLocal:{type:WL.Type.Bool,default:!1},_myScaleAsOne:{type:WL.Type.Bool,default:!0}},{init:function(){this._myEasyObjectTuner=new PP.EasyTransform(this._myIsLocal,this._myScaleAsOne,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(i){this._myEasyObjectTuner.update(i)},pp_clone(i){return i.pp_addComponent(this.type,{_myVariableName:this._myVariableName,_mySetAsDefault:this._mySetAsDefault,_myUseTuneTarget:this._myUseTuneTarget,_myIsLocal:this._myIsLocal,_myScaleAsOne:this._myScaleAsOne})}});PP.EasyTransform=class extends PP.EasyObjectTuner{constructor(e,t,n,a,s,o){super(n,a,s,o),this._myIsLocal=e,this._myScaleAsOne=t}_getVariableNamePrefix(){return"Transform "}_createEasyTuneVariable(e){return new PP.EasyTuneTransform(e,this._getDefaultValue(),this._myScaleAsOne)}_getObjectValue(e){return this._myIsLocal?e.pp_getTransformLocal():e.pp_getTransformWorld()}_getDefaultValue(){return PP.mat4_create()}_updateObjectValue(e,t){this._myIsLocal?e.pp_setTransformLocal(t):e.pp_setTransformWorld(t)}}});var po=S(()=>{WL.registerComponent("pp-easy-mesh-ambient-factor",{_myVariableName:{type:WL.Type.String,default:""},_myUseTuneTarget:{type:WL.Type.Bool,default:!1},_mySetAsDefault:{type:WL.Type.Bool,default:!1}},{init:function(){this._myEasyObjectTuner=new PP.EasyMeshAmbientFactor(this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget)},start:function(){this._myEasyObjectTuner.start()},update:function(i){this._myEasyObjectTuner.update(i)},pp_clone(i){return i.pp_addComponent(this.type,{_myVariableName:this._myVariableName,_mySetAsDefault:this._mySetAsDefault,_myUseTuneTarget:this._myUseTuneTarget})}});PP.EasyMeshAmbientFactor=class extends PP.EasyObjectTuner{constructor(e,t,n,a){super(e,t,n,a)}_getVariableNamePrefix(){let e=null;return this._myColorModel==0,e="Mesh AF ",e}_createEasyTuneVariable(e){return new PP.EasyTuneNumber(e,this._getDefaultValue(),.1,3,0,1)}_getObjectValue(e){let t=null,n=this._getMeshMaterial(e);return n?t=n.ambientFactor:t=this._getDefaultValue(),t}_getDefaultValue(){return 0}_updateObjectValue(e,t){let n=t,a=this._getMeshMaterial(e);a&&(a.ambientFactor=n)}_getMeshMaterial(e){let t=null,n=e.pp_getComponentHierarchy("mesh");return n&&(t=n.material),t}}});var _o=S(()=>{PP.EasyTuneBaseWidgetParams=class{constructor(){this.myVariablesImportCallback=null,this.myVariablesExportCallback=null}};PP.EasyTuneBaseWidget=class{constructor(e){this._mySetup=null,this._myUI=null,this._myParams=e,this._myAdditionalSetup=null,this._myVariable=null,this._myIsVisible=!0,this._myScrollVariableRequestCallbacks=new Map,this._myAppendToVariableName="",this._myScrollVariableActive=!1,this._myScrollDirection=0,this._myScrollVariableTimer=0,this._myHasScrolled=!1,this._myResetImportLabelTimer=new PP.Timer(0,!1),this._myResetExportLabelTimer=new PP.Timer(0,!1)}setVisible(e){e&&this._refreshUI(),this._myUI.setVisible(e),this._myIsVisible=e}setEasyTuneVariable(e,t){this._myVariable=e,typeof t<"u"?this._myAppendToVariableName=t:this._myAppendToVariableName="",this._setEasyTuneVariableHook(),this._refreshUI()}isScrollVariableActive(){return this._myScrollVariableActive}getScrollVariableDirection(){return this._myScrollDirection}setScrollVariableActive(e,t){this._myScrollVariableActive=e,this._myScrollDirection=t,this._myScrollVariableTimer=this._mySetup.myScrollVariableDelay,this._myHasScrolled=!1}getWidget(){return this}syncWidget(e){e!=null?(e._myResetImportLabelTimer.isRunning()?this._myResetImportLabelTimer.start(e._myResetImportLabelTimer.getTimeLeft()):this._myResetImportLabelTimer.reset(),e._myResetExportLabelTimer.isRunning()?this._myResetExportLabelTimer.start(e._myResetExportLabelTimer.getTimeLeft()):this._myResetExportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=e._myUI.myImportButtonTextComponent.text,this._myUI.myExportButtonTextComponent.text=e._myUI.myExportButtonTextComponent.text,this.setScrollVariableActive(e.isScrollVariableActive(),e.getScrollVariableDirection())):(this._myResetImportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=this._mySetup.myImportButtonText,this._myResetExportLabelTimer.reset(),this._myUI.myExportButtonTextComponent.text=this._mySetup.myExportButtonText)}onImportSuccess(){this._myUI.myImportButtonTextComponent.text=this._mySetup.myImportSuccessButtonText,this._myResetImportLabelTimer.start(this._mySetup.myImportExportResetLabelSeconds)}onImportFailure(){this._myUI.myImportButtonTextComponent.text=this._mySetup.myImportFailureButtonText,this._myResetImportLabelTimer.start(this._mySetup.myImportExportResetLabelSeconds)}onExportSuccess(){this._myUI.myExportButtonTextComponent.text=this._mySetup.myExportSuccessButtonText,this._myResetExportLabelTimer.start(this._mySetup.myImportExportResetLabelSeconds)}onExportFailure(){this._myUI.myExportButtonTextComponent.text=this._mySetup.myExportFailureButtonText,this._myResetExportLabelTimer.start(this._mySetup.myImportExportResetLabelSeconds)}registerScrollVariableRequestEventListener(e,t){this._myScrollVariableRequestCallbacks.set(e,t)}unregisterScrollVariableRequestEventListener(e){this._myScrollVariableRequestCallbacks.delete(e)}start(e,t){this._myAdditionalSetup=t,this._mySetup.build(),this._myResetImportLabelTimer.setDuration(this._mySetup.myImportExportResetLabelSeconds),this._myResetExportLabelTimer.setDuration(this._mySetup.myImportExportResetLabelSeconds),this._myUI.build(e,this._mySetup,t),this._myUI.setImportExportButtonsActive(this._myAdditionalSetup.myEnableVariablesImportExportButtons),this._startHook(e,t),this._addListeners()}update(e){this._isActive()&&(this._updateHook(e),this._updateScrollVariable(e),this._updateImportExportLabel(e))}_setEasyTuneVariableHook(){}_refreshUIHook(){}_startHook(e,t){}_addListenersHook(){}_updateHook(e){}_refreshUI(){if(this._myVariable){if(this._myVariable.myName!=null)this._myUI.myVariableLabelTextComponent.text=this._myVariable.myName.concat(this._myAppendToVariableName);else{let e="Unknown";this._myUI.myVariableLabelTextComponent.text=e.concat(this._myAppendToVariableName)}this._refreshUIHook()}}_updateScrollVariable(e){this._myScrollVariableActive&&(this._myScrollVariableTimer<=0?(this._scrollVariableRequest(this._myScrollDirection),this._myScrollVariableTimer=this._mySetup.myScrollVariableDelay,this._myHasScrolled=!0):this._myScrollVariableTimer-=e)}_updateImportExportLabel(e){this._myResetImportLabelTimer.isRunning(e)&&(this._myResetImportLabelTimer.update(e),this._myResetImportLabelTimer.isDone()&&(this._myResetImportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=this._mySetup.myImportButtonText)),this._myResetExportLabelTimer.isRunning(e)&&(this._myResetExportLabelTimer.update(e),this._myResetExportLabelTimer.isDone()&&(this._myResetExportLabelTimer.reset(),this._myUI.myExportButtonTextComponent.text=this._mySetup.myExportButtonText))}_isActive(){return this._myIsVisible&&this._myVariable}_addListeners(){let e=this._myUI;e.myNextButtonCursorTargetComponent.addDownFunction(this._setScrollVariableActive.bind(this,!0,1,!1)),e.myNextButtonCursorTargetComponent.addDownOnHoverFunction(this._setScrollVariableActive.bind(this,!0,1,!1)),e.myNextButtonCursorTargetComponent.addUpFunction(this._setScrollVariableActive.bind(this,!1,0,!1)),e.myNextButtonCursorTargetComponent.addUpWithNoDownFunction(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myNextButtonCursorTargetComponent.addUnHoverFunction(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myNextButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myNextButtonBackgroundComponent.material)),e.myNextButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myNextButtonBackgroundComponent.material)),e.myPreviousButtonCursorTargetComponent.addDownFunction(this._setScrollVariableActive.bind(this,!0,-1,!1)),e.myPreviousButtonCursorTargetComponent.addDownOnHoverFunction(this._setScrollVariableActive.bind(this,!0,-1,!1)),e.myPreviousButtonCursorTargetComponent.addUpFunction(this._setScrollVariableActive.bind(this,!1,0,!1)),e.myPreviousButtonCursorTargetComponent.addUpWithNoDownFunction(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myPreviousButtonCursorTargetComponent.addUnHoverFunction(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myPreviousButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myPreviousButtonBackgroundComponent.material)),e.myPreviousButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myPreviousButtonBackgroundComponent.material)),e.myImportButtonCursorTargetComponent.addUpFunction(this._importVariables.bind(this)),e.myImportButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myImportButtonBackgroundComponent.material)),e.myImportButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myImportButtonBackgroundComponent.material)),e.myExportButtonCursorTargetComponent.addUpFunction(this._exportVariables.bind(this)),e.myExportButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myExportButtonBackgroundComponent.material)),e.myExportButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myExportButtonBackgroundComponent.material)),this._addListenersHook()}_setScrollVariableActive(e,t,n){if(this._isActive()||!e){let a=!e&&!this._myHasScrolled&&!n,s=this._myScrollDirection;this.setScrollVariableActive(e,t),a&&this._scrollVariableRequest(s)}}_scrollVariableRequest(e){if(this._isActive()&&e!=0)for(let t of this._myScrollVariableRequestCallbacks.values())t(e)}_genericHover(e){e.color=this._mySetup.myButtonHoverColor}_genericUnHover(e){e.color=this._mySetup.myBackgroundColor}_importVariables(){this._myUI.myImportButtonTextComponent.text==this._mySetup.myImportButtonText&&(this._myUI.myImportButtonTextComponent.text=this._mySetup.myImportingButtonText,this._myResetImportLabelTimer.reset(),this._myParams.myVariablesImportCallback())}_exportVariables(){this._myUI.myExportButtonTextComponent.text==this._mySetup.myExportButtonText&&(this._myUI.myExportButtonTextComponent.text=this._mySetup.myExportingButtonText,this._myResetExportLabelTimer.reset(),this._myParams.myVariablesExportCallback())}}});var Po=S(()=>{PP.EasyTuneBaseWidgetUI=class{build(e,t,n){this._myParentObject=e,this._mySetup=t,this._myAdditionalSetup=n,this._myImportExportButtonsActive=!0,this._myPlaneMesh=PP.myDefaultResources.myMeshes.myPlane,this._buildHook(),this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonVR(),WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}setVisible(e){this.myPivotObject.pp_setActiveHierarchy(e),e&&this.setImportExportButtonsActive(this._myImportExportButtonsActive),this._setVisibleHook(e)}setImportExportButtonsActive(e){this._myImportExportButtonsActive=e,this.myImportExportPanel.pp_setActiveHierarchy(this._myImportExportButtonsActive)}_buildHook(){}_setVisibleHook(e){}_createSkeletonHook(){}_setTransformHook(){}_addComponentsHook(){}_createSkeleton(){this.myPivotObject=WL.scene.addObject(this._myParentObject),this.myBackPanel=WL.scene.addObject(this.myPivotObject),this.myBackBackground=WL.scene.addObject(this.myBackPanel),this.myDisplayPanel=WL.scene.addObject(this.myPivotObject),this.myVariableLabelPanel=WL.scene.addObject(this.myDisplayPanel),this.myVariableLabelText=WL.scene.addObject(this.myVariableLabelPanel),this.myVariableLabelCursorTarget=WL.scene.addObject(this.myVariableLabelPanel),this.myNextButtonPanel=WL.scene.addObject(this.myVariableLabelPanel),this.myNextButtonBackground=WL.scene.addObject(this.myNextButtonPanel),this.myNextButtonText=WL.scene.addObject(this.myNextButtonPanel),this.myNextButtonCursorTarget=WL.scene.addObject(this.myNextButtonPanel),this.myPreviousButtonPanel=WL.scene.addObject(this.myVariableLabelPanel),this.myPreviousButtonBackground=WL.scene.addObject(this.myPreviousButtonPanel),this.myPreviousButtonText=WL.scene.addObject(this.myPreviousButtonPanel),this.myPreviousButtonCursorTarget=WL.scene.addObject(this.myPreviousButtonPanel),this.myImportExportPanel=WL.scene.addObject(this.myPivotObject),this.myImportButtonPanel=WL.scene.addObject(this.myImportExportPanel),this.myImportButtonBackground=WL.scene.addObject(this.myImportButtonPanel),this.myImportButtonText=WL.scene.addObject(this.myImportButtonPanel),this.myImportButtonCursorTarget=WL.scene.addObject(this.myImportButtonPanel),this.myExportButtonPanel=WL.scene.addObject(this.myImportExportPanel),this.myExportButtonBackground=WL.scene.addObject(this.myExportButtonPanel),this.myExportButtonText=WL.scene.addObject(this.myExportButtonPanel),this.myExportButtonCursorTarget=WL.scene.addObject(this.myExportButtonPanel),this.myPointerCursorTarget=WL.scene.addObject(this.myPivotObject),this._createSkeletonHook()}_setTransforms(){this.myPivotObject.setTranslationLocal(this._mySetup.myPivotObjectPositions[this._myAdditionalSetup.myHandedness]),this.myBackPanel.setTranslationLocal(this._mySetup.myBackPanelPosition),this.myBackBackground.scale(this._mySetup.myBackBackgroundScale),this.myDisplayPanel.setTranslationLocal(this._mySetup.myDisplayPanelPosition),this.myVariableLabelPanel.setTranslationLocal(this._mySetup.myVariableLabelPanelPosition),this.myVariableLabelText.scale(this._mySetup.myVariableLabelTextScale),this.myVariableLabelCursorTarget.setTranslationLocal(this._mySetup.myVariableLabelCursorTargetPosition),this.myNextButtonPanel.setTranslationLocal(this._mySetup.myRightSideButtonPosition),this.myNextButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myNextButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myNextButtonText.scale(this._mySetup.mySideButtonTextScale),this.myNextButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myPreviousButtonPanel.setTranslationLocal(this._mySetup.myLeftSideButtonPosition),this.myPreviousButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myPreviousButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myPreviousButtonText.scale(this._mySetup.mySideButtonTextScale),this.myPreviousButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myImportExportPanel.setTranslationLocal(this._mySetup.myImportExportPanelPosition),this.myImportButtonPanel.setTranslationLocal(this._mySetup.myImportButtonPosition),this.myImportButtonBackground.scale(this._mySetup.myImportExportButtonBackgroundScale),this.myImportButtonText.setTranslationLocal(this._mySetup.myImportExportButtonTextPosition),this.myImportButtonText.scale(this._mySetup.myImportExportButtonTextScale),this.myImportButtonCursorTarget.setTranslationLocal(this._mySetup.myImportExportButtonCursorTargetPosition),this.myExportButtonPanel.setTranslationLocal(this._mySetup.myExportButtonPosition),this.myExportButtonBackground.scale(this._mySetup.myImportExportButtonBackgroundScale),this.myExportButtonText.setTranslationLocal(this._mySetup.myImportExportButtonTextPosition),this.myExportButtonText.scale(this._mySetup.myImportExportButtonTextScale),this.myExportButtonCursorTarget.setTranslationLocal(this._mySetup.myImportExportButtonCursorTargetPosition),this.myPointerCursorTarget.setTranslationLocal(this._mySetup.myPointerCursorTargetPosition),this._setTransformHook()}_addComponents(){this.myBackBackgroundComponent=this.myBackBackground.addComponent("mesh"),this.myBackBackgroundComponent.mesh=this._myPlaneMesh,this.myBackBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myBackBackgroundComponent.material.color=this._mySetup.myBackBackgroundColor,this.myVariableLabelTextComponent=this.myVariableLabelText.addComponent("text"),this._setupTextComponent(this.myVariableLabelTextComponent),this.myVariableLabelTextComponent.text=" ",this.myVariableLabelCursorTargetComponent=this.myVariableLabelCursorTarget.addComponent("cursor-target"),this.myVariableLabelCollisionComponent=this.myVariableLabelCursorTarget.addComponent("collision"),this.myVariableLabelCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myVariableLabelCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myVariableLabelCollisionComponent.extents=this._mySetup.myVariableLabelCollisionExtents,this.myNextButtonBackgroundComponent=this.myNextButtonBackground.addComponent("mesh"),this.myNextButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myNextButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myNextButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myNextButtonTextComponent=this.myNextButtonText.addComponent("text"),this._setupTextComponent(this.myNextButtonTextComponent),this.myNextButtonTextComponent.text=this._mySetup.myNextButtonText,this.myNextButtonCursorTargetComponent=this.myNextButtonCursorTarget.addComponent("cursor-target"),this.myNextButtonCollisionComponent=this.myNextButtonCursorTarget.addComponent("collision"),this.myNextButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myNextButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myNextButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myPreviousButtonBackgroundComponent=this.myPreviousButtonBackground.addComponent("mesh"),this.myPreviousButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPreviousButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPreviousButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myPreviousButtonTextComponent=this.myPreviousButtonText.addComponent("text"),this._setupTextComponent(this.myPreviousButtonTextComponent),this.myPreviousButtonTextComponent.text=this._mySetup.myPreviousButtonText,this.myPreviousButtonCursorTargetComponent=this.myPreviousButtonCursorTarget.addComponent("cursor-target"),this.myPreviousButtonCollisionComponent=this.myPreviousButtonCursorTarget.addComponent("collision"),this.myPreviousButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPreviousButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPreviousButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myImportButtonBackgroundComponent=this.myImportButtonBackground.addComponent("mesh"),this.myImportButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myImportButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myImportButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myImportButtonTextComponent=this.myImportButtonText.addComponent("text"),this._setupTextComponent(this.myImportButtonTextComponent),this.myImportButtonTextComponent.text=this._mySetup.myImportButtonText,this.myImportButtonCursorTargetComponent=this.myImportButtonCursorTarget.addComponent("cursor-target"),this.myImportButtonCollisionComponent=this.myImportButtonCursorTarget.addComponent("collision"),this.myImportButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myImportButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myImportButtonCollisionComponent.extents=this._mySetup.myImportExportButtonCollisionExtents,this.myExportButtonBackgroundComponent=this.myExportButtonBackground.addComponent("mesh"),this.myExportButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myExportButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myExportButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myExportButtonTextComponent=this.myExportButtonText.addComponent("text"),this._setupTextComponent(this.myExportButtonTextComponent),this.myExportButtonTextComponent.text=this._mySetup.myExportButtonText,this.myExportButtonCursorTargetComponent=this.myExportButtonCursorTarget.addComponent("cursor-target"),this.myExportButtonCollisionComponent=this.myExportButtonCursorTarget.addComponent("collision"),this.myExportButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myExportButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myExportButtonCollisionComponent.extents=this._mySetup.myImportExportButtonCollisionExtents,this.myPointerCollisionComponent=this.myPointerCursorTarget.addComponent("collision"),this.myPointerCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPointerCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPointerCollisionComponent.extents=this._mySetup.myPointerCollisionExtents,this._addComponentsHook()}_setupTextComponent(e){e.alignment=this._mySetup.myTextAlignment,e.justification=this._mySetup.myTextJustification,e.material=this._myAdditionalSetup.myTextMaterial.clone(),e.material.color=this._mySetup.myTextColor,e.text=""}_onXRSessionStart(){this._setTransformForVR()}_onXRSessionEnd(){this._setTransformForNonVR()}_setTransformForVR(){this.myPivotObject.setTranslationLocal(this._mySetup.myPivotObjectPositions[this._myAdditionalSetup.myHandedness])}_setTransformForNonVR(){this.myPivotObject.setTranslationLocal(this._mySetup.myPivotObjectPositions[PP.ToolHandedness.NONE])}}});var go=S(()=>{PP.EasyTuneBaseWidgetSetup=class{constructor(){}build(){this._initializeBuildSetup(),this._initializeRuntimeSetup()}_getBackPanelMaxY(){return this.myDisplayPanelPosition[1]+this.myVariableLabelPanelPosition[1]+this.mySideButtonBackgroundScale[1]+this._mySideButtonDistanceFromBorder*1.25}_getBackPanelMinY(){return this.myDisplayPanelPosition[1]-this._mySideButtonDistanceFromBorder*1.25-this.mySideButtonBackgroundScale[1]}_getBackPanelMaxX(){return this._mySideButtonPanelHalfWidth}_getBackPanelMinX(){return-this._mySideButtonPanelHalfWidth}_getPivotZOffset(){return 0}_initializeBuildSetupHook(){}_initializeRuntimeSetupHook(){}_initializeBuildSetup(){this.myBackgroundColor=[46/255,46/255,46/255,1],this.myCursorTargetCollisionCollider=WL.Collider.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=[255/255,255/255,255/255,1],this.myTextAlignment=WL.Alignment.Center,this.myTextJustification=WL.Justification.Middle,this.myTextColor=this.myDefaultTextColor,this.myLabelTextScale=PP.vec3_create(.19,.19,.19),this.myButtonTextScale=PP.vec3_create(.18,.18,.18),this._myPanelZOffset=.01,this._myColliderZOffset=.017,this._mySideButtonDistanceFromBorder=.0125,this._mySideButtonPanelHalfWidth=.2,this.myPivotObjectPositions=[],this.myPivotObjectPositions[PP.ToolHandedness.NONE]=PP.vec3_create(0,0,this._getPivotZOffset()),this.myPivotObjectPositions[PP.ToolHandedness.LEFT]=PP.vec3_create(-.04,.02,this._getPivotZOffset()),this.myPivotObjectPositions[PP.ToolHandedness.RIGHT]=PP.vec3_create(-.08,.02,this._getPivotZOffset()),this.mySideButtonBackgroundScale=PP.vec3_create(.015,.015,1),this.mySideButtonTextScale=this.myButtonTextScale,this.mySideButtonTextPosition=PP.vec3_create(0,0,.007),this.mySideButtonCursorTargetPosition=PP.vec3_create(0,0,0),this.mySideButtonCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.mySideButtonCollisionExtents=this.mySideButtonBackgroundScale.slice(0),this.mySideButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myLeftSideButtonPosition=PP.vec3_create(0,0,-1e-5),this.myLeftSideButtonPosition[0]=-this._mySideButtonPanelHalfWidth+this.mySideButtonBackgroundScale[0]+this._mySideButtonDistanceFromBorder,this.myRightSideButtonPosition=PP.vec3_create(0,0,-1e-5),this.myRightSideButtonPosition[0]=-this.myLeftSideButtonPosition[0],this.myDisplayPanelPosition=PP.vec3_create(0,.1,0),this.myVariableLabelPanelPosition=PP.vec3_create(0,.025,this._myPanelZOffset),this.myVariableLabelTextScale=this.myLabelTextScale,this.myVariableLabelCursorTargetPosition=PP.vec3_create(0,0,0),this.myVariableLabelCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myVariableLabelCollisionExtents=PP.vec3_create(.065,.0175,1),this.myVariableLabelCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myNextButtonText=">",this.myPreviousButtonText="<",this._initializeBuildSetupHook();{let e=this._getBackPanelMaxX(),t=this._getBackPanelMinX(),n=this._getBackPanelMaxY(),a=this._getBackPanelMinY();this.myBackPanelPosition=[(e+t)/2,(n+a)/2,0],this.myBackBackgroundScale=[(e-t)/2,(n-a)/2,1],this.myBackBackgroundColor=[70/255,70/255,70/255,1]}this.myImportExportButtonBackgroundScale=PP.vec3_create(.04,.02,1),this.myImportExportButtonTextScale=this.myButtonTextScale,this.myImportExportButtonTextPosition=PP.vec3_create(0,0,.007),this.myImportExportPanelPosition=[0,this._getBackPanelMaxY()+this._mySideButtonDistanceFromBorder+this.myImportExportButtonBackgroundScale[1],this._myPanelZOffset],this.myImportExportButtonCursorTargetPosition=PP.vec3_create(0,0,0),this.myImportExportButtonCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myImportExportButtonCollisionExtents=this.myImportExportButtonBackgroundScale.slice(0),this.myImportExportButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myImportButtonText="Import",this.myExportButtonText="Export",this.myImportExportResetLabelSeconds=2,this.myImportingButtonText="...",this.myImportSuccessButtonText="Done",this.myImportFailureButtonText="Error",this.myExportingButtonText="...",this.myExportSuccessButtonText="Done",this.myExportFailureButtonText="Error",this.myImportButtonPosition=PP.vec3_create(0,0,-1e-5),this.myImportButtonPosition[0]=-this.myImportExportButtonBackgroundScale[0]-this._mySideButtonDistanceFromBorder/2,this.myExportButtonPosition=PP.vec3_create(0,0,-1e-5),this.myExportButtonPosition[0]=-this.myImportButtonPosition[0],this.myPointerCollisionExtents=this.myBackBackgroundScale.slice(0),this.myPointerCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myPointerCursorTargetPosition=this.myBackPanelPosition.slice(0),this.myPointerCursorTargetPosition[2]=this._myColliderZOffset-1e-4}_initializeRuntimeSetup(){this.myButtonHoverColor=[150/255,150/255,150/255,1],this.myScrollVariableDelay=.5,this._initializeRuntimeSetupHook()}}});var fo=S(()=>{PP.EasyTuneBoolArrayWidget=class extends PP.EasyTuneBaseWidget{constructor(e,t,n){super(e),this._mySetup=new PP.EasyTuneBoolArrayWidgetSetup(t),this._myUI=new PP.EasyTuneBoolArrayWidgetUI,this._myGamepad=n,this._myValueEditIndex=0,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myValueEditActive=!1}_refreshUIHook(){for(let e=0;e<this._mySetup.myArraySize;e++)this._myUI.myValueTextComponents[e].text=this._myVariable.myValue[e]?"true":"false"}_startHook(e,t){this._myUI.setAdditionalButtonsActive(t.myEnableAdditionalButtons)}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;this._myGamepad&&(t=this._myGamepad.getAxesInfo(PP.GamepadAxesID.THUMBSTICK).myAxes[1]);let n=0;this._myValueEditActive?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),Math.abs(n)>this._mySetup.myThumbstickToggleThreshold&&(this._myVariable.myValue[this._myValueEditIndex]=n>0,this._refreshUI())}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.addClickFunction(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,e.myVariableLabelText,this._mySetup.myVariableLabelTextScale));for(let t=0;t<this._mySetup.myArraySize;t++)e.myValueIncreaseButtonCursorTargetComponents[t].addDownFunction(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].addUpFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].addDownFunction(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].addUpFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].addHoverFunction(this._genericHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueIncreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._genericUnHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].addHoverFunction(this._genericHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._genericUnHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueCursorTargetComponents[t].addClickFunction(this._resetValue.bind(this,t)),e.myValueCursorTargetComponents[t].addHoverFunction(this._setValueEditActive.bind(this,t,e.myValueTexts[t],!0)),e.myValueCursorTargetComponents[t].addUnHoverFunction(this._setValueEditActive.bind(this,t,e.myValueTexts[t],!1))}_setValueEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myValueButtonEditIntensityTimer=this._mySetup.myButtonEditDelay,this._myValueEditIndex=e),this._myValueButtonEditIntensity=t)}_setValueEditActive(e,t,n){(this._isActive()||!n)&&(n?(this._myValueEditIndex=e,t.scale(this._mySetup.myTextHoverScaleMultiplier)):t.scalingWorld=this._mySetup.myValueTextScale,this._myValueEditActive=n)}_resetValue(e){this._isActive()&&(this._myVariable.myValue[e]=this._myVariable.myDefaultValue[e],this._myUI.myValueTextComponents[e].text=this._myVariable.myValue[e]?"true":"false")}_resetAllValues(){for(let e=0;e<this._mySetup.myArraySize;e++)this._resetValue(e)}_genericTextHover(e){e.scale(this._mySetup.myTextHoverScaleMultiplier)}_genericTextUnHover(e,t){e.scalingWorld=t}}});var vo=S(()=>{PP.EasyTuneBoolArrayWidgetUI=class extends PP.EasyTuneBaseWidgetUI{setAdditionalButtonsActive(e){this._myAdditionalButtonsActive=e;for(let t=0;t<this._mySetup.myArraySize;t++)this.myValueIncreaseButtonPanels[t].pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myValueDecreaseButtonPanels[t].pp_setActiveHierarchy(this._myAdditionalButtonsActive)}_buildHook(){this._myAdditionalButtonsActive=!0}_createSkeletonHook(){this.myValuesPanel=WL.scene.addObject(this.myDisplayPanel),this.myValuePanels=[],this.myValueTexts=[],this.myValueCursorTargets=[],this.myValueIncreaseButtonPanels=[],this.myValueIncreaseButtonBackgrounds=[],this.myValueIncreaseButtonTexts=[],this.myValueIncreaseButtonCursorTargets=[],this.myValueDecreaseButtonPanels=[],this.myValueDecreaseButtonBackgrounds=[],this.myValueDecreaseButtonTexts=[],this.myValueDecreaseButtonCursorTargets=[];for(let e=0;e<this._mySetup.myArraySize;e++)this.myValuePanels[e]=WL.scene.addObject(this.myValuesPanel),this.myValueTexts[e]=WL.scene.addObject(this.myValuePanels[e]),this.myValueCursorTargets[e]=WL.scene.addObject(this.myValuePanels[e]),this.myValueIncreaseButtonPanels[e]=WL.scene.addObject(this.myValuePanels[e]),this.myValueIncreaseButtonBackgrounds[e]=WL.scene.addObject(this.myValueIncreaseButtonPanels[e]),this.myValueIncreaseButtonTexts[e]=WL.scene.addObject(this.myValueIncreaseButtonPanels[e]),this.myValueIncreaseButtonCursorTargets[e]=WL.scene.addObject(this.myValueIncreaseButtonPanels[e]),this.myValueDecreaseButtonPanels[e]=WL.scene.addObject(this.myValuePanels[e]),this.myValueDecreaseButtonBackgrounds[e]=WL.scene.addObject(this.myValueDecreaseButtonPanels[e]),this.myValueDecreaseButtonTexts[e]=WL.scene.addObject(this.myValueDecreaseButtonPanels[e]),this.myValueDecreaseButtonCursorTargets[e]=WL.scene.addObject(this.myValueDecreaseButtonPanels[e])}_setTransformHook(){this.myValuesPanel.setTranslationLocal(this._mySetup.myValuesPanelPosition);for(let e=0;e<this._mySetup.myArraySize;e++)this.myValuePanels[e].setTranslationLocal(this._mySetup.myValuePanelsPositions[e]),this.myValueTexts[e].scale(this._mySetup.myValueTextScale),this.myValueCursorTargets[e].setTranslationLocal(this._mySetup.myValueCursorTargetPosition),this.myValueIncreaseButtonPanels[e].setTranslationLocal(this._mySetup.myRightSideButtonPosition),this.myValueIncreaseButtonBackgrounds[e].scale(this._mySetup.mySideButtonBackgroundScale),this.myValueIncreaseButtonTexts[e].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myValueIncreaseButtonTexts[e].scale(this._mySetup.mySideButtonTextScale),this.myValueIncreaseButtonCursorTargets[e].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myValueDecreaseButtonPanels[e].setTranslationLocal(this._mySetup.myLeftSideButtonPosition),this.myValueDecreaseButtonBackgrounds[e].scale(this._mySetup.mySideButtonBackgroundScale),this.myValueDecreaseButtonTexts[e].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myValueDecreaseButtonTexts[e].scale(this._mySetup.mySideButtonTextScale),this.myValueDecreaseButtonCursorTargets[e].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myValueTextComponents=[],this.myValueCursorTargetComponents=[],this.myValueCollisionComponents=[],this.myValueIncreaseButtonBackgroundComponents=[],this.myValueIncreaseButtonTextComponents=[],this.myValueIncreaseButtonCursorTargetComponents=[],this.myValueIncreaseButtonCollisionComponents=[],this.myValueDecreaseButtonBackgroundComponents=[],this.myValueDecreaseButtonTextComponents=[],this.myValueDecreaseButtonCursorTargetComponents=[],this.myValueDecreaseButtonCollisionComponents=[];for(let e=0;e<this._mySetup.myArraySize;e++)this.myValueTextComponents[e]=this.myValueTexts[e].addComponent("text"),this._setupTextComponent(this.myValueTextComponents[e]),this.myValueTextComponents[e].text=" ",this.myValueCursorTargetComponents[e]=this.myValueCursorTargets[e].addComponent("cursor-target"),this.myValueCollisionComponents[e]=this.myValueCursorTargets[e].addComponent("collision"),this.myValueCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueCollisionComponents[e].extents=this._mySetup.myValueCollisionExtents,this.myValueIncreaseButtonBackgroundComponents[e]=this.myValueIncreaseButtonBackgrounds[e].addComponent("mesh"),this.myValueIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueIncreaseButtonBackgroundComponents[e].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myValueIncreaseButtonBackgroundComponents[e].material.color=this._mySetup.myBackgroundColor,this.myValueIncreaseButtonTextComponents[e]=this.myValueIncreaseButtonTexts[e].addComponent("text"),this._setupTextComponent(this.myValueIncreaseButtonTextComponents[e]),this.myValueIncreaseButtonTextComponents[e].text=this._mySetup.myIncreaseButtonText,this.myValueIncreaseButtonCursorTargetComponents[e]=this.myValueIncreaseButtonCursorTargets[e].addComponent("cursor-target"),this.myValueIncreaseButtonCollisionComponents[e]=this.myValueIncreaseButtonCursorTargets[e].addComponent("collision"),this.myValueIncreaseButtonCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueIncreaseButtonCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueIncreaseButtonCollisionComponents[e].extents=this._mySetup.mySideButtonCollisionExtents,this.myValueDecreaseButtonBackgroundComponents[e]=this.myValueDecreaseButtonBackgrounds[e].addComponent("mesh"),this.myValueDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueDecreaseButtonBackgroundComponents[e].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myValueDecreaseButtonBackgroundComponents[e].material.color=this._mySetup.myBackgroundColor,this.myValueDecreaseButtonTextComponents[e]=this.myValueDecreaseButtonTexts[e].addComponent("text"),this._setupTextComponent(this.myValueDecreaseButtonTextComponents[e]),this.myValueDecreaseButtonTextComponents[e].text=this._mySetup.myDecreaseButtonText,this.myValueDecreaseButtonCursorTargetComponents[e]=this.myValueDecreaseButtonCursorTargets[e].addComponent("cursor-target"),this.myValueDecreaseButtonCollisionComponents[e]=this.myValueDecreaseButtonCursorTargets[e].addComponent("collision"),this.myValueDecreaseButtonCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueDecreaseButtonCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueDecreaseButtonCollisionComponents[e].extents=this._mySetup.mySideButtonCollisionExtents}_setVisibleHook(e){e&&this.setAdditionalButtonsActive(this._myAdditionalButtonsActive)}}});var To=S(()=>{PP.EasyTuneBoolArrayWidgetSetup=class extends PP.EasyTuneBaseWidgetSetup{constructor(e){super(),this.myArraySize=e}_getBackPanelMinY(){let e=this.myValuePanelsPositions[this.myArraySize-1]?this.myValuePanelsPositions[this.myArraySize-1][1]:0;return super._getBackPanelMinY()+this.myValuesPanelPosition[1]+e}_getPivotZOffset(){return .00802713}_initializeBuildSetupHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValuesPanelPosition=[0,this.myVariableLabelPanelPosition[1]-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myValueTextScale=PP.vec3_create(.4,.4,.4),this.myValueCursorTargetPosition=PP.vec3_create(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=PP.vec3_create(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=PP.vec3_create(0,0,0);for(let e=1;e<this.myArraySize;e++)this.myValuePanelsPositions[e]=this.myValuePanelsPositions[e-1].slice(0),this.myValuePanelsPositions[e][1]-=this._myDistanceBetweenValues}_initializeRuntimeSetupHook(){this.myTextHoverScaleMultiplier=PP.vec3_create(1.25,1.25,1.25),this.myThumbstickToggleThreshold=.6,this.myButtonEditDelay=0}}});var Co=S(()=>{PP.EasyTuneBoolArrayWidgetSelector=class{constructor(e,t){this._myGamepad=t,this._myParentObject=null,this._myParams=e,this._myAdditionalSetup=null,this._myWidgets=new Map,this._myVariable=null,this._myIsVisible=!0,this._myAppendToVariableName=null,this._myScrollVariableRequestCallbacks=new Map,this._myCurrentArraySize=0}setEasyTuneVariable(e,t){this._myVariable=e,this._myCurrentArraySize=this._myVariable.myValue.length,this._myAppendToVariableName=t,this._myWidgets.has(this._myCurrentArraySize)||this._createWidget(this._myCurrentArraySize);let n=this._myWidgets.get(this._myCurrentArraySize);n&&n.setEasyTuneVariable(e,t),this.setVisible(this._myIsVisible)}setVisible(e){for(let t of this._myWidgets.values())t.setVisible(!1);if(this._myVariable){this._sizeChangedCheck();let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.setVisible(e)}this._myIsVisible=e}isScrollVariableActive(){let e=this._myWidgets.get(this._myCurrentArraySize);return e?e.isScrollVariableActive():!1}getScrollVariableDirection(){let e=this._myWidgets.get(this._myCurrentArraySize);return e?e.getScrollVariableDirection():0}setScrollVariableActive(e,t){let n=this._myWidgets.get(this._myCurrentArraySize);n&&n.setScrollVariableActive(e,t)}getWidget(){return this._myWidgets.get(this._myCurrentArraySize)}registerScrollVariableRequestEventListener(e,t){this._myScrollVariableRequestCallbacks.set(e,t)}unregisterScrollVariableRequestEventListener(e){this._myScrollVariableRequestCallbacks.delete(e)}start(e,t){this._myParentObject=e,this._myAdditionalSetup=t,this._createWidget(1),this._myVariable&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}update(e){if(this._isActive()){this._sizeChangedCheck();let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.update(e)}}onImportSuccess(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onImportSuccess()}onImportFailure(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onImportFailure()}onExportSuccess(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onExportSuccess()}onExportFailure(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onExportFailure()}_isActive(){return this._myIsVisible&&this._myVariable}_scrollVariableRequest(e){for(let t of this._myScrollVariableRequestCallbacks.values())t(e)}_createWidget(e){this._myWidgets.set(e,new PP.EasyTuneBoolArrayWidget(this._myParams,e,this._myGamepad)),this._myWidgets.get(e).start(this._myParentObject,this._myAdditionalSetup),this._myWidgets.get(e).setVisible(!1),this._myWidgets.get(e).registerScrollVariableRequestEventListener(this,this._scrollVariableRequest.bind(this))}_sizeChangedCheck(){this._myVariable.myValue.length!=this._myCurrentArraySize&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}}});var So=S(()=>{PP.EasyTuneNoneWidget=class extends PP.EasyTuneBaseWidget{constructor(e){super(e),this._mySetup=new PP.EasyTuneNoneWidgetSetup,this._myUI=new PP.EasyTuneNoneWidgetUI}}});var bo=S(()=>{PP.EasyTuneNoneWidgetUI=class extends PP.EasyTuneBaseWidgetUI{_createSkeletonHook(){this.myTypeNotSupportedPanel=WL.scene.addObject(this.myDisplayPanel),this.myTypeNotSupportedText=WL.scene.addObject(this.myTypeNotSupportedPanel),this.myTypeNotSupportedCursorTarget=WL.scene.addObject(this.myTypeNotSupportedPanel)}_setTransformHook(){this.myTypeNotSupportedPanel.setTranslationLocal(this._mySetup.myTypeNotSupportedPanelPosition),this.myTypeNotSupportedText.scale(this._mySetup.myTypeNotSupportedTextScale)}_addComponentsHook(){this.myTypeNotSupportedTextComponent=this.myTypeNotSupportedText.addComponent("text"),this._setupTextComponent(this.myTypeNotSupportedTextComponent),this.myTypeNotSupportedTextComponent.text=this._mySetup.myTypeNotSupportedText}}});var Mo=S(()=>{PP.EasyTuneNoneWidgetSetup=class extends PP.EasyTuneBaseWidgetSetup{_getBackPanelMinY(){return super._getBackPanelMinY()+this.myTypeNotSupportedPanelPosition[1]}_getPivotZOffset(){return .00804713}_initializeBuildSetupHook(){this.myTypeNotSupportedPanelPosition=PP.vec3_create(0,-.03,this._myPanelZOffset),this.myTypeNotSupportedTextScale=PP.vec3_create(.275,.275,.275),this.myTypeNotSupportedText="Type Not Supported"}}});var Ao=S(()=>{PP.EasyTuneNumberArrayWidget=class extends PP.EasyTuneBaseWidget{constructor(e,t,n){super(e),this._myGamepad=n,this._mySetup=new PP.EasyTuneNumberArrayWidgetSetup(t),this._myUI=new PP.EasyTuneNumberArrayWidgetUI,this._myValueEditIndex=-1,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myStepButtonEditIntensity=0,this._myStepButtonEditIntensityTimer=0,this._myValueEditActive=!1,this._myStepEditActive=!1,this._myValueRealValue=0,this._myStepMultiplierValue=0,this._myStepFastEdit=!1}_setEasyTuneVariableHook(){this._myValueEditIndex>=0&&(this._myValueRealValue=this._myVariable.myValue[this._myValueEditIndex])}_refreshUIHook(){for(let e=0;e<this._mySetup.myArraySize;e++)this._myUI.myValueTextComponents[e].text=this._myVariable.myValue[e].toFixed(this._myVariable.myDecimalPlaces);this._myUI.myStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myStepPerSecond)}_startHook(e,t){this._myUI.setAdditionalButtonsActive(t.myEnableAdditionalButtons)}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;if(this._myGamepad){let s=this._myGamepad.getAxesInfo(PP.GamepadAxesID.THUMBSTICK).myAxes[1];if(Math.abs(s)>this._mySetup.myEditThumbstickMinThreshold){let o=(Math.abs(s)-this._mySetup.myEditThumbstickMinThreshold)/(1-this._mySetup.myEditThumbstickMinThreshold);t=Math.sign(s)*o}}let n=0;if(this._myValueEditActive?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),n!=0){let s=n*this._myVariable.myStepPerSecond*e;this._myValueRealValue+=s,this._myVariable.myMin!=null&&this._myVariable.myMax!=null?this._myValueRealValue=Math.pp_clamp(this._myValueRealValue,this._myVariable.myMin,this._myVariable.myMax):this._myVariable.myMin!=null?this._myValueRealValue=Math.max(this._myValueRealValue,this._myVariable.myMin):this._myVariable.myMax!=null&&(this._myValueRealValue=Math.min(this._myValueRealValue,this._myVariable.myMax));let o=Math.pow(10,this._myVariable.myDecimalPlaces);if(this._myVariable.myEditAllValuesTogether){let m=Math.round(this._myValueRealValue*o+Number.EPSILON)/o-this._myVariable.myValue[this._myValueEditIndex];for(let c=0;c<this._mySetup.myArraySize;c++)this._myVariable.myValue[c]=Math.round((this._myVariable.myValue[c]+m)*o+Number.EPSILON)/o,this._myVariable.myMin!=null&&this._myVariable.myMax!=null?this._myVariable.myValue[c]=Math.pp_clamp(this._myVariable.myValue[c],this._myVariable.myMin,this._myVariable.myMax):this._myVariable.myMin!=null?this._myVariable.myValue[c]=Math.max(this._myVariable.myValue[c],this._myVariable.myMin):this._myVariable.myMax!=null&&(this._myVariable.myValue[c]=Math.min(this._myVariable.myValue[c],this._myVariable.myMax)),this._myUI.myValueTextComponents[c].text=this._myVariable.myValue[c].toFixed(this._myVariable.myDecimalPlaces)}else this._myVariable.myValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*o+Number.EPSILON)/o,this._myVariable.myMin!=null&&this._myVariable.myMax!=null?this._myVariable.myValue[this._myValueEditIndex]=Math.pp_clamp(this._myVariable.myValue[this._myValueEditIndex],this._myVariable.myMin,this._myVariable.myMax):this._myVariable.myMin!=null?this._myVariable.myValue[this._myValueEditIndex]=Math.max(this._myVariable.myValue[this._myValueEditIndex],this._myVariable.myMin):this._myVariable.myMax!=null&&(this._myVariable.myValue[this._myValueEditIndex]=Math.min(this._myVariable.myValue[this._myValueEditIndex],this._myVariable.myMax)),this._myUI.myValueTextComponents[this._myValueEditIndex].text=this._myVariable.myValue[this._myValueEditIndex].toFixed(this._myVariable.myDecimalPlaces)}else this._myValueRealValue=this._myVariable.myValue[this._myValueEditIndex];let a=0;if(this._myStepEditActive?a=t:this._myStepButtonEditIntensity!=0&&(this._myStepButtonEditIntensityTimer<=0?a=this._myStepButtonEditIntensity:this._myStepButtonEditIntensityTimer-=e),a!=0){let s=0;this._myStepFastEdit?(s=Math.sign(a)*1,this._myStepFastEdit=!1):s=a*this._mySetup.myStepMultiplierStepPerSecond*e,this._myStepMultiplierValue+=s,Math.abs(this._myStepMultiplierValue)>=1&&(Math.sign(this._myStepMultiplierValue)>0?(this._myStepMultiplierValue-=1,this._changeStep(this._myVariable.myStepPerSecond*10)):(this._myStepMultiplierValue+=1,this._changeStep(this._myVariable.myStepPerSecond*.1)))}else this._myStepMultiplierValue=0,this._myStepFastEdit=!0}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.addClickFunction(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,e.myVariableLabelText,this._mySetup.myVariableLabelTextScale));for(let t=0;t<this._mySetup.myArraySize;t++)e.myValueIncreaseButtonCursorTargetComponents[t].addDownFunction(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].addUpFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].addDownFunction(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].addUpFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].addHoverFunction(this._genericHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueIncreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._genericUnHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].addHoverFunction(this._genericHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._genericUnHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueCursorTargetComponents[t].addClickFunction(this._resetValue.bind(this,t)),e.myValueCursorTargetComponents[t].addHoverFunction(this._setValueEditActive.bind(this,t,e.myValueTexts[t],!0)),e.myValueCursorTargetComponents[t].addUnHoverFunction(this._setValueEditActive.bind(this,t,e.myValueTexts[t],!1));e.myStepCursorTargetComponent.addClickFunction(this._resetStep.bind(this)),e.myStepCursorTargetComponent.addHoverFunction(this._setStepEditActive.bind(this,e.myStepText,!0)),e.myStepCursorTargetComponent.addUnHoverFunction(this._setStepEditActive.bind(this,e.myStepText,!1)),e.myStepIncreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,1)),e.myStepIncreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,1)),e.myStepIncreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,0)),e.myStepIncreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,0)),e.myStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,0)),e.myStepDecreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,-1)),e.myStepDecreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,-1)),e.myStepDecreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,0)),e.myStepDecreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,0)),e.myStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,0)),e.myStepIncreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myStepIncreaseButtonBackgroundComponent.material)),e.myStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myStepIncreaseButtonBackgroundComponent.material)),e.myStepDecreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myStepDecreaseButtonBackgroundComponent.material)),e.myStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myStepDecreaseButtonBackgroundComponent.material))}_setValueEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myValueButtonEditIntensityTimer=this._mySetup.myButtonEditDelay,this._myValueRealValue=this._myVariable.myValue[e],this._myValueEditIndex=e),this._myValueButtonEditIntensity=t)}_setStepEditIntensity(e){(this._isActive()||e==0)&&(e!=0&&(this._myStepButtonEditIntensityTimer=this._mySetup.myButtonEditDelay),this._myStepButtonEditIntensity=e)}_setValueEditActive(e,t,n){(this._isActive()||!n)&&(n?(this._myValueRealValue=this._myVariable.myValue[e],this._myValueEditIndex=e,t.scale(this._mySetup.myTextHoverScaleMultiplier)):t.scalingWorld=this._mySetup.myValueTextScale,this._myValueEditActive=n)}_setStepEditActive(e,t){(this._isActive()||!t)&&(t?e.scale(this._mySetup.myTextHoverScaleMultiplier):e.scalingWorld=this._mySetup.myStepTextScale,this._myStepEditActive=t)}_resetValue(e){this._isActive()&&(this._myVariable.myValue[e]=this._myVariable.myDefaultValue[e],this._myUI.myValueTextComponents[e].text=this._myVariable.myValue[e].toFixed(this._myVariable.myDecimalPlaces))}_resetAllValues(){for(let e=0;e<this._mySetup.myArraySize;e++)this._resetValue(e)}_resetStep(){this._isActive()&&this._changeStep(this._myVariable.myDefaultStepPerSecond)}_changeStep(e){e=Math.pp_roundDecimal(e,10),this._myVariable.myStepPerSecond=e,this._myUI.myStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myStepPerSecond)}_genericTextHover(e){e.scale(this._mySetup.myTextHoverScaleMultiplier)}_genericTextUnHover(e,t){e.scalingWorld=t}}});var Io=S(()=>{PP.EasyTuneNumberArrayWidgetUI=class extends PP.EasyTuneBaseWidgetUI{setAdditionalButtonsActive(e){this._myAdditionalButtonsActive=e;for(let t=0;t<this._mySetup.myArraySize;t++)this.myValueIncreaseButtonPanels[t].pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myValueDecreaseButtonPanels[t].pp_setActiveHierarchy(this._myAdditionalButtonsActive);this.myStepIncreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myStepDecreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive)}_buildHook(){this._myAdditionalButtonsActive=!0}_createSkeletonHook(){this.myValuesPanel=WL.scene.addObject(this.myDisplayPanel),this.myValuePanels=[],this.myValueTexts=[],this.myValueCursorTargets=[],this.myValueIncreaseButtonPanels=[],this.myValueIncreaseButtonBackgrounds=[],this.myValueIncreaseButtonTexts=[],this.myValueIncreaseButtonCursorTargets=[],this.myValueDecreaseButtonPanels=[],this.myValueDecreaseButtonBackgrounds=[],this.myValueDecreaseButtonTexts=[],this.myValueDecreaseButtonCursorTargets=[];for(let e=0;e<this._mySetup.myArraySize;e++)this.myValuePanels[e]=WL.scene.addObject(this.myValuesPanel),this.myValueTexts[e]=WL.scene.addObject(this.myValuePanels[e]),this.myValueCursorTargets[e]=WL.scene.addObject(this.myValuePanels[e]),this.myValueIncreaseButtonPanels[e]=WL.scene.addObject(this.myValuePanels[e]),this.myValueIncreaseButtonBackgrounds[e]=WL.scene.addObject(this.myValueIncreaseButtonPanels[e]),this.myValueIncreaseButtonTexts[e]=WL.scene.addObject(this.myValueIncreaseButtonPanels[e]),this.myValueIncreaseButtonCursorTargets[e]=WL.scene.addObject(this.myValueIncreaseButtonPanels[e]),this.myValueDecreaseButtonPanels[e]=WL.scene.addObject(this.myValuePanels[e]),this.myValueDecreaseButtonBackgrounds[e]=WL.scene.addObject(this.myValueDecreaseButtonPanels[e]),this.myValueDecreaseButtonTexts[e]=WL.scene.addObject(this.myValueDecreaseButtonPanels[e]),this.myValueDecreaseButtonCursorTargets[e]=WL.scene.addObject(this.myValueDecreaseButtonPanels[e]);this.myStepPanel=WL.scene.addObject(this.myPivotObject),this.myStepText=WL.scene.addObject(this.myStepPanel),this.myStepCursorTarget=WL.scene.addObject(this.myStepPanel),this.myStepIncreaseButtonPanel=WL.scene.addObject(this.myStepPanel),this.myStepIncreaseButtonBackground=WL.scene.addObject(this.myStepIncreaseButtonPanel),this.myStepIncreaseButtonText=WL.scene.addObject(this.myStepIncreaseButtonPanel),this.myStepIncreaseButtonCursorTarget=WL.scene.addObject(this.myStepIncreaseButtonPanel),this.myStepDecreaseButtonPanel=WL.scene.addObject(this.myStepPanel),this.myStepDecreaseButtonBackground=WL.scene.addObject(this.myStepDecreaseButtonPanel),this.myStepDecreaseButtonText=WL.scene.addObject(this.myStepDecreaseButtonPanel),this.myStepDecreaseButtonCursorTarget=WL.scene.addObject(this.myStepDecreaseButtonPanel)}_setTransformHook(){this.myValuesPanel.setTranslationLocal(this._mySetup.myValuesPanelPosition);for(let e=0;e<this._mySetup.myArraySize;e++)this.myValuePanels[e].setTranslationLocal(this._mySetup.myValuePanelsPositions[e]),this.myValueTexts[e].scale(this._mySetup.myValueTextScale),this.myValueCursorTargets[e].setTranslationLocal(this._mySetup.myValueCursorTargetPosition),this.myValueIncreaseButtonPanels[e].setTranslationLocal(this._mySetup.myRightSideButtonPosition),this.myValueIncreaseButtonBackgrounds[e].scale(this._mySetup.mySideButtonBackgroundScale),this.myValueIncreaseButtonTexts[e].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myValueIncreaseButtonTexts[e].scale(this._mySetup.mySideButtonTextScale),this.myValueIncreaseButtonCursorTargets[e].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myValueDecreaseButtonPanels[e].setTranslationLocal(this._mySetup.myLeftSideButtonPosition),this.myValueDecreaseButtonBackgrounds[e].scale(this._mySetup.mySideButtonBackgroundScale),this.myValueDecreaseButtonTexts[e].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myValueDecreaseButtonTexts[e].scale(this._mySetup.mySideButtonTextScale),this.myValueDecreaseButtonCursorTargets[e].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition);this.myStepPanel.setTranslationLocal(this._mySetup.myStepPanelPosition),this.myStepText.scale(this._mySetup.myStepTextScale),this.myStepCursorTarget.setTranslationLocal(this._mySetup.myStepCursorTargetPosition),this.myStepIncreaseButtonPanel.setTranslationLocal(this._mySetup.myRightSideButtonPosition),this.myStepIncreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myStepIncreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myStepIncreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myStepIncreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myStepDecreaseButtonPanel.setTranslationLocal(this._mySetup.myLeftSideButtonPosition),this.myStepDecreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myStepDecreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myStepDecreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myStepDecreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myValueTextComponents=[],this.myValueCursorTargetComponents=[],this.myValueCollisionComponents=[],this.myValueIncreaseButtonBackgroundComponents=[],this.myValueIncreaseButtonTextComponents=[],this.myValueIncreaseButtonCursorTargetComponents=[],this.myValueIncreaseButtonCollisionComponents=[],this.myValueDecreaseButtonBackgroundComponents=[],this.myValueDecreaseButtonTextComponents=[],this.myValueDecreaseButtonCursorTargetComponents=[],this.myValueDecreaseButtonCollisionComponents=[];for(let e=0;e<this._mySetup.myArraySize;e++)this.myValueTextComponents[e]=this.myValueTexts[e].addComponent("text"),this._setupTextComponent(this.myValueTextComponents[e]),this.myValueTextComponents[e].text=" ",this.myValueCursorTargetComponents[e]=this.myValueCursorTargets[e].addComponent("cursor-target"),this.myValueCollisionComponents[e]=this.myValueCursorTargets[e].addComponent("collision"),this.myValueCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueCollisionComponents[e].extents=this._mySetup.myValueCollisionExtents,this.myValueIncreaseButtonBackgroundComponents[e]=this.myValueIncreaseButtonBackgrounds[e].addComponent("mesh"),this.myValueIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueIncreaseButtonBackgroundComponents[e].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myValueIncreaseButtonBackgroundComponents[e].material.color=this._mySetup.myBackgroundColor,this.myValueIncreaseButtonTextComponents[e]=this.myValueIncreaseButtonTexts[e].addComponent("text"),this._setupTextComponent(this.myValueIncreaseButtonTextComponents[e]),this.myValueIncreaseButtonTextComponents[e].text=this._mySetup.myIncreaseButtonText,this.myValueIncreaseButtonCursorTargetComponents[e]=this.myValueIncreaseButtonCursorTargets[e].addComponent("cursor-target"),this.myValueIncreaseButtonCollisionComponents[e]=this.myValueIncreaseButtonCursorTargets[e].addComponent("collision"),this.myValueIncreaseButtonCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueIncreaseButtonCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueIncreaseButtonCollisionComponents[e].extents=this._mySetup.mySideButtonCollisionExtents,this.myValueDecreaseButtonBackgroundComponents[e]=this.myValueDecreaseButtonBackgrounds[e].addComponent("mesh"),this.myValueDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueDecreaseButtonBackgroundComponents[e].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myValueDecreaseButtonBackgroundComponents[e].material.color=this._mySetup.myBackgroundColor,this.myValueDecreaseButtonTextComponents[e]=this.myValueDecreaseButtonTexts[e].addComponent("text"),this._setupTextComponent(this.myValueDecreaseButtonTextComponents[e]),this.myValueDecreaseButtonTextComponents[e].text=this._mySetup.myDecreaseButtonText,this.myValueDecreaseButtonCursorTargetComponents[e]=this.myValueDecreaseButtonCursorTargets[e].addComponent("cursor-target"),this.myValueDecreaseButtonCollisionComponents[e]=this.myValueDecreaseButtonCursorTargets[e].addComponent("collision"),this.myValueDecreaseButtonCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myValueDecreaseButtonCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myValueDecreaseButtonCollisionComponents[e].extents=this._mySetup.mySideButtonCollisionExtents;this.myStepTextComponent=this.myStepText.addComponent("text"),this._setupTextComponent(this.myStepTextComponent),this.myStepTextComponent.text=" ",this.myStepCursorTargetComponent=this.myStepCursorTarget.addComponent("cursor-target"),this.myStepCollisionComponent=this.myStepCursorTarget.addComponent("collision"),this.myStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myStepIncreaseButtonBackgroundComponent=this.myStepIncreaseButtonBackground.addComponent("mesh"),this.myStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myStepIncreaseButtonTextComponent=this.myStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myStepIncreaseButtonTextComponent),this.myStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myStepIncreaseButtonCursorTargetComponent=this.myStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myStepIncreaseButtonCollisionComponent=this.myStepIncreaseButtonCursorTarget.addComponent("collision"),this.myStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myStepDecreaseButtonBackgroundComponent=this.myStepDecreaseButtonBackground.addComponent("mesh"),this.myStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myStepDecreaseButtonTextComponent=this.myStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myStepDecreaseButtonTextComponent),this.myStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myStepDecreaseButtonCursorTargetComponent=this.myStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myStepDecreaseButtonCollisionComponent=this.myStepDecreaseButtonCursorTarget.addComponent("collision"),this.myStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents}_setVisibleHook(e){e&&this.setAdditionalButtonsActive(this._myAdditionalButtonsActive)}}});var xo=S(()=>{PP.EasyTuneNumberArrayWidgetSetup=class extends PP.EasyTuneBaseWidgetSetup{constructor(e){super(),this.myArraySize=e}_getBackPanelMinY(){return this.myStepPanelPosition[1]-this._mySideButtonDistanceFromBorder*1.25-this.mySideButtonBackgroundScale[1]}_getPivotZOffset(){return .00803713}_initializeBuildSetupHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValuesPanelPosition=[0,this.myVariableLabelPanelPosition[1]-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myValueTextScale=PP.vec3_create(.4,.4,.4),this.myValueCursorTargetPosition=PP.vec3_create(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=PP.vec3_create(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=PP.vec3_create(0,0,0);for(let t=1;t<this.myArraySize;t++)this.myValuePanelsPositions[t]=this.myValuePanelsPositions[t-1].slice(0),this.myValuePanelsPositions[t][1]-=this._myDistanceBetweenValues;let e=this.myValuePanelsPositions[this.myArraySize-1]?this.myValuePanelsPositions[this.myArraySize-1][1]:0;this.myStepPanelPosition=[0,this.myDisplayPanelPosition[1]+this.myValuesPanelPosition[1]+e-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myStepTextScale=this.myLabelTextScale,this.myStepStartString="Step: ",this.myStepCursorTargetPosition=PP.vec3_create(0,0,0),this.myStepCursorTargetPosition[2]=this._myColliderZOffset-this.myStepPanelPosition[2],this.myStepCollisionExtents=PP.vec3_create(.065,.0175,1),this.myStepCollisionExtents[2]=this.myCursorTargetCollisionThickness}_initializeRuntimeSetupHook(){this.myTextHoverScaleMultiplier=PP.vec3_create(1.25,1.25,1.25),this.myEditThumbstickMinThreshold=.35,this.myStepMultiplierStepPerSecond=2.25,this.myButtonEditDelay=0}}});var Ro=S(()=>{PP.EasyTuneNumberArrayWidgetSelector=class{constructor(e,t){this._myGamepad=t,this._myParentObject=null,this._myParams=e,this._myAdditionalSetup=null,this._myWidgets=new Map,this._myVariable=null,this._myIsVisible=!0,this._myAppendToVariableName=null,this._myScrollVariableRequestCallbacks=new Map,this._myCurrentArraySize=0}setEasyTuneVariable(e,t){this._myVariable=e,this._myCurrentArraySize=this._myVariable.myValue.length,this._myAppendToVariableName=t,this._myWidgets.has(this._myCurrentArraySize)||this._createWidget(this._myCurrentArraySize);let n=this._myWidgets.get(this._myCurrentArraySize);n&&n.setEasyTuneVariable(e,t),this.setVisible(this._myIsVisible)}setVisible(e){for(let t of this._myWidgets.values())t.setVisible(!1);if(this._myVariable){this._sizeChangedCheck();let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.setVisible(e)}this._myIsVisible=e}isScrollVariableActive(){let e=this._myWidgets.get(this._myCurrentArraySize);return e?e.isScrollVariableActive():!1}getScrollVariableDirection(){let e=this._myWidgets.get(this._myCurrentArraySize);return e?e.getScrollVariableDirection():0}setScrollVariableActive(e,t){let n=this._myWidgets.get(this._myCurrentArraySize);n&&n.setScrollVariableActive(e,t)}getWidget(){return this._myWidgets.get(this._myCurrentArraySize)}registerScrollVariableRequestEventListener(e,t){this._myScrollVariableRequestCallbacks.set(e,t)}unregisterScrollVariableRequestEventListener(e){this._myScrollVariableRequestCallbacks.delete(e)}start(e,t){this._myParentObject=e,this._myAdditionalSetup=t,this._createWidget(1),this._myVariable&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}update(e){if(this._isActive()){this._sizeChangedCheck();let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.update(e)}}onImportSuccess(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onImportSuccess()}onImportFailure(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onImportFailure()}onExportSuccess(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onExportSuccess()}onExportFailure(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onExportFailure()}_isActive(){return this._myIsVisible&&this._myVariable}_scrollVariableRequest(e){for(let t of this._myScrollVariableRequestCallbacks.values())t(e)}_createWidget(e){this._myWidgets.set(e,new PP.EasyTuneNumberArrayWidget(this._myParams,e,this._myGamepad)),this._myWidgets.get(e).start(this._myParentObject,this._myAdditionalSetup),this._myWidgets.get(e).setVisible(!1),this._myWidgets.get(e).registerScrollVariableRequestEventListener(this,this._scrollVariableRequest.bind(this))}_sizeChangedCheck(){this._myVariable.myValue.length!=this._myCurrentArraySize&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}}});var Vo=S(()=>{PP.EasyTuneTransformWidget=class extends PP.EasyTuneBaseWidget{constructor(e,t){super(e),this._myGamepad=t,this._mySetup=new PP.EasyTuneTransformWidgetSetup,this._myUI=new PP.EasyTuneTransformWidgetUI,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myStepButtonEditIntensity=0,this._myStepButtonEditIntensityTimer=0,this._myValueEditActive=!1,this._myStepEditActive=!1,this._myValueRealValue=0,this._myComponentStepValue=0,this._myStepMultiplierValue=0,this._myStepFastEdit=!1,this._myValueEditIndex=-1,this._myComponentIndex=0,this._myStepIndex=0}_setEasyTuneVariableHook(){if(this._myValueEditIndex>=0)switch(this._myComponentIndex){case 0:this._myValueRealValue=this._myVariable.myPosition[this._myValueEditIndex],this._myComponentStepValue=this._myVariable.myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable.myRotation[this._myValueEditIndex],this._myComponentStepValue=this._myVariable.myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable.myScale[this._myValueEditIndex],this._myComponentStepValue=this._myVariable.myScaleStepPerSecond;break}}_refreshUIHook(){for(let e=0;e<3;e++)this._myUI.myPositionTextComponents[e].text=this._myVariable.myPosition[e].toFixed(this._myVariable.myDecimalPlaces);this._myUI.myPositionStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myPositionStepPerSecond);for(let e=0;e<3;e++)this._myUI.myRotationTextComponents[e].text=this._myVariable.myRotation[e].toFixed(this._myVariable.myDecimalPlaces);this._myUI.myRotationStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myRotationStepPerSecond);for(let e=0;e<3;e++)this._myUI.myScaleTextComponents[e].text=this._myVariable.myScale[e].toFixed(this._myVariable.myDecimalPlaces);this._myUI.myScaleStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myScaleStepPerSecond)}_startHook(e,t){this._myUI.setAdditionalButtonsActive(t.myEnableAdditionalButtons)}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;if(this._myGamepad){let s=this._myGamepad.getAxesInfo(PP.GamepadAxesID.THUMBSTICK).myAxes[1];if(Math.abs(s)>this._mySetup.myEditThumbstickMinThreshold){let o=(Math.abs(s)-this._mySetup.myEditThumbstickMinThreshold)/(1-this._mySetup.myEditThumbstickMinThreshold);t=Math.sign(s)*o}}let n=0;if(this._myValueEditActive?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),n!=0){let s=n*this._myComponentStepValue*e;this._myValueRealValue+=s;let o=Math.pow(10,this._myVariable.myDecimalPlaces);switch(this._myComponentIndex){case 0:this._myVariable.myPosition[this._myValueEditIndex]=Math.round(this._myValueRealValue*o+Number.EPSILON)/o,this._myUI.myPositionTextComponents[this._myValueEditIndex].text=this._myVariable.myPosition[this._myValueEditIndex].toFixed(this._myVariable.myDecimalPlaces);break;case 1:if(this._myValueRealValue>180){for(;this._myValueRealValue>180;)this._myValueRealValue-=180;this._myValueRealValue=-180+this._myValueRealValue}if(this._myValueRealValue<-180){for(;this._myValueRealValue<-180;)this._myValueRealValue+=180;this._myValueRealValue=180-this._myValueRealValue}this._myVariable.myRotation[this._myValueEditIndex]=Math.round(this._myValueRealValue*o+Number.EPSILON)/o,this._myUI.myRotationTextComponents[this._myValueEditIndex].text=this._myVariable.myRotation[this._myValueEditIndex].toFixed(this._myVariable.myDecimalPlaces);break;case 2:if(this._myValueRealValue<=0&&(this._myValueRealValue=1/o),this._myVariable.myScaleAsOne){let m=Math.round(this._myValueRealValue*o+Number.EPSILON)/o-this._myVariable.myScale[this._myValueEditIndex];for(let c=0;c<3;c++)this._myVariable.myScale[c]=Math.round((this._myVariable.myScale[c]+m)*o+Number.EPSILON)/o,this._myVariable.myScale[c]=Math.max(this._myVariable.myScale[c],1/o),this._myUI.myScaleTextComponents[c].text=this._myVariable.myScale[c].toFixed(this._myVariable.myDecimalPlaces)}else this._myVariable.myScale[this._myValueEditIndex]=Math.round(this._myValueRealValue*o+Number.EPSILON)/o,this._myVariable.myScale[this._myValueEditIndex]=Math.max(this._myVariable.myScale[this._myValueEditIndex],1/o),this._myUI.myScaleTextComponents[this._myValueEditIndex].text=this._myVariable.myScale[this._myValueEditIndex].toFixed(this._myVariable.myDecimalPlaces);break}}else switch(this._myComponentIndex){case 0:this._myValueRealValue=this._myVariable.myPosition[this._myValueEditIndex];break;case 1:this._myValueRealValue=this._myVariable.myRotation[this._myValueEditIndex];break;case 2:this._myValueRealValue=this._myVariable.myScale[this._myValueEditIndex];break}let a=0;if(this._myStepEditActive?a=t:this._myStepButtonEditIntensity!=0&&(this._myStepButtonEditIntensityTimer<=0?a=this._myStepButtonEditIntensity:this._myStepButtonEditIntensityTimer-=e),a!=0){let s=0;if(this._myStepFastEdit?(s=Math.sign(a)*1,this._myStepFastEdit=!1):s=a*this._mySetup.myStepMultiplierStepPerSecond*e,this._myStepMultiplierValue+=s,Math.abs(this._myStepMultiplierValue)>=1){let o=0;switch(this._myStepIndex){case 0:o=this._myVariable.myPositionStepPerSecond;break;case 1:o=this._myVariable.myRotationStepPerSecond;break;case 2:o=this._myVariable.myScaleStepPerSecond;break;default:o=0}Math.sign(this._myStepMultiplierValue)>0?(this._myStepMultiplierValue-=1,this._changeStep(this._myStepIndex,o*10)):(this._myStepMultiplierValue+=1,this._changeStep(this._myStepIndex,o*.1))}}else this._myStepMultiplierValue=0,this._myStepFastEdit=!0}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.addClickFunction(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,e.myVariableLabelText,this._mySetup.myVariableLabelTextScale)),e.myPositionLabelCursorTargetComponent.addClickFunction(this._resetComponentValues.bind(this,0)),e.myPositionLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,e.myPositionLabelText)),e.myPositionLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,e.myPositionLabelText,this._mySetup.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myPositionIncreaseButtonCursorTargetComponents[t].addDownFunction(this._setValueEditIntensity.bind(this,0,t,1)),e.myPositionIncreaseButtonCursorTargetComponents[t].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,0,t,1)),e.myPositionIncreaseButtonCursorTargetComponents[t].addUpFunction(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionIncreaseButtonCursorTargetComponents[t].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionIncreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionDecreaseButtonCursorTargetComponents[t].addDownFunction(this._setValueEditIntensity.bind(this,0,t,-1)),e.myPositionDecreaseButtonCursorTargetComponents[t].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,0,t,-1)),e.myPositionDecreaseButtonCursorTargetComponents[t].addUpFunction(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionDecreaseButtonCursorTargetComponents[t].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionDecreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionIncreaseButtonCursorTargetComponents[t].addHoverFunction(this._genericHover.bind(this,e.myPositionIncreaseButtonBackgroundComponents[t].material)),e.myPositionIncreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._genericUnHover.bind(this,e.myPositionIncreaseButtonBackgroundComponents[t].material)),e.myPositionDecreaseButtonCursorTargetComponents[t].addHoverFunction(this._genericHover.bind(this,e.myPositionDecreaseButtonBackgroundComponents[t].material)),e.myPositionDecreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._genericUnHover.bind(this,e.myPositionDecreaseButtonBackgroundComponents[t].material)),e.myPositionCursorTargetComponents[t].addClickFunction(this._resetValue.bind(this,0,t)),e.myPositionCursorTargetComponents[t].addHoverFunction(this._setValueEditActive.bind(this,0,t,e.myPositionTexts[t],!0)),e.myPositionCursorTargetComponents[t].addUnHoverFunction(this._setValueEditActive.bind(this,0,t,e.myPositionTexts[t],!1));e.myRotationLabelCursorTargetComponent.addClickFunction(this._resetComponentValues.bind(this,1)),e.myRotationLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,e.myRotationLabelText)),e.myRotationLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,e.myRotationLabelText,this._mySetup.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myRotationIncreaseButtonCursorTargetComponents[t].addDownFunction(this._setValueEditIntensity.bind(this,1,t,1)),e.myRotationIncreaseButtonCursorTargetComponents[t].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,1,t,1)),e.myRotationIncreaseButtonCursorTargetComponents[t].addUpFunction(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationIncreaseButtonCursorTargetComponents[t].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationIncreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationDecreaseButtonCursorTargetComponents[t].addDownFunction(this._setValueEditIntensity.bind(this,1,t,-1)),e.myRotationDecreaseButtonCursorTargetComponents[t].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,1,t,-1)),e.myRotationDecreaseButtonCursorTargetComponents[t].addUpFunction(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationDecreaseButtonCursorTargetComponents[t].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationDecreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationIncreaseButtonCursorTargetComponents[t].addHoverFunction(this._genericHover.bind(this,e.myRotationIncreaseButtonBackgroundComponents[t].material)),e.myRotationIncreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._genericUnHover.bind(this,e.myRotationIncreaseButtonBackgroundComponents[t].material)),e.myRotationDecreaseButtonCursorTargetComponents[t].addHoverFunction(this._genericHover.bind(this,e.myRotationDecreaseButtonBackgroundComponents[t].material)),e.myRotationDecreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._genericUnHover.bind(this,e.myRotationDecreaseButtonBackgroundComponents[t].material)),e.myRotationCursorTargetComponents[t].addClickFunction(this._resetValue.bind(this,1,t)),e.myRotationCursorTargetComponents[t].addHoverFunction(this._setValueEditActive.bind(this,1,t,e.myRotationTexts[t],!0)),e.myRotationCursorTargetComponents[t].addUnHoverFunction(this._setValueEditActive.bind(this,1,t,e.myRotationTexts[t],!1));e.myScaleLabelCursorTargetComponent.addClickFunction(this._resetComponentValues.bind(this,2)),e.myScaleLabelCursorTargetComponent.addHoverFunction(this._genericTextHover.bind(this,e.myScaleLabelText)),e.myScaleLabelCursorTargetComponent.addUnHoverFunction(this._genericTextUnHover.bind(this,e.myScaleLabelText,this._mySetup.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myScaleIncreaseButtonCursorTargetComponents[t].addDownFunction(this._setValueEditIntensity.bind(this,2,t,1)),e.myScaleIncreaseButtonCursorTargetComponents[t].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,2,t,1)),e.myScaleIncreaseButtonCursorTargetComponents[t].addUpFunction(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleIncreaseButtonCursorTargetComponents[t].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleIncreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleDecreaseButtonCursorTargetComponents[t].addDownFunction(this._setValueEditIntensity.bind(this,2,t,-1)),e.myScaleDecreaseButtonCursorTargetComponents[t].addDownOnHoverFunction(this._setValueEditIntensity.bind(this,2,t,-1)),e.myScaleDecreaseButtonCursorTargetComponents[t].addUpFunction(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleDecreaseButtonCursorTargetComponents[t].addUpWithNoDownFunction(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleDecreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleIncreaseButtonCursorTargetComponents[t].addHoverFunction(this._genericHover.bind(this,e.myScaleIncreaseButtonBackgroundComponents[t].material)),e.myScaleIncreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._genericUnHover.bind(this,e.myScaleIncreaseButtonBackgroundComponents[t].material)),e.myScaleDecreaseButtonCursorTargetComponents[t].addHoverFunction(this._genericHover.bind(this,e.myScaleDecreaseButtonBackgroundComponents[t].material)),e.myScaleDecreaseButtonCursorTargetComponents[t].addUnHoverFunction(this._genericUnHover.bind(this,e.myScaleDecreaseButtonBackgroundComponents[t].material)),e.myScaleCursorTargetComponents[t].addClickFunction(this._resetValue.bind(this,2,t)),e.myScaleCursorTargetComponents[t].addHoverFunction(this._setValueEditActive.bind(this,2,t,e.myScaleTexts[t],!0)),e.myScaleCursorTargetComponents[t].addUnHoverFunction(this._setValueEditActive.bind(this,2,t,e.myScaleTexts[t],!1));e.myPositionStepCursorTargetComponent.addClickFunction(this._resetStep.bind(this,0)),e.myPositionStepCursorTargetComponent.addHoverFunction(this._setStepEditActive.bind(this,0,e.myPositionStepText,!0)),e.myPositionStepCursorTargetComponent.addUnHoverFunction(this._setStepEditActive.bind(this,0,e.myPositionStepText,!1)),e.myPositionStepIncreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,0,1)),e.myPositionStepIncreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,0,1)),e.myPositionStepIncreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepIncreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepDecreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,0,-1)),e.myPositionStepDecreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,0,-1)),e.myPositionStepDecreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepDecreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepIncreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myPositionStepIncreaseButtonBackgroundComponent.material)),e.myPositionStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myPositionStepIncreaseButtonBackgroundComponent.material)),e.myPositionStepDecreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myPositionStepDecreaseButtonBackgroundComponent.material)),e.myPositionStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myPositionStepDecreaseButtonBackgroundComponent.material)),e.myRotationStepCursorTargetComponent.addClickFunction(this._resetStep.bind(this,1)),e.myRotationStepCursorTargetComponent.addHoverFunction(this._setStepEditActive.bind(this,1,e.myRotationStepText,!0)),e.myRotationStepCursorTargetComponent.addUnHoverFunction(this._setStepEditActive.bind(this,1,e.myRotationStepText,!1)),e.myRotationStepIncreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,1,1)),e.myRotationStepIncreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,1,1)),e.myRotationStepIncreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepIncreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepDecreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,1,-1)),e.myRotationStepDecreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,1,-1)),e.myRotationStepDecreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepDecreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepIncreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myRotationStepIncreaseButtonBackgroundComponent.material)),e.myRotationStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myRotationStepIncreaseButtonBackgroundComponent.material)),e.myRotationStepDecreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myRotationStepDecreaseButtonBackgroundComponent.material)),e.myRotationStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myRotationStepDecreaseButtonBackgroundComponent.material)),e.myScaleStepCursorTargetComponent.addClickFunction(this._resetStep.bind(this,2)),e.myScaleStepCursorTargetComponent.addHoverFunction(this._setStepEditActive.bind(this,2,e.myScaleStepText,!0)),e.myScaleStepCursorTargetComponent.addUnHoverFunction(this._setStepEditActive.bind(this,2,e.myScaleStepText,!1)),e.myScaleStepIncreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,2,1)),e.myScaleStepIncreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,2,1)),e.myScaleStepIncreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepIncreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepDecreaseButtonCursorTargetComponent.addDownFunction(this._setStepEditIntensity.bind(this,2,-1)),e.myScaleStepDecreaseButtonCursorTargetComponent.addDownOnHoverFunction(this._setStepEditIntensity.bind(this,2,-1)),e.myScaleStepDecreaseButtonCursorTargetComponent.addUpFunction(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepDecreaseButtonCursorTargetComponent.addUpWithNoDownFunction(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepIncreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myScaleStepIncreaseButtonBackgroundComponent.material)),e.myScaleStepIncreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myScaleStepIncreaseButtonBackgroundComponent.material)),e.myScaleStepDecreaseButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myScaleStepDecreaseButtonBackgroundComponent.material)),e.myScaleStepDecreaseButtonCursorTargetComponent.addUnHoverFunction(this._genericUnHover.bind(this,e.myScaleStepDecreaseButtonBackgroundComponent.material))}_setValueEditIntensity(e,t,n){if(this._isActive()||n==0){if(n!=0){switch(e){case 0:this._myValueRealValue=this._myVariable.myPosition[t],this._myComponentStepValue=this._myVariable.myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable.myRotation[t],this._myComponentStepValue=this._myVariable.myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable.myScale[t],this._myComponentStepValue=this._myVariable.myScaleStepPerSecond;break}this._myValueButtonEditIntensityTimer=this._mySetup.myButtonEditDelay,this._myValueEditIndex=t,this._myComponentIndex=e}this._myValueButtonEditIntensity=n}}_setStepEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myStepButtonEditIntensityTimer=this._mySetup.myButtonEditDelay),this._myStepButtonEditIntensity=t,this._myStepIndex=e)}_setValueEditActive(e,t,n,a){if(this._isActive()||!a){if(a){switch(e){case 0:this._myValueRealValue=this._myVariable.myPosition[t],this._myComponentStepValue=this._myVariable.myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable.myRotation[t],this._myComponentStepValue=this._myVariable.myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable.myScale[t],this._myComponentStepValue=this._myVariable.myScaleStepPerSecond;break}this._myValueEditIndex=t,this._myComponentIndex=e,n.scale(this._mySetup.myTextHoverScaleMultiplier)}else n.scalingWorld=this._mySetup.myValueTextScale;this._myValueEditActive=a}}_setStepEditActive(e,t,n){(this._isActive()||!n)&&(n?t.scale(this._mySetup.myTextHoverScaleMultiplier):t.scalingWorld=this._mySetup.myStepTextScale,this._myStepEditActive=n,this._myStepIndex=e)}_resetValue(e,t){if(this._isActive())switch(e){case 0:this._myVariable.myPosition[t]=this._myVariable.myDefaultPosition[t],this._myUI.myPositionTextComponents[t].text=this._myVariable.myPosition[t].toFixed(this._myVariable.myDecimalPlaces);break;case 1:this._myVariable.myRotation[t]=this._myVariable.myDefaultRotation[t],this._myUI.myRotationTextComponents[t].text=this._myVariable.myRotation[t].toFixed(this._myVariable.myDecimalPlaces);break;case 2:this._myVariable.myScale[t]=this._myVariable.myDefaultScale[t],this._myUI.myScaleTextComponents[t].text=this._myVariable.myScale[t].toFixed(this._myVariable.myDecimalPlaces);break;default:defaultValue=0}}_resetAllValues(){for(let e=0;e<3;e++)this._resetComponentValues(e)}_resetComponentValues(e){for(let t=0;t<3;t++)this._resetValue(e,t)}_resetStep(e){if(this._isActive()){let t=0;switch(e){case 0:t=this._myVariable.myDefaultPositionStepPerSecond;break;case 1:t=this._myVariable.myDefaultRotationStepPerSecond;break;case 2:t=this._myVariable.myDefaultScaleStepPerSecond;break;default:t=0}this._changeStep(e,t)}}_changeStep(e,t){switch(t=Math.pp_roundDecimal(t,10),e){case 0:this._myVariable.myPositionStepPerSecond=t,this._myUI.myPositionStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myPositionStepPerSecond);break;case 1:this._myVariable.myRotationStepPerSecond=t,this._myUI.myRotationStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myRotationStepPerSecond);break;case 2:this._myVariable.myScaleStepPerSecond=t,this._myUI.myScaleStepTextComponent.text=this._mySetup.myStepStartString.concat(this._myVariable.myScaleStepPerSecond);break}}_genericTextHover(e){e.scale(this._mySetup.myTextHoverScaleMultiplier)}_genericTextUnHover(e,t){e.scalingWorld=t}}});var Do=S(()=>{PP.EasyTuneTransformWidgetUI=class extends PP.EasyTuneBaseWidgetUI{setAdditionalButtonsActive(e){this._myAdditionalButtonsActive=e;for(let t=0;t<3;t++)this.myPositionIncreaseButtonPanels[t].pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myPositionDecreaseButtonPanels[t].pp_setActiveHierarchy(this._myAdditionalButtonsActive);this.myPositionStepIncreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myPositionStepDecreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive);for(let t=0;t<3;t++)this.myRotationIncreaseButtonPanels[t].pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myRotationDecreaseButtonPanels[t].pp_setActiveHierarchy(this._myAdditionalButtonsActive);this.myRotationStepIncreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myRotationStepDecreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive);for(let t=0;t<3;t++)this.myScaleIncreaseButtonPanels[t].pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myScaleDecreaseButtonPanels[t].pp_setActiveHierarchy(this._myAdditionalButtonsActive);this.myScaleStepIncreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive),this.myScaleStepDecreaseButtonPanel.pp_setActiveHierarchy(this._myAdditionalButtonsActive)}_buildHook(){this._myAdditionalButtonsActive=!0}_createSkeletonHook(){this.myPositionPanel=WL.scene.addObject(this.myDisplayPanel),this.myPositionLabelText=WL.scene.addObject(this.myPositionPanel),this.myPositionLabelCursorTarget=WL.scene.addObject(this.myPositionPanel),this.myPositionPanels=[],this.myPositionTexts=[],this.myPositionCursorTargets=[],this.myPositionIncreaseButtonPanels=[],this.myPositionIncreaseButtonBackgrounds=[],this.myPositionIncreaseButtonTexts=[],this.myPositionIncreaseButtonCursorTargets=[],this.myPositionDecreaseButtonPanels=[],this.myPositionDecreaseButtonBackgrounds=[],this.myPositionDecreaseButtonTexts=[],this.myPositionDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myPositionPanels[e]=WL.scene.addObject(this.myPositionPanel),this.myPositionTexts[e]=WL.scene.addObject(this.myPositionPanels[e]),this.myPositionCursorTargets[e]=WL.scene.addObject(this.myPositionPanels[e]),this.myPositionIncreaseButtonPanels[e]=WL.scene.addObject(this.myPositionPanels[e]),this.myPositionIncreaseButtonBackgrounds[e]=WL.scene.addObject(this.myPositionIncreaseButtonPanels[e]),this.myPositionIncreaseButtonTexts[e]=WL.scene.addObject(this.myPositionIncreaseButtonPanels[e]),this.myPositionIncreaseButtonCursorTargets[e]=WL.scene.addObject(this.myPositionIncreaseButtonPanels[e]),this.myPositionDecreaseButtonPanels[e]=WL.scene.addObject(this.myPositionPanels[e]),this.myPositionDecreaseButtonBackgrounds[e]=WL.scene.addObject(this.myPositionDecreaseButtonPanels[e]),this.myPositionDecreaseButtonTexts[e]=WL.scene.addObject(this.myPositionDecreaseButtonPanels[e]),this.myPositionDecreaseButtonCursorTargets[e]=WL.scene.addObject(this.myPositionDecreaseButtonPanels[e]);this.myRotationPanel=WL.scene.addObject(this.myDisplayPanel),this.myRotationLabelText=WL.scene.addObject(this.myRotationPanel),this.myRotationLabelCursorTarget=WL.scene.addObject(this.myRotationPanel),this.myRotationPanels=[],this.myRotationTexts=[],this.myRotationCursorTargets=[],this.myRotationIncreaseButtonPanels=[],this.myRotationIncreaseButtonBackgrounds=[],this.myRotationIncreaseButtonTexts=[],this.myRotationIncreaseButtonCursorTargets=[],this.myRotationDecreaseButtonPanels=[],this.myRotationDecreaseButtonBackgrounds=[],this.myRotationDecreaseButtonTexts=[],this.myRotationDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myRotationPanels[e]=WL.scene.addObject(this.myRotationPanel),this.myRotationTexts[e]=WL.scene.addObject(this.myRotationPanels[e]),this.myRotationCursorTargets[e]=WL.scene.addObject(this.myRotationPanels[e]),this.myRotationIncreaseButtonPanels[e]=WL.scene.addObject(this.myRotationPanels[e]),this.myRotationIncreaseButtonBackgrounds[e]=WL.scene.addObject(this.myRotationIncreaseButtonPanels[e]),this.myRotationIncreaseButtonTexts[e]=WL.scene.addObject(this.myRotationIncreaseButtonPanels[e]),this.myRotationIncreaseButtonCursorTargets[e]=WL.scene.addObject(this.myRotationIncreaseButtonPanels[e]),this.myRotationDecreaseButtonPanels[e]=WL.scene.addObject(this.myRotationPanels[e]),this.myRotationDecreaseButtonBackgrounds[e]=WL.scene.addObject(this.myRotationDecreaseButtonPanels[e]),this.myRotationDecreaseButtonTexts[e]=WL.scene.addObject(this.myRotationDecreaseButtonPanels[e]),this.myRotationDecreaseButtonCursorTargets[e]=WL.scene.addObject(this.myRotationDecreaseButtonPanels[e]);this.myScalePanel=WL.scene.addObject(this.myDisplayPanel),this.myScaleLabelText=WL.scene.addObject(this.myScalePanel),this.myScaleLabelCursorTarget=WL.scene.addObject(this.myScalePanel),this.myScalePanels=[],this.myScaleTexts=[],this.myScaleCursorTargets=[],this.myScaleIncreaseButtonPanels=[],this.myScaleIncreaseButtonBackgrounds=[],this.myScaleIncreaseButtonTexts=[],this.myScaleIncreaseButtonCursorTargets=[],this.myScaleDecreaseButtonPanels=[],this.myScaleDecreaseButtonBackgrounds=[],this.myScaleDecreaseButtonTexts=[],this.myScaleDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myScalePanels[e]=WL.scene.addObject(this.myScalePanel),this.myScaleTexts[e]=WL.scene.addObject(this.myScalePanels[e]),this.myScaleCursorTargets[e]=WL.scene.addObject(this.myScalePanels[e]),this.myScaleIncreaseButtonPanels[e]=WL.scene.addObject(this.myScalePanels[e]),this.myScaleIncreaseButtonBackgrounds[e]=WL.scene.addObject(this.myScaleIncreaseButtonPanels[e]),this.myScaleIncreaseButtonTexts[e]=WL.scene.addObject(this.myScaleIncreaseButtonPanels[e]),this.myScaleIncreaseButtonCursorTargets[e]=WL.scene.addObject(this.myScaleIncreaseButtonPanels[e]),this.myScaleDecreaseButtonPanels[e]=WL.scene.addObject(this.myScalePanels[e]),this.myScaleDecreaseButtonBackgrounds[e]=WL.scene.addObject(this.myScaleDecreaseButtonPanels[e]),this.myScaleDecreaseButtonTexts[e]=WL.scene.addObject(this.myScaleDecreaseButtonPanels[e]),this.myScaleDecreaseButtonCursorTargets[e]=WL.scene.addObject(this.myScaleDecreaseButtonPanels[e]);this.myPositionStepPanel=WL.scene.addObject(this.myPositionPanel),this.myPositionStepText=WL.scene.addObject(this.myPositionStepPanel),this.myPositionStepCursorTarget=WL.scene.addObject(this.myPositionStepPanel),this.myPositionStepIncreaseButtonPanel=WL.scene.addObject(this.myPositionStepPanel),this.myPositionStepIncreaseButtonBackground=WL.scene.addObject(this.myPositionStepIncreaseButtonPanel),this.myPositionStepIncreaseButtonText=WL.scene.addObject(this.myPositionStepIncreaseButtonPanel),this.myPositionStepIncreaseButtonCursorTarget=WL.scene.addObject(this.myPositionStepIncreaseButtonPanel),this.myPositionStepDecreaseButtonPanel=WL.scene.addObject(this.myPositionStepPanel),this.myPositionStepDecreaseButtonBackground=WL.scene.addObject(this.myPositionStepDecreaseButtonPanel),this.myPositionStepDecreaseButtonText=WL.scene.addObject(this.myPositionStepDecreaseButtonPanel),this.myPositionStepDecreaseButtonCursorTarget=WL.scene.addObject(this.myPositionStepDecreaseButtonPanel),this.myRotationStepPanel=WL.scene.addObject(this.myRotationPanel),this.myRotationStepText=WL.scene.addObject(this.myRotationStepPanel),this.myRotationStepCursorTarget=WL.scene.addObject(this.myRotationStepPanel),this.myRotationStepIncreaseButtonPanel=WL.scene.addObject(this.myRotationStepPanel),this.myRotationStepIncreaseButtonBackground=WL.scene.addObject(this.myRotationStepIncreaseButtonPanel),this.myRotationStepIncreaseButtonText=WL.scene.addObject(this.myRotationStepIncreaseButtonPanel),this.myRotationStepIncreaseButtonCursorTarget=WL.scene.addObject(this.myRotationStepIncreaseButtonPanel),this.myRotationStepDecreaseButtonPanel=WL.scene.addObject(this.myRotationStepPanel),this.myRotationStepDecreaseButtonBackground=WL.scene.addObject(this.myRotationStepDecreaseButtonPanel),this.myRotationStepDecreaseButtonText=WL.scene.addObject(this.myRotationStepDecreaseButtonPanel),this.myRotationStepDecreaseButtonCursorTarget=WL.scene.addObject(this.myRotationStepDecreaseButtonPanel),this.myScaleStepPanel=WL.scene.addObject(this.myScalePanel),this.myScaleStepText=WL.scene.addObject(this.myScaleStepPanel),this.myScaleStepCursorTarget=WL.scene.addObject(this.myScaleStepPanel),this.myScaleStepIncreaseButtonPanel=WL.scene.addObject(this.myScaleStepPanel),this.myScaleStepIncreaseButtonBackground=WL.scene.addObject(this.myScaleStepIncreaseButtonPanel),this.myScaleStepIncreaseButtonText=WL.scene.addObject(this.myScaleStepIncreaseButtonPanel),this.myScaleStepIncreaseButtonCursorTarget=WL.scene.addObject(this.myScaleStepIncreaseButtonPanel),this.myScaleStepDecreaseButtonPanel=WL.scene.addObject(this.myScaleStepPanel),this.myScaleStepDecreaseButtonBackground=WL.scene.addObject(this.myScaleStepDecreaseButtonPanel),this.myScaleStepDecreaseButtonText=WL.scene.addObject(this.myScaleStepDecreaseButtonPanel),this.myScaleStepDecreaseButtonCursorTarget=WL.scene.addObject(this.myScaleStepDecreaseButtonPanel)}_setTransformHook(){this.myPositionPanel.setTranslationLocal(this._mySetup.myPositionPanelPosition),this.myPositionLabelText.scale(this._mySetup.myComponentLabelTextScale),this.myPositionLabelCursorTarget.setTranslationLocal(this._mySetup.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myPositionPanels[e].setTranslationLocal(this._mySetup.myValuePanelsPositions[e]),this.myPositionTexts[e].scale(this._mySetup.myValueTextScale),this.myPositionCursorTargets[e].setTranslationLocal(this._mySetup.myValueCursorTargetPosition),this.myPositionIncreaseButtonPanels[e].setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myPositionIncreaseButtonBackgrounds[e].scale(this._mySetup.mySideButtonBackgroundScale),this.myPositionIncreaseButtonTexts[e].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myPositionIncreaseButtonTexts[e].scale(this._mySetup.mySideButtonTextScale),this.myPositionIncreaseButtonCursorTargets[e].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myPositionDecreaseButtonPanels[e].setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myPositionDecreaseButtonBackgrounds[e].scale(this._mySetup.mySideButtonBackgroundScale),this.myPositionDecreaseButtonTexts[e].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myPositionDecreaseButtonTexts[e].scale(this._mySetup.mySideButtonTextScale),this.myPositionDecreaseButtonCursorTargets[e].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition);this.myRotationPanel.setTranslationLocal(this._mySetup.myRotationPanelPosition),this.myRotationLabelText.scale(this._mySetup.myComponentLabelTextScale),this.myRotationLabelCursorTarget.setTranslationLocal(this._mySetup.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myRotationPanels[e].setTranslationLocal(this._mySetup.myValuePanelsPositions[e]),this.myRotationTexts[e].scale(this._mySetup.myValueTextScale),this.myRotationCursorTargets[e].setTranslationLocal(this._mySetup.myValueCursorTargetPosition),this.myRotationIncreaseButtonPanels[e].setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myRotationIncreaseButtonBackgrounds[e].scale(this._mySetup.mySideButtonBackgroundScale),this.myRotationIncreaseButtonTexts[e].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myRotationIncreaseButtonTexts[e].scale(this._mySetup.mySideButtonTextScale),this.myRotationIncreaseButtonCursorTargets[e].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myRotationDecreaseButtonPanels[e].setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myRotationDecreaseButtonBackgrounds[e].scale(this._mySetup.mySideButtonBackgroundScale),this.myRotationDecreaseButtonTexts[e].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myRotationDecreaseButtonTexts[e].scale(this._mySetup.mySideButtonTextScale),this.myRotationDecreaseButtonCursorTargets[e].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition);this.myScalePanel.setTranslationLocal(this._mySetup.myScalePanelPosition),this.myScaleLabelText.scale(this._mySetup.myComponentLabelTextScale),this.myScaleLabelCursorTarget.setTranslationLocal(this._mySetup.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myScalePanels[e].setTranslationLocal(this._mySetup.myValuePanelsPositions[e]),this.myScaleTexts[e].scale(this._mySetup.myValueTextScale),this.myScaleCursorTargets[e].setTranslationLocal(this._mySetup.myValueCursorTargetPosition),this.myScaleIncreaseButtonPanels[e].setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myScaleIncreaseButtonBackgrounds[e].scale(this._mySetup.mySideButtonBackgroundScale),this.myScaleIncreaseButtonTexts[e].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myScaleIncreaseButtonTexts[e].scale(this._mySetup.mySideButtonTextScale),this.myScaleIncreaseButtonCursorTargets[e].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myScaleDecreaseButtonPanels[e].setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myScaleDecreaseButtonBackgrounds[e].scale(this._mySetup.mySideButtonBackgroundScale),this.myScaleDecreaseButtonTexts[e].setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myScaleDecreaseButtonTexts[e].scale(this._mySetup.mySideButtonTextScale),this.myScaleDecreaseButtonCursorTargets[e].setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition);this.myPositionStepPanel.setTranslationLocal(this._mySetup.myStepPanelPosition),this.myPositionStepText.scale(this._mySetup.myStepTextScale),this.myPositionStepCursorTarget.setTranslationLocal(this._mySetup.myStepCursorTargetPosition),this.myPositionStepIncreaseButtonPanel.setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myPositionStepIncreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myPositionStepIncreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myPositionStepIncreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myPositionStepIncreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myPositionStepDecreaseButtonPanel.setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myPositionStepDecreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myPositionStepDecreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myPositionStepDecreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myPositionStepDecreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myRotationStepPanel.setTranslationLocal(this._mySetup.myStepPanelPosition),this.myRotationStepText.scale(this._mySetup.myStepTextScale),this.myRotationStepCursorTarget.setTranslationLocal(this._mySetup.myStepCursorTargetPosition),this.myRotationStepIncreaseButtonPanel.setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myRotationStepIncreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myRotationStepIncreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myRotationStepIncreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myRotationStepIncreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myRotationStepDecreaseButtonPanel.setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myRotationStepDecreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myRotationStepDecreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myRotationStepDecreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myRotationStepDecreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myScaleStepPanel.setTranslationLocal(this._mySetup.myStepPanelPosition),this.myScaleStepText.scale(this._mySetup.myStepTextScale),this.myScaleStepCursorTarget.setTranslationLocal(this._mySetup.myStepCursorTargetPosition),this.myScaleStepIncreaseButtonPanel.setTranslationLocal(this._mySetup.myIncreaseButtonPosition),this.myScaleStepIncreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myScaleStepIncreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myScaleStepIncreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myScaleStepIncreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition),this.myScaleStepDecreaseButtonPanel.setTranslationLocal(this._mySetup.myDecreaseButtonPosition),this.myScaleStepDecreaseButtonBackground.scale(this._mySetup.mySideButtonBackgroundScale),this.myScaleStepDecreaseButtonText.setTranslationLocal(this._mySetup.mySideButtonTextPosition),this.myScaleStepDecreaseButtonText.scale(this._mySetup.mySideButtonTextScale),this.myScaleStepDecreaseButtonCursorTarget.setTranslationLocal(this._mySetup.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myPositionLabelTextComponent=this.myPositionLabelText.addComponent("text"),this._setupTextComponent(this.myPositionLabelTextComponent),this.myPositionLabelTextComponent.text=this._mySetup.myPositionText,this.myPositionLabelCursorTargetComponent=this.myPositionLabelCursorTarget.addComponent("cursor-target"),this.myPositionLabelCollisionComponent=this.myPositionLabelCursorTarget.addComponent("collision"),this.myPositionLabelCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionLabelCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionLabelCollisionComponent.extents=this._mySetup.myComponentLabelCollisionExtents,this.myPositionTextComponents=[],this.myPositionCursorTargetComponents=[],this.myPositionCollisionComponents=[],this.myPositionIncreaseButtonBackgroundComponents=[],this.myPositionIncreaseButtonTextComponents=[],this.myPositionIncreaseButtonCursorTargetComponents=[],this.myPositionIncreaseButtonCollisionComponents=[],this.myPositionDecreaseButtonBackgroundComponents=[],this.myPositionDecreaseButtonTextComponents=[],this.myPositionDecreaseButtonCursorTargetComponents=[],this.myPositionDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myPositionTextComponents[e]=this.myPositionTexts[e].addComponent("text"),this._setupTextComponent(this.myPositionTextComponents[e]),this.myPositionTextComponents[e].text=" ",this.myPositionCursorTargetComponents[e]=this.myPositionCursorTargets[e].addComponent("cursor-target"),this.myPositionCollisionComponents[e]=this.myPositionCursorTargets[e].addComponent("collision"),this.myPositionCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionCollisionComponents[e].extents=this._mySetup.myValueCollisionExtents,this.myPositionIncreaseButtonBackgroundComponents[e]=this.myPositionIncreaseButtonBackgrounds[e].addComponent("mesh"),this.myPositionIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myPositionIncreaseButtonBackgroundComponents[e].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionIncreaseButtonBackgroundComponents[e].material.color=this._mySetup.myBackgroundColor,this.myPositionIncreaseButtonTextComponents[e]=this.myPositionIncreaseButtonTexts[e].addComponent("text"),this._setupTextComponent(this.myPositionIncreaseButtonTextComponents[e]),this.myPositionIncreaseButtonTextComponents[e].text=this._mySetup.myIncreaseButtonText,this.myPositionIncreaseButtonCursorTargetComponents[e]=this.myPositionIncreaseButtonCursorTargets[e].addComponent("cursor-target"),this.myPositionIncreaseButtonCollisionComponents[e]=this.myPositionIncreaseButtonCursorTargets[e].addComponent("collision"),this.myPositionIncreaseButtonCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionIncreaseButtonCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionIncreaseButtonCollisionComponents[e].extents=this._mySetup.mySideButtonCollisionExtents,this.myPositionDecreaseButtonBackgroundComponents[e]=this.myPositionDecreaseButtonBackgrounds[e].addComponent("mesh"),this.myPositionDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myPositionDecreaseButtonBackgroundComponents[e].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionDecreaseButtonBackgroundComponents[e].material.color=this._mySetup.myBackgroundColor,this.myPositionDecreaseButtonTextComponents[e]=this.myPositionDecreaseButtonTexts[e].addComponent("text"),this._setupTextComponent(this.myPositionDecreaseButtonTextComponents[e]),this.myPositionDecreaseButtonTextComponents[e].text=this._mySetup.myDecreaseButtonText,this.myPositionDecreaseButtonCursorTargetComponents[e]=this.myPositionDecreaseButtonCursorTargets[e].addComponent("cursor-target"),this.myPositionDecreaseButtonCollisionComponents[e]=this.myPositionDecreaseButtonCursorTargets[e].addComponent("collision"),this.myPositionDecreaseButtonCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionDecreaseButtonCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionDecreaseButtonCollisionComponents[e].extents=this._mySetup.mySideButtonCollisionExtents;this.myRotationLabelTextComponent=this.myRotationLabelText.addComponent("text"),this._setupTextComponent(this.myRotationLabelTextComponent),this.myRotationLabelTextComponent.text=this._mySetup.myRotationText,this.myRotationLabelCursorTargetComponent=this.myRotationLabelCursorTarget.addComponent("cursor-target"),this.myRotationLabelCollisionComponent=this.myRotationLabelCursorTarget.addComponent("collision"),this.myRotationLabelCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationLabelCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationLabelCollisionComponent.extents=this._mySetup.myComponentLabelCollisionExtents,this.myRotationTextComponents=[],this.myRotationCursorTargetComponents=[],this.myRotationCollisionComponents=[],this.myRotationIncreaseButtonBackgroundComponents=[],this.myRotationIncreaseButtonTextComponents=[],this.myRotationIncreaseButtonCursorTargetComponents=[],this.myRotationIncreaseButtonCollisionComponents=[],this.myRotationDecreaseButtonBackgroundComponents=[],this.myRotationDecreaseButtonTextComponents=[],this.myRotationDecreaseButtonCursorTargetComponents=[],this.myRotationDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myRotationTextComponents[e]=this.myRotationTexts[e].addComponent("text"),this._setupTextComponent(this.myRotationTextComponents[e]),this.myRotationTextComponents[e].text=" ",this.myRotationCursorTargetComponents[e]=this.myRotationCursorTargets[e].addComponent("cursor-target"),this.myRotationCollisionComponents[e]=this.myRotationCursorTargets[e].addComponent("collision"),this.myRotationCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationCollisionComponents[e].extents=this._mySetup.myValueCollisionExtents,this.myRotationIncreaseButtonBackgroundComponents[e]=this.myRotationIncreaseButtonBackgrounds[e].addComponent("mesh"),this.myRotationIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myRotationIncreaseButtonBackgroundComponents[e].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationIncreaseButtonBackgroundComponents[e].material.color=this._mySetup.myBackgroundColor,this.myRotationIncreaseButtonTextComponents[e]=this.myRotationIncreaseButtonTexts[e].addComponent("text"),this._setupTextComponent(this.myRotationIncreaseButtonTextComponents[e]),this.myRotationIncreaseButtonTextComponents[e].text=this._mySetup.myIncreaseButtonText,this.myRotationIncreaseButtonCursorTargetComponents[e]=this.myRotationIncreaseButtonCursorTargets[e].addComponent("cursor-target"),this.myRotationIncreaseButtonCollisionComponents[e]=this.myRotationIncreaseButtonCursorTargets[e].addComponent("collision"),this.myRotationIncreaseButtonCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationIncreaseButtonCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationIncreaseButtonCollisionComponents[e].extents=this._mySetup.mySideButtonCollisionExtents,this.myRotationDecreaseButtonBackgroundComponents[e]=this.myRotationDecreaseButtonBackgrounds[e].addComponent("mesh"),this.myRotationDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myRotationDecreaseButtonBackgroundComponents[e].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationDecreaseButtonBackgroundComponents[e].material.color=this._mySetup.myBackgroundColor,this.myRotationDecreaseButtonTextComponents[e]=this.myRotationDecreaseButtonTexts[e].addComponent("text"),this._setupTextComponent(this.myRotationDecreaseButtonTextComponents[e]),this.myRotationDecreaseButtonTextComponents[e].text=this._mySetup.myDecreaseButtonText,this.myRotationDecreaseButtonCursorTargetComponents[e]=this.myRotationDecreaseButtonCursorTargets[e].addComponent("cursor-target"),this.myRotationDecreaseButtonCollisionComponents[e]=this.myRotationDecreaseButtonCursorTargets[e].addComponent("collision"),this.myRotationDecreaseButtonCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationDecreaseButtonCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationDecreaseButtonCollisionComponents[e].extents=this._mySetup.mySideButtonCollisionExtents;this.myScaleLabelTextComponent=this.myScaleLabelText.addComponent("text"),this._setupTextComponent(this.myScaleLabelTextComponent),this.myScaleLabelTextComponent.text=this._mySetup.myScaleText,this.myScaleLabelCursorTargetComponent=this.myScaleLabelCursorTarget.addComponent("cursor-target"),this.myScaleLabelCollisionComponent=this.myScaleLabelCursorTarget.addComponent("collision"),this.myScaleLabelCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleLabelCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleLabelCollisionComponent.extents=this._mySetup.myComponentLabelCollisionExtents,this.myScaleTextComponents=[],this.myScaleCursorTargetComponents=[],this.myScaleCollisionComponents=[],this.myScaleIncreaseButtonBackgroundComponents=[],this.myScaleIncreaseButtonTextComponents=[],this.myScaleIncreaseButtonCursorTargetComponents=[],this.myScaleIncreaseButtonCollisionComponents=[],this.myScaleDecreaseButtonBackgroundComponents=[],this.myScaleDecreaseButtonTextComponents=[],this.myScaleDecreaseButtonCursorTargetComponents=[],this.myScaleDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myScaleTextComponents[e]=this.myScaleTexts[e].addComponent("text"),this._setupTextComponent(this.myScaleTextComponents[e]),this.myScaleTextComponents[e].text=" ",this.myScaleCursorTargetComponents[e]=this.myScaleCursorTargets[e].addComponent("cursor-target"),this.myScaleCollisionComponents[e]=this.myScaleCursorTargets[e].addComponent("collision"),this.myScaleCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleCollisionComponents[e].extents=this._mySetup.myValueCollisionExtents,this.myScaleIncreaseButtonBackgroundComponents[e]=this.myScaleIncreaseButtonBackgrounds[e].addComponent("mesh"),this.myScaleIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myScaleIncreaseButtonBackgroundComponents[e].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleIncreaseButtonBackgroundComponents[e].material.color=this._mySetup.myBackgroundColor,this.myScaleIncreaseButtonTextComponents[e]=this.myScaleIncreaseButtonTexts[e].addComponent("text"),this._setupTextComponent(this.myScaleIncreaseButtonTextComponents[e]),this.myScaleIncreaseButtonTextComponents[e].text=this._mySetup.myIncreaseButtonText,this.myScaleIncreaseButtonCursorTargetComponents[e]=this.myScaleIncreaseButtonCursorTargets[e].addComponent("cursor-target"),this.myScaleIncreaseButtonCollisionComponents[e]=this.myScaleIncreaseButtonCursorTargets[e].addComponent("collision"),this.myScaleIncreaseButtonCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleIncreaseButtonCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleIncreaseButtonCollisionComponents[e].extents=this._mySetup.mySideButtonCollisionExtents,this.myScaleDecreaseButtonBackgroundComponents[e]=this.myScaleDecreaseButtonBackgrounds[e].addComponent("mesh"),this.myScaleDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myScaleDecreaseButtonBackgroundComponents[e].material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleDecreaseButtonBackgroundComponents[e].material.color=this._mySetup.myBackgroundColor,this.myScaleDecreaseButtonTextComponents[e]=this.myScaleDecreaseButtonTexts[e].addComponent("text"),this._setupTextComponent(this.myScaleDecreaseButtonTextComponents[e]),this.myScaleDecreaseButtonTextComponents[e].text=this._mySetup.myDecreaseButtonText,this.myScaleDecreaseButtonCursorTargetComponents[e]=this.myScaleDecreaseButtonCursorTargets[e].addComponent("cursor-target"),this.myScaleDecreaseButtonCollisionComponents[e]=this.myScaleDecreaseButtonCursorTargets[e].addComponent("collision"),this.myScaleDecreaseButtonCollisionComponents[e].collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleDecreaseButtonCollisionComponents[e].group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleDecreaseButtonCollisionComponents[e].extents=this._mySetup.mySideButtonCollisionExtents;this.myPositionStepTextComponent=this.myPositionStepText.addComponent("text"),this._setupTextComponent(this.myPositionStepTextComponent),this.myPositionStepTextComponent.text=" ",this.myPositionStepCursorTargetComponent=this.myPositionStepCursorTarget.addComponent("cursor-target"),this.myPositionStepCollisionComponent=this.myPositionStepCursorTarget.addComponent("collision"),this.myPositionStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myPositionStepIncreaseButtonBackgroundComponent=this.myPositionStepIncreaseButtonBackground.addComponent("mesh"),this.myPositionStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myPositionStepIncreaseButtonTextComponent=this.myPositionStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myPositionStepIncreaseButtonTextComponent),this.myPositionStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myPositionStepIncreaseButtonCursorTargetComponent=this.myPositionStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myPositionStepIncreaseButtonCollisionComponent=this.myPositionStepIncreaseButtonCursorTarget.addComponent("collision"),this.myPositionStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myPositionStepDecreaseButtonBackgroundComponent=this.myPositionStepDecreaseButtonBackground.addComponent("mesh"),this.myPositionStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myPositionStepDecreaseButtonTextComponent=this.myPositionStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myPositionStepDecreaseButtonTextComponent),this.myPositionStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myPositionStepDecreaseButtonCursorTargetComponent=this.myPositionStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myPositionStepDecreaseButtonCollisionComponent=this.myPositionStepDecreaseButtonCursorTarget.addComponent("collision"),this.myPositionStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myRotationStepTextComponent=this.myRotationStepText.addComponent("text"),this._setupTextComponent(this.myRotationStepTextComponent),this.myRotationStepTextComponent.text=" ",this.myRotationStepCursorTargetComponent=this.myRotationStepCursorTarget.addComponent("cursor-target"),this.myRotationStepCollisionComponent=this.myRotationStepCursorTarget.addComponent("collision"),this.myRotationStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myRotationStepIncreaseButtonBackgroundComponent=this.myRotationStepIncreaseButtonBackground.addComponent("mesh"),this.myRotationStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myRotationStepIncreaseButtonTextComponent=this.myRotationStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myRotationStepIncreaseButtonTextComponent),this.myRotationStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myRotationStepIncreaseButtonCursorTargetComponent=this.myRotationStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myRotationStepIncreaseButtonCollisionComponent=this.myRotationStepIncreaseButtonCursorTarget.addComponent("collision"),this.myRotationStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myRotationStepDecreaseButtonBackgroundComponent=this.myRotationStepDecreaseButtonBackground.addComponent("mesh"),this.myRotationStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myRotationStepDecreaseButtonTextComponent=this.myRotationStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myRotationStepDecreaseButtonTextComponent),this.myRotationStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myRotationStepDecreaseButtonCursorTargetComponent=this.myRotationStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myRotationStepDecreaseButtonCollisionComponent=this.myRotationStepDecreaseButtonCursorTarget.addComponent("collision"),this.myRotationStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myScaleStepTextComponent=this.myScaleStepText.addComponent("text"),this._setupTextComponent(this.myScaleStepTextComponent),this.myScaleStepTextComponent.text=" ",this.myScaleStepCursorTargetComponent=this.myScaleStepCursorTarget.addComponent("cursor-target"),this.myScaleStepCollisionComponent=this.myScaleStepCursorTarget.addComponent("collision"),this.myScaleStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myScaleStepIncreaseButtonBackgroundComponent=this.myScaleStepIncreaseButtonBackground.addComponent("mesh"),this.myScaleStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myScaleStepIncreaseButtonTextComponent=this.myScaleStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myScaleStepIncreaseButtonTextComponent),this.myScaleStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myScaleStepIncreaseButtonCursorTargetComponent=this.myScaleStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myScaleStepIncreaseButtonCollisionComponent=this.myScaleStepIncreaseButtonCursorTarget.addComponent("collision"),this.myScaleStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myScaleStepDecreaseButtonBackgroundComponent=this.myScaleStepDecreaseButtonBackground.addComponent("mesh"),this.myScaleStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myScaleStepDecreaseButtonTextComponent=this.myScaleStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myScaleStepDecreaseButtonTextComponent),this.myScaleStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myScaleStepDecreaseButtonCursorTargetComponent=this.myScaleStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myScaleStepDecreaseButtonCollisionComponent=this.myScaleStepDecreaseButtonCursorTarget.addComponent("collision"),this.myScaleStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents}_addStepComponents(){this.myPositionStepTextComponent=this.myPositionStepText.addComponent("text"),this._setupTextComponent(this.myPositionStepTextComponent),this.myPositionStepTextComponent.text=" ",this.myPositionStepCursorTargetComponent=this.myPositionStepCursorTarget.addComponent("cursor-target"),this.myPositionStepCollisionComponent=this.myPositionStepCursorTarget.addComponent("collision"),this.myPositionStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myPositionStepIncreaseButtonBackgroundComponent=this.myPositionStepIncreaseButtonBackground.addComponent("mesh"),this.myPositionStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myPositionStepIncreaseButtonTextComponent=this.myPositionStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myPositionStepIncreaseButtonTextComponent),this.myPositionStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myPositionStepIncreaseButtonCursorTargetComponent=this.myPositionStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myPositionStepIncreaseButtonCollisionComponent=this.myPositionStepIncreaseButtonCursorTarget.addComponent("collision"),this.myPositionStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myPositionStepDecreaseButtonBackgroundComponent=this.myPositionStepDecreaseButtonBackground.addComponent("mesh"),this.myPositionStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPositionStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myPositionStepDecreaseButtonTextComponent=this.myPositionStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myPositionStepDecreaseButtonTextComponent),this.myPositionStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myPositionStepDecreaseButtonCursorTargetComponent=this.myPositionStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myPositionStepDecreaseButtonCollisionComponent=this.myPositionStepDecreaseButtonCursorTarget.addComponent("collision"),this.myPositionStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPositionStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPositionStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myRotationStepTextComponent=this.myRotationStepText.addComponent("text"),this._setupTextComponent(this.myRotationStepTextComponent),this.myRotationStepTextComponent.text=" ",this.myRotationStepCursorTargetComponent=this.myRotationStepCursorTarget.addComponent("cursor-target"),this.myRotationStepCollisionComponent=this.myRotationStepCursorTarget.addComponent("collision"),this.myRotationStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myRotationStepIncreaseButtonBackgroundComponent=this.myRotationStepIncreaseButtonBackground.addComponent("mesh"),this.myRotationStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myRotationStepIncreaseButtonTextComponent=this.myRotationStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myRotationStepIncreaseButtonTextComponent),this.myRotationStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myRotationStepIncreaseButtonCursorTargetComponent=this.myRotationStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myRotationStepIncreaseButtonCollisionComponent=this.myRotationStepIncreaseButtonCursorTarget.addComponent("collision"),this.myRotationStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myRotationStepDecreaseButtonBackgroundComponent=this.myRotationStepDecreaseButtonBackground.addComponent("mesh"),this.myRotationStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myRotationStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myRotationStepDecreaseButtonTextComponent=this.myRotationStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myRotationStepDecreaseButtonTextComponent),this.myRotationStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myRotationStepDecreaseButtonCursorTargetComponent=this.myRotationStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myRotationStepDecreaseButtonCollisionComponent=this.myRotationStepDecreaseButtonCursorTarget.addComponent("collision"),this.myRotationStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myRotationStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myRotationStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myScaleStepTextComponent=this.myScaleStepText.addComponent("text"),this._setupTextComponent(this.myScaleStepTextComponent),this.myScaleStepTextComponent.text=" ",this.myScaleStepCursorTargetComponent=this.myScaleStepCursorTarget.addComponent("cursor-target"),this.myScaleStepCollisionComponent=this.myScaleStepCursorTarget.addComponent("collision"),this.myScaleStepCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepCollisionComponent.extents=this._mySetup.myStepCollisionExtents,this.myScaleStepIncreaseButtonBackgroundComponent=this.myScaleStepIncreaseButtonBackground.addComponent("mesh"),this.myScaleStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepIncreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleStepIncreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myScaleStepIncreaseButtonTextComponent=this.myScaleStepIncreaseButtonText.addComponent("text"),this._setupTextComponent(this.myScaleStepIncreaseButtonTextComponent),this.myScaleStepIncreaseButtonTextComponent.text=this._mySetup.myIncreaseButtonText,this.myScaleStepIncreaseButtonCursorTargetComponent=this.myScaleStepIncreaseButtonCursorTarget.addComponent("cursor-target"),this.myScaleStepIncreaseButtonCollisionComponent=this.myScaleStepIncreaseButtonCursorTarget.addComponent("collision"),this.myScaleStepIncreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepIncreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepIncreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents,this.myScaleStepDecreaseButtonBackgroundComponent=this.myScaleStepDecreaseButtonBackground.addComponent("mesh"),this.myScaleStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepDecreaseButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myScaleStepDecreaseButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myScaleStepDecreaseButtonTextComponent=this.myScaleStepDecreaseButtonText.addComponent("text"),this._setupTextComponent(this.myScaleStepDecreaseButtonTextComponent),this.myScaleStepDecreaseButtonTextComponent.text=this._mySetup.myDecreaseButtonText,this.myScaleStepDecreaseButtonCursorTargetComponent=this.myScaleStepDecreaseButtonCursorTarget.addComponent("cursor-target"),this.myScaleStepDecreaseButtonCollisionComponent=this.myScaleStepDecreaseButtonCursorTarget.addComponent("collision"),this.myScaleStepDecreaseButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myScaleStepDecreaseButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myScaleStepDecreaseButtonCollisionComponent.extents=this._mySetup.mySideButtonCollisionExtents}}});var Lo=S(()=>{PP.EasyTuneTransformWidgetSetup=class extends PP.EasyTuneBaseWidgetSetup{_getBackPanelMinY(){return super._getBackPanelMinY()+this.myPositionPanelPosition[1]+this.myStepPanelPosition[1]}_getBackPanelMaxX(){return this.myDisplayPanelPosition[0]+this.myRotationPanelPosition[0]+this.myIncreaseButtonPosition[0]+this.mySideButtonBackgroundScale[0]+this._mySideButtonDistanceFromBorder}_getBackPanelMinX(){return this.myDisplayPanelPosition[0]+this.myScalePanelPosition[0]+this.myDecreaseButtonPosition[0]-this.mySideButtonBackgroundScale[0]-this._mySideButtonDistanceFromBorder}_getPivotZOffset(){return .00805713}_initializeBuildSetupHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this.myDecreaseButtonPosition=PP.vec3_create(-.13,0,-1e-5),this.myIncreaseButtonPosition=PP.vec3_create(-this.myDecreaseButtonPosition[0],0,-1e-5);let e=Math.abs(this.myIncreaseButtonPosition[0])+Math.abs(this.myRightSideButtonPosition[0]),t=.045;this.myPositionPanelPosition=[0,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myRotationPanelPosition=[this.myPositionPanelPosition[0]+e,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myScalePanelPosition=[this.myPositionPanelPosition[0]-e,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myPositionText="Position",this.myRotationText="Rotation",this.myScaleText="Scale",this.myComponentLabelTextScale=this.myLabelTextScale,this.myComponentLabelCursorTargetPosition=PP.vec3_create(0,0,0),this.myComponentLabelCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myComponentLabelCollisionExtents=PP.vec3_create(.065,.0175,1),this.myComponentLabelCollisionExtents[2]=this.myCursorTargetCollisionThickness,this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValueTextScale=PP.vec3_create(.4,.4,.4),this.myValueCursorTargetPosition=PP.vec3_create(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=PP.vec3_create(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=PP.vec3_create(0,-this._myValuePanelDistanceFromVariableLabelPanel,0);for(let a=1;a<3;a++)this.myValuePanelsPositions[a]=this.myValuePanelsPositions[a-1].slice(0),this.myValuePanelsPositions[a][1]-=this._myDistanceBetweenValues;let n=this.myValuePanelsPositions[2][1];this.myStepPanelPosition=[0,n-this._myValuePanelDistanceFromVariableLabelPanel,0],this.myStepTextScale=this.myLabelTextScale,this.myStepStartString="Step: ",this.myStepCursorTargetPosition=PP.vec3_create(0,0,0),this.myStepCursorTargetPosition[2]=this._myColliderZOffset-this.myStepPanelPosition[2],this.myStepCollisionExtents=PP.vec3_create(.065,.0175,1),this.myStepCollisionExtents[2]=this.myCursorTargetCollisionThickness}_initializeRuntimeSetupHook(){this.myTextHoverScaleMultiplier=PP.vec3_create(1.25,1.25,1.25),this.myEditThumbstickMinThreshold=.35,this.myStepMultiplierStepPerSecond=2.25,this.myButtonEditDelay=0}}});var Bo=S(()=>{PP.EasyTuneWidgetAdditionalSetup=class{constructor(){this.myHandedness=PP.ToolHandedness.NONE,this.myShowOnStart=!1,this.myShowVisibilityButton=!1,this.myEnableAdditionalButtons=!1,this.myEnableGamepadScrollVariable=!1,this.myPlaneMaterial=null,this.myTextMaterial=null,this.myEnableVariablesImportExportButtons=!1,this.myVariablesImportCallback=null,this.myVariablesExportCallback=null}};PP.EasyTuneWidget=class{constructor(){this._myIsStarted=!1,this._myStartVariable=null,this._myWidgetFrame=new PP.WidgetFrame("E",1),this._myWidgetFrame.registerWidgetVisibleChangedEventListener(this,this._widgetVisibleChanged.bind(this)),this._mySetup=new PP.EasyTuneWidgetSetup,this._myAdditionalSetup=null,this._myWidgets=[],this._myEasyTuneVariables=null,this._myEasyTuneLastSize=0,this._myVariableNames=null,this._myCurrentWidget=null,this._myCurrentVariable=null,this._myScrollVariableTimer=0,this._myGamepad=null,this._myRefreshVariablesTimer=0,this._myDirty=!1}setActiveVariable(e){this._myIsStarted?this._myEasyTuneVariables.has(e)?(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(e),this._selectCurrentWidget()):console.log("Can't set easy tune active variable"):this._myStartVariable=e}refresh(){this._myWidgetFrame.myIsWidgetVisible&&(this._myDirty=!0)}setVisible(e){this._myWidgetFrame.setVisible(e)}isVisible(){return this._myWidgetFrame.isVisible()}start(e,t,n){this._myRightGamepad=PP.myRightGamepad,this._myLeftGamepad=PP.myLeftGamepad,this._mySetup.myGamepadHandedness==PP.ToolHandedness.RIGHT?this._myGamepad=this._myRightGamepad:this._mySetup.myGamepadHandedness==PP.ToolHandedness.LEFT&&(this._myGamepad=this._myLeftGamepad),this._myIsStarted=!0,this._myAdditionalSetup=t,this._myWidgetFrame.start(e,t),this._myEasyTuneVariables=n,this._myEasyTuneLastSize=this._myEasyTuneVariables.length(),this._myVariableNames=this._myEasyTuneVariables.getEasyTuneVariablesNames(),this._myEasyTuneVariables.length()>0&&(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0])),this._myStartVariable&&(this._myEasyTuneVariables.has(this._myStartVariable)?this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myStartVariable):console.log("Can't set easy tune active variable")),this._initializeWidgets()}update(e){this._myWidgetFrame.update(e),(this._myEasyTuneVariables.length()!=this._myEasyTuneLastSize||this._myDirty)&&this._refreshEasyTuneVariables(),this._myWidgetFrame.myIsWidgetVisible&&this._myEasyTuneVariables.length()>0&&(this._mySetup.myRefreshVariablesDelay!=null&&(this._myRefreshVariablesTimer+=e,this._myRefreshVariablesTimer>this._mySetup.myRefreshVariablesDelay&&(this._myRefreshVariablesTimer=0,this._refreshEasyTuneVariables())),this._myCurrentWidget&&this._myCurrentWidget.update(e),this._myAdditionalSetup.myEnableGamepadScrollVariable&&this._updateGamepadScrollVariable(e)),this._updateGamepadWidgetVisibility(),this._updateActiveVariable()}_initializeWidgets(){let e=new PP.EasyTuneBaseWidgetParams;e.myVariablesImportCallback=this._importVariables.bind(this),e.myVariablesExportCallback=this._exportVariables.bind(this),this._myWidgets[PP.EasyTuneVariableType.NONE]=new PP.EasyTuneNoneWidget(e),this._myWidgets[PP.EasyTuneVariableType.NUMBER]=new PP.EasyTuneNumberArrayWidgetSelector(e,this._myGamepad),this._myWidgets[PP.EasyTuneVariableType.BOOL]=new PP.EasyTuneBoolArrayWidgetSelector(e,this._myGamepad),this._myWidgets[PP.EasyTuneVariableType.TRANSFORM]=new PP.EasyTuneTransformWidget(e,this._myGamepad);for(let t of this._myWidgets)t!=null&&(t.start(this._myWidgetFrame.getWidgetObject(),this._myAdditionalSetup),t.setVisible(!1),t.registerScrollVariableRequestEventListener(this,this._scrollVariable.bind(this)));this._selectCurrentWidget()}_selectCurrentWidget(){if(this._myEasyTuneVariables.length()<=0)return;let e=null;this._myCurrentWidget!=null&&(e=this._myCurrentWidget.getWidget()),this._myCurrentVariable.myType in this._myWidgets?this._myCurrentWidget=this._myWidgets[this._myCurrentVariable.myType]:this._myCurrentWidget=this._myWidgets[PP.EasyTuneVariableType.NONE],this._myCurrentWidget.setEasyTuneVariable(this._myCurrentVariable,this._createIndexString()),this._myCurrentWidget.getWidget().syncWidget(e),e?.setVisible(!1),this._myCurrentWidget.setVisible(this._myWidgetFrame.myIsWidgetVisible)}_refreshEasyTuneVariables(){this._myVariableNames=this._myEasyTuneVariables.getEasyTuneVariablesNames(),this._myEasyTuneLastSize=this._myEasyTuneVariables.length(),this._myEasyTuneVariables.length()>0?(this._myCurrentVariable&&this._myEasyTuneVariables.has(this._myCurrentVariable.myName)?this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myCurrentVariable.myName):this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0]),this._selectCurrentWidget()):(this._myCurrentVariable=null,this._myCurrentWidget&&(this._myCurrentWidget.setVisible(!1),this._myCurrentWidget=null)),this._myDirty=!1}_updateGamepadWidgetVisibility(){this._myGamepad&&(this._myGamepad.getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).isPressStart()&&this._myGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).myIsPressed||this._myGamepad.getButtonInfo(PP.GamepadButtonID.TOP_BUTTON).isPressStart()&&this._myGamepad.getButtonInfo(PP.GamepadButtonID.BOTTOM_BUTTON).myIsPressed)&&this._toggleVisibility()}_toggleVisibility(){this._myWidgetFrame.toggleVisibility()}_widgetVisibleChanged(e){for(let t of this._myWidgets)t?.setVisible(!1);this._myCurrentWidget&&(this._myEasyTuneVariables.length()>0?this._myCurrentWidget.setVisible(e):this._myCurrentWidget.setVisible(!1)),e&&this._refreshEasyTuneVariables()}_updateGamepadScrollVariable(e){if(this._myGamepad&&(!this._mySetup.myScrollVariableButtonID||this._myGamepad.getButtonInfo(this._mySetup.myScrollVariableButtonID).myIsPressed)){let t=this._myGamepad.getAxesInfo(PP.GamepadAxesID.THUMBSTICK).myAxes[0],n=this._myGamepad.getAxesInfo(PP.GamepadAxesID.THUMBSTICK).myAxes[1];if(Math.abs(t)>this._mySetup.myScrollVariableMinXThreshold&&Math.abs(n)<this._mySetup.myScrollVariableMaxYThreshold)for(this._myScrollVariableTimer+=e;this._myScrollVariableTimer>this._mySetup.myScrollVariableDelay;)this._myScrollVariableTimer-=this._mySetup.myScrollVariableDelay,this._scrollVariable(Math.sign(t));else this._myScrollVariableTimer=this._mySetup.myScrollVariableDelay}else this._myScrollVariableTimer=this._mySetup.myScrollVariableDelay}_scrollVariable(e){if(this._myEasyTuneVariables.length()<=0)return;let t=this._getVariableIndex(this._myCurrentVariable);if(t>=0){let n=((t+e)%this._myVariableNames.length+this._myVariableNames.length)%this._myVariableNames.length;this._myEasyTuneVariables.has(this._myVariableNames[n])?(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[n]),this._selectCurrentWidget()):this._refreshEasyTuneVariables()}else this._refreshEasyTuneVariables()}_createIndexString(){let e=" (",t=(this._getVariableIndex(this._myCurrentVariable)+1).toString(),n=this._myEasyTuneVariables.length().toString();for(;t.length<n.length;)t="0".concat(t);return e=e.concat(t).concat(" - ").concat(n).concat(")"),e}_getVariableIndex(e){return this._myVariableNames.indexOf(e.myName)}_updateActiveVariable(){this._myEasyTuneVariables.getEasyTuneVariables().forEach(function(e){e.myIsActive=!1}),this._myWidgetFrame.myIsWidgetVisible&&this._myCurrentVariable&&(this._myCurrentVariable.myIsActive=!0)}_importVariables(){this._myAdditionalSetup.myVariablesImportCallback(this._onImportSuccess.bind(this),this._onImportFailure.bind(this))}_exportVariables(){this._myAdditionalSetup.myVariablesExportCallback(this._onExportSuccess.bind(this),this._onExportFailure.bind(this))}_onImportSuccess(){this._myCurrentWidget&&this._myCurrentWidget.onImportSuccess()}_onImportFailure(){this._myCurrentWidget&&this._myCurrentWidget.onImportFailure()}_onExportSuccess(){this._myCurrentWidget&&this._myCurrentWidget.onExportSuccess()}_onExportFailure(){this._myCurrentWidget&&this._myCurrentWidget.onExportFailure()}}});var Oo=S(()=>{PP.EasyTuneWidgetSetup=class{constructor(){this._initializeRuntimeSetup()}_initializeRuntimeSetup(){this.myGamepadHandedness=PP.ToolHandedness.RIGHT,this.myScrollVariableDelay=.5,this.myScrollVariableMinXThreshold=.6,this.myScrollVariableMaxYThreshold=.25,this.myScrollVariableButtonID=null,this.myRefreshVariablesDelay=null}}});var Ho=S(()=>{PP.EasyTuneVariables=class{constructor(){this._myVariables=new Map}add(e){this._myVariables.set(e.myName,e)}remove(e){this._myVariables.delete(e)}get(e){let t=this._myVariables.get(e);return t?t.getValue():null}set(e,t,n=!1){let a=this._myVariables.get(e);a&&a.setValue(t,n)}has(e){return this._myVariables.has(e)}length(){return this._myVariables.size}isActive(e){let t=this._myVariables.get(e);return t?t.myIsActive:!1}getEasyTuneVariable(e){return this._myVariables.get(e)}getEasyTuneVariables(){return Array.from(this._myVariables.values())}getEasyTuneVariablesNames(){return Array.from(this._myVariables.keys())}fromJSON(e,t=!1){let n=JSON.parse(e);for(let a of this._myVariables.values()){let s=n[a.myName];s!==void 0&&a.fromJSON(s,t)}}toJSON(){let e={};for(let t of this._myVariables.values())e[t.myName]=t.toJSON();return JSON.stringify(e)}registerValueChangedEventListener(e,t,n){this._myVariables.get(e).registerValueChangedEventListener(t,n)}unregisterValueChangedEventListener(e,t,n){this._myVariables.get(e).unregisterValueChangedEventListener(t)}}});var Eo=S(()=>{PP.EasyTuneVariableType={NONE:0,NUMBER:1,BOOL:2,TRANSFORM:3};PP.EasyTuneVariable=class{constructor(e,t){this.myName=e.slice(0),this.myType=t,this.myValue=null,this.myDefaultValue=null,this.myIsActive=!1,this._myValueChangedCallbacks=new Map}getValue(){return this.myValue}setValue(e,t=!1){let n=this.myValue;this.myValue=e,t&&PP.EasyTuneVariable.prototype.setDefaultValue.call(this,e),PP.refreshEasyTuneWidget(),n!=e&&this._triggerValueChangedCallback()}setDefaultValue(e){this.myDefaultValue=e}fromJSON(e,t=!1){this.setValue(JSON.parse(e),t)}toJSON(){return JSON.stringify(this.getValue())}registerValueChangedEventListener(e,t){this._myValueChangedCallbacks.set(e,t)}unregisterValueChangedEventListener(e){this._myValueChangedCallbacks.delete(e)}_triggerValueChangedCallback(){this._myValueChangedCallbacks.size>0&&this._myValueChangedCallbacks.forEach(function(e){e(this.myName,this.getValue())}.bind(this))}};PP.EasyTuneVariableArray=class extends PP.EasyTuneVariable{constructor(e,t,n){super(e,t),PP.EasyTuneVariableArray.prototype.setValue.call(this,n,!0)}getValue(){return this.myValue.slice(0)}setValue(e,t=!1){let n=this.myValue;this.myValue=e.slice(0),t&&PP.EasyTuneVariableArray.prototype.setDefaultValue.call(this,e),PP.refreshEasyTuneWidget(),(n==null||!n.pp_equals(e))&&this._triggerValueChangedCallback()}setDefaultValue(e){this.myDefaultValue=e.slice(0)}};PP.EasyTuneNumberArray=class extends PP.EasyTuneVariableArray{constructor(e,t,n,a,s=null,o=null,l=!1){super(e,PP.EasyTuneVariableType.NUMBER,t),this.myDecimalPlaces=a,this.myStepPerSecond=n,this.myDefaultStepPerSecond=this.myStepPerSecond,this.myMin=s,this.myMax=o,this.myEditAllValuesTogether=l,this._clampValue(!0)}setMax(e){this.myMax=e,this._clampValue(!1)}setMin(e){this.myMin=e,this._clampValue(!1)}_clampValue(e){let t=this.myValue.vec_clamp(this.myMin,this.myMax);if(!e){let n=this.myDefaultValue.vec_clamp(this.myMin,this.myMax);!n.vec_equals(this.myDefaultValue,1e-5)&&PP.EasyTuneVariableArray.prototype.setDefaultValue.call(this,n)}PP.EasyTuneVariableArray.prototype.setValue.call(this,t,e)}};PP.EasyTuneNumber=class extends PP.EasyTuneNumberArray{constructor(e,t,n,a,s,o){super(e,[t],n,a,s,o)}getValue(){return this.myValue[0]}setValue(e,t=!1){super.setValue([e],t)}setDefaultValue(e){super.setValue([e])}};PP.EasyTuneInt=class extends PP.EasyTuneNumber{constructor(e,t,n,a,s){super(e,t,n,0,a,s)}};PP.EasyTuneIntArray=class extends PP.EasyTuneNumberArray{constructor(e,t,n,a,s,o){let l=t.slice(0);for(let m=0;m<t.length;m++)l[m]=Math.round(l[m]);super(e,l,n,0,a!=null?Math.round(a):null,s!=null?Math.round(s):s,o)}};PP.EasyTuneBoolArray=class extends PP.EasyTuneVariableArray{constructor(e,t){super(e,PP.EasyTuneVariableType.BOOL,t)}};PP.EasyTuneBool=class extends PP.EasyTuneBoolArray{constructor(e,t){super(e,[t])}getValue(){return this.myValue[0]}setValue(e,t=!1){super.setValue([e],t)}setDefaultValue(e){super.setValue([e])}};PP.EasyTuneTransform=class extends PP.EasyTuneVariable{constructor(e,t,n=!0,a=1,s=50,o=1){super(e,PP.EasyTuneVariableType.TRANSFORM),this.myDecimalPlaces=3,this.myPosition=t.mat4_getPosition(),this.myRotation=t.mat4_getRotationDegrees(),this.myScale=t.mat4_getScale();let l=Math.pow(10,this.myDecimalPlaces);for(let m=0;m<3;m++)this.myScale[m]=Math.max(this.myScale[m],1/l);this.myScaleAsOne=n,this.myPositionStepPerSecond=a,this.myRotationStepPerSecond=s,this.myScaleStepPerSecond=o,this.myDefaultPosition=this.myPosition.vec3_clone(),this.myDefaultRotation=this.myRotation.vec3_clone(),this.myDefaultScale=this.myScale.vec3_clone(),this.myDefaultPositionStepPerSecond=this.myPositionStepPerSecond,this.myDefaultRotationStepPerSecond=this.myRotationStepPerSecond,this.myDefaultScaleStepPerSecond=this.myScaleStepPerSecond,this.myTransform=PP.mat4_create(),this.myTransform.mat4_setPositionRotationDegreesScale(this.myPosition,this.myRotation,this.myScale),this.myTempTransform=PP.mat4_create()}getValue(){return this.myTransform.mat4_setPositionRotationDegreesScale(this.myPosition,this.myRotation,this.myScale),this.myTransform.slice(0)}setValue(e,t=!1){this.myTempTransform.mat4_setPositionRotationDegreesScale(this.myPosition,this.myRotation,this.myScale),e.mat4_getPosition(this.myPosition),e.mat4_getRotationDegrees(this.myRotation),e.mat4_getScale(this.myScale),this.myTransform.mat4_setPositionRotationDegreesScale(this.myPosition,this.myRotation,this.myScale),t&&PP.EasyTuneTransform.prototype.setDefaultValue.call(this,e),PP.refreshEasyTuneWidget(),this.myTempTransform.pp_equals(this.myTransform)||this._triggerValueChangedCallback()}setDefaultValue(e){this.myDefaultPosition=e.mat4_getPosition(),this.myDefaultRotation=e.mat4_getRotationDegrees(),this.myDefaultScale=e.mat4_getScale()}fromJSON(e,t=!1){this.setValue(JSON.parse(e),t)}toJSON(){return this.getValue().vec_toString()}}});var ko=S(()=>{PP.myEasyTuneVariables=new PP.EasyTuneVariables;PP.myEasyTuneTarget=null;PP.importEasyTuneVariables=function(e=null,t=!1,n=null,a=null){if(e==null||e.length==0)navigator.clipboard&&navigator.clipboard.readText().then(function(s){PP.myEasyTuneVariables.fromJSON(s,t),PP.refreshEasyTuneWidget(),n?.(),console.log("Easy Tune Variables Imported from: clipboard"),console.log(s)},function(){a?.(),console.error("An error occurred while importing the easy tune variables from: clipboard")}).catch(function(s){a?.(),console.error("An error occurred while importing the easy tune variables from: clipboard"),console.error(s)});else{let s=PP._importExportEasyTuneVariablesReplaceFileURLParams(e);fetch(s).then(function(o){o.ok?o.text().then(function(l){PP.myEasyTuneVariables.fromJSON(l,t),PP.refreshEasyTuneWidget(),n?.(),console.log("Easy Tune Variables Imported from:",s),console.log(l)},function(l){a?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(l)}):(a?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(o))},function(o){a?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(o)}).catch(function(o){a?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(o)})}PP.refreshEasyTuneWidget()};PP.exportEasyTuneVariables=function(e=null,t=null,n=null){let a=PP.myEasyTuneVariables.toJSON();if(e==null||e.length==0)navigator.clipboard&&navigator.clipboard.writeText(a).then(function(){t?.(),console.log("Easy Tune Variables Exported to: clipboard"),console.log(a)},function(){n?.(),console.error("An error occurred while exporting the easy tune variables to: clipboard")}).catch(function(s){n?.(),console.error("An error occurred while exporting the easy tune variables to: clipboard"),console.error(s)});else{let s=PP._importExportEasyTuneVariablesReplaceFileURLParams(e);fetch(s,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:a}).then(function(o){o.ok?(t?.(),console.log("Easy Tune Variables Exported to:",s),console.log(a)):(n?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(o))},function(o){n?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(o)}).catch(function(o){n?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(o)})}};PP.mySetEasyTuneWidgetActiveVariableCallbacks=[];PP.setEasyTuneWidgetActiveVariable=function(e){for(let t of PP.mySetEasyTuneWidgetActiveVariableCallbacks)t(e)};PP.myRefreshEasyTuneWidgetCallbacks=[];PP.refreshEasyTuneWidget=function(){for(let e of PP.myRefreshEasyTuneWidgetCallbacks)e()};PP._importExportEasyTuneVariablesReplaceFileURLParams=function(e){let t=e.match(/\{.+?\}/g);if(t==null||t.length==0)return e;for(let s=0;s<t.length;s++)t[s]=t[s].replace("{",""),t[s]=t[s].replace("}","");let n=new URL(document.location).searchParams,a=e;for(let s of t){let o=n.get(s);o!=null&&(a=a.replace("{"+s+"}",o))}return a}});var Fo=S(()=>{WL.registerComponent("pp-easy-tune",{_myHandedness:{type:WL.Type.Enum,values:["none","left","right"],default:"none"},_myShowOnStart:{type:WL.Type.Bool,default:!1},_myShowVisibilityButton:{type:WL.Type.Bool,default:!1},_myEnableGamepadScrollVariable:{type:WL.Type.Bool,default:!0},_myEnableVariablesImportExportButtons:{type:WL.Type.Bool,default:!1},_myVariablesImportURL:{type:WL.Type.String,default:""},_myVariablesExportURL:{type:WL.Type.String,default:""},_myImportVariablesOnStart:{type:WL.Type.Bool,default:!1},_myResetVariablesDefaultValueOnImport:{type:WL.Type.Bool,default:!1}},{init:function(){this._myWidget=new PP.EasyTuneWidget,PP.mySetEasyTuneWidgetActiveVariableCallbacks.push(function(i){this._myWidget.setActiveVariable(i)}.bind(this)),PP.myRefreshEasyTuneWidgetCallbacks.push(function(){this._myWidget.refresh()}.bind(this)),this._myStarted=!1},start:function(){let i=new PP.EasyTuneWidgetAdditionalSetup;i.myHandedness=[null,"left","right"][this._myHandedness],i.myShowOnStart=this._myShowOnStart,i.myShowVisibilityButton=this._myShowVisibilityButton,i.myEnableAdditionalButtons=!0,i.myEnableGamepadScrollVariable=this._myEnableGamepadScrollVariable,i.myPlaneMaterial=PP.myDefaultResources.myMaterials.myFlatOpaque.clone(),i.myTextMaterial=PP.myDefaultResources.myMaterials.myText.clone(),i.myEnableVariablesImportExportButtons=this._myEnableVariablesImportExportButtons,i.myVariablesImportCallback=function(e,t){PP.importEasyTuneVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,e,t)}.bind(this),i.myVariablesExportCallback=function(e,t){PP.exportEasyTuneVariables(this._myVariablesExportURL,e,t)}.bind(this),this._myWidget.start(this.object,i,PP.myEasyTuneVariables),this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._mySetVisibleNextUpdate=!1,this._myStarted=!0,this._myFirstUpdate=!0},update:function(i){this._myFirstUpdate&&(this._myFirstUpdate=!1,this._myImportVariablesOnStart&&PP.importEasyTuneVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport)),this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this._myWidget.setVisible(!1),this._myWidget.setVisible(this._myWidgetVisibleBackup)),this._myWidget.update(i)},onActivate(){this._mySetVisibleNextUpdate=!0},onDeactivate(){this._myStarted&&(this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._myWidget.setVisible(!1))}})});var wo=S(()=>{WL.registerComponent("pp-easy-tune-import-variables",{_myVariablesImportURL:{type:WL.Type.String,default:""},_myResetVariablesDefaultValueOnImport:{type:WL.Type.Bool,default:!0}},{init:function(){},start:function(){this._myFirstUpdate=!0},update:function(i){this._myFirstUpdate&&(this._myFirstUpdate=!1,PP.importEasyTuneVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport))}})});var Wo=S(()=>{PP.WidgetFrameSetup=class{constructor(e,t){this._initializeBuildSetup(e,t),this._initializeRuntimeSetup()}_initializeBuildSetup(e,t){this.myBackgroundColor=[46/255,46/255,46/255,1],this.myCursorTargetCollisionCollider=2,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=[255/255,255/255,255/255,1],this.myTextAlignment=2,this.myTextJustification=2,this.myTextColor=this.myDefaultTextColor,this.myButtonTextScale=PP.vec3_create(.18,.18,.18),this.myVisibilityButtonBackgroundScale=PP.vec3_create(.015,.015,1),this.myVisibilityButtonTextPosition=PP.vec3_create(0,0,.007),this.myVisibilityButtonTextScale=this.myButtonTextScale;let n=.01,a=this.myVisibilityButtonBackgroundScale[0]*(2*t)+n*t;this.myVisibilityButtonPosition=[],this.myVisibilityButtonPosition[PP.ToolHandedness.NONE]={},this.myVisibilityButtonPosition[PP.ToolHandedness.NONE].myPosition=[-.3+a,-.205,.035],this.myVisibilityButtonPosition[PP.ToolHandedness.LEFT]={},this.myVisibilityButtonPosition[PP.ToolHandedness.LEFT].myPosition=[-.2+a,.025,.015],this.myVisibilityButtonPosition[PP.ToolHandedness.RIGHT]={},this.myVisibilityButtonPosition[PP.ToolHandedness.RIGHT].myPosition=[.2-a,.025,.015],this.myVisibilityButtonText=e,this.myVisibilityButtonCursorTargetPosition=PP.vec3_create(0,0,0),this.myVisibilityButtonCursorTargetPosition[2]=this.myVisibilityButtonTextPosition[2],this.myVisibilityButtonCollisionExtents=this.myVisibilityButtonBackgroundScale.slice(0),this.myVisibilityButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myFlagButtonBackgroundScale=PP.vec3_create(.0125,.0125,1),this.myFlagButtonTextPosition=PP.vec3_create(0,0,.007),this.myFlagButtonTextScale=PP.vec3_create(.15,.15,.15);let s=.0075,o=0,l=this.myVisibilityButtonBackgroundScale[1]+this.myFlagButtonBackgroundScale[1]+s+this.myFlagButtonBackgroundScale[1]*(2*o)+s*o;this.myPinButtonPosition=[],this.myPinButtonPosition[PP.ToolHandedness.NONE]={},this.myPinButtonPosition[PP.ToolHandedness.NONE].myPosition=this.myVisibilityButtonPosition[PP.ToolHandedness.NONE].myPosition.slice(0),this.myPinButtonPosition[PP.ToolHandedness.NONE].myPosition[1]+=l,this.myPinButtonPosition[PP.ToolHandedness.LEFT]={},this.myPinButtonPosition[PP.ToolHandedness.LEFT].myPosition=this.myVisibilityButtonPosition[PP.ToolHandedness.LEFT].myPosition.slice(0),this.myPinButtonPosition[PP.ToolHandedness.LEFT].myPosition[1]+=l,this.myPinButtonPosition[PP.ToolHandedness.RIGHT]={},this.myPinButtonPosition[PP.ToolHandedness.RIGHT].myPosition=this.myVisibilityButtonPosition[PP.ToolHandedness.RIGHT].myPosition.slice(0),this.myPinButtonPosition[PP.ToolHandedness.RIGHT].myPosition[1]+=l,this.myPinButtonText="P",this.myPinButtonCursorTargetPosition=PP.vec3_create(0,0,0),this.myPinButtonCursorTargetPosition[2]=this.myFlagButtonTextPosition[2],this.myPinButtonCollisionExtents=this.myFlagButtonBackgroundScale.slice(0),this.myPinButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness}_initializeRuntimeSetup(){this._initializeObjectsTransforms(),this.myButtonHoverColor=[150/255,150/255,150/255,1],this.myButtonDisabledTextColor=this.myBackgroundColor,this.myButtonDisabledBackgroundColor=[110/255,110/255,110/255,1]}_initializeObjectsTransforms(){this.myPivotObjectTransforms=this._createDefaultObjectTransforms(),this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.LEFT].myRotation=PP.quat_create(-.645,.425,.25,.584),this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.LEFT].myRotation.quat_normalize(this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.LEFT].myRotation),this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.RIGHT].myRotation=PP.quat_create(-.645,-.425,-.25,.584),this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.RIGHT].myRotation.quat_normalize(this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.RIGHT].myRotation),this.myPivotObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.LEFT].myRotation=PP.quat_create(-.645,.425,.25,.584),this.myPivotObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.LEFT].myRotation.quat_normalize(this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.LEFT].myRotation),this.myPivotObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.RIGHT].myRotation=PP.quat_create(-.645,-.425,-.25,.584),this.myPivotObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.RIGHT].myRotation.quat_normalize(this.myPivotObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.RIGHT].myRotation),this.myWidgetObjectTransforms=this._createDefaultObjectTransforms(),this.myWidgetObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.LEFT].myPosition=PP.vec3_create(.1,.23,-.02),this.myWidgetObjectTransforms[PP.ToolInputSourceType.GAMEPAD][PP.ToolHandedness.RIGHT].myPosition=PP.vec3_create(.07,.23,-.02),this.myWidgetObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.LEFT].myPosition=PP.vec3_create(.1,.23,-.02),this.myWidgetObjectTransforms[PP.ToolInputSourceType.TRACKED_HAND][PP.ToolHandedness.RIGHT].myPosition=PP.vec3_create(.07,.23,-.02),this._myPivotObjectDistanceFromNonVRHead=.6}_createDefaultObjectTransforms(){let e=[];for(let t in PP.ToolInputSourceType){let n=PP.ToolInputSourceType[t];e[n]=[];for(let a in PP.ToolHandedness){let s=PP.ToolHandedness[a];e[n][s]={},e[n][s].myPosition=PP.vec3_create(0,0,0),e[n][s].myRotation=PP.quat_create(0,0,0,1)}}return e}}});var jo=S(()=>{PP.WidgetFrameUI=class{constructor(){this._myInputSourceType=null,this._myParentObject=null,this._myIsPinned=!1,this._myWidgetVisible=!0,this._myVisibilityButtonVisible=!0}build(e,t,n){this._myParentObject=e,this._mySetup=t,this._myAdditionalSetup=n,this._myPlaneMesh=PP.MeshUtils.createPlaneMesh(),this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonVR(),WL.xrSession&&this._onXRSessionStart(WL.xrSession),WL.onXRSessionStart.push(this._onXRSessionStart.bind(this)),WL.onXRSessionEnd.push(this._onXRSessionEnd.bind(this))}setWidgetVisible(e){this._myWidgetVisible=e,this.myFlagsButtonPanel.pp_setActiveHierarchy(e),e&&this._updateObjectsTransforms(!0)}setVisibilityButtonVisible(e){this._myVisibilityButtonVisible=e,this.myVisibilityButtonPanel.pp_setActiveHierarchy(e)}setPinned(e){e!=this._myIsPinned&&(this._myIsPinned=e,this._myIsPinned?this.myPivotObject.pp_setParent(null):(this.myPivotObject.pp_setParent(this.myFixForwardObject),PP.XRUtils.isSessionActive()||this._setTransformForNonVR(),this._updateObjectsTransforms(!0)))}update(e){this._updateObjectsTransforms(!1)}_updateObjectsTransforms(e){if(PP.XRUtils.isSessionActive()){let t=PP.InputUtils.getInputSourceTypeByHandedness(this._myAdditionalSetup.myHandedness);(t!=this._myInputSourceType||e)&&(this._myInputSourceType=t,this._myIsPinned||(this.myPivotObject.setTranslationLocal(this._mySetup.myPivotObjectTransforms[this._myInputSourceType][this._myAdditionalSetup.myHandedness].myPosition),this.myPivotObject.resetRotation(),this.myPivotObject.rotateObject(this._mySetup.myPivotObjectTransforms[this._myInputSourceType][this._myAdditionalSetup.myHandedness].myRotation),this.myWidgetObject.setTranslationLocal(this._mySetup.myWidgetObjectTransforms[this._myInputSourceType][this._myAdditionalSetup.myHandedness].myPosition),this.myWidgetObject.resetRotation(),this.myWidgetObject.rotateObject(this._mySetup.myWidgetObjectTransforms[this._myInputSourceType][this._myAdditionalSetup.myHandedness].myRotation),this.myVisibilityButtonPanel.setTranslationLocal(this._mySetup.myVisibilityButtonPosition[this._myAdditionalSetup.myHandedness].myPosition),this.myPinButtonPanel.setTranslationLocal(this._mySetup.myPinButtonPosition[this._myAdditionalSetup.myHandedness].myPosition)))}else this.myVisibilityButtonPanel.pp_setActiveHierarchy(this._myWidgetVisible||this._myVisibilityButtonVisible)}_createSkeleton(){this.myFixForwardObject=WL.scene.addObject(this._myParentObject),this.myFixForwardObject.pp_rotateObject(PP.vec3_create(0,180,0)),this.myPivotObject=WL.scene.addObject(this.myFixForwardObject),this.myWidgetObject=WL.scene.addObject(this.myPivotObject),this.myVisibilityButtonPanel=WL.scene.addObject(this.myPivotObject),this.myVisibilityButtonBackground=WL.scene.addObject(this.myVisibilityButtonPanel),this.myVisibilityButtonText=WL.scene.addObject(this.myVisibilityButtonPanel),this.myVisibilityButtonCursorTarget=WL.scene.addObject(this.myVisibilityButtonPanel),this.myFlagsButtonPanel=WL.scene.addObject(this.myPivotObject),this.myPinButtonPanel=WL.scene.addObject(this.myFlagsButtonPanel),this.myPinButtonBackground=WL.scene.addObject(this.myPinButtonPanel),this.myPinButtonText=WL.scene.addObject(this.myPinButtonPanel),this.myPinButtonCursorTarget=WL.scene.addObject(this.myPinButtonPanel),this.myNonVRParentObject=WL.scene.addObject(PP.myPlayerObjects.myNonVRCamera),this.myNonVRParentObject.pp_translateLocal(PP.vec3_create(0,0,-this._mySetup._myPivotObjectDistanceFromNonVRHead)),this.myNonVRParentObject.pp_lookToLocal(PP.vec3_create(0,0,1),PP.vec3_create(0,1,0))}_setTransforms(){this.myPivotObject.setDirty(),this.myVisibilityButtonPanel.setTranslationLocal(this._mySetup.myVisibilityButtonPosition[this._myAdditionalSetup.myHandedness].myPosition),this.myVisibilityButtonBackground.scale(this._mySetup.myVisibilityButtonBackgroundScale),this.myVisibilityButtonText.setTranslationLocal(this._mySetup.myVisibilityButtonTextPosition),this.myVisibilityButtonText.scale(this._mySetup.myVisibilityButtonTextScale),this.myVisibilityButtonCursorTarget.setTranslationLocal(this._mySetup.myVisibilityButtonCursorTargetPosition),this.myPinButtonPanel.setTranslationLocal(this._mySetup.myPinButtonPosition[this._myAdditionalSetup.myHandedness].myPosition),this.myPinButtonBackground.scale(this._mySetup.myFlagButtonBackgroundScale),this.myPinButtonText.setTranslationLocal(this._mySetup.myFlagButtonTextPosition),this.myPinButtonText.scale(this._mySetup.myFlagButtonTextScale),this.myPinButtonCursorTarget.setTranslationLocal(this._mySetup.myPinButtonCursorTargetPosition)}_addComponents(){this.myVisibilityButtonBackgroundComponent=this.myVisibilityButtonBackground.addComponent("mesh"),this.myVisibilityButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myVisibilityButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myVisibilityButtonBackgroundComponent.material.color=this._mySetup.myBackgroundColor,this.myVisibilityButtonTextComponent=this.myVisibilityButtonText.addComponent("text"),this._setupButtonTextComponent(this.myVisibilityButtonTextComponent),this.myVisibilityButtonTextComponent.text=this._mySetup.myVisibilityButtonText,this.myVisibilityButtonCursorTargetComponent=this.myVisibilityButtonCursorTarget.addComponent("cursor-target"),this.myVisibilityButtonCollisionComponent=this.myVisibilityButtonCursorTarget.addComponent("collision"),this.myVisibilityButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myVisibilityButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myVisibilityButtonCollisionComponent.extents=this._mySetup.myVisibilityButtonCollisionExtents,this.myPinButtonBackgroundComponent=this.myPinButtonBackground.addComponent("mesh"),this.myPinButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPinButtonBackgroundComponent.material=this._myAdditionalSetup.myPlaneMaterial.clone(),this.myPinButtonBackgroundComponent.material.color=this._mySetup.myButtonDisabledBackgroundColor,this.myPinButtonTextComponent=this.myPinButtonText.addComponent("text"),this._setupButtonTextComponent(this.myPinButtonTextComponent),this.myPinButtonTextComponent.material.color=this._mySetup.myButtonDisabledTextColor,this.myPinButtonTextComponent.text=this._mySetup.myPinButtonText,this.myPinButtonCursorTargetComponent=this.myPinButtonCursorTarget.addComponent("cursor-target"),this.myPinButtonCollisionComponent=this.myPinButtonCursorTarget.addComponent("collision"),this.myPinButtonCollisionComponent.collider=this._mySetup.myCursorTargetCollisionCollider,this.myPinButtonCollisionComponent.group=1<<this._mySetup.myCursorTargetCollisionGroup,this.myPinButtonCollisionComponent.extents=this._mySetup.myPinButtonCollisionExtents}_setupButtonTextComponent(e){e.alignment=this._mySetup.myTextAlignment,e.justification=this._mySetup.myTextJustification,e.material=this._myAdditionalSetup.myTextMaterial.clone(),e.material.color=this._mySetup.myTextColor,e.text=""}_onXRSessionStart(){this.myVisibilityButtonPanel.pp_setActiveHierarchy(this._myVisibilityButtonVisible),this._setTransformForVR()}_onXRSessionEnd(){this._setTransformForNonVR()}_setTransformForVR(){this.myFixForwardObject.pp_setParent(this._myParentObject),this.myFixForwardObject.pp_resetTransformLocal(),this.myFixForwardObject.pp_rotateObject(PP.vec3_create(0,180,0)),this._updateObjectsTransforms(!0)}_setTransformForNonVR(){this._myIsPinned||(this.myFixForwardObject.pp_setParent(this.myNonVRParentObject),this.myFixForwardObject.pp_resetTransformLocal(),this.myPivotObject.setTranslationLocal(this._mySetup.myPivotObjectTransforms[PP.ToolInputSourceType.NONE][PP.ToolHandedness.NONE].myPosition),this.myPivotObject.resetRotation(),this.myPivotObject.rotateObject(this._mySetup.myPivotObjectTransforms[PP.ToolInputSourceType.NONE][PP.ToolHandedness.NONE].myRotation),this.myWidgetObject.setTranslationLocal(this._mySetup.myWidgetObjectTransforms[PP.ToolInputSourceType.NONE][PP.ToolHandedness.NONE].myPosition),this.myWidgetObject.resetRotation(),this.myWidgetObject.rotateObject(this._mySetup.myWidgetObjectTransforms[PP.ToolInputSourceType.NONE][PP.ToolHandedness.NONE].myRotation),this.myVisibilityButtonPanel.setTranslationLocal(this._mySetup.myVisibilityButtonPosition[PP.ToolHandedness.NONE].myPosition),this.myPinButtonPanel.setTranslationLocal(this._mySetup.myPinButtonPosition[PP.ToolHandedness.NONE].myPosition))}}});var zo=S(()=>{PP.WidgetFrame=class{constructor(e,t){this.myIsWidgetVisible=!0,this.myIsPinned=!1,this._mySetup=new PP.WidgetFrameSetup(e,t),this._myAdditionalSetup=null,this._myUI=new PP.WidgetFrameUI,this._myShowVisibilityButton=!1,this._myWidgetVisibleChangedCallbacks=new Map,this._myPinChangedCallbacks=new Map}getWidgetObject(){return this._myUI.myWidgetObject}setVisible(e){this.myIsWidgetVisible=!e,this._toggleVisibility(!1,!0)}isVisible(){return this.myIsWidgetVisible}toggleVisibility(){this._toggleVisibility(!1,!0)}togglePin(){this._togglePin(!1)}registerWidgetVisibleChangedEventListener(e,t){this._myWidgetVisibleChangedCallbacks.set(e,t)}unregisterWidgetVisibleChangedEventListener(e){this._myWidgetVisibleChangedCallbacks.delete(e)}registerPinChangedEventListener(e,t){this._myPinChangedCallbacks.set(e,t)}unregisterPinChangedEventListener(e){this._myPinChangedCallbacks.delete(e)}start(e,t){this._myAdditionalSetup=t,this._myUI.build(e,this._mySetup,t),this._myUI.setVisibilityButtonVisible(t.myShowVisibilityButton),this._myShowVisibilityButton=t.myShowVisibilityButton,t.myShowOnStart||this._toggleVisibility(!1,!1),this._addListeners()}update(e){this._myUI.update(e)}_addListeners(){let e=this._myUI;e.myPinButtonCursorTargetComponent.addClickFunction(this._togglePin.bind(this,!0)),e.myPinButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myPinButtonBackgroundComponent.material)),e.myPinButtonCursorTargetComponent.addUnHoverFunction(this._pinUnHover.bind(this,e.myPinButtonBackgroundComponent.material)),e.myVisibilityButtonCursorTargetComponent.addClickFunction(this._toggleVisibility.bind(this,!0,!0)),e.myVisibilityButtonCursorTargetComponent.addHoverFunction(this._genericHover.bind(this,e.myVisibilityButtonBackgroundComponent.material)),e.myVisibilityButtonCursorTargetComponent.addUnHoverFunction(this._visibilityUnHover.bind(this,e.myVisibilityButtonBackgroundComponent.material))}_toggleVisibility(e,t){this.myIsWidgetVisible=!this.myIsWidgetVisible,this._myUI.setWidgetVisible(this.myIsWidgetVisible);let n=this._myUI.myVisibilityButtonTextComponent.material,a=this._myUI.myVisibilityButtonBackgroundComponent.material;if(this.myIsWidgetVisible?(n.color=this._mySetup.myDefaultTextColor,e||(a.color=this._mySetup.myBackgroundColor)):(n.color=this._mySetup.myButtonDisabledTextColor,e||(a.color=this._mySetup.myButtonDisabledBackgroundColor)),t)for(let s of this._myWidgetVisibleChangedCallbacks.values())s(this.myIsWidgetVisible);this._myUI.setVisibilityButtonVisible(this._myShowVisibilityButton)}_togglePin(e){if(this.myIsWidgetVisible){this.myIsPinned=!this.myIsPinned,this._myUI.setPinned(this.myIsPinned);let t=this._myUI.myPinButtonTextComponent.material,n=this._myUI.myPinButtonBackgroundComponent.material;this.myIsPinned?(t.color=this._mySetup.myDefaultTextColor,e||(n.color=this._mySetup.myBackgroundColor)):(t.color=this._mySetup.myButtonDisabledTextColor,e||(n.color=this._mySetup.myButtonDisabledBackgroundColor));for(let a of this._myPinChangedCallbacks.values())a(this.myIsPinned)}}_genericHover(e){e.color=this._mySetup.myButtonHoverColor}_visibilityUnHover(e){this.myIsWidgetVisible?e.color=this._mySetup.myBackgroundColor:e.color=this._mySetup.myButtonDisabledBackgroundColor}_pinUnHover(e){this.myIsPinned?e.color=this._mySetup.myBackgroundColor:e.color=this._mySetup.myButtonDisabledBackgroundColor}}});jt();Di();Li();Bi();Oi();Hi();Ei();ki();Fi();wi();$i();en();nn();an();on();rn();ln();mn();yn();cn();un();hn();pn();dn();_n();Pn();gn();fn();vn();Tn();Cn();Sn();bn();Mn();An();In();xn();Rn();Vn();Dn();Ln();Bn();On();Hn();En();kn();Fn();wn();Wn();jn();zn();Gn();Un();Nn();qn();Qn();Xn();Kn();Jn();Zn();Yn();$n();ea();ta();ia();na();aa();sa();oa();ra();la();ma();ya();ca();ua();ha();pa();da();_a();Pa();ga();fa();va();Ta();Ca();Sa();ba();Ma();Aa();Ia();xa();Ra();Va();Da();La();Ba();Oa();Ha();Ea();ka();Fa();wa();Wa();ja();za();Ga();Ua();Na();qa();Qa();Xa();Ka();Ja();Za();Ya();$a();es();ts();is();ns();as();ss();os();rs();ls();ms();ys();cs();us();hs();ps();ds();_s();Ps();gs();fs();vs();Ts();Cs();Ss();bs();Ms();As();Is();xs();Rs();Vs();Ds();Ls();Bs();Os();Hs();Es();ks();Fs();ws();Ws();js();zs();Gs();Us();Ns();qs();Qs();Xs();Ks();Js();Zs();Ys();$s();eo();to();io();no();ao();so();oo();ro();lo();mo();yo();co();uo();ho();po();_o();Po();go();fo();vo();To();Co();So();bo();Mo();Ao();Io();xo();Ro();Vo();Do();Lo();Bo();Oo();Ho();Eo();ko();Fo();wo();Wo();jo();zo();})();
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
//# sourceMappingURL=wle_pp_bundle.js.map
